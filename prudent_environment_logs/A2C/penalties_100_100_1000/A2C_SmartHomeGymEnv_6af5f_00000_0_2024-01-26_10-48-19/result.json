{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1527852288.0, "policy_entropy": 4295.3291015625, "var_gnorm": 22.627458572387695, "vf_loss": 23511215112192.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": 0.0, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 1, "diff_num_grad_updates_vs_sampler_policy": 0}}, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "sampler_results": {"episode_reward_max": -1661292.0442888488, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1661292.0442888488, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15551258619178296, "mean_inference_ms": 5.212793010632432, "mean_action_processing_ms": 0.14565465004578543, "mean_env_wait_ms": 0.2661211200566957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014972686767578125, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.05931854248046875}}, "episode_reward_max": -1661292.0442888488, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1661292.0442888488, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15551258619178296, "mean_inference_ms": 5.212793010632432, "mean_action_processing_ms": 0.14565465004578543, "mean_env_wait_ms": 0.2661211200566957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014972686767578125, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.05931854248046875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 336, "timers": {"training_iteration_time_ms": 2010.523, "learn_time_ms": 59.063, "learn_throughput": 5688.822, "synch_weights_time_ms": 0.189}, "counters": {"num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-27", "timestamp": 1706266107, "time_this_iter_s": 2.010767936706543, "time_total_s": 2.010767936706543, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2d10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ef8a60fa170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 2.010767936706543, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 6.1000000000000005, "ram_util_percent": 8.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1195777792.0, "policy_entropy": 4257.00439453125, "var_gnorm": 22.629060745239258, "vf_loss": 14645169487872.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.9073486328125e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 2, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "sampler_results": {"episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1495502.8769188724, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15518210669996577, "mean_inference_ms": 5.209000638729455, "mean_action_processing_ms": 0.14531861799055443, "mean_env_wait_ms": 0.26603861108783833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014603137969970703, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.05854368209838867}}, "episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1495502.8769188724, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15518210669996577, "mean_inference_ms": 5.209000638729455, "mean_action_processing_ms": 0.14531861799055443, "mean_env_wait_ms": 0.26603861108783833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014603137969970703, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.05854368209838867}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 672, "timers": {"training_iteration_time_ms": 1984.076, "learn_time_ms": 38.853, "learn_throughput": 8647.97, "synch_weights_time_ms": 0.164}, "counters": {"num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-28", "timestamp": 1706266108, "time_this_iter_s": 1.9578654766082764, "time_total_s": 3.9686334133148193, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8090370>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ef8a60d3d00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 3.9686334133148193, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 8.766666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1317936256.0, "policy_entropy": 4091.661376953125, "var_gnorm": 22.630638122558594, "vf_loss": 18869880094720.0}, "grad_gnorm": 40.0, "vf_explained_var": -3.5762786865234375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 3, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "sampler_results": {"episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1492832.5956486177, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485571983789728, "mean_inference_ms": 5.203140015087111, "mean_action_processing_ms": 0.14507964374267898, "mean_env_wait_ms": 0.2659819457624588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014527638753255209, "StateBufferConnector_ms": 0.0025192896525065103, "ViewRequirementAgentConnector_ms": 0.05820592244466146}}, "episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1492832.5956486177, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485571983789728, "mean_inference_ms": 5.203140015087111, "mean_action_processing_ms": 0.14507964374267898, "mean_env_wait_ms": 0.2659819457624588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014527638753255209, "StateBufferConnector_ms": 0.0025192896525065103, "ViewRequirementAgentConnector_ms": 0.05820592244466146}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1008, "timers": {"training_iteration_time_ms": 1971.355, "learn_time_ms": 32.195, "learn_throughput": 10436.296, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-30", "timestamp": 1706266110, "time_this_iter_s": 1.9461584091186523, "time_total_s": 5.914791822433472, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f184c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9280f880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 5.914791822433472, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 8.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1115812736.0, "policy_entropy": 3645.994140625, "var_gnorm": 22.63355827331543, "vf_loss": 17440992919552.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -5.7220458984375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 4, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "sampler_results": {"episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1471212.8671229798, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15433972561384895, "mean_inference_ms": 5.198773938731373, "mean_action_processing_ms": 0.14475603107299817, "mean_env_wait_ms": 0.2653766687041956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014317035675048828, "StateBufferConnector_ms": 0.002473592758178711, "ViewRequirementAgentConnector_ms": 0.05796551704406738}}, "episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1471212.8671229798, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15433972561384895, "mean_inference_ms": 5.198773938731373, "mean_action_processing_ms": 0.14475603107299817, "mean_env_wait_ms": 0.2653766687041956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014317035675048828, "StateBufferConnector_ms": 0.002473592758178711, "ViewRequirementAgentConnector_ms": 0.05796551704406738}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1344, "timers": {"training_iteration_time_ms": 1963.977, "learn_time_ms": 28.819, "learn_throughput": 11658.82, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-32", "timestamp": 1706266112, "time_this_iter_s": 1.9420907497406006, "time_total_s": 7.856882572174072, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1d50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92820dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 7.856882572174072, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 8.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -961921024.0, "policy_entropy": 3253.7958984375, "var_gnorm": 22.635578155517578, "vf_loss": 16066807857152.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -7.3909759521484375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 5, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "sampler_results": {"episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1450822.0475347564, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539224425627656, "mean_inference_ms": 5.195879908026543, "mean_action_processing_ms": 0.1444854310899972, "mean_env_wait_ms": 0.26478232760449905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014214515686035156, "StateBufferConnector_ms": 0.0024318695068359375, "ViewRequirementAgentConnector_ms": 0.05795478820800781}}, "episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1450822.0475347564, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539224425627656, "mean_inference_ms": 5.195879908026543, "mean_action_processing_ms": 0.1444854310899972, "mean_env_wait_ms": 0.26478232760449905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014214515686035156, "StateBufferConnector_ms": 0.0024318695068359375, "ViewRequirementAgentConnector_ms": 0.05795478820800781}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1680, "timers": {"training_iteration_time_ms": 1960.432, "learn_time_ms": 26.762, "learn_throughput": 12554.91, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-34", "timestamp": 1706266114, "time_this_iter_s": 1.9465136528015137, "time_total_s": 9.803396224975586, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9ab0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92821bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 9.803396224975586, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 9.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -793610176.0, "policy_entropy": 2950.079833984375, "var_gnorm": 22.636213302612305, "vf_loss": 12341875834880.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.1205673217773438e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 6, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "sampler_results": {"episode_reward_max": -1211644.3328933395, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1410959.0950945204, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15360880272805122, "mean_inference_ms": 5.194211421998367, "mean_action_processing_ms": 0.14429362623731765, "mean_env_wait_ms": 0.2642700690658852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014162063598632812, "StateBufferConnector_ms": 0.0024040540059407554, "ViewRequirementAgentConnector_ms": 0.057816505432128906}}, "episode_reward_max": -1211644.3328933395, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1410959.0950945204, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15360880272805122, "mean_inference_ms": 5.194211421998367, "mean_action_processing_ms": 0.14429362623731765, "mean_env_wait_ms": 0.2642700690658852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014162063598632812, "StateBufferConnector_ms": 0.0024040540059407554, "ViewRequirementAgentConnector_ms": 0.057816505432128906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2016, "timers": {"training_iteration_time_ms": 1959.058, "learn_time_ms": 25.4, "learn_throughput": 13228.242, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-36", "timestamp": 1706266116, "time_this_iter_s": 1.9524543285369873, "time_total_s": 11.755850553512573, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd944bf910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 11.755850553512573, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.45, "ram_util_percent": 9.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -698791168.0, "policy_entropy": 2641.40869140625, "var_gnorm": 22.638208389282227, "vf_loss": 12176105406464.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.3470649719238281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 7, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "sampler_results": {"episode_reward_max": -1208216.7021338907, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1381995.8961001446, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15337709213429798, "mean_inference_ms": 5.193898624755696, "mean_action_processing_ms": 0.14415557378556784, "mean_env_wait_ms": 0.26383401601379436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0141143798828125, "StateBufferConnector_ms": 0.0023739678519112723, "ViewRequirementAgentConnector_ms": 0.058000428336007256}}, "episode_reward_max": -1208216.7021338907, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1381995.8961001446, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15337709213429798, "mean_inference_ms": 5.193898624755696, "mean_action_processing_ms": 0.14415557378556784, "mean_env_wait_ms": 0.26383401601379436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0141143798828125, "StateBufferConnector_ms": 0.0023739678519112723, "ViewRequirementAgentConnector_ms": 0.058000428336007256}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2352, "timers": {"training_iteration_time_ms": 1959.863, "learn_time_ms": 24.473, "learn_throughput": 13729.5, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-38", "timestamp": 1706266118, "time_this_iter_s": 1.9649574756622314, "time_total_s": 13.720808029174805, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f187c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92822050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 13.720808029174805, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 9.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5990868480.0, "policy_entropy": 2336.12841796875, "var_gnorm": 22.640920639038086, "vf_loss": 11819765727232.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.4901161193847656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 8, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "sampler_results": {"episode_reward_max": -1171231.5787866367, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1355650.3564359562, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531711912674112, "mean_inference_ms": 5.193820836023331, "mean_action_processing_ms": 0.14404644725639923, "mean_env_wait_ms": 0.26347267992560475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014033913612365723, "StateBufferConnector_ms": 0.0023633241653442383, "ViewRequirementAgentConnector_ms": 0.05786120891571045}}, "episode_reward_max": -1171231.5787866367, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1355650.3564359562, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531711912674112, "mean_inference_ms": 5.193820836023331, "mean_action_processing_ms": 0.14404644725639923, "mean_env_wait_ms": 0.26347267992560475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014033913612365723, "StateBufferConnector_ms": 0.0023633241653442383, "ViewRequirementAgentConnector_ms": 0.05786120891571045}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1959.331, "learn_time_ms": 23.829, "learn_throughput": 14100.229, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-40", "timestamp": 1706266120, "time_this_iter_s": 1.9558868408203125, "time_total_s": 15.676694869995117, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105570>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92822e60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 15.676694869995117, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 9.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8953786368.0, "policy_entropy": 2101.990966796875, "var_gnorm": 22.64286994934082, "vf_loss": 11894300606464.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.5497207641601562e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 9, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "sampler_results": {"episode_reward_max": -1171231.5787866367, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1336561.994900359, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15300718569573893, "mean_inference_ms": 5.1939180590377125, "mean_action_processing_ms": 0.1439599060456349, "mean_env_wait_ms": 0.263188209483993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014095836215549044, "StateBufferConnector_ms": 0.002357694837782118, "ViewRequirementAgentConnector_ms": 0.05802578396267361}}, "episode_reward_max": -1171231.5787866367, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1336561.994900359, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15300718569573893, "mean_inference_ms": 5.1939180590377125, "mean_action_processing_ms": 0.1439599060456349, "mean_env_wait_ms": 0.263188209483993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014095836215549044, "StateBufferConnector_ms": 0.002357694837782118, "ViewRequirementAgentConnector_ms": 0.05802578396267361}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3024, "timers": {"training_iteration_time_ms": 1959.14, "learn_time_ms": 23.276, "learn_throughput": 14435.381, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-42", "timestamp": 1706266122, "time_this_iter_s": 1.9578804969787598, "time_total_s": 17.634575366973877, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9b10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928230a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 17.634575366973877, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 9.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -19133683712.0, "policy_entropy": 1934.100830078125, "var_gnorm": 22.64400863647461, "vf_loss": 10955657314304.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.811981201171875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 10, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1313615.9171498255, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15285406275732266, "mean_inference_ms": 5.193858398295954, "mean_action_processing_ms": 0.14387840803190105, "mean_env_wait_ms": 0.2629213604274061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014088153839111328, "StateBufferConnector_ms": 0.0023412704467773438, "ViewRequirementAgentConnector_ms": 0.057997703552246094}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1313615.9171498255, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15285406275732266, "mean_inference_ms": 5.193858398295954, "mean_action_processing_ms": 0.14387840803190105, "mean_env_wait_ms": 0.2629213604274061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014088153839111328, "StateBufferConnector_ms": 0.0023412704467773438, "ViewRequirementAgentConnector_ms": 0.057997703552246094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3360, "timers": {"training_iteration_time_ms": 1957.925, "learn_time_ms": 22.847, "learn_throughput": 14706.444, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-44", "timestamp": 1706266124, "time_this_iter_s": 1.9472625255584717, "time_total_s": 19.58183789253235, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1c90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92821090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 19.58183789253235, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 9.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -28354002944.0, "policy_entropy": 1824.073486328125, "var_gnorm": 22.64480209350586, "vf_loss": 11284886061056.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.6927719116210938e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 11, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1298451.4700371285, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15273051591062506, "mean_inference_ms": 5.194002128099247, "mean_action_processing_ms": 0.14381640533461046, "mean_env_wait_ms": 0.26270364009832653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014569542624733665, "StateBufferConnector_ms": 0.0023321671919389205, "ViewRequirementAgentConnector_ms": 0.05797472867098721}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1298451.4700371285, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15273051591062506, "mean_inference_ms": 5.194002128099247, "mean_action_processing_ms": 0.14381640533461046, "mean_env_wait_ms": 0.26270364009832653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014569542624733665, "StateBufferConnector_ms": 0.0023321671919389205, "ViewRequirementAgentConnector_ms": 0.05797472867098721}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3696, "timers": {"training_iteration_time_ms": 1952.992, "learn_time_ms": 18.807, "learn_throughput": 17865.841, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-46", "timestamp": 1706266126, "time_this_iter_s": 1.9614636898040771, "time_total_s": 21.543301582336426, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3970>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928237f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 21.543301582336426, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 9.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1660150784.0, "policy_entropy": 1754.1953125, "var_gnorm": 22.64542007446289, "vf_loss": 12976188817408.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.7404556274414062e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 12, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1291916.1360380512, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15262181171788167, "mean_inference_ms": 5.194017276830601, "mean_action_processing_ms": 0.14375872288893823, "mean_env_wait_ms": 0.2625023959269681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014507770538330078, "StateBufferConnector_ms": 0.0023245811462402344, "ViewRequirementAgentConnector_ms": 0.05805492401123047}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1291916.1360380512, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15262181171788167, "mean_inference_ms": 5.194017276830601, "mean_action_processing_ms": 0.14375872288893823, "mean_env_wait_ms": 0.2625023959269681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014507770538330078, "StateBufferConnector_ms": 0.0023245811462402344, "ViewRequirementAgentConnector_ms": 0.05805492401123047}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4032, "timers": {"training_iteration_time_ms": 1951.979, "learn_time_ms": 18.836, "learn_throughput": 17837.778, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-48", "timestamp": 1706266128, "time_this_iter_s": 1.94779372215271, "time_total_s": 23.491095304489136, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d06a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92823760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 23.491095304489136, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 9.649999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -24127901696.0, "policy_entropy": 1685.5087890625, "var_gnorm": 22.646318435668945, "vf_loss": 12028004532224.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.7404556274414062e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 13, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284310.136655023, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1525252739539016, "mean_inference_ms": 5.1939665983412535, "mean_action_processing_ms": 0.14370852532362316, "mean_env_wait_ms": 0.2623142624974003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01452335944542518, "StateBufferConnector_ms": 0.0023163281954251803, "ViewRequirementAgentConnector_ms": 0.05807693188007061}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284310.136655023, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1525252739539016, "mean_inference_ms": 5.1939665983412535, "mean_action_processing_ms": 0.14370852532362316, "mean_env_wait_ms": 0.2623142624974003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01452335944542518, "StateBufferConnector_ms": 0.0023163281954251803, "ViewRequirementAgentConnector_ms": 0.05807693188007061}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4368, "timers": {"training_iteration_time_ms": 1952.341, "learn_time_ms": 18.934, "learn_throughput": 17745.665, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-50", "timestamp": 1706266130, "time_this_iter_s": 1.9498088359832764, "time_total_s": 25.440904140472412, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19090>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92821990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 25.440904140472412, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 9.733333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -971224960.0, "policy_entropy": 1687.32958984375, "var_gnorm": 22.646800994873047, "vf_loss": 11430044631040.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.8596649169921875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 14, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1274469.7470798152, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244361256799963, "mean_inference_ms": 5.194019959991535, "mean_action_processing_ms": 0.14366639097875336, "mean_env_wait_ms": 0.26214850891017544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014478819710867745, "StateBufferConnector_ms": 0.0023194721766880582, "ViewRequirementAgentConnector_ms": 0.05810431071690151}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1274469.7470798152, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244361256799963, "mean_inference_ms": 5.194019959991535, "mean_action_processing_ms": 0.14366639097875336, "mean_env_wait_ms": 0.26214850891017544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014478819710867745, "StateBufferConnector_ms": 0.0023194721766880582, "ViewRequirementAgentConnector_ms": 0.05810431071690151}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4704, "timers": {"training_iteration_time_ms": 1954.09, "learn_time_ms": 18.947, "learn_throughput": 17733.606, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-52", "timestamp": 1706266132, "time_this_iter_s": 1.9596261978149414, "time_total_s": 27.400530338287354, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8090f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92854280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 27.400530338287354, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -16650246144.0, "policy_entropy": 1644.059326171875, "var_gnorm": 22.6478271484375, "vf_loss": 12005119361024.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.9431114196777344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 15, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1268319.0036370198, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15237517081599966, "mean_inference_ms": 5.194195129090753, "mean_action_processing_ms": 0.1436322862502217, "mean_env_wait_ms": 0.26200767925159124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014460881551106771, "StateBufferConnector_ms": 0.002311070760091146, "ViewRequirementAgentConnector_ms": 0.0582122802734375}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1268319.0036370198, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15237517081599966, "mean_inference_ms": 5.194195129090753, "mean_action_processing_ms": 0.1436322862502217, "mean_env_wait_ms": 0.26200767925159124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014460881551106771, "StateBufferConnector_ms": 0.002311070760091146, "ViewRequirementAgentConnector_ms": 0.0582122802734375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 1955.862, "learn_time_ms": 18.99, "learn_throughput": 17693.486, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-54", "timestamp": 1706266134, "time_this_iter_s": 1.964247226715088, "time_total_s": 29.36477756500244, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccbb20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928211b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 29.36477756500244, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333334, "ram_util_percent": 9.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4048100864.0, "policy_entropy": 1641.7650146484375, "var_gnorm": 22.648624420166016, "vf_loss": 12698201882624.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.6570091247558594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 16, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1264572.416368843, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15231610773845472, "mean_inference_ms": 5.194413492962804, "mean_action_processing_ms": 0.14360497727157723, "mean_env_wait_ms": 0.26188051747056407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014670193195343018, "StateBufferConnector_ms": 0.002306699752807617, "ViewRequirementAgentConnector_ms": 0.05822479724884033}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1264572.416368843, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15231610773845472, "mean_inference_ms": 5.194413492962804, "mean_action_processing_ms": 0.14360497727157723, "mean_env_wait_ms": 0.26188051747056407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014670193195343018, "StateBufferConnector_ms": 0.002306699752807617, "ViewRequirementAgentConnector_ms": 0.05822479724884033}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 1956.602, "learn_time_ms": 19.0, "learn_throughput": 17684.139, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-56", "timestamp": 1706266136, "time_this_iter_s": 1.959871768951416, "time_total_s": 31.324649333953857, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3a90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ef8a60f8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 31.324649333953857, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 10.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -750747776.0, "policy_entropy": 1702.3358154296875, "var_gnorm": 22.649145126342773, "vf_loss": 10929467031552.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.8358230590820312e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 17, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257612.5344523876, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522698740539264, "mean_inference_ms": 5.194755228549354, "mean_action_processing_ms": 0.14358345083275276, "mean_env_wait_ms": 0.2617769730295734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014620668747845818, "StateBufferConnector_ms": 0.0022986355949850645, "ViewRequirementAgentConnector_ms": 0.05825407364789177}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257612.5344523876, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522698740539264, "mean_inference_ms": 5.194755228549354, "mean_action_processing_ms": 0.14358345083275276, "mean_env_wait_ms": 0.2617769730295734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014620668747845818, "StateBufferConnector_ms": 0.0022986355949850645, "ViewRequirementAgentConnector_ms": 0.05825407364789177}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5712, "timers": {"training_iteration_time_ms": 1957.221, "learn_time_ms": 19.009, "learn_throughput": 17675.998, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "done": false, "episodes_total": 17, "training_iteration": 17, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-48-58", "timestamp": 1706266138, "time_this_iter_s": 1.9711673259735107, "time_total_s": 33.29581665992737, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105630>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92854af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 33.29581665992737, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 10.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -783846080.0, "policy_entropy": 1803.4246826171875, "var_gnorm": 22.649600982666016, "vf_loss": 12081460936704.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.6808509826660156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 18, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1253246.2962521554, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522295497082081, "mean_inference_ms": 5.195079245547405, "mean_action_processing_ms": 0.14356496485866962, "mean_env_wait_ms": 0.2616866811652385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014564726087782118, "StateBufferConnector_ms": 0.0022954410976833766, "ViewRequirementAgentConnector_ms": 0.0584668583340115}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1253246.2962521554, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522295497082081, "mean_inference_ms": 5.195079245547405, "mean_action_processing_ms": 0.14356496485866962, "mean_env_wait_ms": 0.2616866811652385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014564726087782118, "StateBufferConnector_ms": 0.0022954410976833766, "ViewRequirementAgentConnector_ms": 0.0584668583340115}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6048, "timers": {"training_iteration_time_ms": 1957.447, "learn_time_ms": 18.944, "learn_throughput": 17736.173, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "done": false, "episodes_total": 18, "training_iteration": 18, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-00", "timestamp": 1706266140, "time_this_iter_s": 1.958155870437622, "time_total_s": 35.25397253036499, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d20b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928236d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 35.25397253036499, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 10.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -498618464.0, "policy_entropy": 1919.781494140625, "var_gnorm": 22.650039672851562, "vf_loss": 11028122304512.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.621246337890625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 19, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1247370.6247101538, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15219799429415395, "mean_inference_ms": 5.195353961965096, "mean_action_processing_ms": 0.14355124647167536, "mean_env_wait_ms": 0.26160938166921643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014962648090563323, "StateBufferConnector_ms": 0.002293837697882401, "ViewRequirementAgentConnector_ms": 0.05840376803749486}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1247370.6247101538, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15219799429415395, "mean_inference_ms": 5.195353961965096, "mean_action_processing_ms": 0.14355124647167536, "mean_env_wait_ms": 0.26160938166921643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014962648090563323, "StateBufferConnector_ms": 0.002293837697882401, "ViewRequirementAgentConnector_ms": 0.05840376803749486}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6384, "timers": {"training_iteration_time_ms": 1957.209, "learn_time_ms": 18.96, "learn_throughput": 17721.141, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "done": false, "episodes_total": 19, "training_iteration": 19, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-02", "timestamp": 1706266142, "time_this_iter_s": 1.9555201530456543, "time_total_s": 37.209492683410645, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18e80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928549d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 37.209492683410645, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 10.233333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -516327712.0, "policy_entropy": 1947.475341796875, "var_gnorm": 22.651330947875977, "vf_loss": 12125724475392.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.5020370483398438e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 20, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1245309.3707845286, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1521697468633099, "mean_inference_ms": 5.19559088722771, "mean_action_processing_ms": 0.14354100921262486, "mean_env_wait_ms": 0.2615429008002447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014899969100952148, "StateBufferConnector_ms": 0.0022971630096435547, "ViewRequirementAgentConnector_ms": 0.05842447280883789}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1245309.3707845286, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1521697468633099, "mean_inference_ms": 5.19559088722771, "mean_action_processing_ms": 0.14354100921262486, "mean_env_wait_ms": 0.2615429008002447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014899969100952148, "StateBufferConnector_ms": 0.0022971630096435547, "ViewRequirementAgentConnector_ms": 0.05842447280883789}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6720, "timers": {"training_iteration_time_ms": 1958.009, "learn_time_ms": 18.944, "learn_throughput": 17736.887, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-04", "timestamp": 1706266144, "time_this_iter_s": 1.9552850723266602, "time_total_s": 39.164777755737305, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8091420>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92855480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 39.164777755737305, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 10.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -540923968.0, "policy_entropy": 1961.302490234375, "var_gnorm": 22.6533145904541, "vf_loss": 12411155251200.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.5020370483398438e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 21, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1243912.2011170022, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15214361958710387, "mean_inference_ms": 5.1958328031979875, "mean_action_processing_ms": 0.14353254290111722, "mean_env_wait_ms": 0.2614795536966644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014969280787876673, "StateBufferConnector_ms": 0.0023013069516136533, "ViewRequirementAgentConnector_ms": 0.05841709318615142}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1243912.2011170022, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15214361958710387, "mean_inference_ms": 5.1958328031979875, "mean_action_processing_ms": 0.14353254290111722, "mean_env_wait_ms": 0.2614795536966644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014969280787876673, "StateBufferConnector_ms": 0.0023013069516136533, "ViewRequirementAgentConnector_ms": 0.05841709318615142}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7056, "timers": {"training_iteration_time_ms": 1957.838, "learn_time_ms": 18.99, "learn_throughput": 17693.664, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "done": false, "episodes_total": 21, "training_iteration": 21, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-06", "timestamp": 1706266146, "time_this_iter_s": 1.9597735404968262, "time_total_s": 41.12455129623413, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca530>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92821240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 41.12455129623413, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 10.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -656905600.0, "policy_entropy": 1955.4453125, "var_gnorm": 22.656204223632812, "vf_loss": 14561841250304.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.239776611328125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 22, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1246850.9170139774, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15212460598731006, "mean_inference_ms": 5.196110657053482, "mean_action_processing_ms": 0.14352622301096618, "mean_env_wait_ms": 0.2614230911709583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015266375108198687, "StateBufferConnector_ms": 0.002306157892400568, "ViewRequirementAgentConnector_ms": 0.05852092396129261}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1246850.9170139774, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15212460598731006, "mean_inference_ms": 5.196110657053482, "mean_action_processing_ms": 0.14352622301096618, "mean_env_wait_ms": 0.2614230911709583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015266375108198687, "StateBufferConnector_ms": 0.002306157892400568, "ViewRequirementAgentConnector_ms": 0.05852092396129261}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7392, "timers": {"training_iteration_time_ms": 1959.816, "learn_time_ms": 19.065, "learn_throughput": 17623.765, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "done": false, "episodes_total": 22, "training_iteration": 22, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-08", "timestamp": 1706266148, "time_this_iter_s": 1.9676024913787842, "time_total_s": 43.092153787612915, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1db0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92855120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 43.092153787612915, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 10.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -675399360.0, "policy_entropy": 1982.1680908203125, "var_gnorm": 22.65787124633789, "vf_loss": 16130995388416.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.2993812561035156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 23, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1252899.8052255302, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15211046272342282, "mean_inference_ms": 5.1964312992336374, "mean_action_processing_ms": 0.14352130502664404, "mean_env_wait_ms": 0.2613745468022225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015284704125445822, "StateBufferConnector_ms": 0.0023095504097316575, "ViewRequirementAgentConnector_ms": 0.05854109059209409}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1252899.8052255302, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15211046272342282, "mean_inference_ms": 5.1964312992336374, "mean_action_processing_ms": 0.14352130502664404, "mean_env_wait_ms": 0.2613745468022225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015284704125445822, "StateBufferConnector_ms": 0.0023095504097316575, "ViewRequirementAgentConnector_ms": 0.05854109059209409}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7728, "timers": {"training_iteration_time_ms": 1961.814, "learn_time_ms": 18.975, "learn_throughput": 17707.825, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "done": false, "episodes_total": 23, "training_iteration": 23, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-10", "timestamp": 1706266150, "time_this_iter_s": 1.969811201095581, "time_total_s": 45.061964988708496, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18e80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92821ea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 45.061964988708496, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 10.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -649025920.0, "policy_entropy": 2038.5340576171875, "var_gnorm": 22.658720016479492, "vf_loss": 15531717427200.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.3470649719238281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 24, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257056.1003451296, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15209815130719842, "mean_inference_ms": 5.1967051732879925, "mean_action_processing_ms": 0.14351624614676306, "mean_env_wait_ms": 0.2613261401233608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01522998015085856, "StateBufferConnector_ms": 0.0023096799850463867, "ViewRequirementAgentConnector_ms": 0.058613220850626625}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257056.1003451296, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15209815130719842, "mean_inference_ms": 5.1967051732879925, "mean_action_processing_ms": 0.14351624614676306, "mean_env_wait_ms": 0.2613261401233608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01522998015085856, "StateBufferConnector_ms": 0.0023096799850463867, "ViewRequirementAgentConnector_ms": 0.058613220850626625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1961.13, "learn_time_ms": 19.007, "learn_throughput": 17677.284, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-12", "timestamp": 1706266152, "time_this_iter_s": 1.9528110027313232, "time_total_s": 47.01477599143982, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1030>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92855090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 47.01477599143982, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 10.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -723696384.0, "policy_entropy": 2050.43994140625, "var_gnorm": 22.659996032714844, "vf_loss": 15933895606272.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.4662742614746094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 25, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1262701.178806744, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15209060639927122, "mean_inference_ms": 5.197049689763236, "mean_action_processing_ms": 0.14351383684020358, "mean_env_wait_ms": 0.2612858229033209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015198707580566406, "StateBufferConnector_ms": 0.0023050308227539062, "ViewRequirementAgentConnector_ms": 0.058625221252441406}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1262701.178806744, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15209060639927122, "mean_inference_ms": 5.197049689763236, "mean_action_processing_ms": 0.14351383684020358, "mean_env_wait_ms": 0.2612858229033209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015198707580566406, "StateBufferConnector_ms": 0.0023050308227539062, "ViewRequirementAgentConnector_ms": 0.058625221252441406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 1962.555, "learn_time_ms": 18.99, "learn_throughput": 17693.686, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "done": false, "episodes_total": 25, "training_iteration": 25, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-14", "timestamp": 1706266154, "time_this_iter_s": 1.9785330295562744, "time_total_s": 48.993309020996094, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19cc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92821bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 48.993309020996094, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 10.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -748444288.0, "policy_entropy": 2093.775146484375, "var_gnorm": 22.66047477722168, "vf_loss": 18301405102080.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.1920928955078125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 26, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269999.0650036419, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15208553212048898, "mean_inference_ms": 5.197411555663942, "mean_action_processing_ms": 0.14351158707522088, "mean_env_wait_ms": 0.26124704753379413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015153334690974308, "StateBufferConnector_ms": 0.0023025732774000903, "ViewRequirementAgentConnector_ms": 0.05866105739886944}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269999.0650036419, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15208553212048898, "mean_inference_ms": 5.197411555663942, "mean_action_processing_ms": 0.14351158707522088, "mean_env_wait_ms": 0.26124704753379413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015153334690974308, "StateBufferConnector_ms": 0.0023025732774000903, "ViewRequirementAgentConnector_ms": 0.05866105739886944}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8736, "timers": {"training_iteration_time_ms": 1963.312, "learn_time_ms": 18.974, "learn_throughput": 17708.27, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "done": false, "episodes_total": 26, "training_iteration": 26, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-16", "timestamp": 1706266156, "time_this_iter_s": 1.967480182647705, "time_total_s": 50.9607892036438, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92855d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 50.9607892036438, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 10.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -730206784.0, "policy_entropy": 2164.85498046875, "var_gnorm": 22.659990310668945, "vf_loss": 16453157781504.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.33514404296875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 27, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1274895.9695379569, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.152082332274167, "mean_inference_ms": 5.197801304306567, "mean_action_processing_ms": 0.14350899920449656, "mean_env_wait_ms": 0.26121079238416434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015114854883264613, "StateBufferConnector_ms": 0.0023011808042173033, "ViewRequirementAgentConnector_ms": 0.05867304625334563}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1274895.9695379569, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.152082332274167, "mean_inference_ms": 5.197801304306567, "mean_action_processing_ms": 0.14350899920449656, "mean_env_wait_ms": 0.26121079238416434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015114854883264613, "StateBufferConnector_ms": 0.0023011808042173033, "ViewRequirementAgentConnector_ms": 0.05867304625334563}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9072, "timers": {"training_iteration_time_ms": 1963.349, "learn_time_ms": 18.939, "learn_throughput": 17741.331, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "done": false, "episodes_total": 27, "training_iteration": 27, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-18", "timestamp": 1706266158, "time_this_iter_s": 1.9715700149536133, "time_total_s": 52.93235921859741, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8090f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92822830>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 52.93235921859741, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 10.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -707124608.0, "policy_entropy": 2250.8916015625, "var_gnorm": 22.65918731689453, "vf_loss": 17157406588928.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.1205673217773438e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 28, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1279292.9212102238, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15208012906527593, "mean_inference_ms": 5.198178713059635, "mean_action_processing_ms": 0.1435052564316479, "mean_env_wait_ms": 0.2611734623472339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015072311673845564, "StateBufferConnector_ms": 0.002299887793404715, "ViewRequirementAgentConnector_ms": 0.058903864451817105}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1279292.9212102238, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15208012906527593, "mean_inference_ms": 5.198178713059635, "mean_action_processing_ms": 0.1435052564316479, "mean_env_wait_ms": 0.2611734623472339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015072311673845564, "StateBufferConnector_ms": 0.002299887793404715, "ViewRequirementAgentConnector_ms": 0.058903864451817105}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9408, "timers": {"training_iteration_time_ms": 1963.715, "learn_time_ms": 18.974, "learn_throughput": 17708.582, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-20", "timestamp": 1706266160, "time_this_iter_s": 1.9618279933929443, "time_total_s": 54.894187211990356, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3bb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928555a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 54.894187211990356, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 11.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -687052736.0, "policy_entropy": 2352.90185546875, "var_gnorm": 22.65814781188965, "vf_loss": 16731985674240.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.0728836059570312e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 29, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284003.3704663191, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15207906099955767, "mean_inference_ms": 5.198530423563205, "mean_action_processing_ms": 0.14350008992698135, "mean_env_wait_ms": 0.2611349123233526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015039279543120286, "StateBufferConnector_ms": 0.002301972487877155, "ViewRequirementAgentConnector_ms": 0.05892145222630994}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284003.3704663191, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15207906099955767, "mean_inference_ms": 5.198530423563205, "mean_action_processing_ms": 0.14350008992698135, "mean_env_wait_ms": 0.2611349123233526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015039279543120286, "StateBufferConnector_ms": 0.002301972487877155, "ViewRequirementAgentConnector_ms": 0.05892145222630994}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9744, "timers": {"training_iteration_time_ms": 1963.901, "learn_time_ms": 18.934, "learn_throughput": 17745.799, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "done": false, "episodes_total": 29, "training_iteration": 29, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-22", "timestamp": 1706266162, "time_this_iter_s": 1.9574007987976074, "time_total_s": 56.851588010787964, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3c10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92856b00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 56.851588010787964, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 11.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -795426176.0, "policy_entropy": 2419.02978515625, "var_gnorm": 22.65766716003418, "vf_loss": 17995709546496.0}, "grad_gnorm": 40.0, "vf_explained_var": -9.655952453613281e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 30, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1289132.703184466, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15207826929063759, "mean_inference_ms": 5.198865347886356, "mean_action_processing_ms": 0.14349450567169103, "mean_env_wait_ms": 0.2610971879902449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015229384104410807, "StateBufferConnector_ms": 0.002299149831136068, "ViewRequirementAgentConnector_ms": 0.05889574686686198}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1289132.703184466, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15207826929063759, "mean_inference_ms": 5.198865347886356, "mean_action_processing_ms": 0.14349450567169103, "mean_env_wait_ms": 0.2610971879902449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015229384104410807, "StateBufferConnector_ms": 0.002299149831136068, "ViewRequirementAgentConnector_ms": 0.05889574686686198}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10080, "timers": {"training_iteration_time_ms": 1964.363, "learn_time_ms": 18.919, "learn_throughput": 17759.507, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "done": false, "episodes_total": 30, "training_iteration": 30, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-24", "timestamp": 1706266164, "time_this_iter_s": 1.9599425792694092, "time_total_s": 58.81153059005737, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccbd60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92856d40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 58.81153059005737, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 11.199999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -785506944.0, "policy_entropy": 2488.8564453125, "var_gnorm": 22.657142639160156, "vf_loss": 16802804400128.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -9.5367431640625e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 31, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1292387.8233637777, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15207868304285427, "mean_inference_ms": 5.199200777142292, "mean_action_processing_ms": 0.14348763704742912, "mean_env_wait_ms": 0.2610607428631842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015192647134104082, "StateBufferConnector_ms": 0.002299585650044103, "ViewRequirementAgentConnector_ms": 0.05893861093828755}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1292387.8233637777, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15207868304285427, "mean_inference_ms": 5.199200777142292, "mean_action_processing_ms": 0.14348763704742912, "mean_env_wait_ms": 0.2610607428631842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015192647134104082, "StateBufferConnector_ms": 0.002299585650044103, "ViewRequirementAgentConnector_ms": 0.05893861093828755}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10416, "timers": {"training_iteration_time_ms": 1964.928, "learn_time_ms": 18.893, "learn_throughput": 17784.316, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "done": false, "episodes_total": 31, "training_iteration": 31, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-26", "timestamp": 1706266166, "time_this_iter_s": 1.9654333591461182, "time_total_s": 60.77696394920349, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92855f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 60.77696394920349, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 11.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -834138112.0, "policy_entropy": 2552.814697265625, "var_gnorm": 22.6567440032959, "vf_loss": 18334145839104.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.0609626770019531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 32, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297565.5156206735, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15208227976844035, "mean_inference_ms": 5.199595052533061, "mean_action_processing_ms": 0.14348252199138, "mean_env_wait_ms": 0.2610301429114042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015194714069366455, "StateBufferConnector_ms": 0.00230446457862854, "ViewRequirementAgentConnector_ms": 0.059267133474349976}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297565.5156206735, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15208227976844035, "mean_inference_ms": 5.199595052533061, "mean_action_processing_ms": 0.14348252199138, "mean_env_wait_ms": 0.2610301429114042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015194714069366455, "StateBufferConnector_ms": 0.00230446457862854, "ViewRequirementAgentConnector_ms": 0.059267133474349976}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1967.074, "learn_time_ms": 18.783, "learn_throughput": 17888.542, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 32, "training_iteration": 32, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-28", "timestamp": 1706266168, "time_this_iter_s": 1.9890832901000977, "time_total_s": 62.76604723930359, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d26e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92822ef0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 62.76604723930359, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 11.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -793070848.0, "policy_entropy": 2601.87109375, "var_gnorm": 22.656694412231445, "vf_loss": 16487779663872.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -9.417533874511719e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 33, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1300016.4223462455, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15208702047808104, "mean_inference_ms": 5.199990035931735, "mean_action_processing_ms": 0.14347814534236286, "mean_env_wait_ms": 0.2610025804724454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513596737023556, "StateBufferConnector_ms": 0.00230326797022964, "ViewRequirementAgentConnector_ms": 0.059266523881392044}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1300016.4223462455, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15208702047808104, "mean_inference_ms": 5.199990035931735, "mean_action_processing_ms": 0.14347814534236286, "mean_env_wait_ms": 0.2610025804724454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513596737023556, "StateBufferConnector_ms": 0.00230326797022964, "ViewRequirementAgentConnector_ms": 0.059266523881392044}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11088, "timers": {"training_iteration_time_ms": 1967.078, "learn_time_ms": 18.757, "learn_throughput": 17913.144, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "done": false, "episodes_total": 33, "training_iteration": 33, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-30", "timestamp": 1706266170, "time_this_iter_s": 1.9698655605316162, "time_total_s": 64.7359127998352, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d24a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92855d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 64.7359127998352, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 11.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -687634048.0, "policy_entropy": 2632.87353515625, "var_gnorm": 22.657054901123047, "vf_loss": 12237779501056.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.0132789611816406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 34, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297534.5856227474, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15209186290640403, "mean_inference_ms": 5.20035276166613, "mean_action_processing_ms": 0.14347363063803134, "mean_env_wait_ms": 0.260975390743093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01509540221270393, "StateBufferConnector_ms": 0.002304245443905101, "ViewRequirementAgentConnector_ms": 0.0592491206000833}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297534.5856227474, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15209186290640403, "mean_inference_ms": 5.20035276166613, "mean_action_processing_ms": 0.14347363063803134, "mean_env_wait_ms": 0.260975390743093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01509540221270393, "StateBufferConnector_ms": 0.002304245443905101, "ViewRequirementAgentConnector_ms": 0.0592491206000833}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11424, "timers": {"training_iteration_time_ms": 1967.501, "learn_time_ms": 18.806, "learn_throughput": 17866.634, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "done": false, "episodes_total": 34, "training_iteration": 34, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-32", "timestamp": 1706266172, "time_this_iter_s": 1.9570419788360596, "time_total_s": 66.69295477867126, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92856290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 66.69295477867126, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 11.533333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -721349440.0, "policy_entropy": 2626.3427734375, "var_gnorm": 22.658103942871094, "vf_loss": 14278217170944.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -9.894371032714844e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 35, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297666.8644412204, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1520985316039301, "mean_inference_ms": 5.200697182904019, "mean_action_processing_ms": 0.1434701046129161, "mean_env_wait_ms": 0.26095045235514175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015079634530203683, "StateBufferConnector_ms": 0.0023044858660016742, "ViewRequirementAgentConnector_ms": 0.05925587245396206}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297666.8644412204, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1520985316039301, "mean_inference_ms": 5.200697182904019, "mean_action_processing_ms": 0.1434701046129161, "mean_env_wait_ms": 0.26095045235514175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015079634530203683, "StateBufferConnector_ms": 0.0023044858660016742, "ViewRequirementAgentConnector_ms": 0.05925587245396206}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11760, "timers": {"training_iteration_time_ms": 1965.895, "learn_time_ms": 18.791, "learn_throughput": 17880.643, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "done": false, "episodes_total": 35, "training_iteration": 35, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-34", "timestamp": 1706266174, "time_this_iter_s": 1.9625046253204346, "time_total_s": 68.6554594039917, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c225f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92857760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 68.6554594039917, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 11.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -691416512.0, "policy_entropy": 2656.50537109375, "var_gnorm": 22.658546447753906, "vf_loss": 12722770018304.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -7.510185241699219e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 36, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1295325.8564868916, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15210543757036382, "mean_inference_ms": 5.201006103754692, "mean_action_processing_ms": 0.14346643752241994, "mean_env_wait_ms": 0.2609255614639075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015032953686184354, "StateBufferConnector_ms": 0.002305375205145942, "ViewRequirementAgentConnector_ms": 0.059234433703952365}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1295325.8564868916, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15210543757036382, "mean_inference_ms": 5.201006103754692, "mean_action_processing_ms": 0.14346643752241994, "mean_env_wait_ms": 0.2609255614639075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015032953686184354, "StateBufferConnector_ms": 0.002305375205145942, "ViewRequirementAgentConnector_ms": 0.059234433703952365}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12096, "timers": {"training_iteration_time_ms": 1964.445, "learn_time_ms": 18.864, "learn_throughput": 17812.009, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "done": false, "episodes_total": 36, "training_iteration": 36, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-36", "timestamp": 1706266176, "time_this_iter_s": 1.9530072212219238, "time_total_s": 70.60846662521362, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18e80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928579a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 70.60846662521362, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 11.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -743847360.0, "policy_entropy": 2718.052490234375, "var_gnorm": 22.65862464904785, "vf_loss": 13987433414656.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -8.344650268554688e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 37, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1294249.254169845, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15211270996727316, "mean_inference_ms": 5.201292509881927, "mean_action_processing_ms": 0.14346186918762308, "mean_env_wait_ms": 0.2609018024778459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015017148610707876, "StateBufferConnector_ms": 0.002306860846442145, "ViewRequirementAgentConnector_ms": 0.05924379503404772}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1294249.254169845, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15211270996727316, "mean_inference_ms": 5.201292509881927, "mean_action_processing_ms": 0.14346186918762308, "mean_env_wait_ms": 0.2609018024778459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015017148610707876, "StateBufferConnector_ms": 0.002306860846442145, "ViewRequirementAgentConnector_ms": 0.05924379503404772}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12432, "timers": {"training_iteration_time_ms": 1962.979, "learn_time_ms": 18.871, "learn_throughput": 17805.078, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "done": false, "episodes_total": 37, "training_iteration": 37, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-38", "timestamp": 1706266178, "time_this_iter_s": 1.9569370746612549, "time_total_s": 72.56540369987488, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3d60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92855870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 72.56540369987488, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 11.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -708654656.0, "policy_entropy": 2814.380615234375, "var_gnorm": 22.658042907714844, "vf_loss": 12457995141120.0}, "grad_gnorm": 40.0, "vf_explained_var": -7.748603820800781e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 38, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1291865.8949376736, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15212021808373868, "mean_inference_ms": 5.201527062209043, "mean_action_processing_ms": 0.14345696195218646, "mean_env_wait_ms": 0.260879851707416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015137070103695518, "StateBufferConnector_ms": 0.0023063860441509044, "ViewRequirementAgentConnector_ms": 0.05920560736405222}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1291865.8949376736, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15212021808373868, "mean_inference_ms": 5.201527062209043, "mean_action_processing_ms": 0.14345696195218646, "mean_env_wait_ms": 0.260879851707416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015137070103695518, "StateBufferConnector_ms": 0.0023063860441509044, "ViewRequirementAgentConnector_ms": 0.05920560736405222}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12768, "timers": {"training_iteration_time_ms": 1960.989, "learn_time_ms": 18.807, "learn_throughput": 17865.592, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "done": false, "episodes_total": 38, "training_iteration": 38, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-40", "timestamp": 1706266180, "time_this_iter_s": 1.9419636726379395, "time_total_s": 74.50736737251282, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a61055a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a0940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 74.50736737251282, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 11.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -772316352.0, "policy_entropy": 2861.9921875, "var_gnorm": 22.658315658569336, "vf_loss": 12896197148672.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.0013580322265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 39, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290159.4212083532, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15212686515912088, "mean_inference_ms": 5.20170993145597, "mean_action_processing_ms": 0.14345192990277264, "mean_env_wait_ms": 0.2608580555020711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015101066002478966, "StateBufferConnector_ms": 0.002303490271935096, "ViewRequirementAgentConnector_ms": 0.0591895519158779}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290159.4212083532, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15212686515912088, "mean_inference_ms": 5.20170993145597, "mean_action_processing_ms": 0.14345192990277264, "mean_env_wait_ms": 0.2608580555020711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015101066002478966, "StateBufferConnector_ms": 0.002303490271935096, "ViewRequirementAgentConnector_ms": 0.0591895519158779}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13104, "timers": {"training_iteration_time_ms": 1959.128, "learn_time_ms": 18.886, "learn_throughput": 17790.535, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "done": false, "episodes_total": 39, "training_iteration": 39, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-42", "timestamp": 1706266182, "time_this_iter_s": 1.938821792602539, "time_total_s": 76.44618916511536, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2380>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92857490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 76.44618916511536, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 12.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -802046272.0, "policy_entropy": 2869.718505859375, "var_gnorm": 22.6590633392334, "vf_loss": 14676232503296.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -7.271766662597656e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 40, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290687.89702733, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15213411412592026, "mean_inference_ms": 5.201883523802975, "mean_action_processing_ms": 0.14344723444979293, "mean_env_wait_ms": 0.26083894847076694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01512765884399414, "StateBufferConnector_ms": 0.0023037195205688477, "ViewRequirementAgentConnector_ms": 0.05924701690673828}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290687.89702733, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15213411412592026, "mean_inference_ms": 5.201883523802975, "mean_action_processing_ms": 0.14344723444979293, "mean_env_wait_ms": 0.26083894847076694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01512765884399414, "StateBufferConnector_ms": 0.0023037195205688477, "ViewRequirementAgentConnector_ms": 0.05924701690673828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 1959.151, "learn_time_ms": 18.894, "learn_throughput": 17783.217, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "done": false, "episodes_total": 40, "training_iteration": 40, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-44", "timestamp": 1706266184, "time_this_iter_s": 1.960184097290039, "time_total_s": 78.4063732624054, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a0c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 78.4063732624054, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 12.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -823409280.0, "policy_entropy": 2863.72216796875, "var_gnorm": 22.660524368286133, "vf_loss": 15064094474240.0}, "grad_gnorm": 40.0, "vf_explained_var": -9.179115295410156e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 41, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1291399.7697197343, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15214146790528443, "mean_inference_ms": 5.202051930214438, "mean_action_processing_ms": 0.14344318374472842, "mean_env_wait_ms": 0.26082194285870813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015122134511063739, "StateBufferConnector_ms": 0.002302774568883384, "ViewRequirementAgentConnector_ms": 0.05926155462497618}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1291399.7697197343, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15214146790528443, "mean_inference_ms": 5.202051930214438, "mean_action_processing_ms": 0.14344318374472842, "mean_env_wait_ms": 0.26082194285870813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015122134511063739, "StateBufferConnector_ms": 0.002302774568883384, "ViewRequirementAgentConnector_ms": 0.05926155462497618}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13776, "timers": {"training_iteration_time_ms": 1958.783, "learn_time_ms": 18.875, "learn_throughput": 17801.187, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "done": false, "episodes_total": 41, "training_iteration": 41, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-46", "timestamp": 1706266186, "time_this_iter_s": 1.961782455444336, "time_total_s": 80.36815571784973, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19ba0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92857910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 80.36815571784973, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 12.149999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -841638848.0, "policy_entropy": 2827.22705078125, "var_gnorm": 22.662574768066406, "vf_loss": 15796104331264.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.0132789611816406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 42, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1293043.806443021, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15214894234952775, "mean_inference_ms": 5.202224536928646, "mean_action_processing_ms": 0.14343936448498634, "mean_env_wait_ms": 0.2608052639148626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015103816986083984, "StateBufferConnector_ms": 0.0023013069516136533, "ViewRequirementAgentConnector_ms": 0.05925382886614118}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1293043.806443021, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15214894234952775, "mean_inference_ms": 5.202224536928646, "mean_action_processing_ms": 0.14343936448498634, "mean_env_wait_ms": 0.2608052639148626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015103816986083984, "StateBufferConnector_ms": 0.0023013069516136533, "ViewRequirementAgentConnector_ms": 0.05925382886614118}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14112, "timers": {"training_iteration_time_ms": 1956.484, "learn_time_ms": 18.882, "learn_throughput": 17794.534, "synch_weights_time_ms": 0.141}, "counters": {"num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "done": false, "episodes_total": 42, "training_iteration": 42, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-48", "timestamp": 1706266188, "time_this_iter_s": 1.966115951538086, "time_total_s": 82.33427166938782, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d18d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a0ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 82.33427166938782, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 12.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -748247936.0, "policy_entropy": 2770.09130859375, "var_gnorm": 22.665485382080078, "vf_loss": 13091052978176.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.0371208190917969e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 43, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1292099.2976698093, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15215650419755267, "mean_inference_ms": 5.2023949170304205, "mean_action_processing_ms": 0.1434351328965096, "mean_env_wait_ms": 0.26078871201931286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015099658522495004, "StateBufferConnector_ms": 0.0023026799046716026, "ViewRequirementAgentConnector_ms": 0.05929691846980605}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1292099.2976698093, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15215650419755267, "mean_inference_ms": 5.2023949170304205, "mean_action_processing_ms": 0.1434351328965096, "mean_env_wait_ms": 0.26078871201931286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015099658522495004, "StateBufferConnector_ms": 0.0023026799046716026, "ViewRequirementAgentConnector_ms": 0.05929691846980605}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14448, "timers": {"training_iteration_time_ms": 1955.708, "learn_time_ms": 18.871, "learn_throughput": 17805.46, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "done": false, "episodes_total": 43, "training_iteration": 43, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-50", "timestamp": 1706266190, "time_this_iter_s": 1.962125301361084, "time_total_s": 84.2963969707489, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92855d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 84.2963969707489, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 12.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -817671296.0, "policy_entropy": 2777.36767578125, "var_gnorm": 22.667255401611328, "vf_loss": 15182935883776.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.0371208190917969e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 44, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1293044.0120021666, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15216476403159437, "mean_inference_ms": 5.202575405985172, "mean_action_processing_ms": 0.14343138513334475, "mean_env_wait_ms": 0.2607738062824509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015088103034279564, "StateBufferConnector_ms": 0.002312118356878107, "ViewRequirementAgentConnector_ms": 0.059288740158081055}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1293044.0120021666, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15216476403159437, "mean_inference_ms": 5.202575405985172, "mean_action_processing_ms": 0.14343138513334475, "mean_env_wait_ms": 0.2607738062824509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015088103034279564, "StateBufferConnector_ms": 0.002312118356878107, "ViewRequirementAgentConnector_ms": 0.059288740158081055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14784, "timers": {"training_iteration_time_ms": 1957.26, "learn_time_ms": 18.812, "learn_throughput": 17860.634, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "done": false, "episodes_total": 44, "training_iteration": 44, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-52", "timestamp": 1706266192, "time_this_iter_s": 1.9726145267486572, "time_total_s": 86.26901149749756, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a1900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 86.26901149749756, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 12.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -774849344.0, "policy_entropy": 2831.270263671875, "var_gnorm": 22.66802215576172, "vf_loss": 13789513646080.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -9.298324584960938e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 45, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1292208.4455543766, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1521733168077129, "mean_inference_ms": 5.202756971710411, "mean_action_processing_ms": 0.1434287367526082, "mean_env_wait_ms": 0.26076097380588875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01510779062906901, "StateBufferConnector_ms": 0.0023137198554144967, "ViewRequirementAgentConnector_ms": 0.05931536356608073}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1292208.4455543766, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1521733168077129, "mean_inference_ms": 5.202756971710411, "mean_action_processing_ms": 0.1434287367526082, "mean_env_wait_ms": 0.26076097380588875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01510779062906901, "StateBufferConnector_ms": 0.0023137198554144967, "ViewRequirementAgentConnector_ms": 0.05931536356608073}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15120, "timers": {"training_iteration_time_ms": 1957.815, "learn_time_ms": 18.85, "learn_throughput": 17825.346, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "done": false, "episodes_total": 45, "training_iteration": 45, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-54", "timestamp": 1706266194, "time_this_iter_s": 1.9680871963500977, "time_total_s": 88.23709869384766, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c239d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92857490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 88.23709869384766, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 12.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -772720384.0, "policy_entropy": 2837.771240234375, "var_gnorm": 22.669696807861328, "vf_loss": 12732253339648.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.049041748046875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 46, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290817.1042292833, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15218163483812053, "mean_inference_ms": 5.202920686690233, "mean_action_processing_ms": 0.14342590444558728, "mean_env_wait_ms": 0.2607475165612828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015231837397036345, "StateBufferConnector_ms": 0.002313696819802989, "ViewRequirementAgentConnector_ms": 0.05935948827992315}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290817.1042292833, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15218163483812053, "mean_inference_ms": 5.202920686690233, "mean_action_processing_ms": 0.14342590444558728, "mean_env_wait_ms": 0.2607475165612828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015231837397036345, "StateBufferConnector_ms": 0.002313696819802989, "ViewRequirementAgentConnector_ms": 0.05935948827992315}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15456, "timers": {"training_iteration_time_ms": 1957.705, "learn_time_ms": 18.826, "learn_throughput": 17848.057, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "done": false, "episodes_total": 46, "training_iteration": 46, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-56", "timestamp": 1706266196, "time_this_iter_s": 1.9519221782684326, "time_total_s": 90.18902087211609, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d10f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a08b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 90.18902087211609, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 12.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -703367360.0, "policy_entropy": 2803.310791015625, "var_gnorm": 22.67215919494629, "vf_loss": 10482589106176.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.1920928955078125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 47, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1287349.1553596766, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15218976947384563, "mean_inference_ms": 5.203095789979574, "mean_action_processing_ms": 0.14342291497682635, "mean_env_wait_ms": 0.2607342165129542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015223279912421044, "StateBufferConnector_ms": 0.0023136747644302695, "ViewRequirementAgentConnector_ms": 0.05940274989351313}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1287349.1553596766, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15218976947384563, "mean_inference_ms": 5.203095789979574, "mean_action_processing_ms": 0.14342291497682635, "mean_env_wait_ms": 0.2607342165129542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015223279912421044, "StateBufferConnector_ms": 0.0023136747644302695, "ViewRequirementAgentConnector_ms": 0.05940274989351313}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15792, "timers": {"training_iteration_time_ms": 1959.331, "learn_time_ms": 18.873, "learn_throughput": 17803.661, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "done": false, "episodes_total": 47, "training_iteration": 47, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-49-58", "timestamp": 1706266198, "time_this_iter_s": 1.9732515811920166, "time_total_s": 92.1622724533081, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105090>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a2a70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 92.1622724533081, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 12.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -744240192.0, "policy_entropy": 2728.174560546875, "var_gnorm": 22.675376892089844, "vf_loss": 10900973027328.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.5497207641601562e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 48, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "sampler_results": {"episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284093.9767830714, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15219775878612687, "mean_inference_ms": 5.203268715174003, "mean_action_processing_ms": 0.14341970973630377, "mean_env_wait_ms": 0.26072102627641003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015211602052052816, "StateBufferConnector_ms": 0.0023136536280314126, "ViewRequirementAgentConnector_ms": 0.059444705645243325}}, "episode_reward_max": -1107101.2173950234, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284093.9767830714, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15219775878612687, "mean_inference_ms": 5.203268715174003, "mean_action_processing_ms": 0.14341970973630377, "mean_env_wait_ms": 0.26072102627641003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015211602052052816, "StateBufferConnector_ms": 0.0023136536280314126, "ViewRequirementAgentConnector_ms": 0.059444705645243325}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1961.476, "learn_time_ms": 18.92, "learn_throughput": 17758.522, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "done": false, "episodes_total": 48, "training_iteration": 48, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-00", "timestamp": 1706266200, "time_this_iter_s": 1.9634501934051514, "time_total_s": 94.12572264671326, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0e50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a2950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 94.12572264671326, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 12.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1601793920.0, "policy_entropy": 2633.248779296875, "var_gnorm": 22.6791934967041, "vf_loss": 9176003641344.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.3828277587890625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 49, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1278778.0715636797, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15220529600264537, "mean_inference_ms": 5.203427251175865, "mean_action_processing_ms": 0.1434159293008067, "mean_env_wait_ms": 0.2607072127827916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015186290351711974, "StateBufferConnector_ms": 0.0023107139431700415, "ViewRequirementAgentConnector_ms": 0.059449915983238996}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1278778.0715636797, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15220529600264537, "mean_inference_ms": 5.203427251175865, "mean_action_processing_ms": 0.1434159293008067, "mean_env_wait_ms": 0.2607072127827916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015186290351711974, "StateBufferConnector_ms": 0.0023107139431700415, "ViewRequirementAgentConnector_ms": 0.059449915983238996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16464, "timers": {"training_iteration_time_ms": 1962.821, "learn_time_ms": 18.851, "learn_throughput": 17824.039, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "done": false, "episodes_total": 49, "training_iteration": 49, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-02", "timestamp": 1706266202, "time_this_iter_s": 1.9523091316223145, "time_total_s": 96.07803177833557, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2920>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a2290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 96.07803177833557, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 12.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6347557888.0, "policy_entropy": 2506.70751953125, "var_gnorm": 22.683856964111328, "vf_loss": 10652160622592.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.6570091247558594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 50, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1275615.5047925548, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15221157338026767, "mean_inference_ms": 5.2035601936720335, "mean_action_processing_ms": 0.14341110313613215, "mean_env_wait_ms": 0.26069199417733147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015155792236328125, "StateBufferConnector_ms": 0.0023088455200195312, "ViewRequirementAgentConnector_ms": 0.059476375579833984}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1275615.5047925548, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15221157338026767, "mean_inference_ms": 5.2035601936720335, "mean_action_processing_ms": 0.14341110313613215, "mean_env_wait_ms": 0.26069199417733147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015155792236328125, "StateBufferConnector_ms": 0.0023088455200195312, "ViewRequirementAgentConnector_ms": 0.059476375579833984}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16800, "timers": {"training_iteration_time_ms": 1960.781, "learn_time_ms": 18.826, "learn_throughput": 17847.808, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "done": false, "episodes_total": 50, "training_iteration": 50, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-04", "timestamp": 1706266204, "time_this_iter_s": 1.9398269653320312, "time_total_s": 98.0178587436676, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a61069e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a3a30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 98.0178587436676, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 12.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -25865873408.0, "policy_entropy": 2441.593994140625, "var_gnorm": 22.687040328979492, "vf_loss": 9782174941184.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.7762184143066406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 51, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1271674.0787762252, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15221779031930058, "mean_inference_ms": 5.203681289302242, "mean_action_processing_ms": 0.1434062441757132, "mean_env_wait_ms": 0.2606772892611403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01516248665603937, "StateBufferConnector_ms": 0.0023084528305951286, "ViewRequirementAgentConnector_ms": 0.05950039508295994}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1271674.0787762252, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15221779031930058, "mean_inference_ms": 5.203681289302242, "mean_action_processing_ms": 0.1434062441757132, "mean_env_wait_ms": 0.2606772892611403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01516248665603937, "StateBufferConnector_ms": 0.0023084528305951286, "ViewRequirementAgentConnector_ms": 0.05950039508295994}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17136, "timers": {"training_iteration_time_ms": 1959.98, "learn_time_ms": 18.87, "learn_throughput": 17806.27, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "done": false, "episodes_total": 51, "training_iteration": 51, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-06", "timestamp": 1706266206, "time_this_iter_s": 1.953810453414917, "time_total_s": 99.97166919708252, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3be0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a3520>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 99.97166919708252, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 13.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -135864090624.0, "policy_entropy": 2333.8671875, "var_gnorm": 22.691083908081055, "vf_loss": 10364846604288.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.5616416931152344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 52, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1268199.0675332674, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522236701389591, "mean_inference_ms": 5.203802092261659, "mean_action_processing_ms": 0.14340132227744054, "mean_env_wait_ms": 0.2606626784533899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015145540237426758, "StateBufferConnector_ms": 0.002308075244610126, "ViewRequirementAgentConnector_ms": 0.05949506392845741}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1268199.0675332674, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522236701389591, "mean_inference_ms": 5.203802092261659, "mean_action_processing_ms": 0.14340132227744054, "mean_env_wait_ms": 0.2606626784533899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015145540237426758, "StateBufferConnector_ms": 0.002308075244610126, "ViewRequirementAgentConnector_ms": 0.05949506392845741}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17472, "timers": {"training_iteration_time_ms": 1959.686, "learn_time_ms": 18.954, "learn_throughput": 17727.204, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "done": false, "episodes_total": 52, "training_iteration": 52, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-08", "timestamp": 1706266208, "time_this_iter_s": 1.963238000869751, "time_total_s": 101.93490719795227, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1ac20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a0430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 101.93490719795227, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 13.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2078532042752.0, "policy_entropy": 2197.627197265625, "var_gnorm": 22.69601058959961, "vf_loss": 11585468760064.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.990795135498047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 53, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1266254.9576159015, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15222946970537404, "mean_inference_ms": 5.203923778341022, "mean_action_processing_ms": 0.1433963257509368, "mean_env_wait_ms": 0.26064821303388697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015157123781600088, "StateBufferConnector_ms": 0.0023090614462798497, "ViewRequirementAgentConnector_ms": 0.059541216436422094}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1266254.9576159015, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15222946970537404, "mean_inference_ms": 5.203923778341022, "mean_action_processing_ms": 0.1433963257509368, "mean_env_wait_ms": 0.26064821303388697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015157123781600088, "StateBufferConnector_ms": 0.0023090614462798497, "ViewRequirementAgentConnector_ms": 0.059541216436422094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17808, "timers": {"training_iteration_time_ms": 1959.886, "learn_time_ms": 18.998, "learn_throughput": 17686.291, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "done": false, "episodes_total": 53, "training_iteration": 53, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-10", "timestamp": 1706266210, "time_this_iter_s": 1.9641671180725098, "time_total_s": 103.89907431602478, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104d30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bc4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 103.89907431602478, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 13.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -36382860902400.0, "policy_entropy": 2029.716796875, "var_gnorm": 22.702106475830078, "vf_loss": 10774054436864.0}, "grad_gnorm": 0.0, "vf_explained_var": -1.9311904907226562e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 54, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1263495.8030087848, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522351479368507, "mean_inference_ms": 5.204044320012929, "mean_action_processing_ms": 0.14339169986725664, "mean_env_wait_ms": 0.2606338726726827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513869674117477, "StateBufferConnector_ms": 0.00230780354252568, "ViewRequirementAgentConnector_ms": 0.059612150545473454}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1263495.8030087848, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522351479368507, "mean_inference_ms": 5.204044320012929, "mean_action_processing_ms": 0.14339169986725664, "mean_env_wait_ms": 0.2606338726726827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513869674117477, "StateBufferConnector_ms": 0.00230780354252568, "ViewRequirementAgentConnector_ms": 0.059612150545473454}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18144, "timers": {"training_iteration_time_ms": 1958.917, "learn_time_ms": 19.006, "learn_throughput": 17678.97, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "done": false, "episodes_total": 54, "training_iteration": 54, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-12", "timestamp": 1706266212, "time_this_iter_s": 1.96293044090271, "time_total_s": 105.86200475692749, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d17b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a0ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 105.86200475692749, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 13.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -273095898169344.0, "policy_entropy": 1875.06103515625, "var_gnorm": 22.707977294921875, "vf_loss": 11259239989248.0}, "grad_gnorm": 0.0, "vf_explained_var": -1.990795135498047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 55, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1261079.537597999, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15224174932196027, "mean_inference_ms": 5.204175408712984, "mean_action_processing_ms": 0.14338749073180843, "mean_env_wait_ms": 0.26062038389906506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513264395973899, "StateBufferConnector_ms": 0.0023070248690518465, "ViewRequirementAgentConnector_ms": 0.05971084941517223}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1261079.537597999, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15224174932196027, "mean_inference_ms": 5.204175408712984, "mean_action_processing_ms": 0.14338749073180843, "mean_env_wait_ms": 0.26062038389906506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513264395973899, "StateBufferConnector_ms": 0.0023070248690518465, "ViewRequirementAgentConnector_ms": 0.05971084941517223}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18480, "timers": {"training_iteration_time_ms": 1959.79, "learn_time_ms": 19.023, "learn_throughput": 17662.529, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "done": false, "episodes_total": 55, "training_iteration": 55, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-14", "timestamp": 1706266214, "time_this_iter_s": 1.9768424034118652, "time_total_s": 107.83884716033936, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2e90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bc4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 107.83884716033936, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 13.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2469553044979712.0, "policy_entropy": 1734.4725341796875, "var_gnorm": 22.713590621948242, "vf_loss": 10629582684160.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.0503997802734375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 56, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1258339.1924048036, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15224845216488989, "mean_inference_ms": 5.2043071916863495, "mean_action_processing_ms": 0.14338363879317736, "mean_env_wait_ms": 0.26060830832583404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015161292893545968, "StateBufferConnector_ms": 0.0023084027426583426, "ViewRequirementAgentConnector_ms": 0.059736626488821845}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1258339.1924048036, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15224845216488989, "mean_inference_ms": 5.2043071916863495, "mean_action_processing_ms": 0.14338363879317736, "mean_env_wait_ms": 0.26060830832583404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015161292893545968, "StateBufferConnector_ms": 0.0023084027426583426, "ViewRequirementAgentConnector_ms": 0.059736626488821845}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 1961.345, "learn_time_ms": 19.049, "learn_throughput": 17638.809, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "done": false, "episodes_total": 56, "training_iteration": 56, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-16", "timestamp": 1706266216, "time_this_iter_s": 1.9675076007843018, "time_total_s": 109.80635476112366, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc91e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a0430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 109.80635476112366, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 13.433333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.801677792136397e+16, "policy_entropy": 1608.392333984375, "var_gnorm": 22.71891975402832, "vf_loss": 9595741274112.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.6464462280273438e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 57, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1254634.7309562452, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15225491847150133, "mean_inference_ms": 5.204437766366584, "mean_action_processing_ms": 0.1433799416632658, "mean_env_wait_ms": 0.2605972129765222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0152604621753358, "StateBufferConnector_ms": 0.0023093139916135555, "ViewRequirementAgentConnector_ms": 0.05972845512523986}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1254634.7309562452, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15225491847150133, "mean_inference_ms": 5.204437766366584, "mean_action_processing_ms": 0.1433799416632658, "mean_env_wait_ms": 0.2605972129765222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0152604621753358, "StateBufferConnector_ms": 0.0023093139916135555, "ViewRequirementAgentConnector_ms": 0.05972845512523986}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19152, "timers": {"training_iteration_time_ms": 1960.482, "learn_time_ms": 19.036, "learn_throughput": 17650.363, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "done": false, "episodes_total": 57, "training_iteration": 57, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-18", "timestamp": 1706266218, "time_this_iter_s": 1.9646015167236328, "time_total_s": 111.77095627784729, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1090>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a0670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 111.77095627784729, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 13.533333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1837096512507085e+17, "policy_entropy": 1495.99365234375, "var_gnorm": 22.72394561767578, "vf_loss": 9975861608448.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.3484230041503906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 58, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251758.354137919, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15226153174542836, "mean_inference_ms": 5.204567442081984, "mean_action_processing_ms": 0.143376343211233, "mean_env_wait_ms": 0.26058639341520423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015260844395078462, "StateBufferConnector_ms": 0.002308549552128233, "ViewRequirementAgentConnector_ms": 0.05972796473009833}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251758.354137919, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15226153174542836, "mean_inference_ms": 5.204567442081984, "mean_action_processing_ms": 0.143376343211233, "mean_env_wait_ms": 0.26058639341520423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015260844395078462, "StateBufferConnector_ms": 0.002308549552128233, "ViewRequirementAgentConnector_ms": 0.05972796473009833}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19488, "timers": {"training_iteration_time_ms": 1960.633, "learn_time_ms": 19.091, "learn_throughput": 17600.325, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "done": false, "episodes_total": 58, "training_iteration": 58, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-20", "timestamp": 1706266220, "time_this_iter_s": 1.9649746417999268, "time_total_s": 113.73593091964722, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0b80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a3b50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 113.73593091964722, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 13.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0142288330012754e+18, "policy_entropy": 1386.8819580078125, "var_gnorm": 22.72866439819336, "vf_loss": 10340251205632.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.6345252990722656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 59, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249218.9956032154, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522682893084615, "mean_inference_ms": 5.204700430870868, "mean_action_processing_ms": 0.14337346535125442, "mean_env_wait_ms": 0.260576373832342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01524747428247484, "StateBufferConnector_ms": 0.0023090233237056407, "ViewRequirementAgentConnector_ms": 0.05975173691571769}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249218.9956032154, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522682893084615, "mean_inference_ms": 5.204700430870868, "mean_action_processing_ms": 0.14337346535125442, "mean_env_wait_ms": 0.260576373832342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01524747428247484, "StateBufferConnector_ms": 0.0023090233237056407, "ViewRequirementAgentConnector_ms": 0.05975173691571769}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19824, "timers": {"training_iteration_time_ms": 1962.524, "learn_time_ms": 19.144, "learn_throughput": 17550.897, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "done": false, "episodes_total": 59, "training_iteration": 59, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-22", "timestamp": 1706266222, "time_this_iter_s": 1.9712584018707275, "time_total_s": 115.70718932151794, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f183d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92857b50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 115.70718932151794, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 13.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.665853342970544e+18, "policy_entropy": 1293.17578125, "var_gnorm": 22.733078002929688, "vf_loss": 9897980723200.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.8967857360839844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 60, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1246228.4359026316, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15227525208706696, "mean_inference_ms": 5.204830785094773, "mean_action_processing_ms": 0.1433708068005805, "mean_env_wait_ms": 0.26056678034098585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015228589375813803, "StateBufferConnector_ms": 0.002309878667195638, "ViewRequirementAgentConnector_ms": 0.059778690338134766}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1246228.4359026316, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15227525208706696, "mean_inference_ms": 5.204830785094773, "mean_action_processing_ms": 0.1433708068005805, "mean_env_wait_ms": 0.26056678034098585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015228589375813803, "StateBufferConnector_ms": 0.002309878667195638, "ViewRequirementAgentConnector_ms": 0.059778690338134766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20160, "timers": {"training_iteration_time_ms": 1964.912, "learn_time_ms": 19.218, "learn_throughput": 17483.248, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "done": false, "episodes_total": 60, "training_iteration": 60, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-24", "timestamp": 1706266224, "time_this_iter_s": 1.9637322425842285, "time_total_s": 117.67092156410217, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f199c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92857ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 117.67092156410217, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 13.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.350414779982021e+18, "policy_entropy": 1210.462890625, "var_gnorm": 22.73719024658203, "vf_loss": 10803016105984.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.86102294921875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 61, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1244170.0714744648, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522820664100632, "mean_inference_ms": 5.204959163261222, "mean_action_processing_ms": 0.14336797599821668, "mean_env_wait_ms": 0.26055740366833385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015217749798884158, "StateBufferConnector_ms": 0.00230797001572906, "ViewRequirementAgentConnector_ms": 0.05978091818387391}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1244170.0714744648, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1522820664100632, "mean_inference_ms": 5.204959163261222, "mean_action_processing_ms": 0.14336797599821668, "mean_env_wait_ms": 0.26055740366833385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015217749798884158, "StateBufferConnector_ms": 0.00230797001572906, "ViewRequirementAgentConnector_ms": 0.05978091818387391}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20496, "timers": {"training_iteration_time_ms": 1965.82, "learn_time_ms": 19.189, "learn_throughput": 17509.749, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "done": false, "episodes_total": 61, "training_iteration": 61, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-26", "timestamp": 1706266226, "time_this_iter_s": 1.9629144668579102, "time_total_s": 119.63383603096008, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d38e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a3010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 119.63383603096008, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 13.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.589841909017844e+19, "policy_entropy": 1131.26513671875, "var_gnorm": 22.741008758544922, "vf_loss": 9781961031680.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.0279159545898438e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 62, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1241365.2929115656, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15228814071740554, "mean_inference_ms": 5.205073883890011, "mean_action_processing_ms": 0.14336446713607998, "mean_env_wait_ms": 0.26054730740778487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015190339857532133, "StateBufferConnector_ms": 0.0023088147563319053, "ViewRequirementAgentConnector_ms": 0.05977422960342899}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1241365.2929115656, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15228814071740554, "mean_inference_ms": 5.205073883890011, "mean_action_processing_ms": 0.14336446713607998, "mean_env_wait_ms": 0.26054730740778487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015190339857532133, "StateBufferConnector_ms": 0.0023088147563319053, "ViewRequirementAgentConnector_ms": 0.05977422960342899}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20832, "timers": {"training_iteration_time_ms": 1963.997, "learn_time_ms": 19.113, "learn_throughput": 17579.336, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "done": false, "episodes_total": 62, "training_iteration": 62, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-28", "timestamp": 1706266228, "time_this_iter_s": 1.9450209140777588, "time_total_s": 121.57885694503784, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca620>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bcf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 121.57885694503784, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 13.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.0223635988660145e+20, "policy_entropy": 1064.6253662109375, "var_gnorm": 22.744544982910156, "vf_loss": 9726884577280.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.0517578125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 63, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1238489.7177606563, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15229377088044066, "mean_inference_ms": 5.205186634892584, "mean_action_processing_ms": 0.14336077703244512, "mean_env_wait_ms": 0.26053753438605715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015190291026281931, "StateBufferConnector_ms": 0.002307740468827505, "ViewRequirementAgentConnector_ms": 0.05976661803230407}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1238489.7177606563, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15229377088044066, "mean_inference_ms": 5.205186634892584, "mean_action_processing_ms": 0.14336077703244512, "mean_env_wait_ms": 0.26053753438605715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015190291026281931, "StateBufferConnector_ms": 0.002307740468827505, "ViewRequirementAgentConnector_ms": 0.05976661803230407}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21168, "timers": {"training_iteration_time_ms": 1963.773, "learn_time_ms": 19.12, "learn_throughput": 17573.176, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "done": false, "episodes_total": 63, "training_iteration": 63, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-30", "timestamp": 1706266230, "time_this_iter_s": 1.9619560241699219, "time_total_s": 123.54081296920776, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a13f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 123.54081296920776, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 14.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.8172276416544107e+21, "policy_entropy": 1001.8895263671875, "var_gnorm": 22.747812271118164, "vf_loss": 11135432523776.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.8252601623535156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 64, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1236879.092213247, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15229928929249428, "mean_inference_ms": 5.205295559084299, "mean_action_processing_ms": 0.14335690672775403, "mean_env_wait_ms": 0.26052795191830014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015185028314590454, "StateBufferConnector_ms": 0.002308189868927002, "ViewRequirementAgentConnector_ms": 0.05979761481285095}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1236879.092213247, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15229928929249428, "mean_inference_ms": 5.205295559084299, "mean_action_processing_ms": 0.14335690672775403, "mean_env_wait_ms": 0.26052795191830014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015185028314590454, "StateBufferConnector_ms": 0.002308189868927002, "ViewRequirementAgentConnector_ms": 0.05979761481285095}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 1963.429, "learn_time_ms": 19.11, "learn_throughput": 17581.99, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 64, "training_iteration": 64, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-32", "timestamp": 1706266232, "time_this_iter_s": 1.9595310688018799, "time_total_s": 125.50034403800964, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f185e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bcc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 125.50034403800964, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 14.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.9446625722825263e+21, "policy_entropy": 945.2896118164062, "var_gnorm": 22.750823974609375, "vf_loss": 9337972981760.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6835670471191406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 65, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1234245.8467474554, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15230528510940888, "mean_inference_ms": 5.205405635453107, "mean_action_processing_ms": 0.14335358572516002, "mean_env_wait_ms": 0.26051927951828313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01525585467998798, "StateBufferConnector_ms": 0.0023067914522611178, "ViewRequirementAgentConnector_ms": 0.05977410536545973}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1234245.8467474554, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15230528510940888, "mean_inference_ms": 5.205405635453107, "mean_action_processing_ms": 0.14335358572516002, "mean_env_wait_ms": 0.26051927951828313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01525585467998798, "StateBufferConnector_ms": 0.0023067914522611178, "ViewRequirementAgentConnector_ms": 0.05977410536545973}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21840, "timers": {"training_iteration_time_ms": 1962.652, "learn_time_ms": 19.079, "learn_throughput": 17610.948, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "done": false, "episodes_total": 65, "training_iteration": 65, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-34", "timestamp": 1706266234, "time_this_iter_s": 1.969115972518921, "time_total_s": 127.46946001052856, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105870>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bde10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 127.46946001052856, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 14.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.798609147517041e+21, "policy_entropy": 893.3668212890625, "var_gnorm": 22.753599166870117, "vf_loss": 9600171507712.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.349781036376953e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 66, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1231655.828164536, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523104058926129, "mean_inference_ms": 5.205498880885091, "mean_action_processing_ms": 0.14335003474418, "mean_env_wait_ms": 0.2605105817649789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015231334801876184, "StateBufferConnector_ms": 0.0023068803729433002, "ViewRequirementAgentConnector_ms": 0.05975600444909298}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1231655.828164536, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523104058926129, "mean_inference_ms": 5.205498880885091, "mean_action_processing_ms": 0.14335003474418, "mean_env_wait_ms": 0.2605105817649789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015231334801876184, "StateBufferConnector_ms": 0.0023068803729433002, "ViewRequirementAgentConnector_ms": 0.05975600444909298}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22176, "timers": {"training_iteration_time_ms": 1959.72, "learn_time_ms": 18.988, "learn_throughput": 17695.841, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "done": false, "episodes_total": 66, "training_iteration": 66, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-36", "timestamp": 1706266236, "time_this_iter_s": 1.9382078647613525, "time_total_s": 129.40766787528992, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1d20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a3a30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 129.40766787528992, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 14.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9503583532066263e+22, "policy_entropy": 850.3701171875, "var_gnorm": 22.756147384643555, "vf_loss": 9713528864768.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.1948089599609375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 67, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1229318.2642875793, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15231505452387273, "mean_inference_ms": 5.205577311849082, "mean_action_processing_ms": 0.14334627854562976, "mean_env_wait_ms": 0.26050126920532535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015209326103552063, "StateBufferConnector_ms": 0.0023055432447746617, "ViewRequirementAgentConnector_ms": 0.05974983101460471}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1229318.2642875793, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15231505452387273, "mean_inference_ms": 5.205577311849082, "mean_action_processing_ms": 0.14334627854562976, "mean_env_wait_ms": 0.26050126920532535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015209326103552063, "StateBufferConnector_ms": 0.0023055432447746617, "ViewRequirementAgentConnector_ms": 0.05974983101460471}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22512, "timers": {"training_iteration_time_ms": 1957.183, "learn_time_ms": 18.934, "learn_throughput": 17745.396, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "done": false, "episodes_total": 67, "training_iteration": 67, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-38", "timestamp": 1706266238, "time_this_iter_s": 1.9392642974853516, "time_total_s": 131.34693217277527, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca830>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bda20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 131.34693217277527, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 14.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.8671779274478926e+22, "policy_entropy": 807.8038330078125, "var_gnorm": 22.75848388671875, "vf_loss": 9383684603904.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.337860107421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 68, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1226687.443378224, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15231953591298678, "mean_inference_ms": 5.205651105273229, "mean_action_processing_ms": 0.14334242757794424, "mean_env_wait_ms": 0.2604917900475514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015182004255406997, "StateBufferConnector_ms": 0.002305998521692613, "ViewRequirementAgentConnector_ms": 0.05974383915171904}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1226687.443378224, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15231953591298678, "mean_inference_ms": 5.205651105273229, "mean_action_processing_ms": 0.14334242757794424, "mean_env_wait_ms": 0.2604917900475514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015182004255406997, "StateBufferConnector_ms": 0.002305998521692613, "ViewRequirementAgentConnector_ms": 0.05974383915171904}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22848, "timers": {"training_iteration_time_ms": 1956.163, "learn_time_ms": 18.856, "learn_throughput": 17819.666, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "done": false, "episodes_total": 68, "training_iteration": 68, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-40", "timestamp": 1706266240, "time_this_iter_s": 1.9548101425170898, "time_total_s": 133.30174231529236, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105c00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928be680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 133.30174231529236, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 14.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.607600241943592e+22, "policy_entropy": 770.8031616210938, "var_gnorm": 22.7606258392334, "vf_loss": 9850274709504.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.86102294921875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 69, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1224153.8935657195, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15232415239519762, "mean_inference_ms": 5.205731553075626, "mean_action_processing_ms": 0.14333865352554384, "mean_env_wait_ms": 0.26048302523306416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174824258555536, "StateBufferConnector_ms": 0.0023064406021781588, "ViewRequirementAgentConnector_ms": 0.059785013613493546}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1224153.8935657195, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15232415239519762, "mean_inference_ms": 5.205731553075626, "mean_action_processing_ms": 0.14333865352554384, "mean_env_wait_ms": 0.26048302523306416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174824258555536, "StateBufferConnector_ms": 0.0023064406021781588, "ViewRequirementAgentConnector_ms": 0.059785013613493546}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23184, "timers": {"training_iteration_time_ms": 1956.504, "learn_time_ms": 18.799, "learn_throughput": 17873.16, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "done": false, "episodes_total": 69, "training_iteration": 69, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-42", "timestamp": 1706266242, "time_this_iter_s": 1.9746792316436768, "time_total_s": 135.27642154693604, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3a90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928579a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 135.27642154693604, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 14.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2105422696072835e+23, "policy_entropy": 734.9593505859375, "var_gnorm": 22.762588500976562, "vf_loss": 9311312936960.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.314018249511719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 70, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1221485.8393904737, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15232877892801985, "mean_inference_ms": 5.205802099222759, "mean_action_processing_ms": 0.1433349989593098, "mean_env_wait_ms": 0.26047467517146183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015168190002441406, "StateBufferConnector_ms": 0.0023061888558523996, "ViewRequirementAgentConnector_ms": 0.0598113877432687}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1221485.8393904737, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15232877892801985, "mean_inference_ms": 5.205802099222759, "mean_action_processing_ms": 0.1433349989593098, "mean_env_wait_ms": 0.26047467517146183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015168190002441406, "StateBufferConnector_ms": 0.0023061888558523996, "ViewRequirementAgentConnector_ms": 0.0598113877432687}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23520, "timers": {"training_iteration_time_ms": 1954.929, "learn_time_ms": 18.769, "learn_throughput": 17902.244, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "done": false, "episodes_total": 70, "training_iteration": 70, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-44", "timestamp": 1706266244, "time_this_iter_s": 1.9479992389678955, "time_total_s": 137.22442078590393, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f199f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bd510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 137.22442078590393, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 14.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.530126752076003e+23, "policy_entropy": 703.6148071289062, "var_gnorm": 22.764381408691406, "vf_loss": 10005201813504.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.62396240234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 71, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "sampler_results": {"episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1219357.839686351, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523332550466244, "mean_inference_ms": 5.205871353525991, "mean_action_processing_ms": 0.14333121711084432, "mean_env_wait_ms": 0.2604664492125305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015168458643093916, "StateBufferConnector_ms": 0.0023176972295196963, "ViewRequirementAgentConnector_ms": 0.05983802634225765}}, "episode_reward_max": -1023614.6210328755, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1219357.839686351, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523332550466244, "mean_inference_ms": 5.205871353525991, "mean_action_processing_ms": 0.14333121711084432, "mean_env_wait_ms": 0.2604664492125305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015168458643093916, "StateBufferConnector_ms": 0.0023176972295196963, "ViewRequirementAgentConnector_ms": 0.05983802634225765}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23856, "timers": {"training_iteration_time_ms": 1954.658, "learn_time_ms": 18.762, "learn_throughput": 17908.887, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "done": false, "episodes_total": 71, "training_iteration": 71, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-46", "timestamp": 1706266246, "time_this_iter_s": 1.9602434635162354, "time_total_s": 139.18466424942017, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a61053f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bee60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 139.18466424942017, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 14.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2222940885757336e+24, "policy_entropy": 677.07470703125, "var_gnorm": 22.766019821166992, "vf_loss": 8598649831424.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7789344787597656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 72, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1216485.9437241289, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523374991485587, "mean_inference_ms": 5.20593412002572, "mean_action_processing_ms": 0.14332719065531416, "mean_env_wait_ms": 0.2604581057009331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015150507291158041, "StateBufferConnector_ms": 0.0023163027233547634, "ViewRequirementAgentConnector_ms": 0.059820214907328285}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1216485.9437241289, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523374991485587, "mean_inference_ms": 5.20593412002572, "mean_action_processing_ms": 0.14332719065531416, "mean_env_wait_ms": 0.2604581057009331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015150507291158041, "StateBufferConnector_ms": 0.0023163027233547634, "ViewRequirementAgentConnector_ms": 0.059820214907328285}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 1955.212, "learn_time_ms": 18.796, "learn_throughput": 17876.198, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "done": false, "episodes_total": 72, "training_iteration": 72, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-48", "timestamp": 1706266248, "time_this_iter_s": 1.9505665302276611, "time_total_s": 141.13523077964783, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2290>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a1b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 141.13523077964783, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 14.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.897815511064186e+23, "policy_entropy": 650.2943725585938, "var_gnorm": 22.767513275146484, "vf_loss": 8996873306112.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.600120544433594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 73, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1213963.5857492776, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523419014216245, "mean_inference_ms": 5.206001655611851, "mean_action_processing_ms": 0.14332332961868535, "mean_env_wait_ms": 0.2604503160408905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015221556572064962, "StateBufferConnector_ms": 0.0023155996244247647, "ViewRequirementAgentConnector_ms": 0.05980648406564373}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1213963.5857492776, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523419014216245, "mean_inference_ms": 5.206001655611851, "mean_action_processing_ms": 0.14332332961868535, "mean_env_wait_ms": 0.2604503160408905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015221556572064962, "StateBufferConnector_ms": 0.0023155996244247647, "ViewRequirementAgentConnector_ms": 0.05980648406564373}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24528, "timers": {"training_iteration_time_ms": 1956.294, "learn_time_ms": 18.815, "learn_throughput": 17857.623, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "done": false, "episodes_total": 73, "training_iteration": 73, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-50", "timestamp": 1706266250, "time_this_iter_s": 1.972799301147461, "time_total_s": 143.1080300807953, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bcd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 143.1080300807953, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 14.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0982960975670024e+24, "policy_entropy": 628.714111328125, "var_gnorm": 22.768877029418945, "vf_loss": 10125102284800.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3020973205566406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 74, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1212039.180229875, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15234621542049823, "mean_inference_ms": 5.2060660172033835, "mean_action_processing_ms": 0.1433195359008659, "mean_env_wait_ms": 0.2604428061548406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015212394095755912, "StateBufferConnector_ms": 0.0023155599027066616, "ViewRequirementAgentConnector_ms": 0.05981922149658203}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1212039.180229875, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15234621542049823, "mean_inference_ms": 5.2060660172033835, "mean_action_processing_ms": 0.1433195359008659, "mean_env_wait_ms": 0.2604428061548406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015212394095755912, "StateBufferConnector_ms": 0.0023155599027066616, "ViewRequirementAgentConnector_ms": 0.05981922149658203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24864, "timers": {"training_iteration_time_ms": 1956.099, "learn_time_ms": 18.812, "learn_throughput": 17861.335, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "done": false, "episodes_total": 74, "training_iteration": 74, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-52", "timestamp": 1706266252, "time_this_iter_s": 1.957643985748291, "time_total_s": 145.06567406654358, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bf5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 145.06567406654358, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 15.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.9507221726741817e+24, "policy_entropy": 609.0374755859375, "var_gnorm": 22.770118713378906, "vf_loss": 9774137606144.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.409385681152344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 75, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1210185.945597633, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15235072377823142, "mean_inference_ms": 5.2061344066208255, "mean_action_processing_ms": 0.14331597038099977, "mean_env_wait_ms": 0.26043599557230285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015184402465820312, "StateBufferConnector_ms": 0.002314885457356771, "ViewRequirementAgentConnector_ms": 0.05979792277018229}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1210185.945597633, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15235072377823142, "mean_inference_ms": 5.2061344066208255, "mean_action_processing_ms": 0.14331597038099977, "mean_env_wait_ms": 0.26043599557230285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015184402465820312, "StateBufferConnector_ms": 0.002314885457356771, "ViewRequirementAgentConnector_ms": 0.05979792277018229}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25200, "timers": {"training_iteration_time_ms": 1956.441, "learn_time_ms": 18.829, "learn_throughput": 17844.509, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "done": false, "episodes_total": 75, "training_iteration": 75, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-54", "timestamp": 1706266254, "time_this_iter_s": 1.9725725650787354, "time_total_s": 147.03824663162231, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3310>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bc790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 147.03824663162231, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 15.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.7808083483201146e+24, "policy_entropy": 590.7935791015625, "var_gnorm": 22.771249771118164, "vf_loss": 9772278480896.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.981590270996094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 76, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1208408.4821674444, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15235634354837874, "mean_inference_ms": 5.2062124186406855, "mean_action_processing_ms": 0.14331262738605408, "mean_env_wait_ms": 0.2604305776044481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015189773158023232, "StateBufferConnector_ms": 0.0023148561778821445, "ViewRequirementAgentConnector_ms": 0.05984808269299959}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1208408.4821674444, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15235634354837874, "mean_inference_ms": 5.2062124186406855, "mean_action_processing_ms": 0.14331262738605408, "mean_env_wait_ms": 0.2604305776044481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015189773158023232, "StateBufferConnector_ms": 0.0023148561778821445, "ViewRequirementAgentConnector_ms": 0.05984808269299959}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25536, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25536, "timers": {"training_iteration_time_ms": 1961.358, "learn_time_ms": 18.913, "learn_throughput": 17765.373, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "done": false, "episodes_total": 76, "training_iteration": 76, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-56", "timestamp": 1706266256, "time_this_iter_s": 1.9874188899993896, "time_total_s": 149.0256655216217, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f199f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928be0e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 149.0256655216217, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 15.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.010083781254951e+24, "policy_entropy": 573.7601318359375, "var_gnorm": 22.772279739379883, "vf_loss": 10329044025344.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7789344787597656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 77, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1206898.274470668, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15236200671499428, "mean_inference_ms": 5.206289450018364, "mean_action_processing_ms": 0.14330942505696503, "mean_env_wait_ms": 0.26042521341399344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015166827610560827, "StateBufferConnector_ms": 0.0023154469279499795, "ViewRequirementAgentConnector_ms": 0.05983934774027242}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1206898.274470668, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15236200671499428, "mean_inference_ms": 5.206289450018364, "mean_action_processing_ms": 0.14330942505696503, "mean_env_wait_ms": 0.26042521341399344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015166827610560827, "StateBufferConnector_ms": 0.0023154469279499795, "ViewRequirementAgentConnector_ms": 0.05983934774027242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25872, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25872, "timers": {"training_iteration_time_ms": 1963.715, "learn_time_ms": 18.955, "learn_throughput": 17726.513, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "done": false, "episodes_total": 77, "training_iteration": 77, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-50-58", "timestamp": 1706266258, "time_this_iter_s": 1.96285080909729, "time_total_s": 150.988516330719, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105a20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bfe20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 150.988516330719, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 15.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.431684748914047e+24, "policy_entropy": 558.5634155273438, "var_gnorm": 22.773216247558594, "vf_loss": 11094979510272.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8623809814453125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 78, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1206043.5603504453, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523678436181067, "mean_inference_ms": 5.206366475917366, "mean_action_processing_ms": 0.14330648502600238, "mean_env_wait_ms": 0.2604204425282022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015200101412259616, "StateBufferConnector_ms": 0.002314188541510166, "ViewRequirementAgentConnector_ms": 0.05982564045832707}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1206043.5603504453, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523678436181067, "mean_inference_ms": 5.206366475917366, "mean_action_processing_ms": 0.14330648502600238, "mean_env_wait_ms": 0.2604204425282022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015200101412259616, "StateBufferConnector_ms": 0.002314188541510166, "ViewRequirementAgentConnector_ms": 0.05982564045832707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26208, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26208, "timers": {"training_iteration_time_ms": 1964.878, "learn_time_ms": 18.987, "learn_throughput": 17695.93, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "done": false, "episodes_total": 78, "training_iteration": 78, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-00", "timestamp": 1706266260, "time_this_iter_s": 1.9664416313171387, "time_total_s": 152.95495796203613, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2b30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bcc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 152.95495796203613, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 15.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.46091971378675e+25, "policy_entropy": 543.2041015625, "var_gnorm": 22.77406883239746, "vf_loss": 10064034267136.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 79, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1204752.488135055, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15237345825107482, "mean_inference_ms": 5.206438525468823, "mean_action_processing_ms": 0.14330333624123223, "mean_env_wait_ms": 0.2604153151212113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015171871909612342, "StateBufferConnector_ms": 0.0023123584216154076, "ViewRequirementAgentConnector_ms": 0.05978360960755167}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1204752.488135055, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15237345825107482, "mean_inference_ms": 5.206438525468823, "mean_action_processing_ms": 0.14330333624123223, "mean_env_wait_ms": 0.2604153151212113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015171871909612342, "StateBufferConnector_ms": 0.0023123584216154076, "ViewRequirementAgentConnector_ms": 0.05978360960755167}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26544, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26544, "timers": {"training_iteration_time_ms": 1962.629, "learn_time_ms": 19.001, "learn_throughput": 17683.295, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "done": false, "episodes_total": 79, "training_iteration": 79, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-02", "timestamp": 1706266262, "time_this_iter_s": 1.9522273540496826, "time_total_s": 154.90718531608582, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9cc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928a0670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 154.90718531608582, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 15.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.354961281546975e+24, "policy_entropy": 530.6869506835938, "var_gnorm": 22.774843215942383, "vf_loss": 10087619887104.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.266334533691406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 80, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1203220.3220011545, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15237901101380263, "mean_inference_ms": 5.206510610450758, "mean_action_processing_ms": 0.14330030894014323, "mean_env_wait_ms": 0.260410578869766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01515418291091919, "StateBufferConnector_ms": 0.0023111701011657715, "ViewRequirementAgentConnector_ms": 0.05977123975753784}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1203220.3220011545, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15237901101380263, "mean_inference_ms": 5.206510610450758, "mean_action_processing_ms": 0.14330030894014323, "mean_env_wait_ms": 0.260410578869766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01515418291091919, "StateBufferConnector_ms": 0.0023111701011657715, "ViewRequirementAgentConnector_ms": 0.05977123975753784}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26880, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1964.326, "learn_time_ms": 18.976, "learn_throughput": 17706.201, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "done": false, "episodes_total": 80, "training_iteration": 80, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-04", "timestamp": 1706266264, "time_this_iter_s": 1.964989423751831, "time_total_s": 156.87217473983765, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a61069b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272c790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 156.87217473983765, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 15.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5740436085713679e+25, "policy_entropy": 518.9963989257812, "var_gnorm": 22.775548934936523, "vf_loss": 9981273309184.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4809112548828125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 81, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1201612.96495862, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15238424024322603, "mean_inference_ms": 5.206583061547041, "mean_action_processing_ms": 0.14329721070234602, "mean_env_wait_ms": 0.26040570880035624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015144583619671104, "StateBufferConnector_ms": 0.0023105998098114392, "ViewRequirementAgentConnector_ms": 0.059782722849904754}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1201612.96495862, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15238424024322603, "mean_inference_ms": 5.206583061547041, "mean_action_processing_ms": 0.14329721070234602, "mean_env_wait_ms": 0.26040570880035624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015144583619671104, "StateBufferConnector_ms": 0.0023105998098114392, "ViewRequirementAgentConnector_ms": 0.059782722849904754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27216, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27216, "timers": {"training_iteration_time_ms": 1964.708, "learn_time_ms": 19.018, "learn_throughput": 17667.113, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "done": false, "episodes_total": 81, "training_iteration": 81, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-06", "timestamp": 1706266266, "time_this_iter_s": 1.9640424251556396, "time_total_s": 158.8362171649933, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1ba0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928be0e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 158.8362171649933, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 15.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.988101674881868e+25, "policy_entropy": 508.40374755859375, "var_gnorm": 22.776185989379883, "vf_loss": 9894027591680.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.612041473388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 82, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1200084.1867791063, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15238941879979093, "mean_inference_ms": 5.206652084813714, "mean_action_processing_ms": 0.14329405734126013, "mean_env_wait_ms": 0.26040101490933215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015142487316596799, "StateBufferConnector_ms": 0.002310334182367092, "ViewRequirementAgentConnector_ms": 0.059772119289491235}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1200084.1867791063, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15238941879979093, "mean_inference_ms": 5.206652084813714, "mean_action_processing_ms": 0.14329405734126013, "mean_env_wait_ms": 0.26040101490933215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015142487316596799, "StateBufferConnector_ms": 0.002310334182367092, "ViewRequirementAgentConnector_ms": 0.059772119289491235}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27552, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27552, "timers": {"training_iteration_time_ms": 1965.324, "learn_time_ms": 19.009, "learn_throughput": 17675.577, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "done": false, "episodes_total": 82, "training_iteration": 82, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-08", "timestamp": 1706266268, "time_this_iter_s": 1.9567487239837646, "time_total_s": 160.79296588897705, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19510>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272c8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 160.79296588897705, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 15.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.256417248210407e+25, "policy_entropy": 500.0047302246094, "var_gnorm": 22.776765823364258, "vf_loss": 10572710019072.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.172325134277344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 83, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1199248.4893610019, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15239447098157885, "mean_inference_ms": 5.206717727294446, "mean_action_processing_ms": 0.1432908525184257, "mean_env_wait_ms": 0.26039626575067676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015124068202742612, "StateBufferConnector_ms": 0.0023097877042839326, "ViewRequirementAgentConnector_ms": 0.05976809076516025}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1199248.4893610019, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15239447098157885, "mean_inference_ms": 5.206717727294446, "mean_action_processing_ms": 0.1432908525184257, "mean_env_wait_ms": 0.26039626575067676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015124068202742612, "StateBufferConnector_ms": 0.0023097877042839326, "ViewRequirementAgentConnector_ms": 0.05976809076516025}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27888, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27888, "timers": {"training_iteration_time_ms": 1963.619, "learn_time_ms": 18.973, "learn_throughput": 17709.472, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "done": false, "episodes_total": 83, "training_iteration": 83, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-10", "timestamp": 1706266270, "time_this_iter_s": 1.9557256698608398, "time_total_s": 162.7486915588379, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105690>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272d090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 162.7486915588379, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 15.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.3916621764094132e+25, "policy_entropy": 492.0182800292969, "var_gnorm": 22.777294158935547, "vf_loss": 9490999017472.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.1484832763671875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 84, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1197577.1389519635, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15239939852369613, "mean_inference_ms": 5.20678099615234, "mean_action_processing_ms": 0.14328757472315207, "mean_env_wait_ms": 0.26039118760087376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015188114983694894, "StateBufferConnector_ms": 0.0023103895641508557, "ViewRequirementAgentConnector_ms": 0.059766996474493114}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1197577.1389519635, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15239939852369613, "mean_inference_ms": 5.20678099615234, "mean_action_processing_ms": 0.14328757472315207, "mean_env_wait_ms": 0.26039118760087376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015188114983694894, "StateBufferConnector_ms": 0.0023103895641508557, "ViewRequirementAgentConnector_ms": 0.059766996474493114}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28224, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28224, "timers": {"training_iteration_time_ms": 1963.56, "learn_time_ms": 18.967, "learn_throughput": 17714.525, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "done": false, "episodes_total": 84, "training_iteration": 84, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-12", "timestamp": 1706266272, "time_this_iter_s": 1.957033634185791, "time_total_s": 164.70572519302368, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bd510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 164.70572519302368, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 15.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.428694619294993e+25, "policy_entropy": 486.509765625, "var_gnorm": 22.77777099609375, "vf_loss": 10391405985792.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4928321838378906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 85, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1196425.7050769012, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240454336970893, "mean_inference_ms": 5.20684572720108, "mean_action_processing_ms": 0.14328438134074994, "mean_env_wait_ms": 0.2603867321854629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015169311972225414, "StateBufferConnector_ms": 0.0023095748003791362, "ViewRequirementAgentConnector_ms": 0.059753586264217604}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1196425.7050769012, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240454336970893, "mean_inference_ms": 5.20684572720108, "mean_action_processing_ms": 0.14328438134074994, "mean_env_wait_ms": 0.2603867321854629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015169311972225414, "StateBufferConnector_ms": 0.0023095748003791362, "ViewRequirementAgentConnector_ms": 0.059753586264217604}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28560, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28560, "timers": {"training_iteration_time_ms": 1963.25, "learn_time_ms": 18.949, "learn_throughput": 17731.955, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "done": false, "episodes_total": 85, "training_iteration": 85, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-14", "timestamp": 1706266274, "time_this_iter_s": 1.9694604873657227, "time_total_s": 166.6751856803894, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2b30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272cf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 166.6751856803894, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 15.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.785016841587589e+25, "policy_entropy": 476.4931945800781, "var_gnorm": 22.77820587158203, "vf_loss": 10663897333760.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7789344787597656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 86, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1195559.433458023, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240941126324378, "mean_inference_ms": 5.206916339842049, "mean_action_processing_ms": 0.143281099929188, "mean_env_wait_ms": 0.2603821141592752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015156490858211073, "StateBufferConnector_ms": 0.0023093334464139715, "ViewRequirementAgentConnector_ms": 0.059733557146649026}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1195559.433458023, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240941126324378, "mean_inference_ms": 5.206916339842049, "mean_action_processing_ms": 0.143281099929188, "mean_env_wait_ms": 0.2603821141592752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015156490858211073, "StateBufferConnector_ms": 0.0023093334464139715, "ViewRequirementAgentConnector_ms": 0.059733557146649026}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28896, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28896, "timers": {"training_iteration_time_ms": 1962.255, "learn_time_ms": 18.925, "learn_throughput": 17754.473, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "done": false, "episodes_total": 86, "training_iteration": 86, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-16", "timestamp": 1706266276, "time_this_iter_s": 1.9774763584136963, "time_total_s": 168.6526620388031, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105e40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272d900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 168.6526620388031, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 16.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.327376656818341e+25, "policy_entropy": 472.92254638671875, "var_gnorm": 22.778596878051758, "vf_loss": 9392186458112.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.600120544433594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 87, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1193668.8273974096, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241404326487049, "mean_inference_ms": 5.20698329515694, "mean_action_processing_ms": 0.14327772371257838, "mean_env_wait_ms": 0.260377088599466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015146156837200296, "StateBufferConnector_ms": 0.0023093716851596176, "ViewRequirementAgentConnector_ms": 0.05973865245950633}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1193668.8273974096, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241404326487049, "mean_inference_ms": 5.20698329515694, "mean_action_processing_ms": 0.14327772371257838, "mean_env_wait_ms": 0.260377088599466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015146156837200296, "StateBufferConnector_ms": 0.0023093716851596176, "ViewRequirementAgentConnector_ms": 0.05973865245950633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29232, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29232, "timers": {"training_iteration_time_ms": 1961.301, "learn_time_ms": 18.918, "learn_throughput": 17760.469, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "done": false, "episodes_total": 87, "training_iteration": 87, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-18", "timestamp": 1706266278, "time_this_iter_s": 1.9533615112304688, "time_total_s": 170.60602355003357, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1d20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bf370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 170.60602355003357, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 16.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.6473441788794765e+25, "policy_entropy": 466.84771728515625, "var_gnorm": 22.778955459594727, "vf_loss": 10095656173568.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.886222839355469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 88, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1192580.9642780141, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241852671018652, "mean_inference_ms": 5.2070466040988, "mean_action_processing_ms": 0.14327434945018058, "mean_env_wait_ms": 0.2603719147717172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01512820070440119, "StateBufferConnector_ms": 0.0023080544038252397, "ViewRequirementAgentConnector_ms": 0.05975013429468328}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1192580.9642780141, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241852671018652, "mean_inference_ms": 5.2070466040988, "mean_action_processing_ms": 0.14327434945018058, "mean_env_wait_ms": 0.2603719147717172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01512820070440119, "StateBufferConnector_ms": 0.0023080544038252397, "ViewRequirementAgentConnector_ms": 0.05975013429468328}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29568, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 1960.024, "learn_time_ms": 18.886, "learn_throughput": 17790.49, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "done": false, "episodes_total": 88, "training_iteration": 88, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-20", "timestamp": 1706266280, "time_this_iter_s": 1.9537115097045898, "time_total_s": 172.55973505973816, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19630>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272d510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 172.55973505973816, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7246951237085816e+26, "policy_entropy": 462.8753662109375, "var_gnorm": 22.779277801513672, "vf_loss": 10418513772544.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.208087921142578e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 89, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1191597.2794876925, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15242283791775696, "mean_inference_ms": 5.207105560076421, "mean_action_processing_ms": 0.14327094595167045, "mean_env_wait_ms": 0.2603668738553647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015118416775478406, "StateBufferConnector_ms": 0.0023081061545382727, "ViewRequirementAgentConnector_ms": 0.0597487674670273}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1191597.2794876925, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15242283791775696, "mean_inference_ms": 5.207105560076421, "mean_action_processing_ms": 0.14327094595167045, "mean_env_wait_ms": 0.2603668738553647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015118416775478406, "StateBufferConnector_ms": 0.0023081061545382727, "ViewRequirementAgentConnector_ms": 0.0597487674670273}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29904, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29904, "timers": {"training_iteration_time_ms": 1959.991, "learn_time_ms": 18.864, "learn_throughput": 17811.469, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "done": false, "episodes_total": 89, "training_iteration": 89, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-22", "timestamp": 1706266282, "time_this_iter_s": 1.951906442642212, "time_total_s": 174.51164150238037, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105030>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272e0e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 174.51164150238037, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 16.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2729210796877016e+26, "policy_entropy": 456.2574462890625, "var_gnorm": 22.779571533203125, "vf_loss": 10449673256960.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 90, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1190794.633510254, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524271348707929, "mean_inference_ms": 5.207201659696058, "mean_action_processing_ms": 0.14326766647056227, "mean_env_wait_ms": 0.26036211391530906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01510514153374566, "StateBufferConnector_ms": 0.0023084216647677952, "ViewRequirementAgentConnector_ms": 0.0597540537516276}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1190794.633510254, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524271348707929, "mean_inference_ms": 5.207201659696058, "mean_action_processing_ms": 0.14326766647056227, "mean_env_wait_ms": 0.26036211391530906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01510514153374566, "StateBufferConnector_ms": 0.0023084216647677952, "ViewRequirementAgentConnector_ms": 0.0597540537516276}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30240, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30240, "timers": {"training_iteration_time_ms": 1970.082, "learn_time_ms": 18.895, "learn_throughput": 17782.656, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "done": false, "episodes_total": 90, "training_iteration": 90, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-24", "timestamp": 1706266284, "time_this_iter_s": 2.0659191608428955, "time_total_s": 176.57756066322327, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1be50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928be7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 176.57756066322327, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 16.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.669201566842617e+25, "policy_entropy": 452.2193603515625, "var_gnorm": 22.779834747314453, "vf_loss": 10116135911424.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8504600524902344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 91, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1189599.9784282302, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.152431652499685, "mean_inference_ms": 5.207302535130814, "mean_action_processing_ms": 0.1432647780016548, "mean_env_wait_ms": 0.2603580235352162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01510551997593471, "StateBufferConnector_ms": 0.0023113502250922905, "ViewRequirementAgentConnector_ms": 0.059756341871324475}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1189599.9784282302, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.152431652499685, "mean_inference_ms": 5.207302535130814, "mean_action_processing_ms": 0.1432647780016548, "mean_env_wait_ms": 0.2603580235352162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01510551997593471, "StateBufferConnector_ms": 0.0023113502250922905, "ViewRequirementAgentConnector_ms": 0.059756341871324475}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30576, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30576, "timers": {"training_iteration_time_ms": 1972.171, "learn_time_ms": 18.952, "learn_throughput": 17728.966, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "done": false, "episodes_total": 91, "training_iteration": 91, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-26", "timestamp": 1706266286, "time_this_iter_s": 1.9849915504455566, "time_total_s": 178.56255221366882, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272d1b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 178.56255221366882, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 16.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0615330140517566e+26, "policy_entropy": 447.6637878417969, "var_gnorm": 22.780075073242188, "vf_loss": 8984827265024.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.731250762939453e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 92, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1187763.814513043, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15243609389900947, "mean_inference_ms": 5.207406556065444, "mean_action_processing_ms": 0.1432620235238228, "mean_env_wait_ms": 0.26035401267475966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015177156614220661, "StateBufferConnector_ms": 0.0023116236147673235, "ViewRequirementAgentConnector_ms": 0.059753397236699646}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1187763.814513043, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15243609389900947, "mean_inference_ms": 5.207406556065444, "mean_action_processing_ms": 0.1432620235238228, "mean_env_wait_ms": 0.26035401267475966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015177156614220661, "StateBufferConnector_ms": 0.0023116236147673235, "ViewRequirementAgentConnector_ms": 0.059753397236699646}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30912, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30912, "timers": {"training_iteration_time_ms": 1974.23, "learn_time_ms": 18.954, "learn_throughput": 17727.516, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "done": false, "episodes_total": 92, "training_iteration": 92, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-28", "timestamp": 1706266288, "time_this_iter_s": 1.9773609638214111, "time_total_s": 180.53991317749023, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104220>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272dab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 180.53991317749023, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 16.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0965263953258632e+26, "policy_entropy": 444.1852722167969, "var_gnorm": 22.78029441833496, "vf_loss": 9963736924160.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.314018249511719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 93, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1186562.5911879973, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244053062937782, "mean_inference_ms": 5.207512659754776, "mean_action_processing_ms": 0.14325945249451097, "mean_env_wait_ms": 0.2603502364839171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015163677994922926, "StateBufferConnector_ms": 0.0023100965766496557, "ViewRequirementAgentConnector_ms": 0.05974385046189831}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1186562.5911879973, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244053062937782, "mean_inference_ms": 5.207512659754776, "mean_action_processing_ms": 0.14325945249451097, "mean_env_wait_ms": 0.2603502364839171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015163677994922926, "StateBufferConnector_ms": 0.0023100965766496557, "ViewRequirementAgentConnector_ms": 0.05974385046189831}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31248, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31248, "timers": {"training_iteration_time_ms": 1976.221, "learn_time_ms": 18.961, "learn_throughput": 17720.673, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "done": false, "episodes_total": 93, "training_iteration": 93, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-30", "timestamp": 1706266290, "time_this_iter_s": 1.9757201671600342, "time_total_s": 182.51563334465027, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2ef0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928be200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 182.51563334465027, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 16.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.909521747930435e+26, "policy_entropy": 441.2153625488281, "var_gnorm": 22.780492782592773, "vf_loss": 9807071281152.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.24249267578125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 94, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1185322.055784333, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524446747279277, "mean_inference_ms": 5.207611433324543, "mean_action_processing_ms": 0.14325690250365353, "mean_env_wait_ms": 0.26034624091642056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015144906145461063, "StateBufferConnector_ms": 0.002310123849422374, "ViewRequirementAgentConnector_ms": 0.05974211591355344}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1185322.055784333, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524446747279277, "mean_inference_ms": 5.207611433324543, "mean_action_processing_ms": 0.14325690250365353, "mean_env_wait_ms": 0.26034624091642056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015144906145461063, "StateBufferConnector_ms": 0.002310123849422374, "ViewRequirementAgentConnector_ms": 0.05974211591355344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31584, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31584, "timers": {"training_iteration_time_ms": 1975.024, "learn_time_ms": 18.92, "learn_throughput": 17759.395, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "done": false, "episodes_total": 94, "training_iteration": 94, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-32", "timestamp": 1706266292, "time_this_iter_s": 1.945059061050415, "time_total_s": 184.46069240570068, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19930>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272c4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 184.46069240570068, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 16.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.3619781370146017e+26, "policy_entropy": 439.7069091796875, "var_gnorm": 22.780672073364258, "vf_loss": 10741025341440.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.170967102050781e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 95, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1184471.5597373513, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244875192096174, "mean_inference_ms": 5.207706485897228, "mean_action_processing_ms": 0.1432544217043294, "mean_env_wait_ms": 0.2603421456750648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015134811401367188, "StateBufferConnector_ms": 0.0023098995811060854, "ViewRequirementAgentConnector_ms": 0.0597456881874486}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1184471.5597373513, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244875192096174, "mean_inference_ms": 5.207706485897228, "mean_action_processing_ms": 0.1432544217043294, "mean_env_wait_ms": 0.2603421456750648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015134811401367188, "StateBufferConnector_ms": 0.0023098995811060854, "ViewRequirementAgentConnector_ms": 0.0597456881874486}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31920, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31920, "timers": {"training_iteration_time_ms": 1973.72, "learn_time_ms": 18.914, "learn_throughput": 17764.947, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "done": false, "episodes_total": 95, "training_iteration": 95, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-34", "timestamp": 1706266294, "time_this_iter_s": 1.956453800201416, "time_total_s": 186.4171462059021, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105510>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272eb00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 186.4171462059021, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 16.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.382529177317728e+25, "policy_entropy": 436.96142578125, "var_gnorm": 22.780834197998047, "vf_loss": 10239227199488.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.516674041748047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 96, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1183420.2876508692, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15245272846372007, "mean_inference_ms": 5.207801574280048, "mean_action_processing_ms": 0.14325194502021202, "mean_env_wait_ms": 0.2603381178837246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015120704968770346, "StateBufferConnector_ms": 0.002308438221613566, "ViewRequirementAgentConnector_ms": 0.059738755226135254}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1183420.2876508692, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15245272846372007, "mean_inference_ms": 5.207801574280048, "mean_action_processing_ms": 0.14325194502021202, "mean_env_wait_ms": 0.2603381178837246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015120704968770346, "StateBufferConnector_ms": 0.002308438221613566, "ViewRequirementAgentConnector_ms": 0.059738755226135254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32256, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1972.775, "learn_time_ms": 18.923, "learn_throughput": 17756.24, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 96, "training_iteration": 96, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-36", "timestamp": 1706266296, "time_this_iter_s": 1.9680454730987549, "time_total_s": 188.38519167900085, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1a5c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bcf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 188.38519167900085, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 16.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.4832352727558213e+25, "policy_entropy": 432.310302734375, "var_gnorm": 22.78097915649414, "vf_loss": 10452671135744.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 97, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1182584.5650807426, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15245667988410466, "mean_inference_ms": 5.207897761021653, "mean_action_processing_ms": 0.14324953113615066, "mean_env_wait_ms": 0.26033430061313906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015122865893177151, "StateBufferConnector_ms": 0.0023084817473421394, "ViewRequirementAgentConnector_ms": 0.059750891223396226}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1182584.5650807426, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15245667988410466, "mean_inference_ms": 5.207897761021653, "mean_action_processing_ms": 0.14324953113615066, "mean_env_wait_ms": 0.26033430061313906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015122865893177151, "StateBufferConnector_ms": 0.0023084817473421394, "ViewRequirementAgentConnector_ms": 0.059750891223396226}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32592, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32592, "timers": {"training_iteration_time_ms": 1974.685, "learn_time_ms": 18.947, "learn_throughput": 17733.785, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "done": false, "episodes_total": 97, "training_iteration": 97, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-38", "timestamp": 1706266298, "time_this_iter_s": 1.9724750518798828, "time_total_s": 190.35766673088074, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0880>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272d870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 190.35766673088074, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 16.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6714692572931815e+26, "policy_entropy": 429.4207763671875, "var_gnorm": 22.781110763549805, "vf_loss": 9821352886272.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.172325134277344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 98, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1181432.2512353293, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524607645737304, "mean_inference_ms": 5.20799509906425, "mean_action_processing_ms": 0.14324730858897314, "mean_env_wait_ms": 0.2603307682560891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015110385661222497, "StateBufferConnector_ms": 0.002309497521848095, "ViewRequirementAgentConnector_ms": 0.05975645415636958}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1181432.2512353293, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524607645737304, "mean_inference_ms": 5.20799509906425, "mean_action_processing_ms": 0.14324730858897314, "mean_env_wait_ms": 0.2603307682560891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015110385661222497, "StateBufferConnector_ms": 0.002309497521848095, "ViewRequirementAgentConnector_ms": 0.05975645415636958}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32928, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32928, "timers": {"training_iteration_time_ms": 1976.712, "learn_time_ms": 18.98, "learn_throughput": 17702.398, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "done": false, "episodes_total": 98, "training_iteration": 98, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-40", "timestamp": 1706266300, "time_this_iter_s": 1.9739940166473389, "time_total_s": 192.33166074752808, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272f370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 192.33166074752808, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 17.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.342713833243545e+26, "policy_entropy": 428.1678161621094, "var_gnorm": 22.781232833862305, "vf_loss": 9541988122624.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.303455352783203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 99, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1180498.0927719686, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15246486518741173, "mean_inference_ms": 5.208097399999896, "mean_action_processing_ms": 0.1432452048858046, "mean_env_wait_ms": 0.2603274192811084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015101769957879577, "StateBufferConnector_ms": 0.0023092886414190737, "ViewRequirementAgentConnector_ms": 0.05975275328665069}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1180498.0927719686, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15246486518741173, "mean_inference_ms": 5.208097399999896, "mean_action_processing_ms": 0.1432452048858046, "mean_env_wait_ms": 0.2603274192811084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015101769957879577, "StateBufferConnector_ms": 0.0023092886414190737, "ViewRequirementAgentConnector_ms": 0.05975275328665069}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33264, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33264, "timers": {"training_iteration_time_ms": 1980.103, "learn_time_ms": 19.003, "learn_throughput": 17681.498, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "done": false, "episodes_total": 99, "training_iteration": 99, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-42", "timestamp": 1706266302, "time_this_iter_s": 1.9858407974243164, "time_total_s": 194.3175015449524, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1570>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272f6d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 194.3175015449524, "timesteps_since_restore": 0, "iterations_since_restore": 99, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 17.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.026376941771771e+26, "policy_entropy": 430.87591552734375, "var_gnorm": 22.781341552734375, "vf_loss": 10697733832704.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.0650367736816406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 100, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1179885.186286181, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15246887634144898, "mean_inference_ms": 5.208201324304497, "mean_action_processing_ms": 0.14324322776931964, "mean_env_wait_ms": 0.26032429670217483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015084505081176758, "StateBufferConnector_ms": 0.0023086071014404297, "ViewRequirementAgentConnector_ms": 0.0597381591796875}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1179885.186286181, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15246887634144898, "mean_inference_ms": 5.208201324304497, "mean_action_processing_ms": 0.14324322776931964, "mean_env_wait_ms": 0.26032429670217483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015084505081176758, "StateBufferConnector_ms": 0.0023086071014404297, "ViewRequirementAgentConnector_ms": 0.0597381591796875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33600, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 1971.048, "learn_time_ms": 18.981, "learn_throughput": 17702.087, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "done": false, "episodes_total": 100, "training_iteration": 100, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-44", "timestamp": 1706266304, "time_this_iter_s": 1.9753916263580322, "time_total_s": 196.29289317131042, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19810>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272e050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 196.29289317131042, "timesteps_since_restore": 0, "iterations_since_restore": 100, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 17.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.839117293517167e+25, "policy_entropy": 426.07940673828125, "var_gnorm": 22.78144073486328, "vf_loss": 9798152093696.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.552436828613281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 101, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1487492.033108109, "episode_reward_mean": -1173887.6887107063, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244245665905143, "mean_inference_ms": 5.208258682028397, "mean_action_processing_ms": 0.14321722829163422, "mean_env_wait_ms": 0.2602630461133664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01507425308227539, "StateBufferConnector_ms": 0.0023059844970703125, "ViewRequirementAgentConnector_ms": 0.05972743034362793}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1487492.033108109, "episode_reward_mean": -1173887.6887107063, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244245665905143, "mean_inference_ms": 5.208258682028397, "mean_action_processing_ms": 0.14321722829163422, "mean_env_wait_ms": 0.2602630461133664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01507425308227539, "StateBufferConnector_ms": 0.0023059844970703125, "ViewRequirementAgentConnector_ms": 0.05972743034362793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33936, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33936, "timers": {"training_iteration_time_ms": 1968.895, "learn_time_ms": 18.883, "learn_throughput": 17793.95, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "done": false, "episodes_total": 101, "training_iteration": 101, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-46", "timestamp": 1706266306, "time_this_iter_s": 1.9634456634521484, "time_total_s": 198.25633883476257, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104ac0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272fa30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 198.25633883476257, "timesteps_since_restore": 0, "iterations_since_restore": 101, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 17.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1705374073274766e+26, "policy_entropy": 424.4701232910156, "var_gnorm": 22.781530380249023, "vf_loss": 9951764283392.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.0531158447265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 102, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1487492.033108109, "episode_reward_mean": -1171453.7197568624, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524226599615821, "mean_inference_ms": 5.208395914121691, "mean_action_processing_ms": 0.14319804343608078, "mean_env_wait_ms": 0.26020371847720963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015083789825439453, "StateBufferConnector_ms": 0.0023038387298583984, "ViewRequirementAgentConnector_ms": 0.05973982810974121}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1487492.033108109, "episode_reward_mean": -1171453.7197568624, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524226599615821, "mean_inference_ms": 5.208395914121691, "mean_action_processing_ms": 0.14319804343608078, "mean_env_wait_ms": 0.26020371847720963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015083789825439453, "StateBufferConnector_ms": 0.0023038387298583984, "ViewRequirementAgentConnector_ms": 0.05973982810974121}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34272, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34272, "timers": {"training_iteration_time_ms": 1968.907, "learn_time_ms": 18.857, "learn_throughput": 17817.954, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "done": false, "episodes_total": 102, "training_iteration": 102, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-48", "timestamp": 1706266308, "time_this_iter_s": 1.9775047302246094, "time_total_s": 200.23384356498718, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f184c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272fc70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 200.23384356498718, "timesteps_since_restore": 0, "iterations_since_restore": 102, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.699999999999999, "ram_util_percent": 17.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.229330526481965e+26, "policy_entropy": 425.7451171875, "var_gnorm": 22.7816104888916, "vf_loss": 10460911894528.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7789344787597656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 103, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1167753.558150216, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240941928585344, "mean_inference_ms": 5.208672616300228, "mean_action_processing_ms": 0.14318285539958367, "mean_env_wait_ms": 0.2601454091874524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015084266662597656, "StateBufferConnector_ms": 0.002300262451171875, "ViewRequirementAgentConnector_ms": 0.05977225303649902}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1167753.558150216, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1406353.6815460655, -1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240941928585344, "mean_inference_ms": 5.208672616300228, "mean_action_processing_ms": 0.14318285539958367, "mean_env_wait_ms": 0.2601454091874524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015084266662597656, "StateBufferConnector_ms": 0.002300262451171875, "ViewRequirementAgentConnector_ms": 0.05977225303649902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34608, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34608, "timers": {"training_iteration_time_ms": 1968.267, "learn_time_ms": 18.816, "learn_throughput": 17857.352, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "done": false, "episodes_total": 103, "training_iteration": 103, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-50", "timestamp": 1706266310, "time_this_iter_s": 1.9693148136138916, "time_total_s": 202.20315837860107, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2e90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272f1c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 202.20315837860107, "timesteps_since_restore": 0, "iterations_since_restore": 103, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 17.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3144353849918646e+26, "policy_entropy": 422.3135681152344, "var_gnorm": 22.78168296813965, "vf_loss": 9601422458880.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 104, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1164135.558885224, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524102945249579, "mean_inference_ms": 5.20900841913015, "mean_action_processing_ms": 0.1431758423640031, "mean_env_wait_ms": 0.26011041411297475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015093803405761719, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.059804439544677734}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1164135.558885224, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369258.7691818627, -1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524102945249579, "mean_inference_ms": 5.20900841913015, "mean_action_processing_ms": 0.1431758423640031, "mean_env_wait_ms": 0.26011041411297475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015093803405761719, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.059804439544677734}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34944, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 1970.673, "learn_time_ms": 18.819, "learn_throughput": 17853.868, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "done": false, "episodes_total": 104, "training_iteration": 104, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-52", "timestamp": 1706266312, "time_this_iter_s": 1.9691674709320068, "time_total_s": 204.17232584953308, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6106260>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92750310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 204.17232584953308, "timesteps_since_restore": 0, "iterations_since_restore": 104, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 17.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.371733061258792e+25, "policy_entropy": 420.5179443359375, "var_gnorm": 22.781747817993164, "vf_loss": 10726622101504.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.516674041748047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 105, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1161459.9767486355, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241655337138346, "mean_inference_ms": 5.209359084800704, "mean_action_processing_ms": 0.1431726956738297, "mean_env_wait_ms": 0.26008708605171377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015108823776245117, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.0598139762878418}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1161459.9767486355, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1211644.3328933395, -1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241655337138346, "mean_inference_ms": 5.209359084800704, "mean_action_processing_ms": 0.1431726956738297, "mean_env_wait_ms": 0.26008708605171377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015108823776245117, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.0598139762878418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35280, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35280, "timers": {"training_iteration_time_ms": 1971.811, "learn_time_ms": 18.872, "learn_throughput": 17804.493, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "done": false, "episodes_total": 105, "training_iteration": 105, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-54", "timestamp": 1706266314, "time_this_iter_s": 1.9678306579589844, "time_total_s": 206.14015650749207, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1030>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272de10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 206.14015650749207, "timesteps_since_restore": 0, "iterations_since_restore": 105, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 17.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.129735457700214e+25, "policy_entropy": 421.39007568359375, "var_gnorm": 22.78180694580078, "vf_loss": 9253212389376.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.886222839355469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 106, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1159732.0672745947, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15242489486937028, "mean_inference_ms": 5.209694135869625, "mean_action_processing_ms": 0.14317017748499178, "mean_env_wait_ms": 0.2600705786104894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015103578567504883, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.05983233451843262}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1159732.0672745947, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1208216.7021338907, -1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15242489486937028, "mean_inference_ms": 5.209694135869625, "mean_action_processing_ms": 0.14317017748499178, "mean_env_wait_ms": 0.2600705786104894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015103578567504883, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.05983233451843262}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35616, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35616, "timers": {"training_iteration_time_ms": 1971.239, "learn_time_ms": 18.872, "learn_throughput": 17803.818, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "done": false, "episodes_total": 106, "training_iteration": 106, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-56", "timestamp": 1706266316, "time_this_iter_s": 1.9623303413391113, "time_total_s": 208.10248684883118, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f197e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928bfb50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 208.10248684883118, "timesteps_since_restore": 0, "iterations_since_restore": 106, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 17.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.694934253624703e+26, "policy_entropy": 417.21368408203125, "var_gnorm": 22.781862258911133, "vf_loss": 10999443750912.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 107, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1159028.0040555312, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15243389293378434, "mean_inference_ms": 5.209974068776022, "mean_action_processing_ms": 0.14316781173267784, "mean_env_wait_ms": 0.26005905389459183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015107154846191406, "StateBufferConnector_ms": 0.002301454544067383, "ViewRequirementAgentConnector_ms": 0.05983901023864746}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1159028.0040555312, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1171231.5787866367, -1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15243389293378434, "mean_inference_ms": 5.209974068776022, "mean_action_processing_ms": 0.14316781173267784, "mean_env_wait_ms": 0.26005905389459183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015107154846191406, "StateBufferConnector_ms": 0.002301454544067383, "ViewRequirementAgentConnector_ms": 0.05983901023864746}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35952, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35952, "timers": {"training_iteration_time_ms": 1972.679, "learn_time_ms": 18.839, "learn_throughput": 17835.137, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "done": false, "episodes_total": 107, "training_iteration": 107, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-51-58", "timestamp": 1706266318, "time_this_iter_s": 1.9868791103363037, "time_total_s": 210.08936595916748, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a61062c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92750a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 210.08936595916748, "timesteps_since_restore": 0, "iterations_since_restore": 107, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 17.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.784044857264703e+25, "policy_entropy": 421.06671142578125, "var_gnorm": 22.781911849975586, "vf_loss": 12566060335104.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.063678741455078e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 108, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1159094.9783762104, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244554446109834, "mean_inference_ms": 5.210244943577745, "mean_action_processing_ms": 0.14316588686401865, "mean_env_wait_ms": 0.26005024789563586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015116691589355469, "StateBufferConnector_ms": 0.0023009777069091797, "ViewRequirementAgentConnector_ms": 0.05987977981567383}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1159094.9783762104, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1183855.1026155814, -1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244554446109834, "mean_inference_ms": 5.210244943577745, "mean_action_processing_ms": 0.14316588686401865, "mean_env_wait_ms": 0.26005024789563586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015116691589355469, "StateBufferConnector_ms": 0.0023009777069091797, "ViewRequirementAgentConnector_ms": 0.05987977981567383}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36288, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36288, "timers": {"training_iteration_time_ms": 1972.875, "learn_time_ms": 18.826, "learn_throughput": 17847.786, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "done": false, "episodes_total": 108, "training_iteration": 108, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-00", "timestamp": 1706266320, "time_this_iter_s": 1.9759461879730225, "time_total_s": 212.0653121471405, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f199f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272fd90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 212.0653121471405, "timesteps_since_restore": 0, "iterations_since_restore": 108, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 17.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.21404075136509e+25, "policy_entropy": 420.3321533203125, "var_gnorm": 22.78195571899414, "vf_loss": 10324066435072.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8623809814453125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 109, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1158150.6091571494, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15245756173071545, "mean_inference_ms": 5.210502478646077, "mean_action_processing_ms": 0.14316406934793954, "mean_env_wait_ms": 0.26004164852074085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015129566192626953, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.059892892837524414}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1158150.6091571494, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1107101.2173950234, -1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15245756173071545, "mean_inference_ms": 5.210502478646077, "mean_action_processing_ms": 0.14316406934793954, "mean_env_wait_ms": 0.26004164852074085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015129566192626953, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.059892892837524414}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36624, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36624, "timers": {"training_iteration_time_ms": 1970.896, "learn_time_ms": 18.846, "learn_throughput": 17828.909, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "done": false, "episodes_total": 109, "training_iteration": 109, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-02", "timestamp": 1706266322, "time_this_iter_s": 1.966083288192749, "time_total_s": 214.03139543533325, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92750ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 214.03139543533325, "timesteps_since_restore": 0, "iterations_since_restore": 109, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 18.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4416611031287135e+26, "policy_entropy": 418.9261779785156, "var_gnorm": 22.78199577331543, "vf_loss": 9735230193664.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.516674041748047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 110, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1157734.525900155, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15247185312915862, "mean_inference_ms": 5.210777162682949, "mean_action_processing_ms": 0.14316351104900502, "mean_env_wait_ms": 0.2600370826310438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015144824981689453, "StateBufferConnector_ms": 0.0023005008697509766, "ViewRequirementAgentConnector_ms": 0.05990958213806152}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1157734.525900155, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1146806.9989101605, -1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15247185312915862, "mean_inference_ms": 5.210777162682949, "mean_action_processing_ms": 0.14316351104900502, "mean_env_wait_ms": 0.2600370826310438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015144824981689453, "StateBufferConnector_ms": 0.0023005008697509766, "ViewRequirementAgentConnector_ms": 0.05990958213806152}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36960, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36960, "timers": {"training_iteration_time_ms": 1971.016, "learn_time_ms": 18.851, "learn_throughput": 17823.994, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "done": false, "episodes_total": 110, "training_iteration": 110, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-04", "timestamp": 1706266324, "time_this_iter_s": 1.9765501022338867, "time_total_s": 216.00794553756714, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a61046a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92751240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 216.00794553756714, "timesteps_since_restore": 0, "iterations_since_restore": 110, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 18.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.649353640290652e+26, "policy_entropy": 417.7618408203125, "var_gnorm": 22.782032012939453, "vf_loss": 10167398694912.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.017353057861328e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 111, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1157194.379166483, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15248593737736837, "mean_inference_ms": 5.21103116936856, "mean_action_processing_ms": 0.14316245641326344, "mean_env_wait_ms": 0.26003250457793126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015156030654907227, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.05993199348449707}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1157194.379166483, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1220027.4620481997, -1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15248593737736837, "mean_inference_ms": 5.21103116936856, "mean_action_processing_ms": 0.14316245641326344, "mean_env_wait_ms": 0.26003250457793126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015156030654907227, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.05993199348449707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37296, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37296, "timers": {"training_iteration_time_ms": 1971.229, "learn_time_ms": 18.87, "learn_throughput": 17805.775, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "done": false, "episodes_total": 111, "training_iteration": 111, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-06", "timestamp": 1706266326, "time_this_iter_s": 1.965606927871704, "time_total_s": 217.97355246543884, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1ba0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272d1b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 217.97355246543884, "timesteps_since_restore": 0, "iterations_since_restore": 111, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 18.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.493522934330434e+25, "policy_entropy": 417.3291015625, "var_gnorm": 22.782062530517578, "vf_loss": 10922716299264.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.349781036376953e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 112, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1156248.1747956574, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15250064348179737, "mean_inference_ms": 5.2112968403335, "mean_action_processing_ms": 0.14316205611699842, "mean_env_wait_ms": 0.2600302169271669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015156745910644531, "StateBufferConnector_ms": 0.0023005008697509766, "ViewRequirementAgentConnector_ms": 0.059926509857177734}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1156248.1747956574, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1193038.1440586878, -1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15250064348179737, "mean_inference_ms": 5.2112968403335, "mean_action_processing_ms": 0.14316205611699842, "mean_env_wait_ms": 0.2600302169271669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015156745910644531, "StateBufferConnector_ms": 0.0023005008697509766, "ViewRequirementAgentConnector_ms": 0.059926509857177734}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37632, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 1969.388, "learn_time_ms": 18.871, "learn_throughput": 17804.943, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "done": false, "episodes_total": 112, "training_iteration": 112, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-08", "timestamp": 1706266328, "time_this_iter_s": 1.9590966701507568, "time_total_s": 219.9326491355896, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f197e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92751000>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 219.9326491355896, "timesteps_since_restore": 0, "iterations_since_restore": 112, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 18.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0161258254896412e+26, "policy_entropy": 414.7649230957031, "var_gnorm": 22.782094955444336, "vf_loss": 9598028218368.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5762786865234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 113, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1154960.5539542658, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1525159803903519, "mean_inference_ms": 5.211570493023411, "mean_action_processing_ms": 0.14316182616470505, "mean_env_wait_ms": 0.26003010070063687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01516270637512207, "StateBufferConnector_ms": 0.0023021697998046875, "ViewRequirementAgentConnector_ms": 0.05995011329650879}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1154960.5539542658, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1146544.68260211, -1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1525159803903519, "mean_inference_ms": 5.211570493023411, "mean_action_processing_ms": 0.14316182616470505, "mean_env_wait_ms": 0.26003010070063687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01516270637512207, "StateBufferConnector_ms": 0.0023021697998046875, "ViewRequirementAgentConnector_ms": 0.05995011329650879}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37968, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37968, "timers": {"training_iteration_time_ms": 1968.659, "learn_time_ms": 18.917, "learn_throughput": 17761.678, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "done": false, "episodes_total": 113, "training_iteration": 113, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-10", "timestamp": 1706266330, "time_this_iter_s": 1.962036371231079, "time_total_s": 221.89468550682068, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a61056c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92751b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 221.89468550682068, "timesteps_since_restore": 0, "iterations_since_restore": 113, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 18.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.814830526938745e+26, "policy_entropy": 414.2382507324219, "var_gnorm": 22.782121658325195, "vf_loss": 9001145204736.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 114, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1153887.197818119, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.152531397488866, "mean_inference_ms": 5.211828467993849, "mean_action_processing_ms": 0.14316153809160254, "mean_env_wait_ms": 0.2600307318595154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01517033576965332, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.05997514724731445}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1153887.197818119, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1182208.5954378846, -1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.152531397488866, "mean_inference_ms": 5.211828467993849, "mean_action_processing_ms": 0.14316153809160254, "mean_env_wait_ms": 0.2600307318595154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01517033576965332, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.05997514724731445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38304, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38304, "timers": {"training_iteration_time_ms": 1967.445, "learn_time_ms": 18.965, "learn_throughput": 17716.73, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "done": false, "episodes_total": 114, "training_iteration": 114, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-12", "timestamp": 1706266332, "time_this_iter_s": 1.957015037536621, "time_total_s": 223.8517005443573, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19ba0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9272ff40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 223.8517005443573, "timesteps_since_restore": 0, "iterations_since_restore": 114, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 18.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2407042100978494e+26, "policy_entropy": 413.5293884277344, "var_gnorm": 22.78214454650879, "vf_loss": 10026642046976.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.172325134277344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 115, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1153047.4729454934, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15254656727592356, "mean_inference_ms": 5.212073588454107, "mean_action_processing_ms": 0.143161042853101, "mean_env_wait_ms": 0.260031211572062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015165090560913086, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.05996370315551758}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1153047.4729454934, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1208373.6073461939, -1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15254656727592356, "mean_inference_ms": 5.212073588454107, "mean_action_processing_ms": 0.143161042853101, "mean_env_wait_ms": 0.260031211572062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015165090560913086, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.05996370315551758}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38640, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38640, "timers": {"training_iteration_time_ms": 1969.682, "learn_time_ms": 18.906, "learn_throughput": 17771.982, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "done": false, "episodes_total": 115, "training_iteration": 115, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-14", "timestamp": 1706266334, "time_this_iter_s": 1.9902191162109375, "time_total_s": 225.84191966056824, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1db0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92750ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 225.84191966056824, "timesteps_since_restore": 0, "iterations_since_restore": 115, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 18.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5801508643655712e+26, "policy_entropy": 417.8165588378906, "var_gnorm": 22.782167434692383, "vf_loss": 11981411057664.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7789344787597656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 116, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1152674.256466825, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15256175610906061, "mean_inference_ms": 5.21230922763712, "mean_action_processing_ms": 0.14316025088404274, "mean_env_wait_ms": 0.26003251719706194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015133380889892578, "StateBufferConnector_ms": 0.0023016929626464844, "ViewRequirementAgentConnector_ms": 0.05997896194458008}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1152674.256466825, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1146254.4237890996, -1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15256175610906061, "mean_inference_ms": 5.21230922763712, "mean_action_processing_ms": 0.14316025088404274, "mean_env_wait_ms": 0.26003251719706194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015133380889892578, "StateBufferConnector_ms": 0.0023016929626464844, "ViewRequirementAgentConnector_ms": 0.05997896194458008}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38976, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38976, "timers": {"training_iteration_time_ms": 1970.341, "learn_time_ms": 18.885, "learn_throughput": 17792.197, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "done": false, "episodes_total": 116, "training_iteration": 116, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-16", "timestamp": 1706266336, "time_this_iter_s": 1.968923568725586, "time_total_s": 227.81084322929382, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105e70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92752290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 227.81084322929382, "timesteps_since_restore": 0, "iterations_since_restore": 116, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 18.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.180604810139424e+26, "policy_entropy": 412.52496337890625, "var_gnorm": 22.782188415527344, "vf_loss": 9909693317120.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.62396240234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 117, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1151988.6314089021, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15257600779569713, "mean_inference_ms": 5.212523360629765, "mean_action_processing_ms": 0.14315918589248494, "mean_env_wait_ms": 0.26003260324817995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015140295028686523, "StateBufferConnector_ms": 0.002301931381225586, "ViewRequirementAgentConnector_ms": 0.05998373031616211}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1151988.6314089021, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1179020.2468482093, -1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15257600779569713, "mean_inference_ms": 5.212523360629765, "mean_action_processing_ms": 0.14315918589248494, "mean_env_wait_ms": 0.26003260324817995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015140295028686523, "StateBufferConnector_ms": 0.002301931381225586, "ViewRequirementAgentConnector_ms": 0.05998373031616211}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39312, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39312, "timers": {"training_iteration_time_ms": 1969.684, "learn_time_ms": 18.874, "learn_throughput": 17801.996, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "done": false, "episodes_total": 117, "training_iteration": 117, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-18", "timestamp": 1706266338, "time_this_iter_s": 1.9803118705749512, "time_total_s": 229.79115509986877, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d24a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe928be7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 229.79115509986877, "timesteps_since_restore": 0, "iterations_since_restore": 117, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 18.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.9645731041393695e+26, "policy_entropy": 415.57769775390625, "var_gnorm": 22.782203674316406, "vf_loss": 10528515686400.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.838539123535156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 118, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1151413.92414881, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15259024333795196, "mean_inference_ms": 5.212732756633812, "mean_action_processing_ms": 0.14315805251110172, "mean_env_wait_ms": 0.26003244086937277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015155553817749023, "StateBufferConnector_ms": 0.002302408218383789, "ViewRequirementAgentConnector_ms": 0.059969186782836914}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1151413.92414881, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1141608.5369541247, -1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15259024333795196, "mean_inference_ms": 5.212732756633812, "mean_action_processing_ms": 0.14315805251110172, "mean_env_wait_ms": 0.26003244086937277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015155553817749023, "StateBufferConnector_ms": 0.002302408218383789, "ViewRequirementAgentConnector_ms": 0.059969186782836914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39648, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39648, "timers": {"training_iteration_time_ms": 1968.145, "learn_time_ms": 18.89, "learn_throughput": 17786.785, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "done": false, "episodes_total": 118, "training_iteration": 118, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-20", "timestamp": 1706266340, "time_this_iter_s": 1.9605612754821777, "time_total_s": 231.75171637535095, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19930>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92751630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 231.75171637535095, "timesteps_since_restore": 0, "iterations_since_restore": 118, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 18.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.206540178336505e+26, "policy_entropy": 414.65240478515625, "var_gnorm": 22.7822208404541, "vf_loss": 9854516199424.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.898143768310547e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 119, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "sampler_results": {"episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1150548.0312529013, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15260371419002713, "mean_inference_ms": 5.212947972827736, "mean_action_processing_ms": 0.14315644069645794, "mean_env_wait_ms": 0.26003171652784807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015147924423217773, "StateBufferConnector_ms": 0.002302885055541992, "ViewRequirementAgentConnector_ms": 0.05999159812927246}}, "episode_reward_max": -1012581.3304063771, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1150548.0312529013, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1206145.546197651, -1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15260371419002713, "mean_inference_ms": 5.212947972827736, "mean_action_processing_ms": 0.14315644069645794, "mean_env_wait_ms": 0.26003171652784807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015147924423217773, "StateBufferConnector_ms": 0.002302885055541992, "ViewRequirementAgentConnector_ms": 0.05999159812927246}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39984, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39984, "timers": {"training_iteration_time_ms": 1969.173, "learn_time_ms": 18.87, "learn_throughput": 17805.865, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "done": false, "episodes_total": 119, "training_iteration": 119, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-22", "timestamp": 1706266342, "time_this_iter_s": 1.9763646125793457, "time_total_s": 233.7280809879303, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105510>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92752b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 233.7280809879303, "timesteps_since_restore": 0, "iterations_since_restore": 119, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 18.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.6626443603059618e+26, "policy_entropy": 414.0337219238281, "var_gnorm": 22.78223419189453, "vf_loss": 8624641409024.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.0531158447265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 120, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1148475.1809231956, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526171325288292, "mean_inference_ms": 5.213162819173027, "mean_action_processing_ms": 0.14315440468031831, "mean_env_wait_ms": 0.26003026532451223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015154123306274414, "StateBufferConnector_ms": 0.002302408218383789, "ViewRequirementAgentConnector_ms": 0.06001114845275879}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1148475.1809231956, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1215968.8077664732, -1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526171325288292, "mean_inference_ms": 5.213162819173027, "mean_action_processing_ms": 0.14315440468031831, "mean_env_wait_ms": 0.26003026532451223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015154123306274414, "StateBufferConnector_ms": 0.002302408218383789, "ViewRequirementAgentConnector_ms": 0.06001114845275879}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40320, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 1966.872, "learn_time_ms": 18.885, "learn_throughput": 17792.13, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "done": false, "episodes_total": 120, "training_iteration": 120, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-24", "timestamp": 1706266344, "time_this_iter_s": 1.9535744190216064, "time_total_s": 235.6816554069519, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1ad10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927516c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 235.6816554069519, "timesteps_since_restore": 0, "iterations_since_restore": 120, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 18.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2483734439464941e+26, "policy_entropy": 413.6134033203125, "var_gnorm": 22.782249450683594, "vf_loss": 10127085142016.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.124641418457031e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 121, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1147409.6608125502, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526305206740307, "mean_inference_ms": 5.213366933069973, "mean_action_processing_ms": 0.14315206045977422, "mean_env_wait_ms": 0.2600291776541267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015126705169677734, "StateBufferConnector_ms": 0.0023016929626464844, "ViewRequirementAgentConnector_ms": 0.060013771057128906}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1147409.6608125502, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1308563.9508504586, -1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526305206740307, "mean_inference_ms": 5.213366933069973, "mean_action_processing_ms": 0.14315206045977422, "mean_env_wait_ms": 0.2600291776541267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015126705169677734, "StateBufferConnector_ms": 0.0023016929626464844, "ViewRequirementAgentConnector_ms": 0.060013771057128906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40656, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40656, "timers": {"training_iteration_time_ms": 1964.382, "learn_time_ms": 18.838, "learn_throughput": 17835.837, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "done": false, "episodes_total": 121, "training_iteration": 121, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-26", "timestamp": 1706266346, "time_this_iter_s": 1.9407131671905518, "time_total_s": 237.62236857414246, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2e60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92750ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 237.62236857414246, "timesteps_since_restore": 0, "iterations_since_restore": 121, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 19.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1581528167587103e+26, "policy_entropy": 413.6261291503906, "var_gnorm": 22.78226089477539, "vf_loss": 10030595178496.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.647804260253906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 122, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1145104.7821313029, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526429075773235, "mean_inference_ms": 5.213558212731096, "mean_action_processing_ms": 0.14314939553071795, "mean_env_wait_ms": 0.26002777062128946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015060663223266602, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.060034751892089844}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1145104.7821313029, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1385975.3458796872, -1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526429075773235, "mean_inference_ms": 5.213558212731096, "mean_action_processing_ms": 0.14314939553071795, "mean_env_wait_ms": 0.26002777062128946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015060663223266602, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.060034751892089844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40992, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40992, "timers": {"training_iteration_time_ms": 1964.792, "learn_time_ms": 18.876, "learn_throughput": 17800.22, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "done": false, "episodes_total": 122, "training_iteration": 122, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-28", "timestamp": 1706266348, "time_this_iter_s": 1.9632294178009033, "time_total_s": 239.58559799194336, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104220>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92753370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 239.58559799194336, "timesteps_since_restore": 0, "iterations_since_restore": 122, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 19.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9204632243326723e+26, "policy_entropy": 414.7909851074219, "var_gnorm": 22.782270431518555, "vf_loss": 10687232344064.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.409385681152344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 123, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1142318.3221961395, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15265447386638475, "mean_inference_ms": 5.213731411936123, "mean_action_processing_ms": 0.14314649747264335, "mean_env_wait_ms": 0.2600254845438835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015041589736938477, "StateBufferConnector_ms": 0.002297639846801758, "ViewRequirementAgentConnector_ms": 0.06003761291503906}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1142318.3221961395, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352650.8880959149, -1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15265447386638475, "mean_inference_ms": 5.213731411936123, "mean_action_processing_ms": 0.14314649747264335, "mean_env_wait_ms": 0.2600254845438835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015041589736938477, "StateBufferConnector_ms": 0.002297639846801758, "ViewRequirementAgentConnector_ms": 0.06003761291503906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41328, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41328, "timers": {"training_iteration_time_ms": 1963.715, "learn_time_ms": 18.87, "learn_throughput": 17806.36, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "done": false, "episodes_total": 123, "training_iteration": 123, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-30", "timestamp": 1706266350, "time_this_iter_s": 1.951225757598877, "time_total_s": 241.53682374954224, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1180>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927531c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 241.53682374954224, "timesteps_since_restore": 0, "iterations_since_restore": 123, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.641037479127342e+26, "policy_entropy": 415.639404296875, "var_gnorm": 22.78227996826172, "vf_loss": 11041150861312.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.1828880310058594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 124, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1139932.7920432652, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526656325306894, "mean_inference_ms": 5.213904840156413, "mean_action_processing_ms": 0.14314354626252823, "mean_env_wait_ms": 0.2600237729284093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015038251876831055, "StateBufferConnector_ms": 0.0022971630096435547, "ViewRequirementAgentConnector_ms": 0.060027360916137695}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1139932.7920432652, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1398183.0618854903, -1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526656325306894, "mean_inference_ms": 5.213904840156413, "mean_action_processing_ms": 0.14314354626252823, "mean_env_wait_ms": 0.2600237729284093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015038251876831055, "StateBufferConnector_ms": 0.0022971630096435547, "ViewRequirementAgentConnector_ms": 0.060027360916137695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41664, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41664, "timers": {"training_iteration_time_ms": 1962.143, "learn_time_ms": 18.881, "learn_throughput": 17795.365, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "done": false, "episodes_total": 124, "training_iteration": 124, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-31", "timestamp": 1706266351, "time_this_iter_s": 1.9412906169891357, "time_total_s": 243.47811436653137, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1ae00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92751240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 243.47811436653137, "timesteps_since_restore": 0, "iterations_since_restore": 124, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 19.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.4977435654752907e+26, "policy_entropy": 413.9955749511719, "var_gnorm": 22.782289505004883, "vf_loss": 10322478891008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.361701965332031e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 125, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1136807.6081410716, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15267596044247134, "mean_inference_ms": 5.214055837534726, "mean_action_processing_ms": 0.14314010782581055, "mean_env_wait_ms": 0.26002113292641565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015042304992675781, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.060042619705200195}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1136807.6081410716, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1452446.2199260844, -1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15267596044247134, "mean_inference_ms": 5.214055837534726, "mean_action_processing_ms": 0.14314010782581055, "mean_env_wait_ms": 0.26002113292641565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015042304992675781, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.060042619705200195}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42000, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 1959.874, "learn_time_ms": 18.897, "learn_throughput": 17780.435, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 125, "training_iteration": 125, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-33", "timestamp": 1706266353, "time_this_iter_s": 1.9675168991088867, "time_total_s": 245.44563126564026, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104d30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92753be0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 245.44563126564026, "timesteps_since_restore": 0, "iterations_since_restore": 125, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.699999999999999, "ram_util_percent": 19.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.576148684148982e+26, "policy_entropy": 414.5801696777344, "var_gnorm": 22.782299041748047, "vf_loss": 8857228148736.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.184246063232422e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 126, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1132527.101798192, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15268568592161194, "mean_inference_ms": 5.21419587734995, "mean_action_processing_ms": 0.1431366193295419, "mean_env_wait_ms": 0.2600189067338305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503443717956543, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.060033321380615234}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1132527.101798192, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1402215.4874301464, -1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15268568592161194, "mean_inference_ms": 5.21419587734995, "mean_action_processing_ms": 0.1431366193295419, "mean_env_wait_ms": 0.2600189067338305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503443717956543, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.060033321380615234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42336, "timers": {"training_iteration_time_ms": 1959.424, "learn_time_ms": 18.89, "learn_throughput": 17787.055, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "done": false, "episodes_total": 126, "training_iteration": 126, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-35", "timestamp": 1706266355, "time_this_iter_s": 1.9644107818603516, "time_total_s": 247.4100420475006, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18d60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92752560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 247.4100420475006, "timesteps_since_restore": 0, "iterations_since_restore": 126, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 19.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7934745468571706e+26, "policy_entropy": 414.6754455566406, "var_gnorm": 22.782306671142578, "vf_loss": 10366109089792.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.361701965332031e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 127, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1129475.5981398218, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15269497221355383, "mean_inference_ms": 5.214326517697538, "mean_action_processing_ms": 0.14313326348560707, "mean_env_wait_ms": 0.2600167405039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015032768249511719, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.06003117561340332}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1129475.5981398218, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1398010.6163614304, -1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15269497221355383, "mean_inference_ms": 5.214326517697538, "mean_action_processing_ms": 0.14313326348560707, "mean_env_wait_ms": 0.2600167405039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015032768249511719, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.06003117561340332}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42672, "timers": {"training_iteration_time_ms": 1959.953, "learn_time_ms": 18.884, "learn_throughput": 17793.231, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "done": false, "episodes_total": 127, "training_iteration": 127, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-37", "timestamp": 1706266357, "time_this_iter_s": 1.9855964183807373, "time_total_s": 249.39563846588135, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d14e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927516c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 249.39563846588135, "timesteps_since_restore": 0, "iterations_since_restore": 127, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.55, "ram_util_percent": 19.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4049139898955193e+26, "policy_entropy": 413.4813537597656, "var_gnorm": 22.782312393188477, "vf_loss": 10451759923200.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.719329833984375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 128, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1126776.9359015233, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15270419589009135, "mean_inference_ms": 5.214455075854919, "mean_action_processing_ms": 0.14313040242797484, "mean_env_wait_ms": 0.26001578510743173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015037775039672852, "StateBufferConnector_ms": 0.0022966861724853516, "ViewRequirementAgentConnector_ms": 0.05997204780578613}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1126776.9359015233, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1415895.9496369886, -1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15270419589009135, "mean_inference_ms": 5.214455075854919, "mean_action_processing_ms": 0.14313040242797484, "mean_env_wait_ms": 0.26001578510743173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015037775039672852, "StateBufferConnector_ms": 0.0022966861724853516, "ViewRequirementAgentConnector_ms": 0.05997204780578613}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1961.443, "learn_time_ms": 18.901, "learn_throughput": 17777.093, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 128, "training_iteration": 128, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-40", "timestamp": 1706266360, "time_this_iter_s": 1.975456953048706, "time_total_s": 251.37109541893005, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104220>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271c4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 251.37109541893005, "timesteps_since_restore": 0, "iterations_since_restore": 128, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 19.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2950229538658963e+26, "policy_entropy": 414.4365539550781, "var_gnorm": 22.782318115234375, "vf_loss": 11082073636864.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.039836883544922e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 129, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1123969.4663571427, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527132468436536, "mean_inference_ms": 5.214586480680842, "mean_action_processing_ms": 0.14312819448843314, "mean_env_wait_ms": 0.26001603411859564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015049934387207031, "StateBufferConnector_ms": 0.002294778823852539, "ViewRequirementAgentConnector_ms": 0.05996394157409668}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1123969.4663571427, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1437883.3520107234, -1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527132468436536, "mean_inference_ms": 5.214586480680842, "mean_action_processing_ms": 0.14312819448843314, "mean_env_wait_ms": 0.26001603411859564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015049934387207031, "StateBufferConnector_ms": 0.002294778823852539, "ViewRequirementAgentConnector_ms": 0.05996394157409668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43344, "timers": {"training_iteration_time_ms": 1961.632, "learn_time_ms": 18.934, "learn_throughput": 17745.665, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "done": false, "episodes_total": 129, "training_iteration": 129, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-42", "timestamp": 1706266362, "time_this_iter_s": 1.9782390594482422, "time_total_s": 253.3493344783783, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d39d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92753490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 253.3493344783783, "timesteps_since_restore": 0, "iterations_since_restore": 129, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 19.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.123263223797661e+26, "policy_entropy": 413.24713134765625, "var_gnorm": 22.782323837280273, "vf_loss": 10123297685504.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5881996154785156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 130, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1120328.1620514279, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15272231401379902, "mean_inference_ms": 5.214715778909964, "mean_action_processing_ms": 0.14312626194492234, "mean_env_wait_ms": 0.2600167447062076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015042543411254883, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.05998849868774414}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1120328.1620514279, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1390041.428743123, -1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15272231401379902, "mean_inference_ms": 5.214715778909964, "mean_action_processing_ms": 0.14312626194492234, "mean_env_wait_ms": 0.2600167447062076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015042543411254883, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.05998849868774414}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43680, "timers": {"training_iteration_time_ms": 1962.623, "learn_time_ms": 18.93, "learn_throughput": 17749.285, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "done": false, "episodes_total": 130, "training_iteration": 130, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-44", "timestamp": 1706266364, "time_this_iter_s": 1.9634969234466553, "time_total_s": 255.31283140182495, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f190f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92753eb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 255.31283140182495, "timesteps_since_restore": 0, "iterations_since_restore": 130, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 19.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3172628096897624e+26, "policy_entropy": 412.6854248046875, "var_gnorm": 22.782329559326172, "vf_loss": 10707844202496.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 131, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1117556.9403009173, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527309730455996, "mean_inference_ms": 5.214835516259639, "mean_action_processing_ms": 0.1431248124701537, "mean_env_wait_ms": 0.26001778348863935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015065431594848633, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.059978485107421875}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1458073.9755844628, "episode_reward_mean": -1117556.9403009173, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1458073.9755844628, -1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527309730455996, "mean_inference_ms": 5.214835516259639, "mean_action_processing_ms": 0.1431248124701537, "mean_env_wait_ms": 0.26001778348863935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015065431594848633, "StateBufferConnector_ms": 0.0022974014282226562, "ViewRequirementAgentConnector_ms": 0.059978485107421875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44016, "timers": {"training_iteration_time_ms": 1963.625, "learn_time_ms": 18.911, "learn_throughput": 17767.254, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "done": false, "episodes_total": 131, "training_iteration": 131, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-45", "timestamp": 1706266365, "time_this_iter_s": 1.95074462890625, "time_total_s": 257.2635760307312, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271cd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 257.2635760307312, "timesteps_since_restore": 0, "iterations_since_restore": 131, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 19.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7830113691511218e+26, "policy_entropy": 414.2430419921875, "var_gnorm": 22.782333374023438, "vf_loss": 9882964066304.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3974647521972656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 132, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1378445.4375645444, "episode_reward_mean": -1113675.9762714026, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15273853197348813, "mean_inference_ms": 5.214927036063058, "mean_action_processing_ms": 0.14312283948562984, "mean_env_wait_ms": 0.2600174820488056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015084028244018555, "StateBufferConnector_ms": 0.002295255661010742, "ViewRequirementAgentConnector_ms": 0.05988311767578125}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1378445.4375645444, "episode_reward_mean": -1113675.9762714026, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1378445.4375645444, -1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15273853197348813, "mean_inference_ms": 5.214927036063058, "mean_action_processing_ms": 0.14312283948562984, "mean_env_wait_ms": 0.2600174820488056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015084028244018555, "StateBufferConnector_ms": 0.002295255661010742, "ViewRequirementAgentConnector_ms": 0.05988311767578125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44352, "timers": {"training_iteration_time_ms": 1962.305, "learn_time_ms": 18.883, "learn_throughput": 17794.129, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "done": false, "episodes_total": 132, "training_iteration": 132, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-47", "timestamp": 1706266367, "time_this_iter_s": 1.9500179290771484, "time_total_s": 259.21359395980835, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19750>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92753d00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 259.21359395980835, "timesteps_since_restore": 0, "iterations_since_restore": 132, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 20.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7685022670673863e+26, "policy_entropy": 414.2275390625, "var_gnorm": 22.782337188720703, "vf_loss": 9422382301184.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.1604042053222656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 133, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1110280.4592969983, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15274565261029463, "mean_inference_ms": 5.215011064702274, "mean_action_processing_ms": 0.1431207908871176, "mean_env_wait_ms": 0.2600168293435643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015087366104125977, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.059874773025512695}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1110280.4592969983, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1215633.9737473163, -1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15274565261029463, "mean_inference_ms": 5.215011064702274, "mean_action_processing_ms": 0.1431207908871176, "mean_env_wait_ms": 0.2600168293435643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015087366104125977, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.059874773025512695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44688, "timers": {"training_iteration_time_ms": 1963.843, "learn_time_ms": 18.856, "learn_throughput": 17818.833, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "done": false, "episodes_total": 133, "training_iteration": 133, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-49", "timestamp": 1706266369, "time_this_iter_s": 1.9666106700897217, "time_total_s": 261.18020462989807, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0400>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 261.18020462989807, "timesteps_since_restore": 0, "iterations_since_restore": 133, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 20.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4658868431858348e+26, "policy_entropy": 412.8257751464844, "var_gnorm": 22.78234100341797, "vf_loss": 9260379406336.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.695487976074219e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 134, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1108403.3696541484, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527525640796227, "mean_inference_ms": 5.215095491331534, "mean_action_processing_ms": 0.14311879618356416, "mean_env_wait_ms": 0.2600165068919932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015085458755493164, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.05987215042114258}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1108403.3696541484, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1302164.344269306, -1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527525640796227, "mean_inference_ms": 5.215095491331534, "mean_action_processing_ms": 0.14311879618356416, "mean_env_wait_ms": 0.2600165068919932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015085458755493164, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.05987215042114258}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45024, "timers": {"training_iteration_time_ms": 1964.722, "learn_time_ms": 18.806, "learn_throughput": 17866.883, "synch_weights_time_ms": 0.141}, "counters": {"num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "done": false, "episodes_total": 134, "training_iteration": 134, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-51", "timestamp": 1706266371, "time_this_iter_s": 1.950073003768921, "time_total_s": 263.130277633667, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271d480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 263.130277633667, "timesteps_since_restore": 0, "iterations_since_restore": 134, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 20.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.503752382512218e+26, "policy_entropy": 413.29547119140625, "var_gnorm": 22.7823429107666, "vf_loss": 10782810046464.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.731250762939453e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 135, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1106654.7234315139, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15275884351329633, "mean_inference_ms": 5.215180689070127, "mean_action_processing_ms": 0.14311657105327844, "mean_env_wait_ms": 0.2600160088008419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082836151123047, "StateBufferConnector_ms": 0.002292156219482422, "ViewRequirementAgentConnector_ms": 0.05992269515991211}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1106654.7234315139, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1213390.5780853855, -1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15275884351329633, "mean_inference_ms": 5.215180689070127, "mean_action_processing_ms": 0.14311657105327844, "mean_env_wait_ms": 0.2600160088008419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082836151123047, "StateBufferConnector_ms": 0.002292156219482422, "ViewRequirementAgentConnector_ms": 0.05992269515991211}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45360, "timers": {"training_iteration_time_ms": 1965.124, "learn_time_ms": 18.8, "learn_throughput": 17872.571, "synch_weights_time_ms": 0.141}, "counters": {"num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "done": false, "episodes_total": 135, "training_iteration": 135, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-53", "timestamp": 1706266373, "time_this_iter_s": 1.971541404724121, "time_total_s": 265.1018190383911, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d04f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92751510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 265.1018190383911, "timesteps_since_restore": 0, "iterations_since_restore": 135, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 20.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.70936935206312e+25, "policy_entropy": 413.83892822265625, "var_gnorm": 22.782346725463867, "vf_loss": 11347272138752.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.254413604736328e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 136, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1105893.4293035923, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527649767382795, "mean_inference_ms": 5.215274159658399, "mean_action_processing_ms": 0.1431144927455513, "mean_env_wait_ms": 0.26001596834109897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015106678009033203, "StateBufferConnector_ms": 0.0022923946380615234, "ViewRequirementAgentConnector_ms": 0.05993938446044922}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1105893.4293035923, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1255491.5707561683, -1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527649767382795, "mean_inference_ms": 5.215274159658399, "mean_action_processing_ms": 0.1431144927455513, "mean_env_wait_ms": 0.26001596834109897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015106678009033203, "StateBufferConnector_ms": 0.0022923946380615234, "ViewRequirementAgentConnector_ms": 0.05993938446044922}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1966.22, "learn_time_ms": 18.883, "learn_throughput": 17793.321, "synch_weights_time_ms": 0.141}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "done": false, "episodes_total": 136, "training_iteration": 136, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-55", "timestamp": 1706266375, "time_this_iter_s": 1.9753820896148682, "time_total_s": 267.077201128006, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19cf0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271d1b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 267.077201128006, "timesteps_since_restore": 0, "iterations_since_restore": 136, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 20.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.8116837222448537e+26, "policy_entropy": 415.1478271484375, "var_gnorm": 22.782350540161133, "vf_loss": 11246174732288.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5643577575683594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 137, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1104721.8872176684, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15277073122492074, "mean_inference_ms": 5.215367065371273, "mean_action_processing_ms": 0.14311281805526493, "mean_env_wait_ms": 0.26001589039463696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015095710754394531, "StateBufferConnector_ms": 0.002289295196533203, "ViewRequirementAgentConnector_ms": 0.0599210262298584}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1104721.8872176684, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1203681.6033473278, -1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15277073122492074, "mean_inference_ms": 5.215367065371273, "mean_action_processing_ms": 0.14311281805526493, "mean_env_wait_ms": 0.26001589039463696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015095710754394531, "StateBufferConnector_ms": 0.002289295196533203, "ViewRequirementAgentConnector_ms": 0.0599210262298584}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46032, "timers": {"training_iteration_time_ms": 1962.636, "learn_time_ms": 18.887, "learn_throughput": 17789.682, "synch_weights_time_ms": 0.14}, "counters": {"num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "done": false, "episodes_total": 137, "training_iteration": 137, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-57", "timestamp": 1706266377, "time_this_iter_s": 1.9497299194335938, "time_total_s": 269.0269310474396, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271dcf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 269.0269310474396, "timesteps_since_restore": 0, "iterations_since_restore": 137, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 20.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.049206002702143e+26, "policy_entropy": 411.51934814453125, "var_gnorm": 22.782350540161133, "vf_loss": 10429048815616.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.802776336669922e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 138, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1103746.7070233435, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527762560239379, "mean_inference_ms": 5.215475506484264, "mean_action_processing_ms": 0.1431114221279299, "mean_env_wait_ms": 0.2600156532648663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015106201171875, "StateBufferConnector_ms": 0.0022897720336914062, "ViewRequirementAgentConnector_ms": 0.059934377670288086}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1103746.7070233435, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1225313.419494171, -1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527762560239379, "mean_inference_ms": 5.215475506484264, "mean_action_processing_ms": 0.1431114221279299, "mean_env_wait_ms": 0.2600156532648663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015106201171875, "StateBufferConnector_ms": 0.0022897720336914062, "ViewRequirementAgentConnector_ms": 0.059934377670288086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46368, "timers": {"training_iteration_time_ms": 1962.254, "learn_time_ms": 18.901, "learn_throughput": 17777.205, "synch_weights_time_ms": 0.14}, "counters": {"num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "done": false, "episodes_total": 138, "training_iteration": 138, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-52-59", "timestamp": 1706266379, "time_this_iter_s": 1.9716672897338867, "time_total_s": 270.99859833717346, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1b610>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927531c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 270.99859833717346, "timesteps_since_restore": 0, "iterations_since_restore": 138, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 20.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.098503148420802e+26, "policy_entropy": 416.05438232421875, "var_gnorm": 22.782352447509766, "vf_loss": 10618833731584.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.600120544433594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 139, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1102720.724106961, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15278190765870775, "mean_inference_ms": 5.215595952532734, "mean_action_processing_ms": 0.14311012665598058, "mean_env_wait_ms": 0.2600156504381329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015104055404663086, "StateBufferConnector_ms": 0.0022895336151123047, "ViewRequirementAgentConnector_ms": 0.05993914604187012}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1102720.724106961, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1311298.4539674213, -1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15278190765870775, "mean_inference_ms": 5.215595952532734, "mean_action_processing_ms": 0.14311012665598058, "mean_env_wait_ms": 0.2600156504381329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015104055404663086, "StateBufferConnector_ms": 0.0022895336151123047, "ViewRequirementAgentConnector_ms": 0.05993914604187012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46704, "timers": {"training_iteration_time_ms": 1959.023, "learn_time_ms": 18.848, "learn_throughput": 17826.587, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "done": false, "episodes_total": 139, "training_iteration": 139, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-01", "timestamp": 1706266381, "time_this_iter_s": 1.9458963871002197, "time_total_s": 272.9444947242737, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3850>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 272.9444947242737, "timesteps_since_restore": 0, "iterations_since_restore": 139, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.699999999999999, "ram_util_percent": 20.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.84678099334259e+25, "policy_entropy": 414.19097900390625, "var_gnorm": 22.78235626220703, "vf_loss": 8935645904896.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.076957702636719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 140, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1099781.3225088047, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527871852542932, "mean_inference_ms": 5.215715287855646, "mean_action_processing_ms": 0.1431087698293384, "mean_env_wait_ms": 0.26001495642273303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015075445175170898, "StateBufferConnector_ms": 0.0022897720336914062, "ViewRequirementAgentConnector_ms": 0.05991768836975098}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1099781.3225088047, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1319874.677415904, -1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527871852542932, "mean_inference_ms": 5.215715287855646, "mean_action_processing_ms": 0.1431087698293384, "mean_env_wait_ms": 0.26001495642273303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015075445175170898, "StateBufferConnector_ms": 0.0022897720336914062, "ViewRequirementAgentConnector_ms": 0.05991768836975098}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47040, "timers": {"training_iteration_time_ms": 1958.434, "learn_time_ms": 18.847, "learn_throughput": 17827.376, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "done": false, "episodes_total": 140, "training_iteration": 140, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-03", "timestamp": 1706266383, "time_this_iter_s": 1.957597255706787, "time_total_s": 274.90209197998047, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104d30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271e560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 274.90209197998047, "timesteps_since_restore": 0, "iterations_since_restore": 140, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 20.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9642631734612883e+26, "policy_entropy": 410.3453674316406, "var_gnorm": 22.78235626220703, "vf_loss": 10800417734656.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.220008850097656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 141, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1097839.7833836593, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15279230671796187, "mean_inference_ms": 5.215834568310408, "mean_action_processing_ms": 0.14310726446034874, "mean_env_wait_ms": 0.26001386706977053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015083789825439453, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.05993223190307617}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1360449.3120977695, "episode_reward_mean": -1097839.7833836593, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360449.3120977695, -1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15279230671796187, "mean_inference_ms": 5.215834568310408, "mean_action_processing_ms": 0.14310726446034874, "mean_env_wait_ms": 0.26001386706977053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015083789825439453, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.05993223190307617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47376, "timers": {"training_iteration_time_ms": 1960.376, "learn_time_ms": 18.907, "learn_throughput": 17771.197, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "done": false, "episodes_total": 141, "training_iteration": 141, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-05", "timestamp": 1706266385, "time_this_iter_s": 1.9701406955718994, "time_total_s": 276.87223267555237, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d20b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92751630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 276.87223267555237, "timesteps_since_restore": 0, "iterations_since_restore": 141, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 20.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3853204117427472e+26, "policy_entropy": 412.9206848144531, "var_gnorm": 22.782358169555664, "vf_loss": 9449296101376.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5643577575683594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 142, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1333666.7282935327, "episode_reward_mean": -1094782.5035765728, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15279726284855275, "mean_inference_ms": 5.2159493276320905, "mean_action_processing_ms": 0.14310582954533033, "mean_env_wait_ms": 0.26001292383337044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015089988708496094, "StateBufferConnector_ms": 0.0022923946380615234, "ViewRequirementAgentConnector_ms": 0.059946537017822266}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1333666.7282935327, "episode_reward_mean": -1094782.5035765728, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1252429.9291949167, -1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15279726284855275, "mean_inference_ms": 5.2159493276320905, "mean_action_processing_ms": 0.14310582954533033, "mean_env_wait_ms": 0.26001292383337044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015089988708496094, "StateBufferConnector_ms": 0.0022923946380615234, "ViewRequirementAgentConnector_ms": 0.059946537017822266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47712, "timers": {"training_iteration_time_ms": 1962.082, "learn_time_ms": 18.958, "learn_throughput": 17723.214, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "done": false, "episodes_total": 142, "training_iteration": 142, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-07", "timestamp": 1706266387, "time_this_iter_s": 1.9670732021331787, "time_total_s": 278.83930587768555, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1a290>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271c1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 278.83930587768555, "timesteps_since_restore": 0, "iterations_since_restore": 142, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 20.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9907883001671975e+26, "policy_entropy": 413.2703857421875, "var_gnorm": 22.782360076904297, "vf_loss": 11015892762624.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4809112548828125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 143, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1333666.7282935327, "episode_reward_mean": -1093730.4606087045, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15280205881372155, "mean_inference_ms": 5.216062496675903, "mean_action_processing_ms": 0.14310465629531008, "mean_env_wait_ms": 0.2600122241862418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015080690383911133, "StateBufferConnector_ms": 0.002290487289428711, "ViewRequirementAgentConnector_ms": 0.059940338134765625}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1333666.7282935327, "episode_reward_mean": -1093730.4606087045, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1333666.7282935327, -1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15280205881372155, "mean_inference_ms": 5.216062496675903, "mean_action_processing_ms": 0.14310465629531008, "mean_env_wait_ms": 0.2600122241862418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015080690383911133, "StateBufferConnector_ms": 0.002290487289428711, "ViewRequirementAgentConnector_ms": 0.059940338134765625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48048, "timers": {"training_iteration_time_ms": 1962.187, "learn_time_ms": 18.969, "learn_throughput": 17713.434, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "done": false, "episodes_total": 143, "training_iteration": 143, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-09", "timestamp": 1706266389, "time_this_iter_s": 1.9676897525787354, "time_total_s": 280.8069956302643, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271edd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 280.8069956302643, "timesteps_since_restore": 0, "iterations_since_restore": 143, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 20.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.8665031775031386e+26, "policy_entropy": 413.7662353515625, "var_gnorm": 22.782360076904297, "vf_loss": 10238015045632.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6597251892089844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 144, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1255443.521851615, "episode_reward_mean": -1091139.9095656865, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528064049759819, "mean_inference_ms": 5.216165946155687, "mean_action_processing_ms": 0.143103284658747, "mean_env_wait_ms": 0.2600110646168745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015087604522705078, "StateBufferConnector_ms": 0.0022857189178466797, "ViewRequirementAgentConnector_ms": 0.059952497482299805}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1255443.521851615, "episode_reward_mean": -1091139.9095656865, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1255443.521851615, -1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528064049759819, "mean_inference_ms": 5.216165946155687, "mean_action_processing_ms": 0.143103284658747, "mean_env_wait_ms": 0.2600110646168745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015087604522705078, "StateBufferConnector_ms": 0.0022857189178466797, "ViewRequirementAgentConnector_ms": 0.059952497482299805}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 1962.566, "learn_time_ms": 19.002, "learn_throughput": 17681.92, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "done": false, "episodes_total": 144, "training_iteration": 144, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-11", "timestamp": 1706266391, "time_this_iter_s": 1.9538590908050537, "time_total_s": 282.76085472106934, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f185e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe929ab880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 282.76085472106934, "timesteps_since_restore": 0, "iterations_since_restore": 144, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 21.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.314994489703947e+26, "policy_entropy": 411.310791015625, "var_gnorm": 22.782363891601562, "vf_loss": 10888202420224.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3736228942871094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 145, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1228206.744600092, "episode_reward_mean": -1089797.8756559575, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15281054255714557, "mean_inference_ms": 5.216263908217697, "mean_action_processing_ms": 0.14310153668809347, "mean_env_wait_ms": 0.260009317015695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01506352424621582, "StateBufferConnector_ms": 0.0022852420806884766, "ViewRequirementAgentConnector_ms": 0.05993342399597168}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1228206.744600092, "episode_reward_mean": -1089797.8756559575, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1228206.744600092, -1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15281054255714557, "mean_inference_ms": 5.216263908217697, "mean_action_processing_ms": 0.14310153668809347, "mean_env_wait_ms": 0.260009317015695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01506352424621582, "StateBufferConnector_ms": 0.0022852420806884766, "ViewRequirementAgentConnector_ms": 0.05993342399597168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48720, "timers": {"training_iteration_time_ms": 1961.155, "learn_time_ms": 19.005, "learn_throughput": 17679.613, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "done": false, "episodes_total": 145, "training_iteration": 145, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-13", "timestamp": 1706266393, "time_this_iter_s": 1.9574530124664307, "time_total_s": 284.71830773353577, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3370>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271e200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 284.71830773353577, "timesteps_since_restore": 0, "iterations_since_restore": 145, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.550000000000001, "ram_util_percent": 21.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.537819848021247e+25, "policy_entropy": 411.4068603515625, "var_gnorm": 22.782363891601562, "vf_loss": 12504268800000.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.314018249511719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 146, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089582.4430641844, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528146370796175, "mean_inference_ms": 5.216366048402751, "mean_action_processing_ms": 0.14309995221601698, "mean_env_wait_ms": 0.2600080688025737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015055656433105469, "StateBufferConnector_ms": 0.002290010452270508, "ViewRequirementAgentConnector_ms": 0.05991411209106445}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089582.4430641844, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1127823.5073577596, -1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528146370796175, "mean_inference_ms": 5.216366048402751, "mean_action_processing_ms": 0.14309995221601698, "mean_env_wait_ms": 0.2600080688025737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015055656433105469, "StateBufferConnector_ms": 0.002290010452270508, "ViewRequirementAgentConnector_ms": 0.05991411209106445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49056, "timers": {"training_iteration_time_ms": 1959.755, "learn_time_ms": 18.936, "learn_throughput": 17744.324, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "done": false, "episodes_total": 146, "training_iteration": 146, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-15", "timestamp": 1706266395, "time_this_iter_s": 1.9613804817199707, "time_total_s": 286.67968821525574, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271f490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 286.67968821525574, "timesteps_since_restore": 0, "iterations_since_restore": 146, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 21.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.001427803368948e+26, "policy_entropy": 412.07421875, "var_gnorm": 22.782363891601562, "vf_loss": 9576541847552.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.600120544433594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 147, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089048.3376490357, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15281857198424023, "mean_inference_ms": 5.216458138117681, "mean_action_processing_ms": 0.14309844746557665, "mean_env_wait_ms": 0.2600069536071759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015040159225463867, "StateBufferConnector_ms": 0.002288341522216797, "ViewRequirementAgentConnector_ms": 0.05989813804626465}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089048.3376490357, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1131100.5836826472, -1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15281857198424023, "mean_inference_ms": 5.216458138117681, "mean_action_processing_ms": 0.14309844746557665, "mean_env_wait_ms": 0.2600069536071759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015040159225463867, "StateBufferConnector_ms": 0.002288341522216797, "ViewRequirementAgentConnector_ms": 0.05989813804626465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49392, "timers": {"training_iteration_time_ms": 1960.315, "learn_time_ms": 18.962, "learn_throughput": 17719.871, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "done": false, "episodes_total": 147, "training_iteration": 147, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-17", "timestamp": 1706266397, "time_this_iter_s": 1.9553637504577637, "time_total_s": 288.6350519657135, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271d360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 288.6350519657135, "timesteps_since_restore": 0, "iterations_since_restore": 147, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 21.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0216133375390454e+26, "policy_entropy": 412.26263427734375, "var_gnorm": 22.782365798950195, "vf_loss": 10952158216192.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3855438232421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 148, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089007.4224769494, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15282240350836246, "mean_inference_ms": 5.216547629323688, "mean_action_processing_ms": 0.1430970854081316, "mean_env_wait_ms": 0.2600059974428924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015030622482299805, "StateBufferConnector_ms": 0.002286195755004883, "ViewRequirementAgentConnector_ms": 0.05987906455993652}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089007.4224769494, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1023614.6210328755, -1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15282240350836246, "mean_inference_ms": 5.216547629323688, "mean_action_processing_ms": 0.1430970854081316, "mean_env_wait_ms": 0.2600059974428924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015030622482299805, "StateBufferConnector_ms": 0.002286195755004883, "ViewRequirementAgentConnector_ms": 0.05987906455993652}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49728, "timers": {"training_iteration_time_ms": 1959.351, "learn_time_ms": 18.911, "learn_throughput": 17767.478, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "done": false, "episodes_total": 148, "training_iteration": 148, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-19", "timestamp": 1706266399, "time_this_iter_s": 1.9619908332824707, "time_total_s": 290.597042798996, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1ad10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271de10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 290.597042798996, "timesteps_since_restore": 0, "iterations_since_restore": 148, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 21.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1816930758060525e+26, "policy_entropy": 412.99835205078125, "var_gnorm": 22.782365798950195, "vf_loss": 9400726061056.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.540515899658203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 149, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089227.8344000273, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15282625489703766, "mean_inference_ms": 5.216639791232651, "mean_action_processing_ms": 0.14309597995523324, "mean_env_wait_ms": 0.26000561680803264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015036582946777344, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.05987095832824707}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089227.8344000273, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1120649.733007432, -1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15282625489703766, "mean_inference_ms": 5.216639791232651, "mean_action_processing_ms": 0.14309597995523324, "mean_env_wait_ms": 0.26000561680803264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015036582946777344, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.05987095832824707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50064, "timers": {"training_iteration_time_ms": 1960.537, "learn_time_ms": 18.916, "learn_throughput": 17763.111, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "done": false, "episodes_total": 149, "training_iteration": 149, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-21", "timestamp": 1706266401, "time_this_iter_s": 1.9577958583831787, "time_total_s": 292.55483865737915, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104d30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271fb50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 292.55483865737915, "timesteps_since_restore": 0, "iterations_since_restore": 149, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 21.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1051529229582131e+26, "policy_entropy": 411.8125, "var_gnorm": 22.782365798950195, "vf_loss": 9172598915072.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.9696693420410156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 150, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088408.8678712347, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15283060625363462, "mean_inference_ms": 5.216742495910636, "mean_action_processing_ms": 0.14309550383879308, "mean_env_wait_ms": 0.26000614777967895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015041828155517578, "StateBufferConnector_ms": 0.0022881031036376953, "ViewRequirementAgentConnector_ms": 0.05988430976867676}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088408.8678712347, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1074602.7779597454, -1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15283060625363462, "mean_inference_ms": 5.216742495910636, "mean_action_processing_ms": 0.14309550383879308, "mean_env_wait_ms": 0.26000614777967895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015041828155517578, "StateBufferConnector_ms": 0.0022881031036376953, "ViewRequirementAgentConnector_ms": 0.05988430976867676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50400, "timers": {"training_iteration_time_ms": 1961.566, "learn_time_ms": 18.927, "learn_throughput": 17752.639, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "done": false, "episodes_total": 150, "training_iteration": 150, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-23", "timestamp": 1706266403, "time_this_iter_s": 1.9679067134857178, "time_total_s": 294.52274537086487, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1aec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271f910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 294.52274537086487, "timesteps_since_restore": 0, "iterations_since_restore": 150, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 21.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.8352300433400973e+26, "policy_entropy": 412.0036315917969, "var_gnorm": 22.782367706298828, "vf_loss": 10240506462208.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.421306610107422e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 151, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088509.522941488, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528348567598325, "mean_inference_ms": 5.216847367292757, "mean_action_processing_ms": 0.1430951648001195, "mean_env_wait_ms": 0.26000672088236504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015020132064819336, "StateBufferConnector_ms": 0.0022859573364257812, "ViewRequirementAgentConnector_ms": 0.05986618995666504}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088509.522941488, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1090973.4941424222, -1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528348567598325, "mean_inference_ms": 5.216847367292757, "mean_action_processing_ms": 0.1430951648001195, "mean_env_wait_ms": 0.26000672088236504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015020132064819336, "StateBufferConnector_ms": 0.0022859573364257812, "ViewRequirementAgentConnector_ms": 0.05986618995666504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50736, "timers": {"training_iteration_time_ms": 1960.87, "learn_time_ms": 19.528, "learn_throughput": 17206.414, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "done": false, "episodes_total": 151, "training_iteration": 151, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-25", "timestamp": 1706266405, "time_this_iter_s": 1.9632186889648438, "time_total_s": 296.4859640598297, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3b80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271c700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 296.4859640598297, "timesteps_since_restore": 0, "iterations_since_restore": 151, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 21.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.564497529300646e+25, "policy_entropy": 410.2425537109375, "var_gnorm": 22.78236961364746, "vf_loss": 8799291179008.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.1604042053222656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 152, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087744.9032145417, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15283902702917554, "mean_inference_ms": 5.216945865038908, "mean_action_processing_ms": 0.143094819858054, "mean_env_wait_ms": 0.2600073744771301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015020132064819336, "StateBufferConnector_ms": 0.002284526824951172, "ViewRequirementAgentConnector_ms": 0.0598602294921875}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087744.9032145417, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1165161.241912877, -1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15283902702917554, "mean_inference_ms": 5.216945865038908, "mean_action_processing_ms": 0.143094819858054, "mean_env_wait_ms": 0.2600073744771301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015020132064819336, "StateBufferConnector_ms": 0.002284526824951172, "ViewRequirementAgentConnector_ms": 0.0598602294921875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 1958.13, "learn_time_ms": 19.444, "learn_throughput": 17280.447, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "done": false, "episodes_total": 152, "training_iteration": 152, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-27", "timestamp": 1706266407, "time_this_iter_s": 1.9396681785583496, "time_total_s": 298.42563223838806, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a0310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 298.42563223838806, "timesteps_since_restore": 0, "iterations_since_restore": 152, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 21.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.842531467665615e+25, "policy_entropy": 412.7692565917969, "var_gnorm": 22.78236961364746, "vf_loss": 10730766073856.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.910064697265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 153, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087341.0070390045, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528430147338082, "mean_inference_ms": 5.21703773973257, "mean_action_processing_ms": 0.14309451532407377, "mean_env_wait_ms": 0.2600080107323115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014993906021118164, "StateBufferConnector_ms": 0.0022819042205810547, "ViewRequirementAgentConnector_ms": 0.05981755256652832}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087341.0070390045, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1117260.6088316021, -1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528430147338082, "mean_inference_ms": 5.21703773973257, "mean_action_processing_ms": 0.14309451532407377, "mean_env_wait_ms": 0.2600080107323115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014993906021118164, "StateBufferConnector_ms": 0.0022819042205810547, "ViewRequirementAgentConnector_ms": 0.05981755256652832}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51408, "timers": {"training_iteration_time_ms": 1955.459, "learn_time_ms": 19.396, "learn_throughput": 17323.249, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "done": false, "episodes_total": 153, "training_iteration": 153, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-29", "timestamp": 1706266409, "time_this_iter_s": 1.9409549236297607, "time_total_s": 300.3665871620178, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3af0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271fb50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 300.3665871620178, "timesteps_since_restore": 0, "iterations_since_restore": 153, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 21.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.01926851432061e+25, "policy_entropy": 412.3094787597656, "var_gnorm": 22.78236961364746, "vf_loss": 10053893488640.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.029273986816406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 154, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086998.1016683436, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15284673772194413, "mean_inference_ms": 5.217120674189463, "mean_action_processing_ms": 0.1430939087907218, "mean_env_wait_ms": 0.26000850746135046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014984846115112305, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.05976152420043945}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086998.1016683436, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1130601.2054155632, -1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15284673772194413, "mean_inference_ms": 5.217120674189463, "mean_action_processing_ms": 0.1430939087907218, "mean_env_wait_ms": 0.26000850746135046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014984846115112305, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.05976152420043945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51744, "timers": {"training_iteration_time_ms": 1952.231, "learn_time_ms": 19.351, "learn_throughput": 17363.567, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "done": false, "episodes_total": 154, "training_iteration": 154, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-31", "timestamp": 1706266411, "time_this_iter_s": 1.9215893745422363, "time_total_s": 302.28817653656006, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1ab00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92752ef0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 302.28817653656006, "timesteps_since_restore": 0, "iterations_since_restore": 154, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 21.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1291143211727582e+26, "policy_entropy": 412.58831787109375, "var_gnorm": 22.78236961364746, "vf_loss": 10009733758976.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.612041473388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 155, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086637.0437856484, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15284990186738287, "mean_inference_ms": 5.217195871627992, "mean_action_processing_ms": 0.14309319394885375, "mean_env_wait_ms": 0.2600087632683218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014991998672485352, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.05973649024963379}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086637.0437856484, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1107620.2067790572, -1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15284990186738287, "mean_inference_ms": 5.217195871627992, "mean_action_processing_ms": 0.14309319394885375, "mean_env_wait_ms": 0.2600087632683218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014991998672485352, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.05973649024963379}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52080, "timers": {"training_iteration_time_ms": 1953.024, "learn_time_ms": 19.364, "learn_throughput": 17351.595, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "done": false, "episodes_total": 155, "training_iteration": 155, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-33", "timestamp": 1706266413, "time_this_iter_s": 1.9653708934783936, "time_total_s": 304.25354743003845, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104ac0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a0a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 304.25354743003845, "timesteps_since_restore": 0, "iterations_since_restore": 155, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 21.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.070013561082406e+26, "policy_entropy": 415.09283447265625, "var_gnorm": 22.78236961364746, "vf_loss": 10147921395712.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3020973205566406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 156, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086552.619222646, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528527788993, "mean_inference_ms": 5.217265407962519, "mean_action_processing_ms": 0.14309223808752067, "mean_env_wait_ms": 0.26000827989341324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014969825744628906, "StateBufferConnector_ms": 0.00228118896484375, "ViewRequirementAgentConnector_ms": 0.05972743034362793}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086552.619222646, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1047184.8898369626, -1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528527788993, "mean_inference_ms": 5.217265407962519, "mean_action_processing_ms": 0.14309223808752067, "mean_env_wait_ms": 0.26000827989341324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014969825744628906, "StateBufferConnector_ms": 0.00228118896484375, "ViewRequirementAgentConnector_ms": 0.05972743034362793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52416, "timers": {"training_iteration_time_ms": 1951.499, "learn_time_ms": 19.331, "learn_throughput": 17381.256, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "done": false, "episodes_total": 156, "training_iteration": 156, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-35", "timestamp": 1706266415, "time_this_iter_s": 1.9461314678192139, "time_total_s": 306.19967889785767, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1aec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271fd90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 306.19967889785767, "timesteps_since_restore": 0, "iterations_since_restore": 156, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 22.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.1517905601053307e+26, "policy_entropy": 409.95953369140625, "var_gnorm": 22.78236961364746, "vf_loss": 10212755898368.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3020973205566406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 157, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087030.151743739, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15285560419977146, "mean_inference_ms": 5.217330624555915, "mean_action_processing_ms": 0.1430912218379562, "mean_env_wait_ms": 0.2600073445946863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01498270034790039, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.059729576110839844}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087030.151743739, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1087804.8754933127, -1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15285560419977146, "mean_inference_ms": 5.217330624555915, "mean_action_processing_ms": 0.1430912218379562, "mean_env_wait_ms": 0.2600073445946863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01498270034790039, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.059729576110839844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52752, "timers": {"training_iteration_time_ms": 1950.825, "learn_time_ms": 19.315, "learn_throughput": 17396.082, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "done": false, "episodes_total": 157, "training_iteration": 157, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-37", "timestamp": 1706266417, "time_this_iter_s": 1.9486258029937744, "time_total_s": 308.14830470085144, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1720>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a0ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 308.14830470085144, "timesteps_since_restore": 0, "iterations_since_restore": 157, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 22.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.977132747485455e+25, "policy_entropy": 406.914306640625, "var_gnorm": 22.78236961364746, "vf_loss": 9880430706688.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.790855407714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 158, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086945.6407793525, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15285830878284995, "mean_inference_ms": 5.217396527618717, "mean_action_processing_ms": 0.1430902798997881, "mean_env_wait_ms": 0.2600066362609983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014983654022216797, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.05974125862121582}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086945.6407793525, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1101936.2005904205, -1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15285830878284995, "mean_inference_ms": 5.217396527618717, "mean_action_processing_ms": 0.1430902798997881, "mean_env_wait_ms": 0.2600066362609983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014983654022216797, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.05974125862121582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53088, "timers": {"training_iteration_time_ms": 1952.531, "learn_time_ms": 19.341, "learn_throughput": 17372.428, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "done": false, "episodes_total": 158, "training_iteration": 158, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-39", "timestamp": 1706266419, "time_this_iter_s": 1.9790666103363037, "time_total_s": 310.12737131118774, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271ff40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 310.12737131118774, "timesteps_since_restore": 0, "iterations_since_restore": 158, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 22.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.719366246834271e+25, "policy_entropy": 414.3062438964844, "var_gnorm": 22.78236961364746, "vf_loss": 9699674030080.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 159, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086640.4169255774, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286076765597714, "mean_inference_ms": 5.217456527711082, "mean_action_processing_ms": 0.14308897739621193, "mean_env_wait_ms": 0.26000562954125245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014976739883422852, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.05971956253051758}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086640.4169255774, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1069785.4135681805, -1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286076765597714, "mean_inference_ms": 5.217456527711082, "mean_action_processing_ms": 0.14308897739621193, "mean_env_wait_ms": 0.26000562954125245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014976739883422852, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.05971956253051758}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53424, "timers": {"training_iteration_time_ms": 1952.211, "learn_time_ms": 19.335, "learn_throughput": 17378.063, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "done": false, "episodes_total": 159, "training_iteration": 159, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-41", "timestamp": 1706266421, "time_this_iter_s": 1.9545860290527344, "time_total_s": 312.0819573402405, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f199c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92751630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 312.0819573402405, "timesteps_since_restore": 0, "iterations_since_restore": 159, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 22.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.864033158471669e+26, "policy_entropy": 414.0450439453125, "var_gnorm": 22.78236961364746, "vf_loss": 11583648432128.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6716461181640625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 160, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087643.9236416297, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286298445899493, "mean_inference_ms": 5.217516742072576, "mean_action_processing_ms": 0.14308761139927165, "mean_env_wait_ms": 0.2600046024684221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014977693557739258, "StateBufferConnector_ms": 0.0022776126861572266, "ViewRequirementAgentConnector_ms": 0.05970191955566406}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087643.9236416297, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1120668.205784468, -1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286298445899493, "mean_inference_ms": 5.217516742072576, "mean_action_processing_ms": 0.14308761139927165, "mean_env_wait_ms": 0.2600046024684221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014977693557739258, "StateBufferConnector_ms": 0.0022776126861572266, "ViewRequirementAgentConnector_ms": 0.05970191955566406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 1952.402, "learn_time_ms": 19.318, "learn_throughput": 17392.732, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 160, "training_iteration": 160, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-43", "timestamp": 1706266423, "time_this_iter_s": 1.9698257446289062, "time_total_s": 314.0517830848694, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3c10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271fd00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 314.0517830848694, "timesteps_since_restore": 0, "iterations_since_restore": 160, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 22.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2390342263568564e+26, "policy_entropy": 414.04608154296875, "var_gnorm": 22.78236961364746, "vf_loss": 9930848337920.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.993511199951172e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 161, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087219.973804918, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286520837088471, "mean_inference_ms": 5.217575045950062, "mean_action_processing_ms": 0.1430864171801694, "mean_env_wait_ms": 0.2600036284070158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014972686767578125, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.059713125228881836}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087219.973804918, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1070273.8005747104, -1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286520837088471, "mean_inference_ms": 5.217575045950062, "mean_action_processing_ms": 0.1430864171801694, "mean_env_wait_ms": 0.2600036284070158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014972686767578125, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.059713125228881836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54096, "timers": {"training_iteration_time_ms": 1952.122, "learn_time_ms": 18.739, "learn_throughput": 17930.83, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "done": false, "episodes_total": 161, "training_iteration": 161, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-45", "timestamp": 1706266425, "time_this_iter_s": 1.9603726863861084, "time_total_s": 316.0121557712555, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8063130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 316.0121557712555, "timesteps_since_restore": 0, "iterations_since_restore": 161, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 22.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.192865129685271e+25, "policy_entropy": 411.8981018066406, "var_gnorm": 22.78236961364746, "vf_loss": 9523367510016.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.0531158447265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 162, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087201.4044430298, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286780970458377, "mean_inference_ms": 5.217639824519299, "mean_action_processing_ms": 0.14308576117040173, "mean_env_wait_ms": 0.26000333695730693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014979362487792969, "StateBufferConnector_ms": 0.0022764205932617188, "ViewRequirementAgentConnector_ms": 0.059706926345825195}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087201.4044430298, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1060204.0584042827, -1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286780970458377, "mean_inference_ms": 5.217639824519299, "mean_action_processing_ms": 0.14308576117040173, "mean_env_wait_ms": 0.26000333695730693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014979362487792969, "StateBufferConnector_ms": 0.0022764205932617188, "ViewRequirementAgentConnector_ms": 0.059706926345825195}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54432, "timers": {"training_iteration_time_ms": 1954.799, "learn_time_ms": 18.762, "learn_throughput": 17908.955, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "done": false, "episodes_total": 162, "training_iteration": 162, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-47", "timestamp": 1706266427, "time_this_iter_s": 1.9664247035980225, "time_total_s": 317.9785804748535, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0430>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 317.9785804748535, "timesteps_since_restore": 0, "iterations_since_restore": 162, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 22.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.540381178435882e+25, "policy_entropy": 412.4189453125, "var_gnorm": 22.78236961364746, "vf_loss": 10684734636032.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8743019104003906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 163, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087773.99865793, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15287071147845643, "mean_inference_ms": 5.217704935946418, "mean_action_processing_ms": 0.14308533390220388, "mean_env_wait_ms": 0.2600031684367064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014973640441894531, "StateBufferConnector_ms": 0.002277374267578125, "ViewRequirementAgentConnector_ms": 0.05974721908569336}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087773.99865793, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1135409.68272646, -1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15287071147845643, "mean_inference_ms": 5.217704935946418, "mean_action_processing_ms": 0.14308533390220388, "mean_env_wait_ms": 0.2600031684367064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014973640441894531, "StateBufferConnector_ms": 0.002277374267578125, "ViewRequirementAgentConnector_ms": 0.05974721908569336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54768, "timers": {"training_iteration_time_ms": 1957.936, "learn_time_ms": 18.86, "learn_throughput": 17815.882, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "done": false, "episodes_total": 163, "training_iteration": 163, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-49", "timestamp": 1706266429, "time_this_iter_s": 1.972355842590332, "time_total_s": 319.95093631744385, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3ca0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a1090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 319.95093631744385, "timesteps_since_restore": 0, "iterations_since_restore": 163, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 22.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1428239413683391e+26, "policy_entropy": 410.1143493652344, "var_gnorm": 22.782371520996094, "vf_loss": 9678529495040.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.147125244140625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 164, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086915.2953159986, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15287366777146866, "mean_inference_ms": 5.217769908960933, "mean_action_processing_ms": 0.1430851247221174, "mean_env_wait_ms": 0.26000318421545204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01497793197631836, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.05973100662231445}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086915.2953159986, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1065718.1369367917, -1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15287366777146866, "mean_inference_ms": 5.217769908960933, "mean_action_processing_ms": 0.1430851247221174, "mean_env_wait_ms": 0.26000318421545204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01497793197631836, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.05973100662231445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55104, "timers": {"training_iteration_time_ms": 1961.993, "learn_time_ms": 18.902, "learn_throughput": 17776.017, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "done": false, "episodes_total": 164, "training_iteration": 164, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-51", "timestamp": 1706266431, "time_this_iter_s": 1.9621846675872803, "time_total_s": 321.9131209850311, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccafe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a1d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 321.9131209850311, "timesteps_since_restore": 0, "iterations_since_restore": 164, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 22.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4347576858602888e+26, "policy_entropy": 412.751708984375, "var_gnorm": 22.782371520996094, "vf_loss": 9762328543232.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.790855407714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 165, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086926.015352727, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528762368463655, "mean_inference_ms": 5.217831826282569, "mean_action_processing_ms": 0.14308463118001796, "mean_env_wait_ms": 0.2600027386090742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014988899230957031, "StateBufferConnector_ms": 0.0022771358489990234, "ViewRequirementAgentConnector_ms": 0.059767723083496094}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1086926.015352727, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1063304.620274774, -1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528762368463655, "mean_inference_ms": 5.217831826282569, "mean_action_processing_ms": 0.14308463118001796, "mean_env_wait_ms": 0.2600027386090742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014988899230957031, "StateBufferConnector_ms": 0.0022771358489990234, "ViewRequirementAgentConnector_ms": 0.059767723083496094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55440, "timers": {"training_iteration_time_ms": 1961.622, "learn_time_ms": 18.883, "learn_throughput": 17793.433, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "done": false, "episodes_total": 165, "training_iteration": 165, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-53", "timestamp": 1706266433, "time_this_iter_s": 1.9616808891296387, "time_total_s": 323.87480187416077, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1090>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a1fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 323.87480187416077, "timesteps_since_restore": 0, "iterations_since_restore": 165, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 22.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7607444888471878e+26, "policy_entropy": 409.78594970703125, "var_gnorm": 22.782371520996094, "vf_loss": 11043261644800.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.790855407714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 166, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087585.2202978432, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528793035974674, "mean_inference_ms": 5.2179034963230215, "mean_action_processing_ms": 0.143084338483595, "mean_env_wait_ms": 0.26000249527167085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01500248908996582, "StateBufferConnector_ms": 0.0022766590118408203, "ViewRequirementAgentConnector_ms": 0.059787750244140625}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087585.2202978432, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1075039.048408442, -1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528793035974674, "mean_inference_ms": 5.2179034963230215, "mean_action_processing_ms": 0.143084338483595, "mean_env_wait_ms": 0.26000249527167085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01500248908996582, "StateBufferConnector_ms": 0.0022766590118408203, "ViewRequirementAgentConnector_ms": 0.059787750244140625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55776, "timers": {"training_iteration_time_ms": 1963.807, "learn_time_ms": 18.953, "learn_throughput": 17727.896, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "done": false, "episodes_total": 166, "training_iteration": 166, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-55", "timestamp": 1706266435, "time_this_iter_s": 1.9679672718048096, "time_total_s": 325.8427691459656, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23f70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a0af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 325.8427691459656, "timesteps_since_restore": 0, "iterations_since_restore": 166, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 22.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.8385790497266793e+26, "policy_entropy": 411.1885681152344, "var_gnorm": 22.782371520996094, "vf_loss": 9906354651136.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 167, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087513.4489466287, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.152882668648543, "mean_inference_ms": 5.217985202147084, "mean_action_processing_ms": 0.14308428826463376, "mean_env_wait_ms": 0.2600028972978323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015025615692138672, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.05979299545288086}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087513.4489466287, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1050422.442451413, -1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.152882668648543, "mean_inference_ms": 5.217985202147084, "mean_action_processing_ms": 0.14308428826463376, "mean_env_wait_ms": 0.2600028972978323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015025615692138672, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.05979299545288086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56112, "timers": {"training_iteration_time_ms": 1966.43, "learn_time_ms": 18.982, "learn_throughput": 17700.597, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "done": false, "episodes_total": 167, "training_iteration": 167, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-57", "timestamp": 1706266437, "time_this_iter_s": 1.9748950004577637, "time_total_s": 327.81766414642334, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc8a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271fc70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 327.81766414642334, "timesteps_since_restore": 0, "iterations_since_restore": 167, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 23.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3221707504180136e+26, "policy_entropy": 412.0838317871094, "var_gnorm": 22.782371520996094, "vf_loss": 10789881643008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3736228942871094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 168, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088266.3240502856, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15288612189804415, "mean_inference_ms": 5.218066435948804, "mean_action_processing_ms": 0.1430844518015537, "mean_env_wait_ms": 0.26000358579836097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015042543411254883, "StateBufferConnector_ms": 0.0022754669189453125, "ViewRequirementAgentConnector_ms": 0.05980205535888672}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088266.3240502856, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1051872.5063154055, -1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15288612189804415, "mean_inference_ms": 5.218066435948804, "mean_action_processing_ms": 0.1430844518015537, "mean_env_wait_ms": 0.26000358579836097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015042543411254883, "StateBufferConnector_ms": 0.0022754669189453125, "ViewRequirementAgentConnector_ms": 0.05980205535888672}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 1963.71, "learn_time_ms": 18.973, "learn_throughput": 17708.983, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "done": false, "episodes_total": 168, "training_iteration": 168, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-53-59", "timestamp": 1706266439, "time_this_iter_s": 1.9518742561340332, "time_total_s": 329.7695384025574, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a11b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 329.7695384025574, "timesteps_since_restore": 0, "iterations_since_restore": 168, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 23.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2339289308446595e+26, "policy_entropy": 415.46954345703125, "var_gnorm": 22.782371520996094, "vf_loss": 10324925218816.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.540515899658203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 169, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088660.2350405757, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15288943472771824, "mean_inference_ms": 5.218142056782803, "mean_action_processing_ms": 0.14308474009817349, "mean_env_wait_ms": 0.2600040236586534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015039205551147461, "StateBufferConnector_ms": 0.0022754669189453125, "ViewRequirementAgentConnector_ms": 0.059775352478027344}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088660.2350405757, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1037390.1012985101, -1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15288943472771824, "mean_inference_ms": 5.218142056782803, "mean_action_processing_ms": 0.14308474009817349, "mean_env_wait_ms": 0.2600040236586534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015039205551147461, "StateBufferConnector_ms": 0.0022754669189453125, "ViewRequirementAgentConnector_ms": 0.059775352478027344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56784, "timers": {"training_iteration_time_ms": 1964.874, "learn_time_ms": 18.992, "learn_throughput": 17691.82, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "done": false, "episodes_total": 169, "training_iteration": 169, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-01", "timestamp": 1706266441, "time_this_iter_s": 1.9662301540374756, "time_total_s": 331.73576855659485, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3a60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a1bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 331.73576855659485, "timesteps_since_restore": 0, "iterations_since_restore": 169, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.699999999999999, "ram_util_percent": 23.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.006668910848873e+25, "policy_entropy": 412.247314453125, "var_gnorm": 22.782371520996094, "vf_loss": 10630128992256.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.540515899658203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 170, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089596.2354377613, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528926655310377, "mean_inference_ms": 5.218222693874457, "mean_action_processing_ms": 0.14308508442482132, "mean_env_wait_ms": 0.26000444846211845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015044927597045898, "StateBufferConnector_ms": 0.0022749900817871094, "ViewRequirementAgentConnector_ms": 0.05977463722229004}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089596.2354377613, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1070397.860397762, -1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528926655310377, "mean_inference_ms": 5.218222693874457, "mean_action_processing_ms": 0.14308508442482132, "mean_env_wait_ms": 0.26000444846211845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015044927597045898, "StateBufferConnector_ms": 0.0022749900817871094, "ViewRequirementAgentConnector_ms": 0.05977463722229004}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57120, "timers": {"training_iteration_time_ms": 1964.104, "learn_time_ms": 19.008, "learn_throughput": 17676.708, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "done": false, "episodes_total": 170, "training_iteration": 170, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-03", "timestamp": 1706266443, "time_this_iter_s": 1.9621126651763916, "time_total_s": 333.69788122177124, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f183d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a2b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 333.69788122177124, "timesteps_since_restore": 0, "iterations_since_restore": 170, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.433333333333334, "ram_util_percent": 23.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.646793232213221e+26, "policy_entropy": 411.3258361816406, "var_gnorm": 22.782371520996094, "vf_loss": 9367378198528.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.9696693420410156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 171, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089401.9851984822, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15289588661204864, "mean_inference_ms": 5.218300347552718, "mean_action_processing_ms": 0.14308558116797399, "mean_env_wait_ms": 0.26000488848995734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015037059783935547, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.059760093688964844}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089401.9851984822, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1012581.3304063771, -1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15289588661204864, "mean_inference_ms": 5.218300347552718, "mean_action_processing_ms": 0.14308558116797399, "mean_env_wait_ms": 0.26000488848995734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015037059783935547, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.059760093688964844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57456, "timers": {"training_iteration_time_ms": 1962.807, "learn_time_ms": 18.948, "learn_throughput": 17732.379, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "done": false, "episodes_total": 171, "training_iteration": 171, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-05", "timestamp": 1706266445, "time_this_iter_s": 1.9474339485168457, "time_total_s": 335.6453151702881, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23910>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a3490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 335.6453151702881, "timesteps_since_restore": 0, "iterations_since_restore": 171, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 23.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.4005501197829305e+26, "policy_entropy": 413.5760192871094, "var_gnorm": 22.782371520996094, "vf_loss": 10383745089536.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 172, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090492.2599754746, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528991985618316, "mean_inference_ms": 5.218384233430018, "mean_action_processing_ms": 0.14308632543153818, "mean_env_wait_ms": 0.2600055361207109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015049457550048828, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.05976581573486328}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090492.2599754746, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1032353.811559993, -1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528991985618316, "mean_inference_ms": 5.218384233430018, "mean_action_processing_ms": 0.14308632543153818, "mean_env_wait_ms": 0.2600055361207109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015049457550048828, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.05976581573486328}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57792, "timers": {"training_iteration_time_ms": 1964.081, "learn_time_ms": 18.938, "learn_throughput": 17742.269, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "done": false, "episodes_total": 172, "training_iteration": 172, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-07", "timestamp": 1706266447, "time_this_iter_s": 1.9791898727416992, "time_total_s": 337.6245050430298, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1000>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a12d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 337.6245050430298, "timesteps_since_restore": 0, "iterations_since_restore": 172, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 23.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5185060884223709e+26, "policy_entropy": 410.3004150390625, "var_gnorm": 22.782371520996094, "vf_loss": 9079320739840.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.910064697265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 173, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090288.072220503, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529024180131913, "mean_inference_ms": 5.218465813975078, "mean_action_processing_ms": 0.14308714012691098, "mean_env_wait_ms": 0.2600061398034955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015066862106323242, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.05978250503540039}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090288.072220503, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1071557.577313487, -1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529024180131913, "mean_inference_ms": 5.218465813975078, "mean_action_processing_ms": 0.14308714012691098, "mean_env_wait_ms": 0.2600061398034955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015066862106323242, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.05978250503540039}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58128, "timers": {"training_iteration_time_ms": 1964.823, "learn_time_ms": 18.947, "learn_throughput": 17733.963, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "done": false, "episodes_total": 173, "training_iteration": 173, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-09", "timestamp": 1706266449, "time_this_iter_s": 1.9797725677490234, "time_total_s": 339.6042776107788, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6105750>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a3a30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 339.6042776107788, "timesteps_since_restore": 0, "iterations_since_restore": 173, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 23.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2892881378345412e+26, "policy_entropy": 413.24542236328125, "var_gnorm": 22.782371520996094, "vf_loss": 9956350754816.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.993511199951172e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 174, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090378.9667775268, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15290552870756222, "mean_inference_ms": 5.218556683292751, "mean_action_processing_ms": 0.1430879407287485, "mean_env_wait_ms": 0.26000651812992726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015053033828735352, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.05975604057312012}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090378.9667775268, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1073046.5828117342, -1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15290552870756222, "mean_inference_ms": 5.218556683292751, "mean_action_processing_ms": 0.1430879407287485, "mean_env_wait_ms": 0.26000651812992726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015053033828735352, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.05975604057312012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58464, "timers": {"training_iteration_time_ms": 1969.719, "learn_time_ms": 19.104, "learn_throughput": 17588.221, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "done": false, "episodes_total": 174, "training_iteration": 174, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-11", "timestamp": 1706266451, "time_this_iter_s": 2.011119842529297, "time_total_s": 341.6153974533081, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0850>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a15a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 341.6153974533081, "timesteps_since_restore": 0, "iterations_since_restore": 174, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 23.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2748961725756737e+26, "policy_entropy": 409.7900390625, "var_gnorm": 22.782371520996094, "vf_loss": 10510772731904.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.445148468017578e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 175, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090597.2591528913, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15290836349705025, "mean_inference_ms": 5.218642722058016, "mean_action_processing_ms": 0.14308861395265862, "mean_env_wait_ms": 0.26000642672330576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01507878303527832, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.05978846549987793}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090597.2591528913, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1075098.7249032792, -1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15290836349705025, "mean_inference_ms": 5.218642722058016, "mean_action_processing_ms": 0.14308861395265862, "mean_env_wait_ms": 0.26000642672330576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01507878303527832, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.05978846549987793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58800, "timers": {"training_iteration_time_ms": 1969.442, "learn_time_ms": 19.103, "learn_throughput": 17589.187, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "done": false, "episodes_total": 175, "training_iteration": 175, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-13", "timestamp": 1706266453, "time_this_iter_s": 1.9588918685913086, "time_total_s": 343.5742893218994, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f183d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a2c20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 343.5742893218994, "timesteps_since_restore": 0, "iterations_since_restore": 175, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 23.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6303378141622684e+26, "policy_entropy": 412.8752746582031, "var_gnorm": 22.782371520996094, "vf_loss": 10515073990656.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.1604042053222656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 176, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1091028.877218844, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291035438217856, "mean_inference_ms": 5.218721419949313, "mean_action_processing_ms": 0.14308929861516353, "mean_env_wait_ms": 0.2600055547037751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015070676803588867, "StateBufferConnector_ms": 0.0022661685943603516, "ViewRequirementAgentConnector_ms": 0.05974912643432617}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1091028.877218844, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1092122.4895156806, -1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291035438217856, "mean_inference_ms": 5.218721419949313, "mean_action_processing_ms": 0.14308929861516353, "mean_env_wait_ms": 0.2600055547037751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015070676803588867, "StateBufferConnector_ms": 0.0022661685943603516, "ViewRequirementAgentConnector_ms": 0.05974912643432617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 1969.964, "learn_time_ms": 19.086, "learn_throughput": 17604.7, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "done": false, "episodes_total": 176, "training_iteration": 176, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-15", "timestamp": 1706266455, "time_this_iter_s": 1.9732050895690918, "time_total_s": 345.5474944114685, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23700>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a1240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 345.5474944114685, "timesteps_since_restore": 0, "iterations_since_restore": 176, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 23.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3254760380211409e+26, "policy_entropy": 411.48541259765625, "var_gnorm": 22.782371520996094, "vf_loss": 10054518439936.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.9577484130859375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 177, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090860.2545120267, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291214873474093, "mean_inference_ms": 5.218798507179465, "mean_action_processing_ms": 0.1430898979020148, "mean_env_wait_ms": 0.2600046435345882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015078544616699219, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.05975914001464844}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090860.2545120267, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1140230.5730932828, -1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291214873474093, "mean_inference_ms": 5.218798507179465, "mean_action_processing_ms": 0.1430898979020148, "mean_env_wait_ms": 0.2600046435345882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015078544616699219, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.05975914001464844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59472, "timers": {"training_iteration_time_ms": 1968.205, "learn_time_ms": 19.089, "learn_throughput": 17601.753, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "done": false, "episodes_total": 177, "training_iteration": 177, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-17", "timestamp": 1706266457, "time_this_iter_s": 1.9572651386260986, "time_total_s": 347.5047595500946, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1d20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a32e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 347.5047595500946, "timesteps_since_restore": 0, "iterations_since_restore": 177, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 23.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6456002812739742e+26, "policy_entropy": 412.0243835449219, "var_gnorm": 22.782371520996094, "vf_loss": 9418439655424.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.933906555175781e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 178, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090104.7462056149, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291374732381338, "mean_inference_ms": 5.218874653937112, "mean_action_processing_ms": 0.1430903853661969, "mean_env_wait_ms": 0.2600034004427836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015048027038574219, "StateBufferConnector_ms": 0.0022644996643066406, "ViewRequirementAgentConnector_ms": 0.05979466438293457}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1090104.7462056149, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1104048.85533461, -1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291374732381338, "mean_inference_ms": 5.218874653937112, "mean_action_processing_ms": 0.1430903853661969, "mean_env_wait_ms": 0.2600034004427836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015048027038574219, "StateBufferConnector_ms": 0.0022644996643066406, "ViewRequirementAgentConnector_ms": 0.05979466438293457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59808, "timers": {"training_iteration_time_ms": 1969.765, "learn_time_ms": 19.096, "learn_throughput": 17595.007, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "done": false, "episodes_total": 178, "training_iteration": 178, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-19", "timestamp": 1706266459, "time_this_iter_s": 1.9674952030181885, "time_total_s": 349.4722547531128, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a2b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 349.4722547531128, "timesteps_since_restore": 0, "iterations_since_restore": 178, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 23.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5308479747786066e+26, "policy_entropy": 411.693359375, "var_gnorm": 22.782371520996094, "vf_loss": 8935074430976.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.0411949157714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 179, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089334.3345005708, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529155371057322, "mean_inference_ms": 5.218955048462273, "mean_action_processing_ms": 0.14309120569683537, "mean_env_wait_ms": 0.2600027619568266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015055656433105469, "StateBufferConnector_ms": 0.002266407012939453, "ViewRequirementAgentConnector_ms": 0.059838294982910156}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089334.3345005708, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1082179.1974230187, -1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529155371057322, "mean_inference_ms": 5.218955048462273, "mean_action_processing_ms": 0.14309120569683537, "mean_env_wait_ms": 0.2600027619568266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015055656433105469, "StateBufferConnector_ms": 0.002266407012939453, "ViewRequirementAgentConnector_ms": 0.059838294982910156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60144, "timers": {"training_iteration_time_ms": 1970.832, "learn_time_ms": 19.086, "learn_throughput": 17604.458, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "done": false, "episodes_total": 179, "training_iteration": 179, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-21", "timestamp": 1706266461, "time_this_iter_s": 1.976914405822754, "time_total_s": 351.44916915893555, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2320>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe926183a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 351.44916915893555, "timesteps_since_restore": 0, "iterations_since_restore": 179, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 24.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.392149765333716e+26, "policy_entropy": 412.0616149902344, "var_gnorm": 22.782371520996094, "vf_loss": 9113237979136.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.921985626220703e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 180, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088921.4099005759, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291718185155206, "mean_inference_ms": 5.2190321185448765, "mean_action_processing_ms": 0.14309188668647838, "mean_env_wait_ms": 0.26000170298033587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015049457550048828, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.059830427169799805}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088921.4099005759, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1073024.4015558606, -1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15291718185155206, "mean_inference_ms": 5.2190321185448765, "mean_action_processing_ms": 0.14309188668647838, "mean_env_wait_ms": 0.26000170298033587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015049457550048828, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.059830427169799805}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60480, "timers": {"training_iteration_time_ms": 1969.579, "learn_time_ms": 19.079, "learn_throughput": 17611.124, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "done": false, "episodes_total": 180, "training_iteration": 180, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-23", "timestamp": 1706266463, "time_this_iter_s": 1.9495995044708252, "time_total_s": 353.3987686634064, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2380>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a1750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 353.3987686634064, "timesteps_since_restore": 0, "iterations_since_restore": 180, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 24.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5499149906217947e+26, "policy_entropy": 411.5875244140625, "var_gnorm": 22.782371520996094, "vf_loss": 10681279578112.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8623809814453125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 181, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089278.2152727195, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529189215980654, "mean_inference_ms": 5.219105748702242, "mean_action_processing_ms": 0.1430926646655121, "mean_env_wait_ms": 0.26000073035733984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015039205551147461, "StateBufferConnector_ms": 0.002264261245727539, "ViewRequirementAgentConnector_ms": 0.05980968475341797}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089278.2152727195, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1076253.1542384797, -1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529189215980654, "mean_inference_ms": 5.219105748702242, "mean_action_processing_ms": 0.1430926646655121, "mean_env_wait_ms": 0.26000073035733984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015039205551147461, "StateBufferConnector_ms": 0.002264261245727539, "ViewRequirementAgentConnector_ms": 0.05980968475341797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60816, "timers": {"training_iteration_time_ms": 1970.013, "learn_time_ms": 19.143, "learn_throughput": 17552.143, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "done": false, "episodes_total": 181, "training_iteration": 181, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-25", "timestamp": 1706266465, "time_this_iter_s": 1.9517521858215332, "time_total_s": 355.3505208492279, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe926184c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 355.3505208492279, "timesteps_since_restore": 0, "iterations_since_restore": 181, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 24.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0941789549087633e+26, "policy_entropy": 413.5612487792969, "var_gnorm": 22.782371520996094, "vf_loss": 10487086448640.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.0411949157714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 182, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089614.8518240454, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292060841968508, "mean_inference_ms": 5.219180185974684, "mean_action_processing_ms": 0.14309359694171456, "mean_env_wait_ms": 0.25999974408068477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015026092529296875, "StateBufferConnector_ms": 0.002263307571411133, "ViewRequirementAgentConnector_ms": 0.05980992317199707}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089614.8518240454, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1130721.301076435, -1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292060841968508, "mean_inference_ms": 5.219180185974684, "mean_action_processing_ms": 0.14309359694171456, "mean_env_wait_ms": 0.25999974408068477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015026092529296875, "StateBufferConnector_ms": 0.002263307571411133, "ViewRequirementAgentConnector_ms": 0.05980992317199707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61152, "timers": {"training_iteration_time_ms": 1968.075, "learn_time_ms": 19.125, "learn_throughput": 17568.401, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "done": false, "episodes_total": 182, "training_iteration": 182, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-27", "timestamp": 1706266467, "time_this_iter_s": 1.9597773551940918, "time_total_s": 357.310298204422, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a61068f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92619240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 357.310298204422, "timesteps_since_restore": 0, "iterations_since_restore": 182, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 24.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7898779851651195e+26, "policy_entropy": 411.7065124511719, "var_gnorm": 22.782371520996094, "vf_loss": 9935668641792.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.802776336669922e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 183, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089208.5248389444, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292230132420678, "mean_inference_ms": 5.219255111269023, "mean_action_processing_ms": 0.14309463527946853, "mean_env_wait_ms": 0.25999889170956264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015031099319458008, "StateBufferConnector_ms": 0.002262592315673828, "ViewRequirementAgentConnector_ms": 0.05982398986816406}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089208.5248389444, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1058855.055001796, -1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292230132420678, "mean_inference_ms": 5.219255111269023, "mean_action_processing_ms": 0.14309463527946853, "mean_env_wait_ms": 0.25999889170956264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015031099319458008, "StateBufferConnector_ms": 0.002262592315673828, "ViewRequirementAgentConnector_ms": 0.05982398986816406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61488, "timers": {"training_iteration_time_ms": 1965.826, "learn_time_ms": 19.083, "learn_throughput": 17607.097, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "done": false, "episodes_total": 183, "training_iteration": 183, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-29", "timestamp": 1706266469, "time_this_iter_s": 1.9572663307189941, "time_total_s": 359.267564535141, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1ace0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a3eb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 359.267564535141, "timesteps_since_restore": 0, "iterations_since_restore": 183, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 24.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.73398195254505e+26, "policy_entropy": 411.5045166015625, "var_gnorm": 22.782371520996094, "vf_loss": 9564907896832.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.470348358154297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 184, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089331.4793666005, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529240095350364, "mean_inference_ms": 5.219330800159554, "mean_action_processing_ms": 0.14309583083346, "mean_env_wait_ms": 0.2599984116418865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015033721923828125, "StateBufferConnector_ms": 0.0022606849670410156, "ViewRequirementAgentConnector_ms": 0.05981588363647461}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089331.4793666005, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1099705.2595716647, -1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529240095350364, "mean_inference_ms": 5.219330800159554, "mean_action_processing_ms": 0.14309583083346, "mean_env_wait_ms": 0.2599984116418865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015033721923828125, "StateBufferConnector_ms": 0.0022606849670410156, "ViewRequirementAgentConnector_ms": 0.05981588363647461}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1961.06, "learn_time_ms": 18.896, "learn_throughput": 17781.512, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "done": false, "episodes_total": 184, "training_iteration": 184, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-31", "timestamp": 1706266471, "time_this_iter_s": 1.9634737968444824, "time_total_s": 361.2310383319855, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6104670>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe926183a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 361.2310383319855, "timesteps_since_restore": 0, "iterations_since_restore": 184, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 24.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.8532272656383735e+26, "policy_entropy": 410.98583984375, "var_gnorm": 22.782371520996094, "vf_loss": 10064824893440.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7670135498046875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 185, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089191.6341768631, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292539177937603, "mean_inference_ms": 5.2194046651159125, "mean_action_processing_ms": 0.14309701419847692, "mean_env_wait_ms": 0.25999743408193665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015046834945678711, "StateBufferConnector_ms": 0.0022606849670410156, "ViewRequirementAgentConnector_ms": 0.05982184410095215}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1089191.6341768631, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1121926.3458533634, -1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292539177937603, "mean_inference_ms": 5.2194046651159125, "mean_action_processing_ms": 0.14309701419847692, "mean_env_wait_ms": 0.25999743408193665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015046834945678711, "StateBufferConnector_ms": 0.0022606849670410156, "ViewRequirementAgentConnector_ms": 0.05982184410095215}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62160, "timers": {"training_iteration_time_ms": 1961.873, "learn_time_ms": 18.957, "learn_throughput": 17724.194, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "done": false, "episodes_total": 185, "training_iteration": 185, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-33", "timestamp": 1706266473, "time_this_iter_s": 1.967015027999878, "time_total_s": 363.19805335998535, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6106fb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9261a170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 363.19805335998535, "timesteps_since_restore": 0, "iterations_since_restore": 185, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 24.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.676957348122551e+26, "policy_entropy": 411.2962341308594, "var_gnorm": 22.782371520996094, "vf_loss": 9633580187648.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.0650367736816406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 186, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088548.3015194247, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292696792323865, "mean_inference_ms": 5.219474643141034, "mean_action_processing_ms": 0.14309837511600323, "mean_env_wait_ms": 0.25999679426773636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015052556991577148, "StateBufferConnector_ms": 0.002260923385620117, "ViewRequirementAgentConnector_ms": 0.05984067916870117}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088548.3015194247, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1031076.706184661, -1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292696792323865, "mean_inference_ms": 5.219474643141034, "mean_action_processing_ms": 0.14309837511600323, "mean_env_wait_ms": 0.25999679426773636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015052556991577148, "StateBufferConnector_ms": 0.002260923385620117, "ViewRequirementAgentConnector_ms": 0.05984067916870117}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62496, "timers": {"training_iteration_time_ms": 1962.546, "learn_time_ms": 18.961, "learn_throughput": 17720.517, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "done": false, "episodes_total": 186, "training_iteration": 186, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-35", "timestamp": 1706266475, "time_this_iter_s": 1.979940414428711, "time_total_s": 365.17799377441406, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1ace0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a1f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 365.17799377441406, "timesteps_since_restore": 0, "iterations_since_restore": 186, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 24.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0578110145000042e+26, "policy_entropy": 411.2648010253906, "var_gnorm": 22.782371520996094, "vf_loss": 9439495061504.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.612041473388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 187, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088753.8793333054, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292872935332866, "mean_inference_ms": 5.219548577523345, "mean_action_processing_ms": 0.1431000158947421, "mean_env_wait_ms": 0.2599967140436086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015066862106323242, "StateBufferConnector_ms": 0.002262592315673828, "ViewRequirementAgentConnector_ms": 0.059861183166503906}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088753.8793333054, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1097936.872890642, -1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292872935332866, "mean_inference_ms": 5.219548577523345, "mean_action_processing_ms": 0.1431000158947421, "mean_env_wait_ms": 0.2599967140436086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015066862106323242, "StateBufferConnector_ms": 0.002262592315673828, "ViewRequirementAgentConnector_ms": 0.059861183166503906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62832, "timers": {"training_iteration_time_ms": 1964.727, "learn_time_ms": 18.962, "learn_throughput": 17719.448, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "done": false, "episodes_total": 187, "training_iteration": 187, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-37", "timestamp": 1706266477, "time_this_iter_s": 1.9790489673614502, "time_total_s": 367.1570427417755, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a6106bf0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92618ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 367.1570427417755, "timesteps_since_restore": 0, "iterations_since_restore": 187, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 24.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.8071967108387217e+26, "policy_entropy": 410.663818359375, "var_gnorm": 22.782371520996094, "vf_loss": 9614538047488.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.886222839355469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 188, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088510.9607078398, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15293083305761385, "mean_inference_ms": 5.219626784786776, "mean_action_processing_ms": 0.14310180485777826, "mean_env_wait_ms": 0.2599971884363523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015083789825439453, "StateBufferConnector_ms": 0.002264261245727539, "ViewRequirementAgentConnector_ms": 0.059880971908569336}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088510.9607078398, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1105033.0179393706, -1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15293083305761385, "mean_inference_ms": 5.219626784786776, "mean_action_processing_ms": 0.14310180485777826, "mean_env_wait_ms": 0.2599971884363523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015083789825439453, "StateBufferConnector_ms": 0.002264261245727539, "ViewRequirementAgentConnector_ms": 0.059880971908569336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63168, "timers": {"training_iteration_time_ms": 1966.273, "learn_time_ms": 18.956, "learn_throughput": 17724.885, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "done": false, "episodes_total": 188, "training_iteration": 188, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-39", "timestamp": 1706266479, "time_this_iter_s": 1.9829003810882568, "time_total_s": 369.13994312286377, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9271d870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 369.13994312286377, "timesteps_since_restore": 0, "iterations_since_restore": 188, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 24.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.991197626594253e+25, "policy_entropy": 413.46929931640625, "var_gnorm": 22.782371520996094, "vf_loss": 9542474661888.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.826618194580078e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 189, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087949.8643570347, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15293289363044013, "mean_inference_ms": 5.219707180258901, "mean_action_processing_ms": 0.14310363431658438, "mean_env_wait_ms": 0.2599974122414102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015079498291015625, "StateBufferConnector_ms": 0.0022640228271484375, "ViewRequirementAgentConnector_ms": 0.05985665321350098}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087949.8643570347, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1119359.1415182538, -1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15293289363044013, "mean_inference_ms": 5.219707180258901, "mean_action_processing_ms": 0.14310363431658438, "mean_env_wait_ms": 0.2599974122414102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015079498291015625, "StateBufferConnector_ms": 0.0022640228271484375, "ViewRequirementAgentConnector_ms": 0.05985665321350098}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63504, "timers": {"training_iteration_time_ms": 1964.373, "learn_time_ms": 18.96, "learn_throughput": 17721.453, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "done": false, "episodes_total": 189, "training_iteration": 189, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-41", "timestamp": 1706266481, "time_this_iter_s": 1.9578874111175537, "time_total_s": 371.0978305339813, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a35b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 371.0978305339813, "timesteps_since_restore": 0, "iterations_since_restore": 189, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 24.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4886078823288635e+26, "policy_entropy": 412.21820068359375, "var_gnorm": 22.782371520996094, "vf_loss": 11492397154304.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5762786865234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 190, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088306.6612292184, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15293487716882231, "mean_inference_ms": 5.219755252878566, "mean_action_processing_ms": 0.14310545905091904, "mean_env_wait_ms": 0.25999768218684205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015074014663696289, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.059851884841918945}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088306.6612292184, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1082081.0210460743, -1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15293487716882231, "mean_inference_ms": 5.219755252878566, "mean_action_processing_ms": 0.14310545905091904, "mean_env_wait_ms": 0.25999768218684205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015074014663696289, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.059851884841918945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63840, "timers": {"training_iteration_time_ms": 1967.302, "learn_time_ms": 18.907, "learn_throughput": 17771.04, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "done": false, "episodes_total": 190, "training_iteration": 190, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-43", "timestamp": 1706266483, "time_this_iter_s": 1.9788367748260498, "time_total_s": 373.0766673088074, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccba00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a3d90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 373.0766673088074, "timesteps_since_restore": 0, "iterations_since_restore": 190, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 25.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9771122530458307e+26, "policy_entropy": 410.5834655761719, "var_gnorm": 22.782371520996094, "vf_loss": 9254956171264.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.635883331298828e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 191, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087742.127608896, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529366288262001, "mean_inference_ms": 5.2197991429980455, "mean_action_processing_ms": 0.1431070556331464, "mean_env_wait_ms": 0.2599975429532137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015067338943481445, "StateBufferConnector_ms": 0.0022597312927246094, "ViewRequirementAgentConnector_ms": 0.05987119674682617}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087742.127608896, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1020672.8982310215, -1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529366288262001, "mean_inference_ms": 5.2197991429980455, "mean_action_processing_ms": 0.1431070556331464, "mean_env_wait_ms": 0.2599975429532137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015067338943481445, "StateBufferConnector_ms": 0.0022597312927246094, "ViewRequirementAgentConnector_ms": 0.05987119674682617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64176, "timers": {"training_iteration_time_ms": 1970.03, "learn_time_ms": 18.969, "learn_throughput": 17713.034, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "done": false, "episodes_total": 191, "training_iteration": 191, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-45", "timestamp": 1706266485, "time_this_iter_s": 1.9790887832641602, "time_total_s": 375.05575609207153, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe926191b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 375.05575609207153, "timesteps_since_restore": 0, "iterations_since_restore": 191, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 25.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2792151341432942e+26, "policy_entropy": 413.7359924316406, "var_gnorm": 22.782371520996094, "vf_loss": 10467141484544.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.1828880310058594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 192, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088453.4327314696, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15293834331123798, "mean_inference_ms": 5.2198383365671495, "mean_action_processing_ms": 0.1431086342499768, "mean_env_wait_ms": 0.2599975720763972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015086650848388672, "StateBufferConnector_ms": 0.0022585391998291016, "ViewRequirementAgentConnector_ms": 0.059856414794921875}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088453.4327314696, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1076050.045283787, -1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15293834331123798, "mean_inference_ms": 5.2198383365671495, "mean_action_processing_ms": 0.1431086342499768, "mean_env_wait_ms": 0.2599975720763972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015086650848388672, "StateBufferConnector_ms": 0.0022585391998291016, "ViewRequirementAgentConnector_ms": 0.059856414794921875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1970.624, "learn_time_ms": 18.988, "learn_throughput": 17695.752, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "episodes_total": 192, "training_iteration": 192, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-47", "timestamp": 1706266487, "time_this_iter_s": 1.9657347202301025, "time_total_s": 377.02149081230164, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2620>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a3b50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 377.02149081230164, "timesteps_since_restore": 0, "iterations_since_restore": 192, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 25.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5182347368170466e+26, "policy_entropy": 413.01300048828125, "var_gnorm": 22.782371520996094, "vf_loss": 9614192017408.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3855438232421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 193, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088287.4622565927, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529400375288223, "mean_inference_ms": 5.219872950264099, "mean_action_processing_ms": 0.14311012097422465, "mean_env_wait_ms": 0.2599974662978425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01508641242980957, "StateBufferConnector_ms": 0.002259969711303711, "ViewRequirementAgentConnector_ms": 0.05988788604736328}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088287.4622565927, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1069952.2632435644, -1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529400375288223, "mean_inference_ms": 5.219872950264099, "mean_action_processing_ms": 0.14311012097422465, "mean_env_wait_ms": 0.2599974662978425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01508641242980957, "StateBufferConnector_ms": 0.002259969711303711, "ViewRequirementAgentConnector_ms": 0.05988788604736328}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64848, "timers": {"training_iteration_time_ms": 1970.948, "learn_time_ms": 18.988, "learn_throughput": 17694.996, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "done": false, "episodes_total": 193, "training_iteration": 193, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-49", "timestamp": 1706266489, "time_this_iter_s": 1.960491418838501, "time_total_s": 378.98198223114014, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d3550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92618550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 378.98198223114014, "timesteps_since_restore": 0, "iterations_since_restore": 193, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 25.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1552876684691817e+26, "policy_entropy": 411.463623046875, "var_gnorm": 22.782371520996094, "vf_loss": 10803157663744.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3020973205566406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 194, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088651.0345527558, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294179287498547, "mean_inference_ms": 5.219908409044565, "mean_action_processing_ms": 0.1431115276137763, "mean_env_wait_ms": 0.259997360131586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015097618103027344, "StateBufferConnector_ms": 0.002259969711303711, "ViewRequirementAgentConnector_ms": 0.05988621711730957}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088651.0345527558, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1104524.9313210538, -1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294179287498547, "mean_inference_ms": 5.219908409044565, "mean_action_processing_ms": 0.1431115276137763, "mean_env_wait_ms": 0.259997360131586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015097618103027344, "StateBufferConnector_ms": 0.002259969711303711, "ViewRequirementAgentConnector_ms": 0.05988621711730957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65184, "timers": {"training_iteration_time_ms": 1968.019, "learn_time_ms": 18.989, "learn_throughput": 17694.908, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "done": false, "episodes_total": 194, "training_iteration": 194, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-51", "timestamp": 1706266491, "time_this_iter_s": 1.9341700077056885, "time_total_s": 380.9161522388458, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca530>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9261a4d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 380.9161522388458, "timesteps_since_restore": 0, "iterations_since_restore": 194, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 25.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0318516494348357e+26, "policy_entropy": 411.7496337890625, "var_gnorm": 22.782371520996094, "vf_loss": 9456323657728.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.838539123535156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 195, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088103.6516290295, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294347010761628, "mean_inference_ms": 5.219942826699883, "mean_action_processing_ms": 0.14311287567378134, "mean_env_wait_ms": 0.2599972580625164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015103578567504883, "StateBufferConnector_ms": 0.002259969711303711, "ViewRequirementAgentConnector_ms": 0.05988264083862305}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1088103.6516290295, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1083549.4394350618, -1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294347010761628, "mean_inference_ms": 5.219942826699883, "mean_action_processing_ms": 0.14311287567378134, "mean_env_wait_ms": 0.2599972580625164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015103578567504883, "StateBufferConnector_ms": 0.002259969711303711, "ViewRequirementAgentConnector_ms": 0.05988264083862305}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65520, "timers": {"training_iteration_time_ms": 1965.741, "learn_time_ms": 18.915, "learn_throughput": 17763.715, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "done": false, "episodes_total": 195, "training_iteration": 195, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-53", "timestamp": 1706266493, "time_this_iter_s": 1.9442200660705566, "time_total_s": 382.8603723049164, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccafe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a12d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 382.8603723049164, "timesteps_since_restore": 0, "iterations_since_restore": 195, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 25.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.192788499564436e+26, "policy_entropy": 411.61883544921875, "var_gnorm": 22.782371520996094, "vf_loss": 9890308292608.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.528594970703125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 196, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087946.9148558937, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529450604961782, "mean_inference_ms": 5.219972588422404, "mean_action_processing_ms": 0.14311412430645667, "mean_env_wait_ms": 0.2599969984807413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015111207962036133, "StateBufferConnector_ms": 0.0022611618041992188, "ViewRequirementAgentConnector_ms": 0.05988121032714844}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087946.9148558937, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1102355.1983485834, -1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529450604961782, "mean_inference_ms": 5.219972588422404, "mean_action_processing_ms": 0.14311412430645667, "mean_env_wait_ms": 0.2599969984807413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015111207962036133, "StateBufferConnector_ms": 0.0022611618041992188, "ViewRequirementAgentConnector_ms": 0.05988121032714844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65856, "timers": {"training_iteration_time_ms": 1961.984, "learn_time_ms": 18.886, "learn_throughput": 17790.58, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "done": false, "episodes_total": 196, "training_iteration": 196, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-55", "timestamp": 1706266495, "time_this_iter_s": 1.9423682689666748, "time_total_s": 384.80274057388306, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2e90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe92619d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 384.80274057388306, "timesteps_since_restore": 0, "iterations_since_restore": 196, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 25.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.217698998862365e+26, "policy_entropy": 412.9921875, "var_gnorm": 22.782371520996094, "vf_loss": 9895965360128.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.62396240234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 197, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087694.9172379128, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464, -1077155.4365505192], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294655228269133, "mean_inference_ms": 5.219997214588849, "mean_action_processing_ms": 0.1431153174567098, "mean_env_wait_ms": 0.25999648601203473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015106439590454102, "StateBufferConnector_ms": 0.002259969711303711, "ViewRequirementAgentConnector_ms": 0.05986452102661133}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087694.9172379128, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1069657.8082302425, -1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464, -1077155.4365505192], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294655228269133, "mean_inference_ms": 5.219997214588849, "mean_action_processing_ms": 0.1431153174567098, "mean_env_wait_ms": 0.25999648601203473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015106439590454102, "StateBufferConnector_ms": 0.002259969711303711, "ViewRequirementAgentConnector_ms": 0.05986452102661133}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66192, "timers": {"training_iteration_time_ms": 1958.785, "learn_time_ms": 18.853, "learn_throughput": 17822.326, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "done": false, "episodes_total": 197, "training_iteration": 197, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-57", "timestamp": 1706266497, "time_this_iter_s": 1.9470899105072021, "time_total_s": 386.74983048439026, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ef8a61045e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9261af80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 386.74983048439026, "timesteps_since_restore": 0, "iterations_since_restore": 197, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 25.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1862468390480884e+26, "policy_entropy": 412.6624450683594, "var_gnorm": 22.782371520996094, "vf_loss": 9835040997376.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.267692565917969e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 198, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087680.7207109863, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464, -1077155.4365505192, -1068238.1555375915], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294785203583602, "mean_inference_ms": 5.220018233564408, "mean_action_processing_ms": 0.14311636925473564, "mean_env_wait_ms": 0.25999576619900056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015120506286621094, "StateBufferConnector_ms": 0.0022585391998291016, "ViewRequirementAgentConnector_ms": 0.05987238883972168}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087680.7207109863, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1088950.5633626122, -1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464, -1077155.4365505192, -1068238.1555375915], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294785203583602, "mean_inference_ms": 5.220018233564408, "mean_action_processing_ms": 0.14311636925473564, "mean_env_wait_ms": 0.25999576619900056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015120506286621094, "StateBufferConnector_ms": 0.0022585391998291016, "ViewRequirementAgentConnector_ms": 0.05987238883972168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66528, "timers": {"training_iteration_time_ms": 1956.457, "learn_time_ms": 18.866, "learn_throughput": 17809.668, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "done": false, "episodes_total": 198, "training_iteration": 198, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-54-59", "timestamp": 1706266499, "time_this_iter_s": 1.9596543312072754, "time_total_s": 388.70948481559753, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1360>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe926191b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 388.70948481559753, "timesteps_since_restore": 0, "iterations_since_restore": 198, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 25.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.750284834576215e+25, "policy_entropy": 411.2716369628906, "var_gnorm": 22.782371520996094, "vf_loss": 9490283888640.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.838539123535156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 199, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087350.4244767223, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464, -1077155.4365505192, -1068238.1555375915, -1055920.939936196], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294907374917383, "mean_inference_ms": 5.220034921299787, "mean_action_processing_ms": 0.14311739820069524, "mean_env_wait_ms": 0.25999496621286755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015121221542358398, "StateBufferConnector_ms": 0.0022573471069335938, "ViewRequirementAgentConnector_ms": 0.059879302978515625}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087350.4244767223, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1119207.4441932263, -1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464, -1077155.4365505192, -1068238.1555375915, -1055920.939936196], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15294907374917383, "mean_inference_ms": 5.220034921299787, "mean_action_processing_ms": 0.14311739820069524, "mean_env_wait_ms": 0.25999496621286755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015121221542358398, "StateBufferConnector_ms": 0.0022573471069335938, "ViewRequirementAgentConnector_ms": 0.059879302978515625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66864, "timers": {"training_iteration_time_ms": 1958.736, "learn_time_ms": 18.886, "learn_throughput": 17790.49, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "done": false, "episodes_total": 199, "training_iteration": 199, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-55-01", "timestamp": 1706266501, "time_this_iter_s": 1.980675220489502, "time_total_s": 390.69016003608704, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1b370>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe9261a3b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 390.69016003608704, "timesteps_since_restore": 0, "iterations_since_restore": 199, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 25.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.434547024042967e+26, "policy_entropy": 411.18865966796875, "var_gnorm": 22.782371520996094, "vf_loss": 10363596701696.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 200, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "sampler_results": {"episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087064.6310743054, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464, -1077155.4365505192, -1068238.1555375915, -1055920.939936196, -1090628.1039515599], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529503591030188, "mean_inference_ms": 5.220050217005314, "mean_action_processing_ms": 0.14311841323795568, "mean_env_wait_ms": 0.25999413433537577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01512598991394043, "StateBufferConnector_ms": 0.0022573471069335938, "ViewRequirementAgentConnector_ms": 0.05989718437194824}}, "episode_reward_max": -998860.5132271125, "episode_reward_min": -1206663.4854227945, "episode_reward_mean": -1087064.6310743054, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1061542.2867413592, -1086316.814164489, -1117475.872443476, -1044553.7550468385, -1101700.5555230242, -1038853.3854892659, -1137810.3802275653, -1177929.0108545588, -1089418.1807094633, -1065492.8916955832, -1092792.325542951, -1125407.0249656623, -1064276.059919532, -1039209.0689874364, -1098236.1081753133, -1171051.9594793597, -1077691.917996827, -1121549.5208390008, -1055019.247363215, -998860.5132271125, -1109416.796701934, -1078076.0827257282, -1107329.3523633105, -1114097.8728085032, -1085664.6716661295, -1024395.5856381113, -1097065.1215931433, -1128144.392531557, -1135148.9951989418, -1073752.9214392675, -1112919.2536920502, -1069977.5726329908, -1038893.7401241313, -1027925.0094623122, -1127299.7220058572, -1137261.1652932002, -1138337.3621637963, -1106163.5839148369, -1122715.1278559219, -1017358.2941517874, -1125720.7649013905, -1054721.3313891198, -1147225.6324080832, -1074611.6239917171, -1121240.1308787356, -1206663.4854227945, -1074412.9658428712, -1127009.0664740081, -1045655.813340661, -1038753.080128172, -1084668.284985078, -1014511.5214477994, -1124771.6243591416, -1082970.071765518, -1094495.4171460625, -1099177.7504788374, -1094938.1419462196, -1079353.7790546739, -1071413.815212901, -1170136.0851734118, -1078273.222113284, -1068416.8643858982, -1117463.4798942984, -1049539.348533327, -1066790.1406096092, -1129225.1147864088, -1067861.9132870047, -1125709.9528170957, -1091263.6053444354, -1130990.141017061, -1050972.8364698354, -1121608.8081056282, -1011935.0360628226, -1080647.0330158896, -1094875.820348163, -1118260.5314985327, -1075260.218833966, -1064679.7424521134, -1027007.6848301772, -1040886.7374235403, -1108704.9387702295, -1109916.8093710574, -1090088.602566346, -1071150.5077673928, -1085720.740597926, -1057593.0801095194, -1051634.4875727657, -1073645.0103440383, -1048923.3828588678, -1155038.8287366142, -1025627.6590138563, -1091803.4104883678, -1059452.9977961187, -1106309.4928598548, -1049786.6389484368, -1067875.762121464, -1077155.4365505192, -1068238.1555375915, -1055920.939936196, -1090628.1039515599], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529503591030188, "mean_inference_ms": 5.220050217005314, "mean_action_processing_ms": 0.14311841323795568, "mean_env_wait_ms": 0.25999413433537577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01512598991394043, "StateBufferConnector_ms": 0.0022573471069335938, "ViewRequirementAgentConnector_ms": 0.05989718437194824}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 67200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1958.84, "learn_time_ms": 18.917, "learn_throughput": 17761.857, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "done": true, "episodes_total": 200, "training_iteration": 200, "trial_id": "6af5f_00000", "experiment_id": "4463d9ae1c404769b1349fab6e52c084", "date": "2024-01-26_10-55-03", "timestamp": 1706266503, "time_this_iter_s": 1.9799096584320068, "time_total_s": 392.67006969451904, "pid": 47188, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb2b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efe927a1900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 392.67006969451904, "timesteps_since_restore": 0, "iterations_since_restore": 200, "warmup_time": 3.0681893825531006, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 25.833333333333332}}
