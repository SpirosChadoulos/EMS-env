{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -498514208.0, "policy_entropy": 4227.8818359375, "var_gnorm": 22.627458572387695, "vf_loss": 2750551687168.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": 0.0, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 1, "diff_num_grad_updates_vs_sampler_policy": 0}}, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "sampler_results": {"episode_reward_max": -559125.1054484426, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -559125.1054484426, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826253579702856, "mean_inference_ms": 5.208948599478611, "mean_action_processing_ms": 0.14770703075193864, "mean_env_wait_ms": 0.2684239463919348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014185905456542969, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.05977153778076172}}, "episode_reward_max": -559125.1054484426, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -559125.1054484426, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826253579702856, "mean_inference_ms": 5.208948599478611, "mean_action_processing_ms": 0.14770703075193864, "mean_env_wait_ms": 0.2684239463919348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014185905456542969, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.05977153778076172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 336, "timers": {"training_iteration_time_ms": 2007.179, "learn_time_ms": 54.52, "learn_throughput": 6162.888, "synch_weights_time_ms": 0.262}, "counters": {"num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-02", "timestamp": 1711724942, "time_this_iter_s": 2.007413625717163, "time_total_s": 2.007413625717163, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577d09ff0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d18ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 2.007413625717163, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.966666666666666, "ram_util_percent": 10.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -494656736.0, "policy_entropy": 5404.16064453125, "var_gnorm": 22.62818145751953, "vf_loss": 1683435814912.0}, "grad_gnorm": 40.0, "vf_explained_var": -5.4836273193359375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 2, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "sampler_results": {"episode_reward_max": -439268.71239131974, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -499196.9089198812, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15888281400155108, "mean_inference_ms": 5.211639206982193, "mean_action_processing_ms": 0.1477891360509075, "mean_env_wait_ms": 0.2689726725318904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014376640319824219, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.060558319091796875}}, "episode_reward_max": -439268.71239131974, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -499196.9089198812, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15888281400155108, "mean_inference_ms": 5.211639206982193, "mean_action_processing_ms": 0.1477891360509075, "mean_env_wait_ms": 0.2689726725318904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014376640319824219, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.060558319091796875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 672, "timers": {"training_iteration_time_ms": 1988.69, "learn_time_ms": 36.545, "learn_throughput": 9194.045, "synch_weights_time_ms": 0.2}, "counters": {"num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-04", "timestamp": 1711724944, "time_this_iter_s": 1.9704351425170898, "time_total_s": 3.977848768234253, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577d5d390>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7c160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 3.977848768234253, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.466666666666666, "ram_util_percent": 10.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -342102176.0, "policy_entropy": 5855.2119140625, "var_gnorm": 22.63177490234375, "vf_loss": 670499340288.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.8715858459472656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 3, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "sampler_results": {"episode_reward_max": -275573.90661837894, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -424655.90815271373, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15891759241988226, "mean_inference_ms": 5.212316028655755, "mean_action_processing_ms": 0.1477628747543911, "mean_env_wait_ms": 0.2691567018472079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014829635620117188, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06058216094970703}}, "episode_reward_max": -275573.90661837894, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -424655.90815271373, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15891759241988226, "mean_inference_ms": 5.212316028655755, "mean_action_processing_ms": 0.1477628747543911, "mean_env_wait_ms": 0.2691567018472079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014829635620117188, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06058216094970703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1008, "timers": {"training_iteration_time_ms": 1981.329, "learn_time_ms": 30.68, "learn_throughput": 10951.696, "synch_weights_time_ms": 0.181}, "counters": {"num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-06", "timestamp": 1711724946, "time_this_iter_s": 1.966844081878662, "time_total_s": 5.944692850112915, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577d5e710>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 5.944692850112915, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 11.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -314169440.0, "policy_entropy": 5853.26171875, "var_gnorm": 22.635637283325195, "vf_loss": 565386870784.0}, "grad_gnorm": 40.0, "vf_explained_var": -3.5643577575683594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 4, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -385235.9844672183, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584700039551083, "mean_inference_ms": 5.209762243617809, "mean_action_processing_ms": 0.14746367936318472, "mean_env_wait_ms": 0.26871601891915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014513731002807617, "StateBufferConnector_ms": 0.0026285648345947266, "ViewRequirementAgentConnector_ms": 0.05990862846374512}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -385235.9844672183, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584700039551083, "mean_inference_ms": 5.209762243617809, "mean_action_processing_ms": 0.14746367936318472, "mean_env_wait_ms": 0.26871601891915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014513731002807617, "StateBufferConnector_ms": 0.0026285648345947266, "ViewRequirementAgentConnector_ms": 0.05990862846374512}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1344, "timers": {"training_iteration_time_ms": 1972.237, "learn_time_ms": 27.758, "learn_throughput": 12104.462, "synch_weights_time_ms": 0.173}, "counters": {"num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-08", "timestamp": 1711724948, "time_this_iter_s": 1.9452240467071533, "time_total_s": 7.889916896820068, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577d5dff0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7dd80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 7.889916896820068, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 11.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -352113984.0, "policy_entropy": 5771.43994140625, "var_gnorm": 22.63760757446289, "vf_loss": 718114914304.0}, "grad_gnorm": 40.0, "vf_explained_var": -3.5762786865234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 5, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -366171.6045284521, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15808738325429522, "mean_inference_ms": 5.208796200357072, "mean_action_processing_ms": 0.14723850477732428, "mean_env_wait_ms": 0.268265480497749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01445770263671875, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06007194519042969}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -366171.6045284521, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15808738325429522, "mean_inference_ms": 5.208796200357072, "mean_action_processing_ms": 0.14723850477732428, "mean_env_wait_ms": 0.268265480497749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01445770263671875, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06007194519042969}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1680, "timers": {"training_iteration_time_ms": 1970.478, "learn_time_ms": 25.951, "learn_throughput": 12947.5, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-10", "timestamp": 1711724950, "time_this_iter_s": 1.9636969566345215, "time_total_s": 9.85361385345459, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577d5e1d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7c040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 9.85361385345459, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.366666666666667, "ram_util_percent": 11.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -342672224.0, "policy_entropy": 5662.81298828125, "var_gnorm": 22.639141082763672, "vf_loss": 669070852096.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -4.780292510986328e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 6, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -351279.599933251, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15770400217762157, "mean_inference_ms": 5.206706340997043, "mean_action_processing_ms": 0.1469958373174125, "mean_env_wait_ms": 0.267739290290756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014460086822509766, "StateBufferConnector_ms": 0.002507368723551432, "ViewRequirementAgentConnector_ms": 0.059866905212402344}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -351279.599933251, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15770400217762157, "mean_inference_ms": 5.206706340997043, "mean_action_processing_ms": 0.1469958373174125, "mean_env_wait_ms": 0.267739290290756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014460086822509766, "StateBufferConnector_ms": 0.002507368723551432, "ViewRequirementAgentConnector_ms": 0.059866905212402344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2016, "timers": {"training_iteration_time_ms": 1965.245, "learn_time_ms": 24.759, "learn_throughput": 13570.837, "synch_weights_time_ms": 0.164}, "counters": {"num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-12", "timestamp": 1711724952, "time_this_iter_s": 1.9393360614776611, "time_total_s": 11.792949914932251, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577d5dea0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7e200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 11.792949914932251, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 11.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -386470656.0, "policy_entropy": 5539.32568359375, "var_gnorm": 22.64063835144043, "vf_loss": 891810742272.0}, "grad_gnorm": 40.0, "vf_explained_var": -3.802776336669922e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 7, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -346379.79200008145, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1573903869434441, "mean_inference_ms": 5.205826601989473, "mean_action_processing_ms": 0.14681167235407136, "mean_env_wait_ms": 0.267279578797217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014322144644601005, "StateBufferConnector_ms": 0.002472741263253348, "ViewRequirementAgentConnector_ms": 0.05965232849121094}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -346379.79200008145, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1573903869434441, "mean_inference_ms": 5.205826601989473, "mean_action_processing_ms": 0.14681167235407136, "mean_env_wait_ms": 0.267279578797217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014322144644601005, "StateBufferConnector_ms": 0.002472741263253348, "ViewRequirementAgentConnector_ms": 0.05965232849121094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2352, "timers": {"training_iteration_time_ms": 1965.391, "learn_time_ms": 23.936, "learn_throughput": 14037.474, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-14", "timestamp": 1711724954, "time_this_iter_s": 1.9665336608886719, "time_total_s": 13.759483575820923, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577be4d00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7eb00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 13.759483575820923, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 11.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -497546016.0, "policy_entropy": 5445.8310546875, "var_gnorm": 22.64194107055664, "vf_loss": 732742418432.0}, "grad_gnorm": 40.0, "vf_explained_var": -5.5789947509765625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 8, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -341577.7785821174, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15710778162493486, "mean_inference_ms": 5.205466954729831, "mean_action_processing_ms": 0.1466677033328399, "mean_env_wait_ms": 0.2668803749976594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014233589172363281, "StateBufferConnector_ms": 0.0024646520614624023, "ViewRequirementAgentConnector_ms": 0.0593721866607666}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -341577.7785821174, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15710778162493486, "mean_inference_ms": 5.205466954729831, "mean_action_processing_ms": 0.1466677033328399, "mean_env_wait_ms": 0.2668803749976594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014233589172363281, "StateBufferConnector_ms": 0.0024646520614624023, "ViewRequirementAgentConnector_ms": 0.0593721866607666}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1965.2, "learn_time_ms": 23.34, "learn_throughput": 14395.73, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-16", "timestamp": 1711724956, "time_this_iter_s": 1.9641244411468506, "time_total_s": 15.723608016967773, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577be5180>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7ef80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 15.723608016967773, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 11.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -795158400.0, "policy_entropy": 5348.16259765625, "var_gnorm": 22.643587112426758, "vf_loss": 601641320448.0}, "grad_gnorm": 40.0, "vf_explained_var": -5.078315734863281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 9, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "sampler_results": {"episode_reward_max": -259054.68931133774, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -332408.5464409196, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15684294796948303, "mean_inference_ms": 5.204962817597593, "mean_action_processing_ms": 0.1465282599672978, "mean_env_wait_ms": 0.2664921383980787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014183256361219618, "StateBufferConnector_ms": 0.0024424658881293405, "ViewRequirementAgentConnector_ms": 0.059403313530815974}}, "episode_reward_max": -259054.68931133774, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -332408.5464409196, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15684294796948303, "mean_inference_ms": 5.204962817597593, "mean_action_processing_ms": 0.1465282599672978, "mean_env_wait_ms": 0.2664921383980787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014183256361219618, "StateBufferConnector_ms": 0.0024424658881293405, "ViewRequirementAgentConnector_ms": 0.059403313530815974}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3024, "timers": {"training_iteration_time_ms": 1963.484, "learn_time_ms": 22.852, "learn_throughput": 14703.344, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-18", "timestamp": 1711724958, "time_this_iter_s": 1.950035572052002, "time_total_s": 17.673643589019775, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577be5810>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7f5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 17.673643589019775, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 11.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4165850880.0, "policy_entropy": 5248.966796875, "var_gnorm": 22.645668029785156, "vf_loss": 492035473408.0}, "grad_gnorm": 39.99999237060547, "vf_explained_var": -6.723403930664062e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 10, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322949.44302083476, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1566148948131154, "mean_inference_ms": 5.2049194327573, "mean_action_processing_ms": 0.14640725563036322, "mean_env_wait_ms": 0.26615792300451663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01416921615600586, "StateBufferConnector_ms": 0.0024318695068359375, "ViewRequirementAgentConnector_ms": 0.05936861038208008}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322949.44302083476, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1566148948131154, "mean_inference_ms": 5.2049194327573, "mean_action_processing_ms": 0.14640725563036322, "mean_env_wait_ms": 0.26615792300451663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01416921615600586, "StateBufferConnector_ms": 0.0024318695068359375, "ViewRequirementAgentConnector_ms": 0.05936861038208008}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3360, "timers": {"training_iteration_time_ms": 1964.238, "learn_time_ms": 22.627, "learn_throughput": 14849.519, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-20", "timestamp": 1711724960, "time_this_iter_s": 1.9713022708892822, "time_total_s": 19.644945859909058, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577be7280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c60820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 19.644945859909058, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 11.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3421716224.0, "policy_entropy": 5173.9814453125, "var_gnorm": 22.647172927856445, "vf_loss": 599346249728.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -6.878376007080078e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 11, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -316997.21898193745, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15640245326684032, "mean_inference_ms": 5.20466829079851, "mean_action_processing_ms": 0.14628216921063586, "mean_env_wait_ms": 0.2658547757756339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014764612371271307, "StateBufferConnector_ms": 0.0024275346235795455, "ViewRequirementAgentConnector_ms": 0.05928386341441761}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -316997.21898193745, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15640245326684032, "mean_inference_ms": 5.20466829079851, "mean_action_processing_ms": 0.14628216921063586, "mean_env_wait_ms": 0.2658547757756339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014764612371271307, "StateBufferConnector_ms": 0.0024275346235795455, "ViewRequirementAgentConnector_ms": 0.05928386341441761}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3696, "timers": {"training_iteration_time_ms": 1958.268, "learn_time_ms": 19.036, "learn_throughput": 17650.915, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-22", "timestamp": 1711724962, "time_this_iter_s": 1.9477488994598389, "time_total_s": 21.592694759368896, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577be5e40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7f250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 21.592694759368896, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 11.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -88162934784.0, "policy_entropy": 5097.75927734375, "var_gnorm": 22.64937973022461, "vf_loss": 785534615552.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -5.8650970458984375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 12, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -315745.35246933735, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15619688043464833, "mean_inference_ms": 5.204202563499302, "mean_action_processing_ms": 0.14616526172703395, "mean_env_wait_ms": 0.2655844857936539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014730294545491537, "StateBufferConnector_ms": 0.0024219353993733725, "ViewRequirementAgentConnector_ms": 0.05913972854614258}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -315745.35246933735, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15619688043464833, "mean_inference_ms": 5.204202563499302, "mean_action_processing_ms": 0.14616526172703395, "mean_env_wait_ms": 0.2655844857936539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014730294545491537, "StateBufferConnector_ms": 0.0024219353993733725, "ViewRequirementAgentConnector_ms": 0.05913972854614258}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4032, "timers": {"training_iteration_time_ms": 1955.55, "learn_time_ms": 19.026, "learn_throughput": 17659.873, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-24", "timestamp": 1711724964, "time_this_iter_s": 1.9433095455169678, "time_total_s": 23.536004304885864, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c805b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c61090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 23.536004304885864, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 11.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -242445975552.0, "policy_entropy": 5023.4072265625, "var_gnorm": 22.652196884155273, "vf_loss": 698783367168.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -6.818771362304688e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 13, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -313071.852759611, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1560173752240282, "mean_inference_ms": 5.203915168594092, "mean_action_processing_ms": 0.1460644453175784, "mean_env_wait_ms": 0.2653344692647747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014660908625676082, "StateBufferConnector_ms": 0.0024208655724158655, "ViewRequirementAgentConnector_ms": 0.05916448739858774}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -313071.852759611, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1560173752240282, "mean_inference_ms": 5.203915168594092, "mean_action_processing_ms": 0.1460644453175784, "mean_env_wait_ms": 0.2653344692647747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014660908625676082, "StateBufferConnector_ms": 0.0024208655724158655, "ViewRequirementAgentConnector_ms": 0.05916448739858774}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4368, "timers": {"training_iteration_time_ms": 1955.098, "learn_time_ms": 19.039, "learn_throughput": 17647.931, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-26", "timestamp": 1711724966, "time_this_iter_s": 1.9623310565948486, "time_total_s": 25.498335361480713, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577be7100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c60280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 25.498335361480713, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 11.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3583803916288.0, "policy_entropy": 4949.8037109375, "var_gnorm": 22.65565299987793, "vf_loss": 641218772992.0}, "grad_gnorm": 40.0, "vf_explained_var": -7.152557373046875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 14, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -309888.0233908886, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15584674274948748, "mean_inference_ms": 5.203441077266062, "mean_action_processing_ms": 0.1459705654284729, "mean_env_wait_ms": 0.2650984194223169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014604840959821428, "StateBufferConnector_ms": 0.0024148396083286832, "ViewRequirementAgentConnector_ms": 0.05909034184047154}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -309888.0233908886, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15584674274948748, "mean_inference_ms": 5.203441077266062, "mean_action_processing_ms": 0.1459705654284729, "mean_env_wait_ms": 0.2650984194223169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014604840959821428, "StateBufferConnector_ms": 0.0024148396083286832, "ViewRequirementAgentConnector_ms": 0.05909034184047154}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4704, "timers": {"training_iteration_time_ms": 1954.56, "learn_time_ms": 19.014, "learn_throughput": 17671.189, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-28", "timestamp": 1711724968, "time_this_iter_s": 1.9398577213287354, "time_total_s": 27.43819308280945, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c81600>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c61bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 27.43819308280945, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 12.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -493920802832384.0, "policy_entropy": 4875.1123046875, "var_gnorm": 22.659696578979492, "vf_loss": 587884199936.0}, "grad_gnorm": 0.0, "vf_explained_var": -9.500980377197266e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 15, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -306622.70966630895, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1556850586113816, "mean_inference_ms": 5.202895112488078, "mean_action_processing_ms": 0.1458818929687464, "mean_env_wait_ms": 0.2648788534808086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014557838439941406, "StateBufferConnector_ms": 0.0024096171061197915, "ViewRequirementAgentConnector_ms": 0.05911032358805338}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -306622.70966630895, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1556850586113816, "mean_inference_ms": 5.202895112488078, "mean_action_processing_ms": 0.1458818929687464, "mean_env_wait_ms": 0.2648788534808086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014557838439941406, "StateBufferConnector_ms": 0.0024096171061197915, "ViewRequirementAgentConnector_ms": 0.05911032358805338}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 1952.562, "learn_time_ms": 19.028, "learn_throughput": 17657.948, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-29", "timestamp": 1711724969, "time_this_iter_s": 1.9437484741210938, "time_total_s": 29.381941556930542, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577be5870>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c61870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 29.381941556930542, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 12.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -256913182818304.0, "policy_entropy": 4798.595703125, "var_gnorm": 22.66360092163086, "vf_loss": 673593819136.0}, "grad_gnorm": 0.0, "vf_explained_var": -9.012222290039062e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 16, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -304701.0789985366, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15554533154156072, "mean_inference_ms": 5.202519531241446, "mean_action_processing_ms": 0.14580617012907704, "mean_env_wait_ms": 0.26468871734873245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014513731002807617, "StateBufferConnector_ms": 0.002415478229522705, "ViewRequirementAgentConnector_ms": 0.059100985527038574}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -304701.0789985366, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15554533154156072, "mean_inference_ms": 5.202519531241446, "mean_action_processing_ms": 0.14580617012907704, "mean_env_wait_ms": 0.26468871734873245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014513731002807617, "StateBufferConnector_ms": 0.002415478229522705, "ViewRequirementAgentConnector_ms": 0.059100985527038574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 1955.16, "learn_time_ms": 19.047, "learn_throughput": 17640.134, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-31", "timestamp": 1711724971, "time_this_iter_s": 1.965348243713379, "time_total_s": 31.34728980064392, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c82560>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c62680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 31.34728980064392, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 12.199999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.084122884673372e+17, "policy_entropy": 4727.5439453125, "var_gnorm": 22.667341232299805, "vf_loss": 657533960192.0}, "grad_gnorm": 0.0, "vf_explained_var": -8.928775787353516e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 17, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -303037.9286625544, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15542482394218246, "mean_inference_ms": 5.202113799959079, "mean_action_processing_ms": 0.1457414182170696, "mean_env_wait_ms": 0.26451913898021345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014509874231675091, "StateBufferConnector_ms": 0.002406625186695772, "ViewRequirementAgentConnector_ms": 0.059223175048828125}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -303037.9286625544, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15542482394218246, "mean_inference_ms": 5.202113799959079, "mean_action_processing_ms": 0.1457414182170696, "mean_env_wait_ms": 0.26451913898021345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014509874231675091, "StateBufferConnector_ms": 0.002406625186695772, "ViewRequirementAgentConnector_ms": 0.059223175048828125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5712, "timers": {"training_iteration_time_ms": 1953.448, "learn_time_ms": 19.018, "learn_throughput": 17667.223, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "done": false, "episodes_total": 17, "training_iteration": 17, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-33", "timestamp": 1711724973, "time_this_iter_s": 1.9494249820709229, "time_total_s": 33.296714782714844, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577be7730>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c60ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 33.296714782714844, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 12.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.1075382531239444e+18, "policy_entropy": 4658.33544921875, "var_gnorm": 22.670900344848633, "vf_loss": 759148707840.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.000110626220703125, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 18, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -302297.93950121565, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553201371306258, "mean_inference_ms": 5.2018987839693525, "mean_action_processing_ms": 0.14568647480809932, "mean_env_wait_ms": 0.26436766383518157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014608436160617404, "StateBufferConnector_ms": 0.0024159749348958335, "ViewRequirementAgentConnector_ms": 0.059594048394097224}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -302297.93950121565, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553201371306258, "mean_inference_ms": 5.2018987839693525, "mean_action_processing_ms": 0.14568647480809932, "mean_env_wait_ms": 0.26436766383518157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014608436160617404, "StateBufferConnector_ms": 0.0024159749348958335, "ViewRequirementAgentConnector_ms": 0.059594048394097224}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6048, "timers": {"training_iteration_time_ms": 1954.297, "learn_time_ms": 19.006, "learn_throughput": 17678.659, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "done": false, "episodes_total": 18, "training_iteration": 18, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-35", "timestamp": 1711724975, "time_this_iter_s": 1.9726576805114746, "time_total_s": 35.26937246322632, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c81720>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c62ef0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 35.26937246322632, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 12.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0787946296854446e+19, "policy_entropy": 4592.20703125, "var_gnorm": 22.67426872253418, "vf_loss": 535478730752.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001100301742553711, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 19, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -299236.9723441981, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15523065909761344, "mean_inference_ms": 5.201664946389754, "mean_action_processing_ms": 0.14563763800173876, "mean_env_wait_ms": 0.26422929622957964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015071818703099302, "StateBufferConnector_ms": 0.0024168114913137337, "ViewRequirementAgentConnector_ms": 0.059604644775390625}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -299236.9723441981, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15523065909761344, "mean_inference_ms": 5.201664946389754, "mean_action_processing_ms": 0.14563763800173876, "mean_env_wait_ms": 0.26422929622957964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015071818703099302, "StateBufferConnector_ms": 0.0024168114913137337, "ViewRequirementAgentConnector_ms": 0.059604644775390625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6384, "timers": {"training_iteration_time_ms": 1954.511, "learn_time_ms": 18.999, "learn_throughput": 17685.537, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "done": false, "episodes_total": 19, "training_iteration": 19, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-37", "timestamp": 1711724977, "time_this_iter_s": 1.952197790145874, "time_total_s": 37.22157025337219, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c814b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c62170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 37.22157025337219, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 12.433333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.371180156584198e+19, "policy_entropy": 4527.5751953125, "var_gnorm": 22.677444458007812, "vf_loss": 762339000320.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001024007797241211, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 20, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -298895.37924292067, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15514623276874423, "mean_inference_ms": 5.201380183123876, "mean_action_processing_ms": 0.1455913662195762, "mean_env_wait_ms": 0.26410080351740606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01501321792602539, "StateBufferConnector_ms": 0.0024127960205078125, "ViewRequirementAgentConnector_ms": 0.059577226638793945}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -298895.37924292067, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15514623276874423, "mean_inference_ms": 5.201380183123876, "mean_action_processing_ms": 0.1455913662195762, "mean_env_wait_ms": 0.26410080351740606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01501321792602539, "StateBufferConnector_ms": 0.0024127960205078125, "ViewRequirementAgentConnector_ms": 0.059577226638793945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6720, "timers": {"training_iteration_time_ms": 1951.914, "learn_time_ms": 18.818, "learn_throughput": 17855.338, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-39", "timestamp": 1711724979, "time_this_iter_s": 1.9453492164611816, "time_total_s": 39.166919469833374, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c849d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c63ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 39.166919469833374, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 12.533333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6785480168538143e+21, "policy_entropy": 4469.4013671875, "var_gnorm": 22.6804256439209, "vf_loss": 598455156736.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012993812561035156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 21, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -297313.9206370427, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1550700468551436, "mean_inference_ms": 5.20105668563568, "mean_action_processing_ms": 0.14554548266235032, "mean_env_wait_ms": 0.2639798504833686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014986310686383928, "StateBufferConnector_ms": 0.0024137042817615325, "ViewRequirementAgentConnector_ms": 0.05966822306315104}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -297313.9206370427, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1550700468551436, "mean_inference_ms": 5.20105668563568, "mean_action_processing_ms": 0.14554548266235032, "mean_env_wait_ms": 0.2639798504833686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014986310686383928, "StateBufferConnector_ms": 0.0024137042817615325, "ViewRequirementAgentConnector_ms": 0.05966822306315104}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7056, "timers": {"training_iteration_time_ms": 1951.665, "learn_time_ms": 18.859, "learn_throughput": 17816.017, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "done": false, "episodes_total": 21, "training_iteration": 21, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-41", "timestamp": 1711724981, "time_this_iter_s": 1.9452869892120361, "time_total_s": 41.11220645904541, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c81690>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c63760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 41.11220645904541, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.433333333333334, "ram_util_percent": 12.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.083474851960663e+21, "policy_entropy": 4412.04052734375, "var_gnorm": 22.68321418762207, "vf_loss": 523637948416.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012433528900146484, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 22, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -295093.7579018761, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15502177280930088, "mean_inference_ms": 5.201180595280529, "mean_action_processing_ms": 0.1455224500156312, "mean_env_wait_ms": 0.26390256458898137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014985691417347301, "StateBufferConnector_ms": 0.0024156136946244674, "ViewRequirementAgentConnector_ms": 0.05986907265403054}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -295093.7579018761, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15502177280930088, "mean_inference_ms": 5.201180595280529, "mean_action_processing_ms": 0.1455224500156312, "mean_env_wait_ms": 0.26390256458898137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014985691417347301, "StateBufferConnector_ms": 0.0024156136946244674, "ViewRequirementAgentConnector_ms": 0.05986907265403054}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7392, "timers": {"training_iteration_time_ms": 1960.84, "learn_time_ms": 18.837, "learn_throughput": 17837.439, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "done": false, "episodes_total": 22, "training_iteration": 22, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-43", "timestamp": 1711724983, "time_this_iter_s": 2.0350754261016846, "time_total_s": 43.147281885147095, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c85570>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9c280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 43.147281885147095, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 12.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.940453721654139e+23, "policy_entropy": 4359.66064453125, "var_gnorm": 22.685815811157227, "vf_loss": 620762497024.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012314319610595703, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 23, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -293851.0296158577, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1549830017473072, "mean_inference_ms": 5.201313072953423, "mean_action_processing_ms": 0.1455023240046332, "mean_env_wait_ms": 0.2638364707865158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014946771704632303, "StateBufferConnector_ms": 0.0024121740589971128, "ViewRequirementAgentConnector_ms": 0.05992184514584749}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -293851.0296158577, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1549830017473072, "mean_inference_ms": 5.201313072953423, "mean_action_processing_ms": 0.1455023240046332, "mean_env_wait_ms": 0.2638364707865158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014946771704632303, "StateBufferConnector_ms": 0.0024121740589971128, "ViewRequirementAgentConnector_ms": 0.05992184514584749}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7728, "timers": {"training_iteration_time_ms": 1961.115, "learn_time_ms": 18.862, "learn_throughput": 17813.27, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "done": false, "episodes_total": 23, "training_iteration": 23, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-45", "timestamp": 1711724985, "time_this_iter_s": 1.9651448726654053, "time_total_s": 45.1124267578125, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c83250>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c63880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 45.1124267578125, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.366666666666667, "ram_util_percent": 12.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.8592646290117548e+24, "policy_entropy": 4311.759765625, "var_gnorm": 22.68824005126953, "vf_loss": 508002467840.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001283884048461914, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 24, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -291747.17140458454, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15495070687931758, "mean_inference_ms": 5.2014756245728995, "mean_action_processing_ms": 0.1454850891592162, "mean_env_wait_ms": 0.2637775256336485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014918049176534018, "StateBufferConnector_ms": 0.002406040827433268, "ViewRequirementAgentConnector_ms": 0.05999406178792318}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -291747.17140458454, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15495070687931758, "mean_inference_ms": 5.2014756245728995, "mean_action_processing_ms": 0.1454850891592162, "mean_env_wait_ms": 0.2637775256336485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014918049176534018, "StateBufferConnector_ms": 0.002406040827433268, "ViewRequirementAgentConnector_ms": 0.05999406178792318}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1963.983, "learn_time_ms": 18.854, "learn_throughput": 17821.176, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-47", "timestamp": 1711724987, "time_this_iter_s": 1.968548059463501, "time_total_s": 47.080974817276, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c85450>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9c3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 47.080974817276, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.75, "ram_util_percent": 12.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.453889468328878e+24, "policy_entropy": 4265.466796875, "var_gnorm": 22.69049072265625, "vf_loss": 656045703168.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013840198516845703, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 25, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -291339.391095224, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15493818456502959, "mean_inference_ms": 5.201830119061629, "mean_action_processing_ms": 0.14547854112935305, "mean_env_wait_ms": 0.26374221248193563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014867782592773438, "StateBufferConnector_ms": 0.0024023056030273438, "ViewRequirementAgentConnector_ms": 0.060006141662597656}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -291339.391095224, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15493818456502959, "mean_inference_ms": 5.201830119061629, "mean_action_processing_ms": 0.14547854112935305, "mean_env_wait_ms": 0.26374221248193563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014867782592773438, "StateBufferConnector_ms": 0.0024023056030273438, "ViewRequirementAgentConnector_ms": 0.060006141662597656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 1970.892, "learn_time_ms": 18.862, "learn_throughput": 17813.292, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "done": false, "episodes_total": 25, "training_iteration": 25, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-49", "timestamp": 1711724989, "time_this_iter_s": 2.012852668762207, "time_total_s": 49.09382748603821, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c83a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c63b50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 49.09382748603821, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.266666666666667, "ram_util_percent": 13.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.277626996366762e+25, "policy_entropy": 4222.36083984375, "var_gnorm": 22.692577362060547, "vf_loss": 672731627520.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012612342834472656, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 26, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -290773.5722023282, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15492994241240343, "mean_inference_ms": 5.202166823120693, "mean_action_processing_ms": 0.1454738208902094, "mean_env_wait_ms": 0.26370997482733155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014880987314077524, "StateBufferConnector_ms": 0.002399774698110727, "ViewRequirementAgentConnector_ms": 0.06007597996638371}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -290773.5722023282, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15492994241240343, "mean_inference_ms": 5.202166823120693, "mean_action_processing_ms": 0.1454738208902094, "mean_env_wait_ms": 0.26370997482733155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014880987314077524, "StateBufferConnector_ms": 0.002399774698110727, "ViewRequirementAgentConnector_ms": 0.06007597996638371}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8736, "timers": {"training_iteration_time_ms": 1970.981, "learn_time_ms": 18.935, "learn_throughput": 17744.771, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "done": false, "episodes_total": 26, "training_iteration": 26, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-51", "timestamp": 1711724991, "time_this_iter_s": 1.9662814140319824, "time_total_s": 51.06010890007019, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c865f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 51.06010890007019, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 13.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1392874238282479e+26, "policy_entropy": 4183.47607421875, "var_gnorm": 22.694507598876953, "vf_loss": 608392445952.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015270709991455078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 27, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -289998.7938943905, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15492263562972539, "mean_inference_ms": 5.202510025659134, "mean_action_processing_ms": 0.1454696459844946, "mean_env_wait_ms": 0.2636785562532505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014864956891095196, "StateBufferConnector_ms": 0.002399197331181279, "ViewRequirementAgentConnector_ms": 0.0600929613466616}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -289998.7938943905, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15492263562972539, "mean_inference_ms": 5.202510025659134, "mean_action_processing_ms": 0.1454696459844946, "mean_env_wait_ms": 0.2636785562532505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014864956891095196, "StateBufferConnector_ms": 0.002399197331181279, "ViewRequirementAgentConnector_ms": 0.0600929613466616}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9072, "timers": {"training_iteration_time_ms": 1973.027, "learn_time_ms": 18.976, "learn_throughput": 17707.002, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "done": false, "episodes_total": 27, "training_iteration": 27, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-53", "timestamp": 1711724993, "time_this_iter_s": 1.9699227809906006, "time_total_s": 53.03003168106079, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c84640>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7cd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 53.03003168106079, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.699999999999999, "ram_util_percent": 13.199999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.724169995660089e+26, "policy_entropy": 4148.11962890625, "var_gnorm": 22.696292877197266, "vf_loss": 662213558272.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013935565948486328, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 28, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -289416.1425887154, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15491591990706952, "mean_inference_ms": 5.20283275832844, "mean_action_processing_ms": 0.14546533636066156, "mean_env_wait_ms": 0.26365108655966607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014883279800415039, "StateBufferConnector_ms": 0.002400364194597517, "ViewRequirementAgentConnector_ms": 0.06028584071568081}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -289416.1425887154, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15491591990706952, "mean_inference_ms": 5.20283275832844, "mean_action_processing_ms": 0.14546533636066156, "mean_env_wait_ms": 0.26365108655966607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014883279800415039, "StateBufferConnector_ms": 0.002400364194597517, "ViewRequirementAgentConnector_ms": 0.06028584071568081}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9408, "timers": {"training_iteration_time_ms": 1972.145, "learn_time_ms": 18.952, "learn_throughput": 17728.877, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-55", "timestamp": 1711724995, "time_this_iter_s": 1.9638466835021973, "time_total_s": 54.99387836456299, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c87520>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9d6c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 54.99387836456299, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.052546083210546e+27, "policy_entropy": 4112.8115234375, "var_gnorm": 22.697938919067383, "vf_loss": 555092606976.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016868114471435547, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 29, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -288098.5835305609, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15490890609795077, "mean_inference_ms": 5.203075495850138, "mean_action_processing_ms": 0.14545909310027433, "mean_env_wait_ms": 0.26362070964783596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014843611881650728, "StateBufferConnector_ms": 0.00239733991951778, "ViewRequirementAgentConnector_ms": 0.0602993471869107}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -288098.5835305609, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15490890609795077, "mean_inference_ms": 5.203075495850138, "mean_action_processing_ms": 0.14545909310027433, "mean_env_wait_ms": 0.26362070964783596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014843611881650728, "StateBufferConnector_ms": 0.00239733991951778, "ViewRequirementAgentConnector_ms": 0.0602993471869107}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9744, "timers": {"training_iteration_time_ms": 1971.296, "learn_time_ms": 18.928, "learn_throughput": 17751.566, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "done": false, "episodes_total": 29, "training_iteration": 29, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-57", "timestamp": 1711724997, "time_this_iter_s": 1.9437344074249268, "time_total_s": 56.937612771987915, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c86fe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c63ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 56.937612771987915, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 13.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.992139256746287e+26, "policy_entropy": 4081.781982421875, "var_gnorm": 22.6994571685791, "vf_loss": 557402750976.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001506805419921875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 30, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -287024.75080079224, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1549022304223359, "mean_inference_ms": 5.2033102136672555, "mean_action_processing_ms": 0.14545215360647162, "mean_env_wait_ms": 0.2635889275148942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015077590942382812, "StateBufferConnector_ms": 0.002396106719970703, "ViewRequirementAgentConnector_ms": 0.060280958811442055}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -287024.75080079224, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1549022304223359, "mean_inference_ms": 5.2033102136672555, "mean_action_processing_ms": 0.14545215360647162, "mean_env_wait_ms": 0.2635889275148942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015077590942382812, "StateBufferConnector_ms": 0.002396106719970703, "ViewRequirementAgentConnector_ms": 0.060280958811442055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10080, "timers": {"training_iteration_time_ms": 1973.126, "learn_time_ms": 19.008, "learn_throughput": 17676.974, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "done": false, "episodes_total": 30, "training_iteration": 30, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-09-59", "timestamp": 1711724999, "time_this_iter_s": 1.9636802673339844, "time_total_s": 58.9012930393219, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acca30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9dcf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 58.9012930393219, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 13.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2718586726669156e+28, "policy_entropy": 4052.56884765625, "var_gnorm": 22.70085334777832, "vf_loss": 653049724928.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014221668243408203, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 31, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286780.9643331845, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15489373675311272, "mean_inference_ms": 5.2035312903038395, "mean_action_processing_ms": 0.1454436432281549, "mean_env_wait_ms": 0.26355635535455946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015031137774067541, "StateBufferConnector_ms": 0.002394953081684728, "ViewRequirementAgentConnector_ms": 0.060217611251338836}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286780.9643331845, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15489373675311272, "mean_inference_ms": 5.2035312903038395, "mean_action_processing_ms": 0.1454436432281549, "mean_env_wait_ms": 0.26355635535455946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015031137774067541, "StateBufferConnector_ms": 0.002394953081684728, "ViewRequirementAgentConnector_ms": 0.060217611251338836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10416, "timers": {"training_iteration_time_ms": 1974.558, "learn_time_ms": 18.952, "learn_throughput": 17729.167, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "done": false, "episodes_total": 31, "training_iteration": 31, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-01", "timestamp": 1711725001, "time_this_iter_s": 1.959622859954834, "time_total_s": 60.86091589927673, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c85d20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 60.86091589927673, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 13.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.3916599780053184e+28, "policy_entropy": 4026.86474609375, "var_gnorm": 22.702136993408203, "vf_loss": 690934841344.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001443624496459961, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 32, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286544.3992261889, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15488735683378457, "mean_inference_ms": 5.203772785491475, "mean_action_processing_ms": 0.1454353571742792, "mean_env_wait_ms": 0.26352590818734245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015043467283248901, "StateBufferConnector_ms": 0.002393871545791626, "ViewRequirementAgentConnector_ms": 0.060258060693740845}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286544.3992261889, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15488735683378457, "mean_inference_ms": 5.203772785491475, "mean_action_processing_ms": 0.1454353571742792, "mean_env_wait_ms": 0.26352590818734245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015043467283248901, "StateBufferConnector_ms": 0.002393871545791626, "ViewRequirementAgentConnector_ms": 0.060258060693740845}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1968.513, "learn_time_ms": 19.065, "learn_throughput": 17623.765, "synch_weights_time_ms": 0.162}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 32, "training_iteration": 32, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-03", "timestamp": 1711725003, "time_this_iter_s": 1.9746501445770264, "time_total_s": 62.83556604385376, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acd930>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9e680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 62.83556604385376, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 13.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.897496343217764e+29, "policy_entropy": 4001.549072265625, "var_gnorm": 22.703319549560547, "vf_loss": 780300517376.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015556812286376953, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 33, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -287128.2446398398, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15488078770224725, "mean_inference_ms": 5.204011566094062, "mean_action_processing_ms": 0.14542685204091554, "mean_env_wait_ms": 0.2634945527855231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01501025575580019, "StateBufferConnector_ms": 0.0023906881159002132, "ViewRequirementAgentConnector_ms": 0.06023248036702474}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -287128.2446398398, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15488078770224725, "mean_inference_ms": 5.204011566094062, "mean_action_processing_ms": 0.14542685204091554, "mean_env_wait_ms": 0.2634945527855231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01501025575580019, "StateBufferConnector_ms": 0.0023906881159002132, "ViewRequirementAgentConnector_ms": 0.06023248036702474}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11088, "timers": {"training_iteration_time_ms": 1968.46, "learn_time_ms": 18.974, "learn_throughput": 17708.738, "synch_weights_time_ms": 0.162}, "counters": {"num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "done": false, "episodes_total": 33, "training_iteration": 33, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-05", "timestamp": 1711725005, "time_this_iter_s": 1.964637279510498, "time_total_s": 64.80020332336426, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c829e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9e200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 64.80020332336426, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 13.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.685281266643022e+28, "policy_entropy": 3980.3369140625, "var_gnorm": 22.70440101623535, "vf_loss": 662962241536.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014197826385498047, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 34, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286860.8718262558, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548779217373236, "mean_inference_ms": 5.204259031886955, "mean_action_processing_ms": 0.14541958588654563, "mean_env_wait_ms": 0.2634658113732734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015007748323328355, "StateBufferConnector_ms": 0.0023918993332806755, "ViewRequirementAgentConnector_ms": 0.060287643881405104}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286860.8718262558, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548779217373236, "mean_inference_ms": 5.204259031886955, "mean_action_processing_ms": 0.14541958588654563, "mean_env_wait_ms": 0.2634658113732734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015007748323328355, "StateBufferConnector_ms": 0.0023918993332806755, "ViewRequirementAgentConnector_ms": 0.060287643881405104}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11424, "timers": {"training_iteration_time_ms": 1968.943, "learn_time_ms": 19.028, "learn_throughput": 17657.749, "synch_weights_time_ms": 0.165}, "counters": {"num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "done": false, "episodes_total": 34, "training_iteration": 34, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-07", "timestamp": 1711725007, "time_this_iter_s": 1.9734101295471191, "time_total_s": 66.77361345291138, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acf1c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9ef80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 66.77361345291138, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.3999999999999995, "ram_util_percent": 13.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0348646045486511e+30, "policy_entropy": 3958.932861328125, "var_gnorm": 22.705394744873047, "vf_loss": 691408273408.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017571449279785156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 35, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286826.040688271, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548757118474865, "mean_inference_ms": 5.204466228011814, "mean_action_processing_ms": 0.14541248305635157, "mean_env_wait_ms": 0.26343860456367507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014976092747279577, "StateBufferConnector_ms": 0.0023903165544782367, "ViewRequirementAgentConnector_ms": 0.060294696262904575}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286826.040688271, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548757118474865, "mean_inference_ms": 5.204466228011814, "mean_action_processing_ms": 0.14541248305635157, "mean_env_wait_ms": 0.26343860456367507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014976092747279577, "StateBufferConnector_ms": 0.0023903165544782367, "ViewRequirementAgentConnector_ms": 0.060294696262904575}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11760, "timers": {"training_iteration_time_ms": 1962.82, "learn_time_ms": 18.993, "learn_throughput": 17690.865, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "done": false, "episodes_total": 35, "training_iteration": 35, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-09", "timestamp": 1711725009, "time_this_iter_s": 1.9516568183898926, "time_total_s": 68.72527027130127, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c86a10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9e950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 68.72527027130127, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 13.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.278402242194837e+30, "policy_entropy": 3941.08740234375, "var_gnorm": 22.7063045501709, "vf_loss": 655928590336.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001308917999267578, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 36, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286540.0648088616, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487103448352213, "mean_inference_ms": 5.20459918030323, "mean_action_processing_ms": 0.14540339746337683, "mean_env_wait_ms": 0.2634075934565845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01494023534986708, "StateBufferConnector_ms": 0.0023874971601698133, "ViewRequirementAgentConnector_ms": 0.06028877364264594}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286540.0648088616, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487103448352213, "mean_inference_ms": 5.20459918030323, "mean_action_processing_ms": 0.14540339746337683, "mean_env_wait_ms": 0.2634075934565845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01494023534986708, "StateBufferConnector_ms": 0.0023874971601698133, "ViewRequirementAgentConnector_ms": 0.06028877364264594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12096, "timers": {"training_iteration_time_ms": 1959.264, "learn_time_ms": 18.931, "learn_throughput": 17748.458, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "done": false, "episodes_total": 36, "training_iteration": 36, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-11", "timestamp": 1711725011, "time_this_iter_s": 1.9307293891906738, "time_total_s": 70.65599966049194, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c865f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9d1b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 70.65599966049194, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 14.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2261983472623732e+30, "policy_entropy": 3923.54296875, "var_gnorm": 22.70713996887207, "vf_loss": 727907172352.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012671947479248047, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 37, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286269.8206711838, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15486599895675018, "mean_inference_ms": 5.204704644851934, "mean_action_processing_ms": 0.14539340785988694, "mean_env_wait_ms": 0.2633763777710847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014931446797138936, "StateBufferConnector_ms": 0.0023874076637061866, "ViewRequirementAgentConnector_ms": 0.06029219240755648}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286269.8206711838, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15486599895675018, "mean_inference_ms": 5.204704644851934, "mean_action_processing_ms": 0.14539340785988694, "mean_env_wait_ms": 0.2633763777710847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014931446797138936, "StateBufferConnector_ms": 0.0023874076637061866, "ViewRequirementAgentConnector_ms": 0.06029219240755648}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12432, "timers": {"training_iteration_time_ms": 1957.374, "learn_time_ms": 18.983, "learn_throughput": 17700.219, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "done": false, "episodes_total": 37, "training_iteration": 37, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-13", "timestamp": 1711725013, "time_this_iter_s": 1.9510395526885986, "time_total_s": 72.60703921318054, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acfdc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9f6d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 72.60703921318054, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 14.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.7514152929945166e+30, "policy_entropy": 3907.1064453125, "var_gnorm": 22.707904815673828, "vf_loss": 632446582784.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001398324966430664, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 38, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285877.59085560247, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15486195024922597, "mean_inference_ms": 5.204826396231445, "mean_action_processing_ms": 0.14538385061771555, "mean_env_wait_ms": 0.26334607929083786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015069309033845601, "StateBufferConnector_ms": 0.0023860680429559004, "ViewRequirementAgentConnector_ms": 0.060264060371800474}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285877.59085560247, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15486195024922597, "mean_inference_ms": 5.204826396231445, "mean_action_processing_ms": 0.14538385061771555, "mean_env_wait_ms": 0.26334607929083786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015069309033845601, "StateBufferConnector_ms": 0.0023860680429559004, "ViewRequirementAgentConnector_ms": 0.060264060371800474}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12768, "timers": {"training_iteration_time_ms": 1958.185, "learn_time_ms": 19.016, "learn_throughput": 17669.35, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "done": false, "episodes_total": 38, "training_iteration": 38, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-15", "timestamp": 1711725015, "time_this_iter_s": 1.9720008373260498, "time_total_s": 74.57904005050659, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acf9d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9fa30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 74.57904005050659, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 14.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1277812678911117e+31, "policy_entropy": 3892.844970703125, "var_gnorm": 22.708600997924805, "vf_loss": 669402791936.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016033649444580078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 39, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285605.2350758218, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548600844149683, "mean_inference_ms": 5.205008704593725, "mean_action_processing_ms": 0.14537654582861112, "mean_env_wait_ms": 0.26332119982953156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015033208406888522, "StateBufferConnector_ms": 0.0023884650988456532, "ViewRequirementAgentConnector_ms": 0.06023614834516476}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285605.2350758218, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548600844149683, "mean_inference_ms": 5.205008704593725, "mean_action_processing_ms": 0.14537654582861112, "mean_env_wait_ms": 0.26332119982953156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015033208406888522, "StateBufferConnector_ms": 0.0023884650988456532, "ViewRequirementAgentConnector_ms": 0.06023614834516476}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13104, "timers": {"training_iteration_time_ms": 1965.259, "learn_time_ms": 20.517, "learn_throughput": 16376.917, "synch_weights_time_ms": 0.17}, "counters": {"num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "done": false, "episodes_total": 39, "training_iteration": 39, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-17", "timestamp": 1711725017, "time_this_iter_s": 2.0147440433502197, "time_total_s": 76.59378409385681, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac5600>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9e9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 76.59378409385681, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 14.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.037387632413654e+30, "policy_entropy": 3880.66748046875, "var_gnorm": 22.709238052368164, "vf_loss": 663090167808.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001671314239501953, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 40, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285652.3374801901, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485787939376883, "mean_inference_ms": 5.205186219092622, "mean_action_processing_ms": 0.14536889011891022, "mean_env_wait_ms": 0.26329653306621537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015000700950622559, "StateBufferConnector_ms": 0.0023865699768066406, "ViewRequirementAgentConnector_ms": 0.06025135517120361}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285652.3374801901, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485787939376883, "mean_inference_ms": 5.205186219092622, "mean_action_processing_ms": 0.14536889011891022, "mean_env_wait_ms": 0.26329653306621537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015000700950622559, "StateBufferConnector_ms": 0.0023865699768066406, "ViewRequirementAgentConnector_ms": 0.06025135517120361}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 1965.288, "learn_time_ms": 20.492, "learn_throughput": 16396.276, "synch_weights_time_ms": 0.168}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "done": false, "episodes_total": 40, "training_iteration": 40, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-19", "timestamp": 1711725019, "time_this_iter_s": 1.9639968872070312, "time_total_s": 78.55778098106384, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acf010>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9f760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 78.55778098106384, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 14.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5401589213605136e+31, "policy_entropy": 3867.771484375, "var_gnorm": 22.709819793701172, "vf_loss": 825437126656.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015532970428466797, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 41, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286141.5332489273, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485621631615865, "mean_inference_ms": 5.205351902199726, "mean_action_processing_ms": 0.14536130581823037, "mean_env_wait_ms": 0.2632728832433415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014960475084258289, "StateBufferConnector_ms": 0.002383604282286109, "ViewRequirementAgentConnector_ms": 0.06020825083662824}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286141.5332489273, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485621631615865, "mean_inference_ms": 5.205351902199726, "mean_action_processing_ms": 0.14536130581823037, "mean_env_wait_ms": 0.2632728832433415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014960475084258289, "StateBufferConnector_ms": 0.002383604282286109, "ViewRequirementAgentConnector_ms": 0.06020825083662824}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13776, "timers": {"training_iteration_time_ms": 1965.33, "learn_time_ms": 20.477, "learn_throughput": 16408.838, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "done": false, "episodes_total": 41, "training_iteration": 41, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-21", "timestamp": 1711725021, "time_this_iter_s": 1.960096836090088, "time_total_s": 80.51787781715393, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac68c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af4ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 80.51787781715393, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.066666666666666, "ram_util_percent": 14.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.0672786106158277e+31, "policy_entropy": 3856.902099609375, "var_gnorm": 22.71035385131836, "vf_loss": 714813538304.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012540817260742188, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 42, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286070.6802953458, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485412805189552, "mean_inference_ms": 5.205482439066425, "mean_action_processing_ms": 0.14535331557263556, "mean_env_wait_ms": 0.2632502640125099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014960765838623047, "StateBufferConnector_ms": 0.0023858887808663504, "ViewRequirementAgentConnector_ms": 0.060304573604038784}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -286070.6802953458, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485412805189552, "mean_inference_ms": 5.205482439066425, "mean_action_processing_ms": 0.14535331557263556, "mean_env_wait_ms": 0.2632502640125099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014960765838623047, "StateBufferConnector_ms": 0.0023858887808663504, "ViewRequirementAgentConnector_ms": 0.060304573604038784}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14112, "timers": {"training_iteration_time_ms": 1962.435, "learn_time_ms": 20.457, "learn_throughput": 16424.538, "synch_weights_time_ms": 0.162}, "counters": {"num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "done": false, "episodes_total": 42, "training_iteration": 42, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-23", "timestamp": 1711725023, "time_this_iter_s": 1.945751667022705, "time_total_s": 82.46362948417664, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac64d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 82.46362948417664, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 14.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0895692987995686e+31, "policy_entropy": 3846.869140625, "var_gnorm": 22.710838317871094, "vf_loss": 701150396416.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018310546875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 43, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285943.12130025396, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485236557919838, "mean_inference_ms": 5.205627132084363, "mean_action_processing_ms": 0.1453454012081046, "mean_env_wait_ms": 0.26322758822468495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0149638153785883, "StateBufferConnector_ms": 0.0023864036382630813, "ViewRequirementAgentConnector_ms": 0.06033764329067497}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285943.12130025396, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485236557919838, "mean_inference_ms": 5.205627132084363, "mean_action_processing_ms": 0.1453454012081046, "mean_env_wait_ms": 0.26322758822468495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0149638153785883, "StateBufferConnector_ms": 0.0023864036382630813, "ViewRequirementAgentConnector_ms": 0.06033764329067497}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14448, "timers": {"training_iteration_time_ms": 1963.378, "learn_time_ms": 20.526, "learn_throughput": 16369.403, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "done": false, "episodes_total": 43, "training_iteration": 43, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-25", "timestamp": 1711725025, "time_this_iter_s": 1.974090576171875, "time_total_s": 84.43772006034851, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b04160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af57e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 84.43772006034851, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.433333333333333, "ram_util_percent": 14.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.999735305435369e+30, "policy_entropy": 3838.864501953125, "var_gnorm": 22.71128273010254, "vf_loss": 673273479168.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015735626220703125, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 44, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285729.58837232704, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485101563847875, "mean_inference_ms": 5.205766690822174, "mean_action_processing_ms": 0.14533785398741594, "mean_env_wait_ms": 0.26320621296230134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014934756539084694, "StateBufferConnector_ms": 0.002382560209794478, "ViewRequirementAgentConnector_ms": 0.06031014702536843}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285729.58837232704, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485101563847875, "mean_inference_ms": 5.205766690822174, "mean_action_processing_ms": 0.14533785398741594, "mean_env_wait_ms": 0.26320621296230134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014934756539084694, "StateBufferConnector_ms": 0.002382560209794478, "ViewRequirementAgentConnector_ms": 0.06031014702536843}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14784, "timers": {"training_iteration_time_ms": 1962.454, "learn_time_ms": 20.55, "learn_throughput": 16350.564, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "done": false, "episodes_total": 44, "training_iteration": 44, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-27", "timestamp": 1711725027, "time_this_iter_s": 1.9641859531402588, "time_total_s": 86.40190601348877, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac65c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af5630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 86.40190601348877, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 14.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.420256630727762e+31, "policy_entropy": 3829.282958984375, "var_gnorm": 22.711688995361328, "vf_loss": 655159656448.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014460086822509766, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 45, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285330.41131232126, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485205345637454, "mean_inference_ms": 5.205937831192168, "mean_action_processing_ms": 0.14533187616543916, "mean_env_wait_ms": 0.2631877598456102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014943546719021268, "StateBufferConnector_ms": 0.0023820665147569445, "ViewRequirementAgentConnector_ms": 0.06035063001844618}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285330.41131232126, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485205345637454, "mean_inference_ms": 5.205937831192168, "mean_action_processing_ms": 0.14533187616543916, "mean_env_wait_ms": 0.2631877598456102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014943546719021268, "StateBufferConnector_ms": 0.0023820665147569445, "ViewRequirementAgentConnector_ms": 0.06035063001844618}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15120, "timers": {"training_iteration_time_ms": 1966.453, "learn_time_ms": 20.556, "learn_throughput": 16345.785, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "done": false, "episodes_total": 45, "training_iteration": 45, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-29", "timestamp": 1711725029, "time_this_iter_s": 1.9916739463806152, "time_total_s": 88.39357995986938, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac5990>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9e8c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 88.39357995986938, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.666666666666667, "ram_util_percent": 14.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2086409815158487e+31, "policy_entropy": 3822.1455078125, "var_gnorm": 22.712055206298828, "vf_loss": 623144337408.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015306472778320312, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 46, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284968.4418273005, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548519945246583, "mean_inference_ms": 5.206078335638881, "mean_action_processing_ms": 0.1453251782737546, "mean_env_wait_ms": 0.26316900865446596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01505198686019234, "StateBufferConnector_ms": 0.0023810759834621263, "ViewRequirementAgentConnector_ms": 0.060297613558561905}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284968.4418273005, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548519945246583, "mean_inference_ms": 5.206078335638881, "mean_action_processing_ms": 0.1453251782737546, "mean_env_wait_ms": 0.26316900865446596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01505198686019234, "StateBufferConnector_ms": 0.0023810759834621263, "ViewRequirementAgentConnector_ms": 0.060297613558561905}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15456, "timers": {"training_iteration_time_ms": 1967.805, "learn_time_ms": 20.536, "learn_throughput": 16361.156, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "done": false, "episodes_total": 46, "training_iteration": 46, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-31", "timestamp": 1711725031, "time_this_iter_s": 1.9442777633666992, "time_total_s": 90.33785772323608, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acfbe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af5b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 90.33785772323608, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 14.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.3656567505377246e+31, "policy_entropy": 3814.00927734375, "var_gnorm": 22.712390899658203, "vf_loss": 713982672896.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001513957977294922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 47, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285049.6376012405, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485151346167797, "mean_inference_ms": 5.206199529845972, "mean_action_processing_ms": 0.14531817760185373, "mean_env_wait_ms": 0.2631501132133911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503609596414769, "StateBufferConnector_ms": 0.0023775912345723902, "ViewRequirementAgentConnector_ms": 0.0603188859655502}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -285049.6376012405, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485151346167797, "mean_inference_ms": 5.206199529845972, "mean_action_processing_ms": 0.14531817760185373, "mean_env_wait_ms": 0.2631501132133911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503609596414769, "StateBufferConnector_ms": 0.0023775912345723902, "ViewRequirementAgentConnector_ms": 0.0603188859655502}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15792, "timers": {"training_iteration_time_ms": 1967.86, "learn_time_ms": 20.495, "learn_throughput": 16394.349, "synch_weights_time_ms": 0.164}, "counters": {"num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "done": false, "episodes_total": 47, "training_iteration": 47, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-33", "timestamp": 1711725033, "time_this_iter_s": 1.951631784439087, "time_total_s": 92.28948950767517, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acf4c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9f5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 92.28948950767517, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.366666666666667, "ram_util_percent": 14.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9908031390114723e+32, "policy_entropy": 3808.0673828125, "var_gnorm": 22.712697982788086, "vf_loss": 655120793600.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001684427261352539, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 48, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284784.8358526568, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485622308576294, "mean_inference_ms": 5.206404008170772, "mean_action_processing_ms": 0.14531559678227618, "mean_env_wait_ms": 0.26314038281023494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015052656332651774, "StateBufferConnector_ms": 0.0023792187372843423, "ViewRequirementAgentConnector_ms": 0.060339272022247314}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284784.8358526568, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15485622308576294, "mean_inference_ms": 5.206404008170772, "mean_action_processing_ms": 0.14531559678227618, "mean_env_wait_ms": 0.26314038281023494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015052656332651774, "StateBufferConnector_ms": 0.0023792187372843423, "ViewRequirementAgentConnector_ms": 0.060339272022247314}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1975.173, "learn_time_ms": 20.502, "learn_throughput": 16388.496, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "done": false, "episodes_total": 48, "training_iteration": 48, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-35", "timestamp": 1711725035, "time_this_iter_s": 2.0451385974884033, "time_total_s": 94.33462810516357, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac7250>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af5750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 94.33462810516357, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 10.0, "ram_util_percent": 14.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2203875969533627e+32, "policy_entropy": 3802.369873046875, "var_gnorm": 22.712976455688477, "vf_loss": 641013710848.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001659393310546875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 49, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284305.15483594034, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15486080883976394, "mean_inference_ms": 5.206600297967692, "mean_action_processing_ms": 0.1453128901156632, "mean_env_wait_ms": 0.2631304689974709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015030101853974012, "StateBufferConnector_ms": 0.002377373831612723, "ViewRequirementAgentConnector_ms": 0.06033449756855867}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284305.15483594034, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15486080883976394, "mean_inference_ms": 5.206600297967692, "mean_action_processing_ms": 0.1453128901156632, "mean_env_wait_ms": 0.2631304689974709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015030101853974012, "StateBufferConnector_ms": 0.002377373831612723, "ViewRequirementAgentConnector_ms": 0.06033449756855867}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16464, "timers": {"training_iteration_time_ms": 1970.103, "learn_time_ms": 19.045, "learn_throughput": 17642.342, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "done": false, "episodes_total": 49, "training_iteration": 49, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-37", "timestamp": 1711725037, "time_this_iter_s": 1.9638144969940186, "time_total_s": 96.29844260215759, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acd960>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af4e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 96.29844260215759, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.85, "ram_util_percent": 15.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.651919794432289e+32, "policy_entropy": 3795.94677734375, "var_gnorm": 22.71323013305664, "vf_loss": 751582183424.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001558065414428711, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 50, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284556.36786205444, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15486642662897246, "mean_inference_ms": 5.206809859702703, "mean_action_processing_ms": 0.1453104970987872, "mean_env_wait_ms": 0.26312164382036823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01502370834350586, "StateBufferConnector_ms": 0.0023756027221679688, "ViewRequirementAgentConnector_ms": 0.06032085418701172}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284556.36786205444, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15486642662897246, "mean_inference_ms": 5.206809859702703, "mean_action_processing_ms": 0.1453104970987872, "mean_env_wait_ms": 0.26312164382036823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01502370834350586, "StateBufferConnector_ms": 0.0023756027221679688, "ViewRequirementAgentConnector_ms": 0.06032085418701172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16800, "timers": {"training_iteration_time_ms": 1972.074, "learn_time_ms": 19.007, "learn_throughput": 17678.016, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "done": false, "episodes_total": 50, "training_iteration": 50, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-39", "timestamp": 1711725039, "time_this_iter_s": 1.9837162494659424, "time_total_s": 98.28215885162354, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b059f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af68c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 98.28215885162354, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 15.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.332770534894879e+32, "policy_entropy": 3791.47412109375, "var_gnorm": 22.71346092224121, "vf_loss": 680426799104.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015175342559814453, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 51, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284618.858225944, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487230640037045, "mean_inference_ms": 5.207022950590515, "mean_action_processing_ms": 0.14530825662548083, "mean_env_wait_ms": 0.26311401904803094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015027382794548483, "StateBufferConnector_ms": 0.0023762385050455728, "ViewRequirementAgentConnector_ms": 0.06036244186700559}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284618.858225944, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487230640037045, "mean_inference_ms": 5.207022950590515, "mean_action_processing_ms": 0.14530825662548083, "mean_env_wait_ms": 0.26311401904803094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015027382794548483, "StateBufferConnector_ms": 0.0023762385050455728, "ViewRequirementAgentConnector_ms": 0.06036244186700559}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17136, "timers": {"training_iteration_time_ms": 1973.63, "learn_time_ms": 19.032, "learn_throughput": 17654.077, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "done": false, "episodes_total": 51, "training_iteration": 51, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-41", "timestamp": 1711725041, "time_this_iter_s": 1.9756720066070557, "time_total_s": 100.25783085823059, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac5870>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af4dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 100.25783085823059, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.666666666666667, "ram_util_percent": 15.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.0785885952286504e+32, "policy_entropy": 3787.66015625, "var_gnorm": 22.713668823242188, "vf_loss": 607017369600.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001430511474609375, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 52, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284100.25089079246, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487826868920654, "mean_inference_ms": 5.20723075137218, "mean_action_processing_ms": 0.14530639856723332, "mean_env_wait_ms": 0.26310702586137896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015005240073570838, "StateBufferConnector_ms": 0.002375474342933068, "ViewRequirementAgentConnector_ms": 0.06034924433781551}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284100.25089079246, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487826868920654, "mean_inference_ms": 5.20723075137218, "mean_action_processing_ms": 0.14530639856723332, "mean_env_wait_ms": 0.26310702586137896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015005240073570838, "StateBufferConnector_ms": 0.002375474342933068, "ViewRequirementAgentConnector_ms": 0.06034924433781551}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17472, "timers": {"training_iteration_time_ms": 1975.863, "learn_time_ms": 18.982, "learn_throughput": 17701.264, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "done": false, "episodes_total": 52, "training_iteration": 52, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-43", "timestamp": 1711725043, "time_this_iter_s": 1.96809720993042, "time_total_s": 102.22592806816101, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b068c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af7130>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 102.22592806816101, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 15.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.85909238146628e+32, "policy_entropy": 3783.71875, "var_gnorm": 22.7138614654541, "vf_loss": 694834036736.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016367435455322266, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 53, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284069.6950061211, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548850738743764, "mean_inference_ms": 5.207442715308048, "mean_action_processing_ms": 0.1453045912380277, "mean_env_wait_ms": 0.2631007720885692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015002826474747568, "StateBufferConnector_ms": 0.0023751888635023585, "ViewRequirementAgentConnector_ms": 0.06040312209219303}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -284069.6950061211, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1548850738743764, "mean_inference_ms": 5.207442715308048, "mean_action_processing_ms": 0.1453045912380277, "mean_env_wait_ms": 0.2631007720885692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015002826474747568, "StateBufferConnector_ms": 0.0023751888635023585, "ViewRequirementAgentConnector_ms": 0.06040312209219303}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17808, "timers": {"training_iteration_time_ms": 1976.282, "learn_time_ms": 19.038, "learn_throughput": 17648.948, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "done": false, "episodes_total": 53, "training_iteration": 53, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-45", "timestamp": 1711725045, "time_this_iter_s": 1.9783263206481934, "time_total_s": 104.2042543888092, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac47f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9cd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 104.2042543888092, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 15.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.790524109621757e+32, "policy_entropy": 3779.859130859375, "var_gnorm": 22.714035034179688, "vf_loss": 672041795584.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015866756439208984, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 54, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283781.21095311746, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15489491117066426, "mean_inference_ms": 5.2077054426221085, "mean_action_processing_ms": 0.14530487062680886, "mean_env_wait_ms": 0.2630993454060928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015010657133879486, "StateBufferConnector_ms": 0.0023749139573838976, "ViewRequirementAgentConnector_ms": 0.06044264192934389}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283781.21095311746, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15489491117066426, "mean_inference_ms": 5.2077054426221085, "mean_action_processing_ms": 0.14530487062680886, "mean_env_wait_ms": 0.2630993454060928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015010657133879486, "StateBufferConnector_ms": 0.0023749139573838976, "ViewRequirementAgentConnector_ms": 0.06044264192934389}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18144, "timers": {"training_iteration_time_ms": 1983.17, "learn_time_ms": 19.054, "learn_throughput": 17634.24, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "done": false, "episodes_total": 54, "training_iteration": 54, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-47", "timestamp": 1711725047, "time_this_iter_s": 2.0330886840820312, "time_total_s": 106.23734307289124, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acc2e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af6320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 106.23734307289124, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.733333333333333, "ram_util_percent": 15.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.138383873482677e+32, "policy_entropy": 3777.96240234375, "var_gnorm": 22.71419334411621, "vf_loss": 682200596480.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001811981201171875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 55, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283629.12346782413, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15490696737179954, "mean_inference_ms": 5.207992130041263, "mean_action_processing_ms": 0.14530716597377447, "mean_env_wait_ms": 0.2631018486358487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015036409551447088, "StateBufferConnector_ms": 0.0023768164894797587, "ViewRequirementAgentConnector_ms": 0.06050153212113814}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283629.12346782413, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15490696737179954, "mean_inference_ms": 5.207992130041263, "mean_action_processing_ms": 0.14530716597377447, "mean_env_wait_ms": 0.2631018486358487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015036409551447088, "StateBufferConnector_ms": 0.0023768164894797587, "ViewRequirementAgentConnector_ms": 0.06050153212113814}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18480, "timers": {"training_iteration_time_ms": 1984.969, "learn_time_ms": 19.126, "learn_throughput": 17567.787, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "done": false, "episodes_total": 55, "training_iteration": 55, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-49", "timestamp": 1711725049, "time_this_iter_s": 2.009690046310425, "time_total_s": 108.24703311920166, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac5c00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af5900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 108.24703311920166, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.366666666666666, "ram_util_percent": 15.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.081548786166238e+32, "policy_entropy": 3773.8671875, "var_gnorm": 22.714338302612305, "vf_loss": 717467877376.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015115737915039062, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 56, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283711.720089079, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15492130089544806, "mean_inference_ms": 5.208297751166034, "mean_action_processing_ms": 0.14531064071343344, "mean_env_wait_ms": 0.2631067964755278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015050172805786133, "StateBufferConnector_ms": 0.00237950256892613, "ViewRequirementAgentConnector_ms": 0.060607705797467916}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283711.720089079, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15492130089544806, "mean_inference_ms": 5.208297751166034, "mean_action_processing_ms": 0.14531064071343344, "mean_env_wait_ms": 0.2631067964755278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015050172805786133, "StateBufferConnector_ms": 0.00237950256892613, "ViewRequirementAgentConnector_ms": 0.060607705797467916}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 1991.135, "learn_time_ms": 19.235, "learn_throughput": 17468.1, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "done": false, "episodes_total": 56, "training_iteration": 56, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-52", "timestamp": 1711725052, "time_this_iter_s": 2.0060110092163086, "time_total_s": 110.25304412841797, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05c90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9e3b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 110.25304412841797, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.5666666666666655, "ram_util_percent": 15.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.636206599496549e+32, "policy_entropy": 3770.175537109375, "var_gnorm": 22.714466094970703, "vf_loss": 672585678848.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00019037723541259766, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 57, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283633.78646064, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15493678065619754, "mean_inference_ms": 5.208629386647806, "mean_action_processing_ms": 0.1453153011072167, "mean_env_wait_ms": 0.2631140100391468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015150455006381921, "StateBufferConnector_ms": 0.002380421287135074, "ViewRequirementAgentConnector_ms": 0.06061395009358724}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283633.78646064, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15493678065619754, "mean_inference_ms": 5.208629386647806, "mean_action_processing_ms": 0.1453153011072167, "mean_env_wait_ms": 0.2631140100391468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015150455006381921, "StateBufferConnector_ms": 0.002380421287135074, "ViewRequirementAgentConnector_ms": 0.06061395009358724}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19152, "timers": {"training_iteration_time_ms": 1997.389, "learn_time_ms": 19.233, "learn_throughput": 17469.746, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "done": false, "episodes_total": 57, "training_iteration": 57, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-54", "timestamp": 1711725054, "time_this_iter_s": 2.014204263687134, "time_total_s": 112.2672483921051, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac7ee0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c9d1b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 112.2672483921051, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 8.7, "ram_util_percent": 15.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2065132292205669e+33, "policy_entropy": 3768.008056640625, "var_gnorm": 22.71458625793457, "vf_loss": 784528244736.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014269351959228516, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 58, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283726.7400362406, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15495390442168747, "mean_inference_ms": 5.208997364568204, "mean_action_processing_ms": 0.145321504493566, "mean_env_wait_ms": 0.2631243885899043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01515026750235722, "StateBufferConnector_ms": 0.0023800751258587017, "ViewRequirementAgentConnector_ms": 0.060626967199917496}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283726.7400362406, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15495390442168747, "mean_inference_ms": 5.208997364568204, "mean_action_processing_ms": 0.145321504493566, "mean_env_wait_ms": 0.2631243885899043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01515026750235722, "StateBufferConnector_ms": 0.0023800751258587017, "ViewRequirementAgentConnector_ms": 0.060626967199917496}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19488, "timers": {"training_iteration_time_ms": 1996.003, "learn_time_ms": 19.24, "learn_throughput": 17464.009, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "done": false, "episodes_total": 58, "training_iteration": 58, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-56", "timestamp": 1711725056, "time_this_iter_s": 2.0312867164611816, "time_total_s": 114.29853510856628, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b059c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b08820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 114.29853510856628, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 8.233333333333334, "ram_util_percent": 15.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1472402587762108e+31, "policy_entropy": 3765.74462890625, "var_gnorm": 22.714693069458008, "vf_loss": 530489769984.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016987323760986328, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 59, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283076.8653410494, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15497193265941314, "mean_inference_ms": 5.209380551811604, "mean_action_processing_ms": 0.14532856284895612, "mean_env_wait_ms": 0.26313644871287545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513109368793035, "StateBufferConnector_ms": 0.002379336599576271, "ViewRequirementAgentConnector_ms": 0.060593071630445576}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283076.8653410494, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15497193265941314, "mean_inference_ms": 5.209380551811604, "mean_action_processing_ms": 0.14532856284895612, "mean_env_wait_ms": 0.26313644871287545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513109368793035, "StateBufferConnector_ms": 0.002379336599576271, "ViewRequirementAgentConnector_ms": 0.060593071630445576}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19824, "timers": {"training_iteration_time_ms": 2000.419, "learn_time_ms": 19.277, "learn_throughput": 17430.356, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "done": false, "episodes_total": 59, "training_iteration": 59, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-10-58", "timestamp": 1711725058, "time_this_iter_s": 2.0080957412719727, "time_total_s": 116.30663084983826, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577accee0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af4f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 116.30663084983826, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 15.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.844799910493761e+32, "policy_entropy": 3763.31787109375, "var_gnorm": 22.714794158935547, "vf_loss": 694858874880.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013017654418945312, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 60, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283099.68118611653, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15499141676594685, "mean_inference_ms": 5.209778236083829, "mean_action_processing_ms": 0.14533692574057358, "mean_env_wait_ms": 0.26315093193429734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174547831217447, "StateBufferConnector_ms": 0.0023837884267171225, "ViewRequirementAgentConnector_ms": 0.0608368714650472}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -283099.68118611653, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15499141676594685, "mean_inference_ms": 5.209778236083829, "mean_action_processing_ms": 0.14533692574057358, "mean_env_wait_ms": 0.26315093193429734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174547831217447, "StateBufferConnector_ms": 0.0023837884267171225, "ViewRequirementAgentConnector_ms": 0.0608368714650472}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20160, "timers": {"training_iteration_time_ms": 2003.356, "learn_time_ms": 19.457, "learn_throughput": 17268.547, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "done": false, "episodes_total": 60, "training_iteration": 60, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-00", "timestamp": 1711725060, "time_this_iter_s": 2.0132265090942383, "time_total_s": 118.3198573589325, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05660>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b08040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 118.3198573589325, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.033333333333334, "ram_util_percent": 16.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1076139673683005e+33, "policy_entropy": 3763.168212890625, "var_gnorm": 22.714879989624023, "vf_loss": 584068628480.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018095970153808594, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 61, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -282665.2892562636, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15501194555977663, "mean_inference_ms": 5.2102113899077676, "mean_action_processing_ms": 0.14534630144471808, "mean_env_wait_ms": 0.26316775612332116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015163421630859375, "StateBufferConnector_ms": 0.002381840690237577, "ViewRequirementAgentConnector_ms": 0.06080846317478868}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -282665.2892562636, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15501194555977663, "mean_inference_ms": 5.2102113899077676, "mean_action_processing_ms": 0.14534630144471808, "mean_env_wait_ms": 0.26316775612332116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015163421630859375, "StateBufferConnector_ms": 0.002381840690237577, "ViewRequirementAgentConnector_ms": 0.06080846317478868}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20496, "timers": {"training_iteration_time_ms": 2009.698, "learn_time_ms": 19.496, "learn_throughput": 17234.652, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "done": false, "episodes_total": 61, "training_iteration": 61, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-02", "timestamp": 1711725062, "time_this_iter_s": 2.0390796661376953, "time_total_s": 120.35893702507019, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac6e00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af6830>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 120.35893702507019, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 16.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.42361625075615e+32, "policy_entropy": 3761.812255859375, "var_gnorm": 22.714962005615234, "vf_loss": 642425225216.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017058849334716797, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 62, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -282512.1030025453, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15503138278148765, "mean_inference_ms": 5.210622942130072, "mean_action_processing_ms": 0.14535486390234353, "mean_env_wait_ms": 0.26318347566826705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015169189822289252, "StateBufferConnector_ms": 0.002381493968348349, "ViewRequirementAgentConnector_ms": 0.06081942589052262}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -282512.1030025453, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15503138278148765, "mean_inference_ms": 5.210622942130072, "mean_action_processing_ms": 0.14535486390234353, "mean_env_wait_ms": 0.26318347566826705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015169189822289252, "StateBufferConnector_ms": 0.002381493968348349, "ViewRequirementAgentConnector_ms": 0.06081942589052262}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20832, "timers": {"training_iteration_time_ms": 2008.961, "learn_time_ms": 19.568, "learn_throughput": 17171.276, "synch_weights_time_ms": 0.16}, "counters": {"num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "done": false, "episodes_total": 62, "training_iteration": 62, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-04", "timestamp": 1711725064, "time_this_iter_s": 1.9607222080230713, "time_total_s": 122.31965923309326, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b043a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b08dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 122.31965923309326, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 16.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0375224158097092e+32, "policy_entropy": 3758.914306640625, "var_gnorm": 22.71503448486328, "vf_loss": 594442584064.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001817941665649414, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 63, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -282064.9146701896, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15505010595967, "mean_inference_ms": 5.2110262722400025, "mean_action_processing_ms": 0.14536303660372282, "mean_env_wait_ms": 0.2631985020017553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015157366555834573, "StateBufferConnector_ms": 0.002380401369125124, "ViewRequirementAgentConnector_ms": 0.06080127897716704}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -282064.9146701896, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15505010595967, "mean_inference_ms": 5.2110262722400025, "mean_action_processing_ms": 0.14536303660372282, "mean_env_wait_ms": 0.2631985020017553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015157366555834573, "StateBufferConnector_ms": 0.002380401369125124, "ViewRequirementAgentConnector_ms": 0.06080127897716704}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21168, "timers": {"training_iteration_time_ms": 2008.898, "learn_time_ms": 19.482, "learn_throughput": 17246.569, "synch_weights_time_ms": 0.164}, "counters": {"num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "done": false, "episodes_total": 63, "training_iteration": 63, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-06", "timestamp": 1711725066, "time_this_iter_s": 1.977687120437622, "time_total_s": 124.29734635353088, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b07400>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b0a710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 124.29734635353088, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.433333333333334, "ram_util_percent": 16.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.783699868441131e+31, "policy_entropy": 3758.15087890625, "var_gnorm": 22.715103149414062, "vf_loss": 573568188416.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001709461212158203, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 64, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -281644.5452328658, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1550676039715546, "mean_inference_ms": 5.211408813664668, "mean_action_processing_ms": 0.1453705732877693, "mean_env_wait_ms": 0.26321209388718725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01514628529548645, "StateBufferConnector_ms": 0.0023789703845977783, "ViewRequirementAgentConnector_ms": 0.06081908941268921}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -281644.5452328658, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1550676039715546, "mean_inference_ms": 5.211408813664668, "mean_action_processing_ms": 0.1453705732877693, "mean_env_wait_ms": 0.26321209388718725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01514628529548645, "StateBufferConnector_ms": 0.0023789703845977783, "ViewRequirementAgentConnector_ms": 0.06081908941268921}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 2001.349, "learn_time_ms": 19.381, "learn_throughput": 17336.824, "synch_weights_time_ms": 0.16}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 64, "training_iteration": 64, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-08", "timestamp": 1711725068, "time_this_iter_s": 1.9576056003570557, "time_total_s": 126.25495195388794, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac5ab0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b0a560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 126.25495195388794, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 16.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.412448323929969e+32, "policy_entropy": 3757.112060546875, "var_gnorm": 22.71516227722168, "vf_loss": 541172039680.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00019085407257080078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 65, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -281368.21885477065, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15508675399342708, "mean_inference_ms": 5.211796861887446, "mean_action_processing_ms": 0.14537802235458616, "mean_env_wait_ms": 0.2632255173022309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015253653893103966, "StateBufferConnector_ms": 0.0023816182063176082, "ViewRequirementAgentConnector_ms": 0.06085065694955679}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -281368.21885477065, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15508675399342708, "mean_inference_ms": 5.211796861887446, "mean_action_processing_ms": 0.14537802235458616, "mean_env_wait_ms": 0.2632255173022309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015253653893103966, "StateBufferConnector_ms": 0.0023816182063176082, "ViewRequirementAgentConnector_ms": 0.06085065694955679}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21840, "timers": {"training_iteration_time_ms": 2000.406, "learn_time_ms": 19.367, "learn_throughput": 17349.309, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "done": false, "episodes_total": 65, "training_iteration": 65, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-10", "timestamp": 1711725070, "time_this_iter_s": 2.0002872943878174, "time_total_s": 128.25523924827576, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b07460>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b09480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 128.25523924827576, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 16.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1036083802574353e+33, "policy_entropy": 3755.099365234375, "var_gnorm": 22.7152156829834, "vf_loss": 653062438912.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016760826110839844, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 66, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "sampler_results": {"episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -281198.50830904127, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15510609290292673, "mean_inference_ms": 5.2121943326106415, "mean_action_processing_ms": 0.14538546948677994, "mean_env_wait_ms": 0.2632397419706233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015250119295987215, "StateBufferConnector_ms": 0.002382740829930161, "ViewRequirementAgentConnector_ms": 0.060855981075402465}}, "episode_reward_max": -237817.51224007088, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -281198.50830904127, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15510609290292673, "mean_inference_ms": 5.2121943326106415, "mean_action_processing_ms": 0.14538546948677994, "mean_env_wait_ms": 0.2632397419706233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015250119295987215, "StateBufferConnector_ms": 0.002382740829930161, "ViewRequirementAgentConnector_ms": 0.060855981075402465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22176, "timers": {"training_iteration_time_ms": 2000.493, "learn_time_ms": 19.295, "learn_throughput": 17413.6, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "done": false, "episodes_total": 66, "training_iteration": 66, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-12", "timestamp": 1711725072, "time_this_iter_s": 2.0068562030792236, "time_total_s": 130.26209545135498, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05a20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af7130>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 130.26209545135498, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 16.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6604598066688243e+32, "policy_entropy": 3755.1484375, "var_gnorm": 22.71526527404785, "vf_loss": 476563537920.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016736984252929688, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 67, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -280501.01543171203, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15512523303364437, "mean_inference_ms": 5.212591544831284, "mean_action_processing_ms": 0.14539300682223613, "mean_env_wait_ms": 0.26325428379062926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015225695140326201, "StateBufferConnector_ms": 0.0023799156075093282, "ViewRequirementAgentConnector_ms": 0.06089851037779851}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -280501.01543171203, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15512523303364437, "mean_inference_ms": 5.212591544831284, "mean_action_processing_ms": 0.14539300682223613, "mean_env_wait_ms": 0.26325428379062926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015225695140326201, "StateBufferConnector_ms": 0.0023799156075093282, "ViewRequirementAgentConnector_ms": 0.06089851037779851}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22512, "timers": {"training_iteration_time_ms": 1998.298, "learn_time_ms": 19.258, "learn_throughput": 17447.512, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "done": false, "episodes_total": 67, "training_iteration": 67, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-14", "timestamp": 1711725074, "time_this_iter_s": 1.9922616481781006, "time_total_s": 132.25435709953308, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac6ec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b0a7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 132.25435709953308, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.099999999999999, "ram_util_percent": 16.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.397313893483959e+32, "policy_entropy": 3753.8115234375, "var_gnorm": 22.71531105041504, "vf_loss": 553596026880.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001779794692993164, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 68, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -280081.37049251964, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15514415745590812, "mean_inference_ms": 5.2129829652619915, "mean_action_processing_ms": 0.14540046710940016, "mean_env_wait_ms": 0.26326870032864247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015232142280129826, "StateBufferConnector_ms": 0.002380679635440602, "ViewRequirementAgentConnector_ms": 0.060929971582749314}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -280081.37049251964, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15514415745590812, "mean_inference_ms": 5.2129829652619915, "mean_action_processing_ms": 0.14540046710940016, "mean_env_wait_ms": 0.26326870032864247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015232142280129826, "StateBufferConnector_ms": 0.002380679635440602, "ViewRequirementAgentConnector_ms": 0.060929971582749314}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22848, "timers": {"training_iteration_time_ms": 1993.515, "learn_time_ms": 19.226, "learn_throughput": 17476.527, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "done": false, "episodes_total": 68, "training_iteration": 68, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-16", "timestamp": 1711725076, "time_this_iter_s": 1.9835090637207031, "time_total_s": 134.23786616325378, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c84be0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b0bbe0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 134.23786616325378, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 16.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1328031844314171e+33, "policy_entropy": 3754.1220703125, "var_gnorm": 22.71535301208496, "vf_loss": 590838824960.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016236305236816406, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 69, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -279707.2519183632, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15516191881997995, "mean_inference_ms": 5.213354558761519, "mean_action_processing_ms": 0.14540739158677912, "mean_env_wait_ms": 0.26328213070556267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015202812526537024, "StateBufferConnector_ms": 0.0023790027784264607, "ViewRequirementAgentConnector_ms": 0.06088761315829512}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -279707.2519183632, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15516191881997995, "mean_inference_ms": 5.213354558761519, "mean_action_processing_ms": 0.14540739158677912, "mean_env_wait_ms": 0.26328213070556267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015202812526537024, "StateBufferConnector_ms": 0.0023790027784264607, "ViewRequirementAgentConnector_ms": 0.06088761315829512}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23184, "timers": {"training_iteration_time_ms": 1988.39, "learn_time_ms": 19.14, "learn_throughput": 17554.985, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "done": false, "episodes_total": 69, "training_iteration": 69, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-18", "timestamp": 1711725078, "time_this_iter_s": 1.9567420482635498, "time_total_s": 136.19460821151733, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac4310>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b0b5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 136.19460821151733, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.3999999999999995, "ram_util_percent": 16.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6455058004792667e+33, "policy_entropy": 3751.979248046875, "var_gnorm": 22.715389251708984, "vf_loss": 692982579200.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015425682067871094, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 70, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -279807.9929298026, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15517903332059632, "mean_inference_ms": 5.213715868981586, "mean_action_processing_ms": 0.1454138857787896, "mean_env_wait_ms": 0.26329506471126846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015205996377127511, "StateBufferConnector_ms": 0.0023794174194335938, "ViewRequirementAgentConnector_ms": 0.060908453805106025}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -279807.9929298026, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15517903332059632, "mean_inference_ms": 5.213715868981586, "mean_action_processing_ms": 0.1454138857787896, "mean_env_wait_ms": 0.26329506471126846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015205996377127511, "StateBufferConnector_ms": 0.0023794174194335938, "ViewRequirementAgentConnector_ms": 0.060908453805106025}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23520, "timers": {"training_iteration_time_ms": 1984.357, "learn_time_ms": 18.969, "learn_throughput": 17712.677, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "done": false, "episodes_total": 70, "training_iteration": 70, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-20", "timestamp": 1711725080, "time_this_iter_s": 1.9728152751922607, "time_total_s": 138.1674234867096, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b066b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b580d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 138.1674234867096, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.1000000000000005, "ram_util_percent": 16.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2775537281819775e+33, "policy_entropy": 3750.994384765625, "var_gnorm": 22.715421676635742, "vf_loss": 658907201536.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001513957977294922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 71, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -279554.3644827249, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15519627126924743, "mean_inference_ms": 5.214075501457969, "mean_action_processing_ms": 0.14542051102309814, "mean_env_wait_ms": 0.2633078863597625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015228231188277123, "StateBufferConnector_ms": 0.002379148778781085, "ViewRequirementAgentConnector_ms": 0.06099821816028004}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -279554.3644827249, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15519627126924743, "mean_inference_ms": 5.214075501457969, "mean_action_processing_ms": 0.14542051102309814, "mean_env_wait_ms": 0.2633078863597625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015228231188277123, "StateBufferConnector_ms": 0.002379148778781085, "ViewRequirementAgentConnector_ms": 0.06099821816028004}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23856, "timers": {"training_iteration_time_ms": 1979.726, "learn_time_ms": 19.303, "learn_throughput": 17406.782, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "done": false, "episodes_total": 71, "training_iteration": 71, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-22", "timestamp": 1711725082, "time_this_iter_s": 1.9928874969482422, "time_total_s": 140.16031098365784, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acfac0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b0beb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 140.16031098365784, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.933333333333334, "ram_util_percent": 16.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.2389348678409056e+33, "policy_entropy": 3751.5654296875, "var_gnorm": 22.715452194213867, "vf_loss": 528535977984.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016248226165771484, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 72, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -279040.53199241526, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15521487865381275, "mean_inference_ms": 5.214454900324109, "mean_action_processing_ms": 0.1454284452860123, "mean_env_wait_ms": 0.2633232343956892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015223357412550185, "StateBufferConnector_ms": 0.002379549874199761, "ViewRequirementAgentConnector_ms": 0.06098548571268717}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -279040.53199241526, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15521487865381275, "mean_inference_ms": 5.214454900324109, "mean_action_processing_ms": 0.1454284452860123, "mean_env_wait_ms": 0.2633232343956892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015223357412550185, "StateBufferConnector_ms": 0.002379549874199761, "ViewRequirementAgentConnector_ms": 0.06098548571268717}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 1987.249, "learn_time_ms": 19.238, "learn_throughput": 17465.805, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "done": false, "episodes_total": 72, "training_iteration": 72, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-24", "timestamp": 1711725084, "time_this_iter_s": 2.0359902381896973, "time_total_s": 142.19630122184753, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b07400>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b09090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 142.19630122184753, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 9.233333333333334, "ram_util_percent": 17.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7402671703789693e+33, "policy_entropy": 3749.33544921875, "var_gnorm": 22.71548080444336, "vf_loss": 556574441472.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018012523651123047, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 73, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278699.81731466606, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15523214353150175, "mean_inference_ms": 5.214808783062644, "mean_action_processing_ms": 0.1454354516643695, "mean_env_wait_ms": 0.2633370539394489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015290142738655822, "StateBufferConnector_ms": 0.0023783069767364085, "ViewRequirementAgentConnector_ms": 0.06093227700011371}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278699.81731466606, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15523214353150175, "mean_inference_ms": 5.214808783062644, "mean_action_processing_ms": 0.1454354516643695, "mean_env_wait_ms": 0.2633370539394489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015290142738655822, "StateBufferConnector_ms": 0.0023783069767364085, "ViewRequirementAgentConnector_ms": 0.06093227700011371}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24528, "timers": {"training_iteration_time_ms": 1983.673, "learn_time_ms": 19.227, "learn_throughput": 17475.443, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "done": false, "episodes_total": 73, "training_iteration": 73, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-26", "timestamp": 1711725086, "time_this_iter_s": 1.941965103149414, "time_total_s": 144.13826632499695, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05a20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b0a560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 144.13826632499695, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 17.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.585644193044795e+32, "policy_entropy": 3749.101318359375, "var_gnorm": 22.715505599975586, "vf_loss": 611997974528.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018012523651123047, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 74, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278501.041027725, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15524925065113715, "mean_inference_ms": 5.215158664332612, "mean_action_processing_ms": 0.14544237142159722, "mean_env_wait_ms": 0.263350629360835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015307761527396537, "StateBufferConnector_ms": 0.002378386420172614, "ViewRequirementAgentConnector_ms": 0.06103676718634528}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278501.041027725, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15524925065113715, "mean_inference_ms": 5.215158664332612, "mean_action_processing_ms": 0.14544237142159722, "mean_env_wait_ms": 0.263350629360835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015307761527396537, "StateBufferConnector_ms": 0.002378386420172614, "ViewRequirementAgentConnector_ms": 0.06103676718634528}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24864, "timers": {"training_iteration_time_ms": 1986.391, "learn_time_ms": 19.259, "learn_throughput": 17446.281, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "done": false, "episodes_total": 74, "training_iteration": 74, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-28", "timestamp": 1711725088, "time_this_iter_s": 1.9848120212554932, "time_total_s": 146.12307834625244, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577d7c310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 146.12307834625244, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 17.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.2643290413517764e+33, "policy_entropy": 3748.07861328125, "var_gnorm": 22.715526580810547, "vf_loss": 651565072384.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001703500747680664, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 75, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278426.34128823894, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1552671655829011, "mean_inference_ms": 5.2155151623702025, "mean_action_processing_ms": 0.14545007330522292, "mean_env_wait_ms": 0.26336574133964485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306790669759115, "StateBufferConnector_ms": 0.0023794174194335938, "ViewRequirementAgentConnector_ms": 0.061047871907552086}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278426.34128823894, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1552671655829011, "mean_inference_ms": 5.2155151623702025, "mean_action_processing_ms": 0.14545007330522292, "mean_env_wait_ms": 0.26336574133964485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306790669759115, "StateBufferConnector_ms": 0.0023794174194335938, "ViewRequirementAgentConnector_ms": 0.061047871907552086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25200, "timers": {"training_iteration_time_ms": 1987.744, "learn_time_ms": 19.412, "learn_throughput": 17309.036, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "done": false, "episodes_total": 75, "training_iteration": 75, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-30", "timestamp": 1711725090, "time_this_iter_s": 2.0138511657714844, "time_total_s": 148.13692951202393, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acf9d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af4b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 148.13692951202393, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.766666666666666, "ram_util_percent": 17.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.6637589500548734e+32, "policy_entropy": 3749.271484375, "var_gnorm": 22.71554946899414, "vf_loss": 507834433536.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00019538402557373047, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 76, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277914.38992662553, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.155284272208782, "mean_inference_ms": 5.215852184428849, "mean_action_processing_ms": 0.14545738959423576, "mean_env_wait_ms": 0.26337973236471585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015285140589663857, "StateBufferConnector_ms": 0.002377284200567948, "ViewRequirementAgentConnector_ms": 0.06101539260462711}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277914.38992662553, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.155284272208782, "mean_inference_ms": 5.215852184428849, "mean_action_processing_ms": 0.14545738959423576, "mean_env_wait_ms": 0.26337973236471585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015285140589663857, "StateBufferConnector_ms": 0.002377284200567948, "ViewRequirementAgentConnector_ms": 0.06101539260462711}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25536, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25536, "timers": {"training_iteration_time_ms": 1982.224, "learn_time_ms": 19.32, "learn_throughput": 17391.423, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "done": false, "episodes_total": 76, "training_iteration": 76, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-32", "timestamp": 1711725092, "time_this_iter_s": 1.9516777992248535, "time_total_s": 150.08860731124878, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06170>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b09bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 150.08860731124878, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 17.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.124072043184226e+33, "policy_entropy": 3750.24560546875, "var_gnorm": 22.71556854248047, "vf_loss": 579612704768.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016427040100097656, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 77, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277591.7398716816, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553021142506118, "mean_inference_ms": 5.216193914971635, "mean_action_processing_ms": 0.14546534730341223, "mean_env_wait_ms": 0.26339504055421303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015338674768224939, "StateBufferConnector_ms": 0.0023820183493874288, "ViewRequirementAgentConnector_ms": 0.0611862578949371}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277591.7398716816, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553021142506118, "mean_inference_ms": 5.216193914971635, "mean_action_processing_ms": 0.14546534730341223, "mean_env_wait_ms": 0.26339504055421303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015338674768224939, "StateBufferConnector_ms": 0.0023820183493874288, "ViewRequirementAgentConnector_ms": 0.0611862578949371}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25872, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25872, "timers": {"training_iteration_time_ms": 1983.873, "learn_time_ms": 19.367, "learn_throughput": 17349.331, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "done": false, "episodes_total": 77, "training_iteration": 77, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-34", "timestamp": 1711725094, "time_this_iter_s": 2.0087974071502686, "time_total_s": 152.09740471839905, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06cb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b59120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 152.09740471839905, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 17.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.319893051560071e+33, "policy_entropy": 3748.0703125, "var_gnorm": 22.715585708618164, "vf_loss": 616799797248.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001894235610961914, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 78, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277395.8607139159, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553191857682414, "mean_inference_ms": 5.216524591480422, "mean_action_processing_ms": 0.14547293097311587, "mean_env_wait_ms": 0.2634095197446884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331537295610476, "StateBufferConnector_ms": 0.002381434807410607, "ViewRequirementAgentConnector_ms": 0.06117392808963091}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277395.8607139159, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553191857682414, "mean_inference_ms": 5.216524591480422, "mean_action_processing_ms": 0.14547293097311587, "mean_env_wait_ms": 0.2634095197446884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331537295610476, "StateBufferConnector_ms": 0.002381434807410607, "ViewRequirementAgentConnector_ms": 0.06117392808963091}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26208, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26208, "timers": {"training_iteration_time_ms": 1982.342, "learn_time_ms": 19.397, "learn_throughput": 17322.355, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "done": false, "episodes_total": 78, "training_iteration": 78, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-36", "timestamp": 1711725096, "time_this_iter_s": 1.9681901931762695, "time_total_s": 154.06559491157532, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05660>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af6b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 154.06559491157532, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.966666666666668, "ram_util_percent": 17.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4617763105787074e+33, "policy_entropy": 3747.800537109375, "var_gnorm": 22.715599060058594, "vf_loss": 767018860544.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015211105346679688, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 79, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277819.0737996929, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15533598702803392, "mean_inference_ms": 5.21684230165703, "mean_action_processing_ms": 0.14548018236330712, "mean_env_wait_ms": 0.2634236709609083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015326391292523734, "StateBufferConnector_ms": 0.0023805642429786393, "ViewRequirementAgentConnector_ms": 0.06116462659232224}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277819.0737996929, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15533598702803392, "mean_inference_ms": 5.21684230165703, "mean_action_processing_ms": 0.14548018236330712, "mean_env_wait_ms": 0.2634236709609083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015326391292523734, "StateBufferConnector_ms": 0.0023805642429786393, "ViewRequirementAgentConnector_ms": 0.06116462659232224}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26544, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26544, "timers": {"training_iteration_time_ms": 1983.164, "learn_time_ms": 19.447, "learn_throughput": 17277.969, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "done": false, "episodes_total": 79, "training_iteration": 79, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-38", "timestamp": 1711725098, "time_this_iter_s": 1.9650278091430664, "time_total_s": 156.03062272071838, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acd960>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b59510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 156.03062272071838, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.266666666666666, "ram_util_percent": 17.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5190625219911328e+33, "policy_entropy": 3746.970458984375, "var_gnorm": 22.715614318847656, "vf_loss": 604024406016.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016832351684570312, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 80, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277708.22642322525, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553519372339686, "mean_inference_ms": 5.21714646354121, "mean_action_processing_ms": 0.14548690475361878, "mean_env_wait_ms": 0.2634367513169586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306174755096436, "StateBufferConnector_ms": 0.0023803114891052246, "ViewRequirementAgentConnector_ms": 0.061144232749938965}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277708.22642322525, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553519372339686, "mean_inference_ms": 5.21714646354121, "mean_action_processing_ms": 0.14548690475361878, "mean_env_wait_ms": 0.2634367513169586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306174755096436, "StateBufferConnector_ms": 0.0023803114891052246, "ViewRequirementAgentConnector_ms": 0.061144232749938965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26880, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1981.787, "learn_time_ms": 19.441, "learn_throughput": 17282.715, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "done": false, "episodes_total": 80, "training_iteration": 80, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-40", "timestamp": 1711725100, "time_this_iter_s": 1.9590563774108887, "time_total_s": 157.98967909812927, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acc460>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577c600d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 157.98967909812927, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 17.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.370581291189681e+33, "policy_entropy": 3747.858154296875, "var_gnorm": 22.715625762939453, "vf_loss": 673878835200.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017690658569335938, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 81, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277814.8880249811, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15536732520896177, "mean_inference_ms": 5.217439240922655, "mean_action_processing_ms": 0.14549299049129824, "mean_env_wait_ms": 0.2634490524236524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015292638613853925, "StateBufferConnector_ms": 0.002380359319993007, "ViewRequirementAgentConnector_ms": 0.06112139901997131}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277814.8880249811, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15536732520896177, "mean_inference_ms": 5.217439240922655, "mean_action_processing_ms": 0.14549299049129824, "mean_env_wait_ms": 0.2634490524236524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015292638613853925, "StateBufferConnector_ms": 0.002380359319993007, "ViewRequirementAgentConnector_ms": 0.06112139901997131}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27216, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27216, "timers": {"training_iteration_time_ms": 1978.789, "learn_time_ms": 19.082, "learn_throughput": 17608.659, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "done": false, "episodes_total": 81, "training_iteration": 81, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-42", "timestamp": 1711725102, "time_this_iter_s": 1.9628291130065918, "time_total_s": 159.95250821113586, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b07430>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b597e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 159.95250821113586, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 17.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0542882301222861e+33, "policy_entropy": 3749.251708984375, "var_gnorm": 22.715639114379883, "vf_loss": 618997874688.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001652240753173828, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 82, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277705.76025659044, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15538272114623713, "mean_inference_ms": 5.21773271599433, "mean_action_processing_ms": 0.14549912635529486, "mean_env_wait_ms": 0.2634613537274098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015295424112459509, "StateBufferConnector_ms": 0.002379533721179497, "ViewRequirementAgentConnector_ms": 0.06116744948596489}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277705.76025659044, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15538272114623713, "mean_inference_ms": 5.21773271599433, "mean_action_processing_ms": 0.14549912635529486, "mean_env_wait_ms": 0.2634613537274098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015295424112459509, "StateBufferConnector_ms": 0.002379533721179497, "ViewRequirementAgentConnector_ms": 0.06116744948596489}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27552, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27552, "timers": {"training_iteration_time_ms": 1974.575, "learn_time_ms": 19.126, "learn_throughput": 17567.459, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "done": false, "episodes_total": 82, "training_iteration": 82, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-44", "timestamp": 1711725104, "time_this_iter_s": 1.9939079284667969, "time_total_s": 161.94641613960266, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06b60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b583a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 161.94641613960266, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 17.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0119997341527828e+32, "policy_entropy": 3746.2216796875, "var_gnorm": 22.715646743774414, "vf_loss": 760923291648.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.000156402587890625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 83, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277956.56509105634, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15539792189461077, "mean_inference_ms": 5.218029759979962, "mean_action_processing_ms": 0.14550515347293957, "mean_env_wait_ms": 0.26347329293688626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01527458788400673, "StateBufferConnector_ms": 0.0023795897702136672, "ViewRequirementAgentConnector_ms": 0.06114546074924699}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277956.56509105634, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15539792189461077, "mean_inference_ms": 5.218029759979962, "mean_action_processing_ms": 0.14550515347293957, "mean_env_wait_ms": 0.26347329293688626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01527458788400673, "StateBufferConnector_ms": 0.0023795897702136672, "ViewRequirementAgentConnector_ms": 0.06114546074924699}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27888, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27888, "timers": {"training_iteration_time_ms": 1980.362, "learn_time_ms": 19.206, "learn_throughput": 17494.686, "synch_weights_time_ms": 0.165}, "counters": {"num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "done": false, "episodes_total": 83, "training_iteration": 83, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-46", "timestamp": 1711725106, "time_this_iter_s": 1.9999256134033203, "time_total_s": 163.94634175300598, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b04f70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5a560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 163.94634175300598, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.433333333333334, "ram_util_percent": 18.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1178973650578887e+34, "policy_entropy": 3745.4091796875, "var_gnorm": 22.715656280517578, "vf_loss": 735299436544.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012958049774169922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 84, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278017.6797599133, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15541293843482484, "mean_inference_ms": 5.218320291221078, "mean_action_processing_ms": 0.14551102141050137, "mean_env_wait_ms": 0.2634850739848306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352737335931687, "StateBufferConnector_ms": 0.002379076821463449, "ViewRequirementAgentConnector_ms": 0.0611310913449242}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278017.6797599133, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15541293843482484, "mean_inference_ms": 5.218320291221078, "mean_action_processing_ms": 0.14551102141050137, "mean_env_wait_ms": 0.2634850739848306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352737335931687, "StateBufferConnector_ms": 0.002379076821463449, "ViewRequirementAgentConnector_ms": 0.0611310913449242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28224, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28224, "timers": {"training_iteration_time_ms": 1979.508, "learn_time_ms": 19.185, "learn_throughput": 17513.274, "synch_weights_time_ms": 0.165}, "counters": {"num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "done": false, "episodes_total": 84, "training_iteration": 84, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-48", "timestamp": 1711725108, "time_this_iter_s": 1.9763202667236328, "time_total_s": 165.92266201972961, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b066b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af4b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 165.92266201972961, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.833333333333333, "ram_util_percent": 18.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.0551629784940007e+33, "policy_entropy": 3747.40771484375, "var_gnorm": 22.715665817260742, "vf_loss": 793989873664.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015354156494140625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 85, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278170.26525095984, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554272800327843, "mean_inference_ms": 5.218600184485258, "mean_action_processing_ms": 0.14551646146228428, "mean_env_wait_ms": 0.2634958869465764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015333400053136489, "StateBufferConnector_ms": 0.0023782954496495866, "ViewRequirementAgentConnector_ms": 0.061106120838838464}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278170.26525095984, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554272800327843, "mean_inference_ms": 5.218600184485258, "mean_action_processing_ms": 0.14551646146228428, "mean_env_wait_ms": 0.2634958869465764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015333400053136489, "StateBufferConnector_ms": 0.0023782954496495866, "ViewRequirementAgentConnector_ms": 0.061106120838838464}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28560, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28560, "timers": {"training_iteration_time_ms": 1974.303, "learn_time_ms": 18.978, "learn_throughput": 17704.867, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "done": false, "episodes_total": 85, "training_iteration": 85, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-50", "timestamp": 1711725110, "time_this_iter_s": 1.9618048667907715, "time_total_s": 167.88446688652039, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06680>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5a050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 167.88446688652039, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 18.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.055869880942059e+32, "policy_entropy": 3746.137939453125, "var_gnorm": 22.715673446655273, "vf_loss": 662256222208.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016021728515625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 86, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278111.63774679456, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15544108708991866, "mean_inference_ms": 5.218881884791663, "mean_action_processing_ms": 0.14552165063478203, "mean_env_wait_ms": 0.2635059259543284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323106632676236, "StateBufferConnector_ms": 0.002377532249273256, "ViewRequirementAgentConnector_ms": 0.06110418674557708}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -278111.63774679456, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15544108708991866, "mean_inference_ms": 5.218881884791663, "mean_action_processing_ms": 0.14552165063478203, "mean_env_wait_ms": 0.2635059259543284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323106632676236, "StateBufferConnector_ms": 0.002377532249273256, "ViewRequirementAgentConnector_ms": 0.06110418674557708}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28896, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28896, "timers": {"training_iteration_time_ms": 1978.48, "learn_time_ms": 19.096, "learn_throughput": 17595.029, "synch_weights_time_ms": 0.16}, "counters": {"num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "done": false, "episodes_total": 86, "training_iteration": 86, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-52", "timestamp": 1711725112, "time_this_iter_s": 1.9934709072113037, "time_total_s": 169.8779377937317, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac6590>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5b760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 169.8779377937317, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 18.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0980076300346984e+33, "policy_entropy": 3746.930908203125, "var_gnorm": 22.715679168701172, "vf_loss": 614400262144.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001627206802368164, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 87, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277883.80230370286, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554545260360726, "mean_inference_ms": 5.219155955171987, "mean_action_processing_ms": 0.14552656450076396, "mean_env_wait_ms": 0.2635155366771031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015305376600945133, "StateBufferConnector_ms": 0.002375690416357983, "ViewRequirementAgentConnector_ms": 0.061085854453602054}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277883.80230370286, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554545260360726, "mean_inference_ms": 5.219155955171987, "mean_action_processing_ms": 0.14552656450076396, "mean_env_wait_ms": 0.2635155366771031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015305376600945133, "StateBufferConnector_ms": 0.002375690416357983, "ViewRequirementAgentConnector_ms": 0.061085854453602054}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29232, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29232, "timers": {"training_iteration_time_ms": 1974.651, "learn_time_ms": 19.055, "learn_throughput": 17632.982, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "done": false, "episodes_total": 87, "training_iteration": 87, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-54", "timestamp": 1711725114, "time_this_iter_s": 1.9704957008361816, "time_total_s": 171.84843349456787, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b054b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5b400>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 171.84843349456787, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.75, "ram_util_percent": 18.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.4824597298795623e+33, "policy_entropy": 3746.466552734375, "var_gnorm": 22.71568489074707, "vf_loss": 688667099136.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014030933380126953, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 88, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277828.5063776359, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554673394371708, "mean_inference_ms": 5.219418045919167, "mean_action_processing_ms": 0.14553106247679015, "mean_env_wait_ms": 0.26352424492797966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015312162312594328, "StateBufferConnector_ms": 0.0023774125359275126, "ViewRequirementAgentConnector_ms": 0.06111751903187145}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277828.5063776359, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554673394371708, "mean_inference_ms": 5.219418045919167, "mean_action_processing_ms": 0.14553106247679015, "mean_env_wait_ms": 0.26352424492797966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015312162312594328, "StateBufferConnector_ms": 0.0023774125359275126, "ViewRequirementAgentConnector_ms": 0.06111751903187145}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29568, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 1973.452, "learn_time_ms": 19.036, "learn_throughput": 17650.783, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "done": false, "episodes_total": 88, "training_iteration": 88, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-56", "timestamp": 1711725116, "time_this_iter_s": 1.9562304019927979, "time_total_s": 173.80466389656067, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b071c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5a710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 173.80466389656067, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 18.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.235944944169567e+33, "policy_entropy": 3746.125244140625, "var_gnorm": 22.71569061279297, "vf_loss": 654411235328.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001519918441772461, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 89, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277850.9939977566, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554797765725291, "mean_inference_ms": 5.219671398111808, "mean_action_processing_ms": 0.14553526450476173, "mean_env_wait_ms": 0.2635324278578966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01530513334810064, "StateBufferConnector_ms": 0.0023764170957415293, "ViewRequirementAgentConnector_ms": 0.06111364686087276}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277850.9939977566, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554797765725291, "mean_inference_ms": 5.219671398111808, "mean_action_processing_ms": 0.14553526450476173, "mean_env_wait_ms": 0.2635324278578966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01530513334810064, "StateBufferConnector_ms": 0.0023764170957415293, "ViewRequirementAgentConnector_ms": 0.06111364686087276}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29904, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29904, "timers": {"training_iteration_time_ms": 1973.454, "learn_time_ms": 19.016, "learn_throughput": 17669.306, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "done": false, "episodes_total": 89, "training_iteration": 89, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-11-58", "timestamp": 1711725118, "time_this_iter_s": 1.9650871753692627, "time_total_s": 175.76975107192993, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06350>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5a050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 175.76975107192993, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 18.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0803837685323918e+33, "policy_entropy": 3745.35693359375, "var_gnorm": 22.7156982421875, "vf_loss": 640696975360.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016546249389648438, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 90, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "sampler_results": {"episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277863.79879966803, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15549175039744872, "mean_inference_ms": 5.219949590887349, "mean_action_processing_ms": 0.14553930334147056, "mean_env_wait_ms": 0.2635398631905502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015287134382459853, "StateBufferConnector_ms": 0.0023751788669162327, "ViewRequirementAgentConnector_ms": 0.06108813815646701}}, "episode_reward_max": -234466.48552798224, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277863.79879966803, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15549175039744872, "mean_inference_ms": 5.219949590887349, "mean_action_processing_ms": 0.14553930334147056, "mean_env_wait_ms": 0.2635398631905502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015287134382459853, "StateBufferConnector_ms": 0.0023751788669162327, "ViewRequirementAgentConnector_ms": 0.06108813815646701}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30240, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30240, "timers": {"training_iteration_time_ms": 1983.031, "learn_time_ms": 18.995, "learn_throughput": 17688.6, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "done": false, "episodes_total": 90, "training_iteration": 90, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-00", "timestamp": 1711725120, "time_this_iter_s": 2.054854154586792, "time_total_s": 177.82460522651672, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b076a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5ba30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 177.82460522651672, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.366666666666667, "ram_util_percent": 18.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.396789244525332e+33, "policy_entropy": 3745.3076171875, "var_gnorm": 22.715702056884766, "vf_loss": 501293613056.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001817941665649414, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 91, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277385.40045065846, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15550288155755132, "mean_inference_ms": 5.220212619732037, "mean_action_processing_ms": 0.14554294014025596, "mean_env_wait_ms": 0.2635462624382227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015269269000042926, "StateBufferConnector_ms": 0.0023734438550341262, "ViewRequirementAgentConnector_ms": 0.06107105003608452}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277385.40045065846, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15550288155755132, "mean_inference_ms": 5.220212619732037, "mean_action_processing_ms": 0.14554294014025596, "mean_env_wait_ms": 0.2635462624382227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015269269000042926, "StateBufferConnector_ms": 0.0023734438550341262, "ViewRequirementAgentConnector_ms": 0.06107105003608452}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30576, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30576, "timers": {"training_iteration_time_ms": 1981.474, "learn_time_ms": 19.256, "learn_throughput": 17448.83, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "done": false, "episodes_total": 91, "training_iteration": 91, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-02", "timestamp": 1711725122, "time_this_iter_s": 1.9473276138305664, "time_total_s": 179.7719328403473, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b051b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b583a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 179.7719328403473, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 18.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.2594001830853616e+33, "policy_entropy": 3745.051513671875, "var_gnorm": 22.71570587158203, "vf_loss": 618413359104.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017690658569335938, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 92, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277295.4100527019, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1555145291758706, "mean_inference_ms": 5.220482495270759, "mean_action_processing_ms": 0.14554699056660866, "mean_env_wait_ms": 0.2635534053464031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015344308770221212, "StateBufferConnector_ms": 0.0023730423139489217, "ViewRequirementAgentConnector_ms": 0.06108154421267302}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277295.4100527019, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1555145291758706, "mean_inference_ms": 5.220482495270759, "mean_action_processing_ms": 0.14554699056660866, "mean_env_wait_ms": 0.2635534053464031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015344308770221212, "StateBufferConnector_ms": 0.0023730423139489217, "ViewRequirementAgentConnector_ms": 0.06108154421267302}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30912, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30912, "timers": {"training_iteration_time_ms": 1983.793, "learn_time_ms": 19.261, "learn_throughput": 17444.769, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "done": false, "episodes_total": 92, "training_iteration": 92, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-04", "timestamp": 1711725124, "time_this_iter_s": 2.0171315670013428, "time_total_s": 181.78906440734863, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acd960>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b94700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 181.78906440734863, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 18.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.0616866848830046e+32, "policy_entropy": 3745.491943359375, "var_gnorm": 22.71571159362793, "vf_loss": 629145665536.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017905235290527344, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 93, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277242.78134626313, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15552644247986916, "mean_inference_ms": 5.220758706704772, "mean_action_processing_ms": 0.1455514451533662, "mean_env_wait_ms": 0.2635613739278874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339543742518271, "StateBufferConnector_ms": 0.0023736748644100723, "ViewRequirementAgentConnector_ms": 0.06108617269864646}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277242.78134626313, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15552644247986916, "mean_inference_ms": 5.220758706704772, "mean_action_processing_ms": 0.1455514451533662, "mean_env_wait_ms": 0.2635613739278874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339543742518271, "StateBufferConnector_ms": 0.0023736748644100723, "ViewRequirementAgentConnector_ms": 0.06108617269864646}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31248, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31248, "timers": {"training_iteration_time_ms": 1985.53, "learn_time_ms": 19.278, "learn_throughput": 17429.623, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "done": false, "episodes_total": 93, "training_iteration": 93, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-06", "timestamp": 1711725126, "time_this_iter_s": 2.0172667503356934, "time_total_s": 183.80633115768433, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c802b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b58e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 183.80633115768433, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.599999999999999, "ram_util_percent": 18.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7917662497257657e+33, "policy_entropy": 3743.85009765625, "var_gnorm": 22.715713500976562, "vf_loss": 704325812224.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001628398895263672, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 94, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277336.5237553484, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15553810055294473, "mean_inference_ms": 5.221033346828287, "mean_action_processing_ms": 0.14555584389323567, "mean_env_wait_ms": 0.2635690173738789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339191923750209, "StateBufferConnector_ms": 0.0023730257724193815, "ViewRequirementAgentConnector_ms": 0.0611074427340893}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277336.5237553484, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15553810055294473, "mean_inference_ms": 5.221033346828287, "mean_action_processing_ms": 0.14555584389323567, "mean_env_wait_ms": 0.2635690173738789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339191923750209, "StateBufferConnector_ms": 0.0023730257724193815, "ViewRequirementAgentConnector_ms": 0.0611074427340893}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31584, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31584, "timers": {"training_iteration_time_ms": 1986.736, "learn_time_ms": 19.326, "learn_throughput": 17385.502, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "done": false, "episodes_total": 94, "training_iteration": 94, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-08", "timestamp": 1711725128, "time_this_iter_s": 1.9884116649627686, "time_total_s": 185.7947428226471, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b07160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b94550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 185.7947428226471, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 18.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.276432917210364e+33, "policy_entropy": 3744.917236328125, "var_gnorm": 22.715715408325195, "vf_loss": 607229575168.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017774105072021484, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 95, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277325.78126908257, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15555025689977703, "mean_inference_ms": 5.221312570616709, "mean_action_processing_ms": 0.14556073494281674, "mean_env_wait_ms": 0.2635774708823591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015336839776290091, "StateBufferConnector_ms": 0.002373394213224712, "ViewRequirementAgentConnector_ms": 0.06112048500462582}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277325.78126908257, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15555025689977703, "mean_inference_ms": 5.221312570616709, "mean_action_processing_ms": 0.14556073494281674, "mean_env_wait_ms": 0.2635774708823591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015336839776290091, "StateBufferConnector_ms": 0.002373394213224712, "ViewRequirementAgentConnector_ms": 0.06112048500462582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31920, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31920, "timers": {"training_iteration_time_ms": 1991.982, "learn_time_ms": 19.34, "learn_throughput": 17373.328, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "done": false, "episodes_total": 95, "training_iteration": 95, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-10", "timestamp": 1711725130, "time_this_iter_s": 2.0142927169799805, "time_total_s": 187.80903553962708, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b180a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b95bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 187.80903553962708, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 8.066666666666666, "ram_util_percent": 19.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.725236085909148e+32, "policy_entropy": 3745.3330078125, "var_gnorm": 22.715721130371094, "vf_loss": 623762210816.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018274784088134766, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 96, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277257.70841967437, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15556179472390322, "mean_inference_ms": 5.221578671634617, "mean_action_processing_ms": 0.14556521114986778, "mean_env_wait_ms": 0.26358518508527096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533453663190206, "StateBufferConnector_ms": 0.00237425168355306, "ViewRequirementAgentConnector_ms": 0.061151633659998574}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277257.70841967437, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15556179472390322, "mean_inference_ms": 5.221578671634617, "mean_action_processing_ms": 0.14556521114986778, "mean_env_wait_ms": 0.26358518508527096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533453663190206, "StateBufferConnector_ms": 0.00237425168355306, "ViewRequirementAgentConnector_ms": 0.061151633659998574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32256, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1987.663, "learn_time_ms": 19.338, "learn_throughput": 17374.934, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 96, "training_iteration": 96, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-12", "timestamp": 1711725132, "time_this_iter_s": 1.950312852859497, "time_total_s": 189.75934839248657, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b04d60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b95ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 189.75934839248657, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.55, "ram_util_percent": 19.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.578971845471279e+33, "policy_entropy": 3744.922607421875, "var_gnorm": 22.715721130371094, "vf_loss": 553183805440.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017690658569335938, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 97, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277008.1870778469, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15557319730708974, "mean_inference_ms": 5.22184038278518, "mean_action_processing_ms": 0.14556957392436254, "mean_env_wait_ms": 0.2635927011880641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331789390328004, "StateBufferConnector_ms": 0.0023745998893816445, "ViewRequirementAgentConnector_ms": 0.0611607561406401}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277008.1870778469, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15557319730708974, "mean_inference_ms": 5.22184038278518, "mean_action_processing_ms": 0.14556957392436254, "mean_env_wait_ms": 0.2635927011880641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331789390328004, "StateBufferConnector_ms": 0.0023745998893816445, "ViewRequirementAgentConnector_ms": 0.0611607561406401}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32592, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32592, "timers": {"training_iteration_time_ms": 1988.601, "learn_time_ms": 19.374, "learn_throughput": 17342.712, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "done": false, "episodes_total": 97, "training_iteration": 97, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-14", "timestamp": 1711725134, "time_this_iter_s": 1.9799282550811768, "time_total_s": 191.73927664756775, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b07400>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b95ea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 191.73927664756775, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.133333333333333, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.4628457305258723e+32, "policy_entropy": 3744.028076171875, "var_gnorm": 22.71572494506836, "vf_loss": 612161617920.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015938282012939453, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 98, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -276899.4275735113, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15558426199032985, "mean_inference_ms": 5.222097757858236, "mean_action_processing_ms": 0.14557386521468454, "mean_env_wait_ms": 0.26360000144117074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352940072818679, "StateBufferConnector_ms": 0.00237494098896883, "ViewRequirementAgentConnector_ms": 0.06116288048880441}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -276899.4275735113, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15558426199032985, "mean_inference_ms": 5.222097757858236, "mean_action_processing_ms": 0.14557386521468454, "mean_env_wait_ms": 0.26360000144117074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352940072818679, "StateBufferConnector_ms": 0.00237494098896883, "ViewRequirementAgentConnector_ms": 0.06116288048880441}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32928, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32928, "timers": {"training_iteration_time_ms": 1990.882, "learn_time_ms": 19.393, "learn_throughput": 17326.273, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "done": false, "episodes_total": 98, "training_iteration": 98, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-16", "timestamp": 1711725136, "time_this_iter_s": 1.9791030883789062, "time_total_s": 193.71837973594666, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b19270>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b96cb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 193.71837973594666, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 19.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.545112461212179e+32, "policy_entropy": 3744.615234375, "var_gnorm": 22.715726852416992, "vf_loss": 728426545152.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001621246337890625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 99, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277077.1888478052, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15559511260718056, "mean_inference_ms": 5.222352002353604, "mean_action_processing_ms": 0.1455780993606152, "mean_env_wait_ms": 0.2636071612528223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015349580784036655, "StateBufferConnector_ms": 0.002375516024502841, "ViewRequirementAgentConnector_ms": 0.0611712234188812}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -277077.1888478052, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15559511260718056, "mean_inference_ms": 5.222352002353604, "mean_action_processing_ms": 0.1455780993606152, "mean_env_wait_ms": 0.2636071612528223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015349580784036655, "StateBufferConnector_ms": 0.002375516024502841, "ViewRequirementAgentConnector_ms": 0.0611712234188812}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33264, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33264, "timers": {"training_iteration_time_ms": 1993.057, "learn_time_ms": 19.78, "learn_throughput": 16987.067, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "done": false, "episodes_total": 99, "training_iteration": 99, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-18", "timestamp": 1711725138, "time_this_iter_s": 1.9868345260620117, "time_total_s": 195.70521426200867, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac5ab0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b59b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 195.70521426200867, "timesteps_since_restore": 0, "iterations_since_restore": 99, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 19.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5004805252497779e+32, "policy_entropy": 3744.221923828125, "var_gnorm": 22.715728759765625, "vf_loss": 590716272640.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017309188842773438, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 100, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -276982.9929286934, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15560587899728165, "mean_inference_ms": 5.222602848788856, "mean_action_processing_ms": 0.14558235000827272, "mean_env_wait_ms": 0.26361421967811494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015347480773925781, "StateBufferConnector_ms": 0.0023758411407470703, "ViewRequirementAgentConnector_ms": 0.0611722469329834}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -276982.9929286934, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15560587899728165, "mean_inference_ms": 5.222602848788856, "mean_action_processing_ms": 0.14558235000827272, "mean_env_wait_ms": 0.26361421967811494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015347480773925781, "StateBufferConnector_ms": 0.0023758411407470703, "ViewRequirementAgentConnector_ms": 0.0611722469329834}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33600, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 1986.792, "learn_time_ms": 20.733, "learn_throughput": 16206.105, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "done": false, "episodes_total": 100, "training_iteration": 100, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-20", "timestamp": 1711725140, "time_this_iter_s": 1.992412805557251, "time_total_s": 197.69762706756592, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b051e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b94670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 197.69762706756592, "timesteps_since_restore": 0, "iterations_since_restore": 100, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.3999999999999995, "ram_util_percent": 19.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.91055911962955e+33, "policy_entropy": 3745.273193359375, "var_gnorm": 22.715728759765625, "vf_loss": 606440259584.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018072128295898438, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 101, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -439268.71239131974, "episode_reward_mean": -274012.70268453314, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15558961248936262, "mean_inference_ms": 5.222981146958516, "mean_action_processing_ms": 0.14556502595657372, "mean_env_wait_ms": 0.2635725682722234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359640121459961, "StateBufferConnector_ms": 0.002372264862060547, "ViewRequirementAgentConnector_ms": 0.06120109558105469}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -439268.71239131974, "episode_reward_mean": -274012.70268453314, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15558961248936262, "mean_inference_ms": 5.222981146958516, "mean_action_processing_ms": 0.14556502595657372, "mean_env_wait_ms": 0.2635725682722234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359640121459961, "StateBufferConnector_ms": 0.002372264862060547, "ViewRequirementAgentConnector_ms": 0.06120109558105469}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33936, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33936, "timers": {"training_iteration_time_ms": 1987.022, "learn_time_ms": 20.483, "learn_throughput": 16403.566, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "done": false, "episodes_total": 101, "training_iteration": 101, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-22", "timestamp": 1711725142, "time_this_iter_s": 1.949655294418335, "time_total_s": 199.64728236198425, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acf6d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b0bb50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 199.64728236198425, "timesteps_since_restore": 0, "iterations_since_restore": 101, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.266666666666666, "ram_util_percent": 19.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.163464057938266e+32, "policy_entropy": 3746.172607421875, "var_gnorm": 22.715730667114258, "vf_loss": 565014429696.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016045570373535156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 102, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -272126.10274618655, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15556069153053437, "mean_inference_ms": 5.223300149196149, "mean_action_processing_ms": 0.14554588992106937, "mean_env_wait_ms": 0.26351954545875805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015364646911621094, "StateBufferConnector_ms": 0.002369403839111328, "ViewRequirementAgentConnector_ms": 0.06121563911437988}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -272126.10274618655, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15556069153053437, "mean_inference_ms": 5.223300149196149, "mean_action_processing_ms": 0.14554588992106937, "mean_env_wait_ms": 0.26351954545875805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015364646911621094, "StateBufferConnector_ms": 0.002369403839111328, "ViewRequirementAgentConnector_ms": 0.06121563911437988}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34272, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34272, "timers": {"training_iteration_time_ms": 1980.75, "learn_time_ms": 20.46, "learn_throughput": 16422.471, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "done": false, "episodes_total": 102, "training_iteration": 102, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-24", "timestamp": 1711725144, "time_this_iter_s": 1.9544026851654053, "time_total_s": 201.60168504714966, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac55a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b95b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 201.60168504714966, "timesteps_since_restore": 0, "iterations_since_restore": 102, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 19.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.8274579788268564e+33, "policy_entropy": 3746.27685546875, "var_gnorm": 22.71573257446289, "vf_loss": 676784373760.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014472007751464844, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 103, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -272189.0595679201, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15553717499131847, "mean_inference_ms": 5.22363097794474, "mean_action_processing_ms": 0.14552857977310754, "mean_env_wait_ms": 0.26346651883275657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015388965606689453, "StateBufferConnector_ms": 0.0023696422576904297, "ViewRequirementAgentConnector_ms": 0.061372995376586914}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -272189.0595679201, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-266976.2134107319, -289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15553717499131847, "mean_inference_ms": 5.22363097794474, "mean_action_processing_ms": 0.14552857977310754, "mean_env_wait_ms": 0.26346651883275657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015388965606689453, "StateBufferConnector_ms": 0.0023696422576904297, "ViewRequirementAgentConnector_ms": 0.061372995376586914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34608, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34608, "timers": {"training_iteration_time_ms": 1978.745, "learn_time_ms": 20.543, "learn_throughput": 16355.82, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "done": false, "episodes_total": 103, "training_iteration": 103, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-26", "timestamp": 1711725146, "time_this_iter_s": 1.9973320960998535, "time_total_s": 203.5990171432495, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac6680>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b96b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 203.5990171432495, "timesteps_since_restore": 0, "iterations_since_restore": 103, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 19.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.055027711527618e+33, "policy_entropy": 3745.404052734375, "var_gnorm": 22.715734481811523, "vf_loss": 708884496384.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001577138900756836, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 104, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -272307.87432163116, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15553230618886116, "mean_inference_ms": 5.224077416636143, "mean_action_processing_ms": 0.14552279533848578, "mean_env_wait_ms": 0.2634348734170587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015397071838378906, "StateBufferConnector_ms": 0.002370595932006836, "ViewRequirementAgentConnector_ms": 0.06139421463012695}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -272307.87432163116, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-289914.0847733873, -276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15553230618886116, "mean_inference_ms": 5.224077416636143, "mean_action_processing_ms": 0.14552279533848578, "mean_env_wait_ms": 0.2634348734170587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015397071838378906, "StateBufferConnector_ms": 0.002370595932006836, "ViewRequirementAgentConnector_ms": 0.06139421463012695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34944, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 1977.531, "learn_time_ms": 20.498, "learn_throughput": 16391.832, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "done": false, "episodes_total": 104, "training_iteration": 104, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-28", "timestamp": 1711725148, "time_this_iter_s": 1.9762766361236572, "time_total_s": 205.57529377937317, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05c00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b95510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 205.57529377937317, "timesteps_since_restore": 0, "iterations_since_restore": 104, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 19.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.6697595770831075e+31, "policy_entropy": 3745.6044921875, "var_gnorm": 22.715734481811523, "vf_loss": 637417029632.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001646280288696289, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 105, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -272098.13964208507, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1555336220453794, "mean_inference_ms": 5.224503982171213, "mean_action_processing_ms": 0.14551970806115955, "mean_env_wait_ms": 0.26341320953790254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015393733978271484, "StateBufferConnector_ms": 0.0023708343505859375, "ViewRequirementAgentConnector_ms": 0.06137847900390625}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -272098.13964208507, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276819.5769572456, -316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1555336220453794, "mean_inference_ms": 5.224503982171213, "mean_action_processing_ms": 0.14551970806115955, "mean_env_wait_ms": 0.26341320953790254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015393733978271484, "StateBufferConnector_ms": 0.0023708343505859375, "ViewRequirementAgentConnector_ms": 0.06137847900390625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35280, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35280, "timers": {"training_iteration_time_ms": 1977.239, "learn_time_ms": 20.51, "learn_throughput": 16382.591, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "done": false, "episodes_total": 105, "training_iteration": 105, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-30", "timestamp": 1711725150, "time_this_iter_s": 2.011382579803467, "time_total_s": 207.58667635917664, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac5450>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b59f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 207.58667635917664, "timesteps_since_restore": 0, "iterations_since_restore": 105, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 19.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.490766224667642e+33, "policy_entropy": 3745.728759765625, "var_gnorm": 22.715734481811523, "vf_loss": 581850693632.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018024444580078125, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 106, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -271975.8381228848, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15554235519987647, "mean_inference_ms": 5.225013270797376, "mean_action_processing_ms": 0.14552197284478915, "mean_env_wait_ms": 0.26340464750700243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015387773513793945, "StateBufferConnector_ms": 0.0023713111877441406, "ViewRequirementAgentConnector_ms": 0.06140875816345215}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -316980.9444010643, "episode_reward_mean": -271975.8381228848, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-316980.9444010643, -307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15554235519987647, "mean_inference_ms": 5.225013270797376, "mean_action_processing_ms": 0.14552197284478915, "mean_env_wait_ms": 0.26340464750700243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015387773513793945, "StateBufferConnector_ms": 0.0023713111877441406, "ViewRequirementAgentConnector_ms": 0.06140875816345215}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35616, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35616, "timers": {"training_iteration_time_ms": 1978.067, "learn_time_ms": 20.452, "learn_throughput": 16428.674, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "done": false, "episodes_total": 106, "training_iteration": 106, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-32", "timestamp": 1711725152, "time_this_iter_s": 1.9586021900177002, "time_total_s": 209.54527854919434, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b07a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b96c20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 209.54527854919434, "timesteps_since_restore": 0, "iterations_since_restore": 106, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.233333333333333, "ram_util_percent": 20.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.331989541294044e+31, "policy_entropy": 3743.6279296875, "var_gnorm": 22.71573829650879, "vf_loss": 674944188416.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015556812286376953, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 107, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271602.73395955935, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.155553785008351, "mean_inference_ms": 5.225474675209828, "mean_action_processing_ms": 0.1455249039958132, "mean_env_wait_ms": 0.2634016685728954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015400409698486328, "StateBufferConnector_ms": 0.00237274169921875, "ViewRequirementAgentConnector_ms": 0.06146073341369629}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271602.73395955935, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-307963.68465636903, -259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.155553785008351, "mean_inference_ms": 5.225474675209828, "mean_action_processing_ms": 0.1455249039958132, "mean_env_wait_ms": 0.2634016685728954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015400409698486328, "StateBufferConnector_ms": 0.00237274169921875, "ViewRequirementAgentConnector_ms": 0.06146073341369629}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35952, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35952, "timers": {"training_iteration_time_ms": 1975.775, "learn_time_ms": 20.466, "learn_throughput": 16417.153, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "done": false, "episodes_total": 107, "training_iteration": 107, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-34", "timestamp": 1711725154, "time_this_iter_s": 1.9570262432098389, "time_total_s": 211.50230479240417, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05d50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b97d90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 211.50230479240417, "timesteps_since_restore": 0, "iterations_since_restore": 107, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 20.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.80329501956058e+33, "policy_entropy": 3744.71435546875, "var_gnorm": 22.71573829650879, "vf_loss": 665852313600.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017571449279785156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 108, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271234.511740716, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1555693274015238, "mean_inference_ms": 5.225919909695617, "mean_action_processing_ms": 0.14552868938267324, "mean_env_wait_ms": 0.263403694313469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015400886535644531, "StateBufferConnector_ms": 0.002370595932006836, "ViewRequirementAgentConnector_ms": 0.06148076057434082}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271234.511740716, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-259054.68931133774, -237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1555693274015238, "mean_inference_ms": 5.225919909695617, "mean_action_processing_ms": 0.14552868938267324, "mean_env_wait_ms": 0.263403694313469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015400886535644531, "StateBufferConnector_ms": 0.002370595932006836, "ViewRequirementAgentConnector_ms": 0.06148076057434082}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36288, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36288, "timers": {"training_iteration_time_ms": 1978.799, "learn_time_ms": 20.423, "learn_throughput": 16451.746, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "done": false, "episodes_total": 108, "training_iteration": 108, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-36", "timestamp": 1711725156, "time_this_iter_s": 2.00929594039917, "time_total_s": 213.51160073280334, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac6e60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b95bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 213.51160073280334, "timesteps_since_restore": 0, "iterations_since_restore": 108, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.733333333333334, "ram_util_percent": 20.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9606977138817174e+33, "policy_entropy": 3745.64697265625, "var_gnorm": 22.715740203857422, "vf_loss": 555325980672.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017213821411132812, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 109, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271159.4513912291, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15558872076161773, "mean_inference_ms": 5.226380378931279, "mean_action_processing_ms": 0.1455347904789411, "mean_env_wait_ms": 0.2634123223876314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015419483184814453, "StateBufferConnector_ms": 0.0023708343505859375, "ViewRequirementAgentConnector_ms": 0.06148982048034668}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271159.4513912291, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-237817.51224007088, -257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15558872076161773, "mean_inference_ms": 5.226380378931279, "mean_action_processing_ms": 0.1455347904789411, "mean_env_wait_ms": 0.2634123223876314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015419483184814453, "StateBufferConnector_ms": 0.0023708343505859375, "ViewRequirementAgentConnector_ms": 0.06148982048034668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36624, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36624, "timers": {"training_iteration_time_ms": 1975.713, "learn_time_ms": 20.112, "learn_throughput": 16706.63, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "done": false, "episodes_total": 109, "training_iteration": 109, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-38", "timestamp": 1711725158, "time_this_iter_s": 1.9561047554016113, "time_total_s": 215.46770548820496, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05bd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577af6b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 215.46770548820496, "timesteps_since_restore": 0, "iterations_since_restore": 109, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 20.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.388645931212953e+33, "policy_entropy": 3745.9423828125, "var_gnorm": 22.715740203857422, "vf_loss": 572890152960.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018274784088134766, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 110, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271373.40019072394, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15560960858086167, "mean_inference_ms": 5.226802729485266, "mean_action_processing_ms": 0.14554169566359035, "mean_env_wait_ms": 0.26342312739238766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015417337417602539, "StateBufferConnector_ms": 0.0023703575134277344, "ViewRequirementAgentConnector_ms": 0.06149554252624512}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271373.40019072394, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-257474.97859296406, -301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15560960858086167, "mean_inference_ms": 5.226802729485266, "mean_action_processing_ms": 0.14554169566359035, "mean_env_wait_ms": 0.26342312739238766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015417337417602539, "StateBufferConnector_ms": 0.0023703575134277344, "ViewRequirementAgentConnector_ms": 0.06149554252624512}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36960, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36960, "timers": {"training_iteration_time_ms": 1973.194, "learn_time_ms": 19.221, "learn_throughput": 17480.992, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "done": false, "episodes_total": 110, "training_iteration": 110, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-40", "timestamp": 1711725160, "time_this_iter_s": 1.9670634269714355, "time_total_s": 217.4347689151764, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c87df0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5bbe0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 217.4347689151764, "timesteps_since_restore": 0, "iterations_since_restore": 110, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 20.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.0148751483704874e+33, "policy_entropy": 3744.67822265625, "var_gnorm": 22.715742111206055, "vf_loss": 580177297408.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.000186920166015625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 111, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271342.1083245149, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15563335492942298, "mean_inference_ms": 5.227251727165549, "mean_action_processing_ms": 0.14555148344654348, "mean_env_wait_ms": 0.2634373830301853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015425443649291992, "StateBufferConnector_ms": 0.0023708343505859375, "ViewRequirementAgentConnector_ms": 0.061505794525146484}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271342.1083245149, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301974.8208307369, -280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15563335492942298, "mean_inference_ms": 5.227251727165549, "mean_action_processing_ms": 0.14555148344654348, "mean_env_wait_ms": 0.2634373830301853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015425443649291992, "StateBufferConnector_ms": 0.0023708343505859375, "ViewRequirementAgentConnector_ms": 0.061505794525146484}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37296, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37296, "timers": {"training_iteration_time_ms": 1977.029, "learn_time_ms": 19.265, "learn_throughput": 17440.538, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "done": false, "episodes_total": 111, "training_iteration": 111, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-42", "timestamp": 1711725162, "time_this_iter_s": 1.9879777431488037, "time_total_s": 219.4227466583252, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac6860>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b97880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 219.4227466583252, "timesteps_since_restore": 0, "iterations_since_restore": 111, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.533333333333334, "ram_util_percent": 20.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.976750927950635e+33, "policy_entropy": 3744.51220703125, "var_gnorm": 22.715742111206055, "vf_loss": 595326009344.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001493692398071289, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 112, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270858.9373035508, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15566089100539482, "mean_inference_ms": 5.227744888200871, "mean_action_processing_ms": 0.14556308589051112, "mean_env_wait_ms": 0.2634545733265114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015442132949829102, "StateBufferConnector_ms": 0.002374410629272461, "ViewRequirementAgentConnector_ms": 0.06157827377319336}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270858.9373035508, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-280989.8562428944, -268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15566089100539482, "mean_inference_ms": 5.227744888200871, "mean_action_processing_ms": 0.14556308589051112, "mean_env_wait_ms": 0.2634545733265114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015442132949829102, "StateBufferConnector_ms": 0.002374410629272461, "ViewRequirementAgentConnector_ms": 0.06157827377319336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37632, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 1984.851, "learn_time_ms": 19.312, "learn_throughput": 17398.594, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "done": false, "episodes_total": 112, "training_iteration": 112, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-44", "timestamp": 1711725164, "time_this_iter_s": 2.0326356887817383, "time_total_s": 221.45538234710693, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac6aa0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b59f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 221.45538234710693, "timesteps_since_restore": 0, "iterations_since_restore": 112, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.599999999999999, "ram_util_percent": 20.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.713404645239001e+33, "policy_entropy": 3744.702392578125, "var_gnorm": 22.715742111206055, "vf_loss": 559794094080.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001876354217529297, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 113, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270647.09076095815, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15568939119240693, "mean_inference_ms": 5.2282264537832965, "mean_action_processing_ms": 0.14557499200729893, "mean_env_wait_ms": 0.2634747711012631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015460729598999023, "StateBufferConnector_ms": 0.0023734569549560547, "ViewRequirementAgentConnector_ms": 0.061602115631103516}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270647.09076095815, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-268498.24159749685, -260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15568939119240693, "mean_inference_ms": 5.2282264537832965, "mean_action_processing_ms": 0.14557499200729893, "mean_env_wait_ms": 0.2634747711012631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015460729598999023, "StateBufferConnector_ms": 0.0023734569549560547, "ViewRequirementAgentConnector_ms": 0.061602115631103516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37968, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37968, "timers": {"training_iteration_time_ms": 1983.83, "learn_time_ms": 19.134, "learn_throughput": 17560.345, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "done": false, "episodes_total": 113, "training_iteration": 113, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-46", "timestamp": 1711725166, "time_this_iter_s": 1.9869999885559082, "time_total_s": 223.44238233566284, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06140>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577bace50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 223.44238233566284, "timesteps_since_restore": 0, "iterations_since_restore": 113, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.699999999999999, "ram_util_percent": 20.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.20582149719798e+32, "policy_entropy": 3744.468994140625, "var_gnorm": 22.715742111206055, "vf_loss": 596210876416.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016188621520996094, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 114, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270584.740459823, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.155720228537261, "mean_inference_ms": 5.2287407439956715, "mean_action_processing_ms": 0.1455879103783815, "mean_env_wait_ms": 0.26349800294715003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015473127365112305, "StateBufferConnector_ms": 0.002373933792114258, "ViewRequirementAgentConnector_ms": 0.06163167953491211}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270584.740459823, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-260908.31752219438, -275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.155720228537261, "mean_inference_ms": 5.2287407439956715, "mean_action_processing_ms": 0.1455879103783815, "mean_env_wait_ms": 0.26349800294715003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015473127365112305, "StateBufferConnector_ms": 0.002373933792114258, "ViewRequirementAgentConnector_ms": 0.06163167953491211}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38304, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38304, "timers": {"training_iteration_time_ms": 1984.228, "learn_time_ms": 19.216, "learn_throughput": 17485.395, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "done": false, "episodes_total": 114, "training_iteration": 114, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-48", "timestamp": 1711725168, "time_this_iter_s": 1.9803059101104736, "time_total_s": 225.42268824577332, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577c86b60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5b640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 225.42268824577332, "timesteps_since_restore": 0, "iterations_since_restore": 114, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 20.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.4817098421964925e+32, "policy_entropy": 3746.265869140625, "var_gnorm": 22.715744018554688, "vf_loss": 668695855104.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016951560974121094, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 115, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270745.2926654238, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15575371914458785, "mean_inference_ms": 5.2292877205398565, "mean_action_processing_ms": 0.1456024901100559, "mean_env_wait_ms": 0.26352426754960206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015493392944335938, "StateBufferConnector_ms": 0.0023746490478515625, "ViewRequirementAgentConnector_ms": 0.06169605255126953}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270745.2926654238, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-275876.6189819508, -276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15575371914458785, "mean_inference_ms": 5.2292877205398565, "mean_action_processing_ms": 0.1456024901100559, "mean_env_wait_ms": 0.26352426754960206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015493392944335938, "StateBufferConnector_ms": 0.0023746490478515625, "ViewRequirementAgentConnector_ms": 0.06169605255126953}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38640, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38640, "timers": {"training_iteration_time_ms": 1986.354, "learn_time_ms": 19.245, "learn_throughput": 17459.487, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "done": false, "episodes_total": 115, "training_iteration": 115, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-50", "timestamp": 1711725170, "time_this_iter_s": 2.0326449871063232, "time_total_s": 227.45533323287964, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b057e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577bacd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 227.45533323287964, "timesteps_since_restore": 0, "iterations_since_restore": 115, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.333333333333333, "ram_util_percent": 20.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.713399052491733e+33, "policy_entropy": 3745.6748046875, "var_gnorm": 22.715744018554688, "vf_loss": 737960853504.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016224384307861328, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 116, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270943.54024976573, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15578739130107577, "mean_inference_ms": 5.229825652680291, "mean_action_processing_ms": 0.1456171515464568, "mean_env_wait_ms": 0.2635509677843707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015499114990234375, "StateBufferConnector_ms": 0.002373933792114258, "ViewRequirementAgentConnector_ms": 0.06171298027038574}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270943.54024976573, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276427.5232868388, -289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15578739130107577, "mean_inference_ms": 5.229825652680291, "mean_action_processing_ms": 0.1456171515464568, "mean_env_wait_ms": 0.2635509677843707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015499114990234375, "StateBufferConnector_ms": 0.002373933792114258, "ViewRequirementAgentConnector_ms": 0.06171298027038574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38976, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38976, "timers": {"training_iteration_time_ms": 1991.695, "learn_time_ms": 19.252, "learn_throughput": 17452.438, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "done": false, "episodes_total": 116, "training_iteration": 116, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-52", "timestamp": 1711725172, "time_this_iter_s": 2.0120255947113037, "time_total_s": 229.46735882759094, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac6500>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b970a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 229.46735882759094, "timesteps_since_restore": 0, "iterations_since_restore": 116, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 20.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.7372262425394445e+32, "policy_entropy": 3742.8544921875, "var_gnorm": 22.715744018554688, "vf_loss": 665307316224.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015997886657714844, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 117, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270961.8359020213, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15582054402051682, "mean_inference_ms": 5.230379119556571, "mean_action_processing_ms": 0.14563143817779242, "mean_env_wait_ms": 0.26357788170041435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015499591827392578, "StateBufferConnector_ms": 0.002374410629272461, "ViewRequirementAgentConnector_ms": 0.06172609329223633}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270961.8359020213, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-289718.12375845667, -244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15582054402051682, "mean_inference_ms": 5.230379119556571, "mean_action_processing_ms": 0.14563143817779242, "mean_env_wait_ms": 0.26357788170041435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015499591827392578, "StateBufferConnector_ms": 0.002374410629272461, "ViewRequirementAgentConnector_ms": 0.06172609329223633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39312, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39312, "timers": {"training_iteration_time_ms": 1994.828, "learn_time_ms": 19.223, "learn_throughput": 17479.128, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "done": false, "episodes_total": 117, "training_iteration": 117, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-55", "timestamp": 1711725175, "time_this_iter_s": 1.988349199295044, "time_total_s": 231.455708026886, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b046d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577bad870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 231.455708026886, "timesteps_since_restore": 0, "iterations_since_restore": 117, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 21.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.11634065441992e+33, "policy_entropy": 3744.216796875, "var_gnorm": 22.715744018554688, "vf_loss": 755377635328.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001474618911743164, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 118, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270990.15817378316, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1558532960748255, "mean_inference_ms": 5.230908076361913, "mean_action_processing_ms": 0.1456453543954449, "mean_env_wait_ms": 0.2636049651431669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015472888946533203, "StateBufferConnector_ms": 0.00237274169921875, "ViewRequirementAgentConnector_ms": 0.06165719032287598}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270990.15817378316, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-244139.5635178822, -292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1558532960748255, "mean_inference_ms": 5.230908076361913, "mean_action_processing_ms": 0.1456453543954449, "mean_env_wait_ms": 0.2636049651431669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015472888946533203, "StateBufferConnector_ms": 0.00237274169921875, "ViewRequirementAgentConnector_ms": 0.06165719032287598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39648, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39648, "timers": {"training_iteration_time_ms": 1992.428, "learn_time_ms": 19.267, "learn_throughput": 17439.2, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "done": false, "episodes_total": 118, "training_iteration": 118, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-57", "timestamp": 1711725177, "time_this_iter_s": 1.9853544235229492, "time_total_s": 233.44106245040894, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac5630>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577bacf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 233.44106245040894, "timesteps_since_restore": 0, "iterations_since_restore": 118, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.7, "ram_util_percent": 21.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.834832592233273e+33, "policy_entropy": 3744.95263671875, "var_gnorm": 22.715744018554688, "vf_loss": 657611030528.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016129016876220703, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 119, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271281.96290597576, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15588578334607614, "mean_inference_ms": 5.231451868078219, "mean_action_processing_ms": 0.14565953611413548, "mean_env_wait_ms": 0.2636332171686334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433073043823242, "StateBufferConnector_ms": 0.0023713111877441406, "ViewRequirementAgentConnector_ms": 0.061647891998291016}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -271281.96290597576, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-292405.11031864997, -265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15588578334607614, "mean_inference_ms": 5.231451868078219, "mean_action_processing_ms": 0.14565953611413548, "mean_env_wait_ms": 0.2636332171686334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433073043823242, "StateBufferConnector_ms": 0.0023713111877441406, "ViewRequirementAgentConnector_ms": 0.061647891998291016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39984, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39984, "timers": {"training_iteration_time_ms": 1997.994, "learn_time_ms": 19.197, "learn_throughput": 17502.594, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "done": false, "episodes_total": 119, "training_iteration": 119, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-12-59", "timestamp": 1711725179, "time_this_iter_s": 2.0116536617279053, "time_total_s": 235.45271611213684, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06f80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577baeb90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 235.45271611213684, "timesteps_since_restore": 0, "iterations_since_restore": 119, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 21.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7851856699619344e+33, "policy_entropy": 3744.2177734375, "var_gnorm": 22.715744018554688, "vf_loss": 528685891584.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001773834228515625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 120, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270792.37024341885, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1559187857619956, "mean_inference_ms": 5.232003753214323, "mean_action_processing_ms": 0.1456739422133704, "mean_env_wait_ms": 0.26366182156767176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015436410903930664, "StateBufferConnector_ms": 0.0023720264434814453, "ViewRequirementAgentConnector_ms": 0.061673879623413086}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -310829.69449029973, "episode_reward_mean": -270792.37024341885, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-265684.7485194842, -248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1559187857619956, "mean_inference_ms": 5.232003753214323, "mean_action_processing_ms": 0.1456739422133704, "mean_env_wait_ms": 0.26366182156767176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015436410903930664, "StateBufferConnector_ms": 0.0023720264434814453, "ViewRequirementAgentConnector_ms": 0.061673879623413086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40320, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 1995.955, "learn_time_ms": 19.137, "learn_throughput": 17557.282, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "done": false, "episodes_total": 120, "training_iteration": 120, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-01", "timestamp": 1711725181, "time_this_iter_s": 1.9466490745544434, "time_total_s": 237.39936518669128, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b067d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577baf640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 237.39936518669128, "timesteps_since_restore": 0, "iterations_since_restore": 120, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 21.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.638027073199843e+33, "policy_entropy": 3745.67236328125, "var_gnorm": 22.715744018554688, "vf_loss": 896340197376.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013744831085205078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 121, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271393.01613464777, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15595172711280025, "mean_inference_ms": 5.232570309044433, "mean_action_processing_ms": 0.14568920798774998, "mean_env_wait_ms": 0.263691278656752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015427827835083008, "StateBufferConnector_ms": 0.002370595932006836, "ViewRequirementAgentConnector_ms": 0.061647653579711914}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271393.01613464777, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-248470.3404633763, -266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15595172711280025, "mean_inference_ms": 5.232570309044433, "mean_action_processing_ms": 0.14568920798774998, "mean_env_wait_ms": 0.263691278656752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015427827835083008, "StateBufferConnector_ms": 0.002370595932006836, "ViewRequirementAgentConnector_ms": 0.061647653579711914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40656, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40656, "timers": {"training_iteration_time_ms": 1995.205, "learn_time_ms": 19.108, "learn_throughput": 17584.71, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "done": false, "episodes_total": 121, "training_iteration": 121, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-03", "timestamp": 1711725183, "time_this_iter_s": 1.9805123805999756, "time_total_s": 239.37987756729126, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac5c00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577baca60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 239.37987756729126, "timesteps_since_restore": 0, "iterations_since_restore": 121, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.666666666666667, "ram_util_percent": 21.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.197124990439091e+33, "policy_entropy": 3744.117919921875, "var_gnorm": 22.715744018554688, "vf_loss": 506557628416.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018668174743652344, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 122, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271363.4252677102, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15598005912650859, "mean_inference_ms": 5.233042564745753, "mean_action_processing_ms": 0.14570036729482408, "mean_env_wait_ms": 0.26371363729263647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015424013137817383, "StateBufferConnector_ms": 0.0023691654205322266, "ViewRequirementAgentConnector_ms": 0.061627864837646484}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271363.4252677102, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-266511.0073234536, -243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15598005912650859, "mean_inference_ms": 5.233042564745753, "mean_action_processing_ms": 0.14570036729482408, "mean_env_wait_ms": 0.26371363729263647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015424013137817383, "StateBufferConnector_ms": 0.0023691654205322266, "ViewRequirementAgentConnector_ms": 0.061627864837646484}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40992, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40992, "timers": {"training_iteration_time_ms": 1988.824, "learn_time_ms": 19.086, "learn_throughput": 17604.7, "synch_weights_time_ms": 0.16}, "counters": {"num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "done": false, "episodes_total": 122, "training_iteration": 122, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-05", "timestamp": 1711725185, "time_this_iter_s": 1.9687926769256592, "time_total_s": 241.34867024421692, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b18b20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779d80d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 241.34867024421692, "timesteps_since_restore": 0, "iterations_since_restore": 122, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.133333333333333, "ram_util_percent": 21.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3042399297418727e+33, "policy_entropy": 3746.01513671875, "var_gnorm": 22.715744018554688, "vf_loss": 654395244544.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016319751739501953, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 123, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271362.3107039312, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15600714911973884, "mean_inference_ms": 5.23351068864957, "mean_action_processing_ms": 0.14571129537729424, "mean_env_wait_ms": 0.26373481765410106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015446186065673828, "StateBufferConnector_ms": 0.0023696422576904297, "ViewRequirementAgentConnector_ms": 0.06165051460266113}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271362.3107039312, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-243358.43254530092, -281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15600714911973884, "mean_inference_ms": 5.23351068864957, "mean_action_processing_ms": 0.14571129537729424, "mean_env_wait_ms": 0.26373481765410106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015446186065673828, "StateBufferConnector_ms": 0.0023696422576904297, "ViewRequirementAgentConnector_ms": 0.06165051460266113}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41328, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41328, "timers": {"training_iteration_time_ms": 1987.971, "learn_time_ms": 19.144, "learn_throughput": 17551.422, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "done": false, "episodes_total": 123, "training_iteration": 123, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-07", "timestamp": 1711725187, "time_this_iter_s": 1.978501558303833, "time_total_s": 243.32717180252075, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac6080>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577badc60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 243.32717180252075, "timesteps_since_restore": 0, "iterations_since_restore": 123, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 21.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.93586661532058e+33, "policy_entropy": 3746.60595703125, "var_gnorm": 22.715744018554688, "vf_loss": 604498690048.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016427040100097656, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 124, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271581.95922947774, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15603355752158832, "mean_inference_ms": 5.233972962754626, "mean_action_processing_ms": 0.14572204291233237, "mean_env_wait_ms": 0.2637556811339686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015462398529052734, "StateBufferConnector_ms": 0.002371549606323242, "ViewRequirementAgentConnector_ms": 0.061675071716308594}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271581.95922947774, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-281552.6636705706, -276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15603355752158832, "mean_inference_ms": 5.233972962754626, "mean_action_processing_ms": 0.14572204291233237, "mean_env_wait_ms": 0.2637556811339686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015462398529052734, "StateBufferConnector_ms": 0.002371549606323242, "ViewRequirementAgentConnector_ms": 0.061675071716308594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41664, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41664, "timers": {"training_iteration_time_ms": 1989.529, "learn_time_ms": 19.114, "learn_throughput": 17579.051, "synch_weights_time_ms": 0.16}, "counters": {"num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "done": false, "episodes_total": 124, "training_iteration": 124, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-09", "timestamp": 1711725189, "time_this_iter_s": 1.995847463607788, "time_total_s": 245.32301926612854, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06ef0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779d84c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 245.32301926612854, "timesteps_since_restore": 0, "iterations_since_restore": 124, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.466666666666666, "ram_util_percent": 21.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0741240528567655e+33, "policy_entropy": 3745.30810546875, "var_gnorm": 22.715744018554688, "vf_loss": 674462236672.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013172626495361328, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 125, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271465.82497491484, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15605607456379986, "mean_inference_ms": 5.234389913995655, "mean_action_processing_ms": 0.1457307411850376, "mean_env_wait_ms": 0.26377227113218915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015494823455810547, "StateBufferConnector_ms": 0.0023729801177978516, "ViewRequirementAgentConnector_ms": 0.061749935150146484}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271465.82497491484, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276628.0998799335, -269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15605607456379986, "mean_inference_ms": 5.234389913995655, "mean_action_processing_ms": 0.1457307411850376, "mean_env_wait_ms": 0.26377227113218915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015494823455810547, "StateBufferConnector_ms": 0.0023729801177978516, "ViewRequirementAgentConnector_ms": 0.061749935150146484}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42000, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 1987.025, "learn_time_ms": 19.098, "learn_throughput": 17593.293, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 125, "training_iteration": 125, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-11", "timestamp": 1711725191, "time_this_iter_s": 2.0076146125793457, "time_total_s": 247.33063387870789, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05810>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577baca60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 247.33063387870789, "timesteps_since_restore": 0, "iterations_since_restore": 125, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.35, "ram_util_percent": 21.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.208280996588121e+33, "policy_entropy": 3745.6435546875, "var_gnorm": 22.715744018554688, "vf_loss": 771254452224.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016009807586669922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 126, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271713.38094742177, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1560776894527173, "mean_inference_ms": 5.234803578245483, "mean_action_processing_ms": 0.14573913763952498, "mean_env_wait_ms": 0.26378870948665484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015494346618652344, "StateBufferConnector_ms": 0.002373218536376953, "ViewRequirementAgentConnector_ms": 0.06173300743103027}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271713.38094742177, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-269854.5578880102, -273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1560776894527173, "mean_inference_ms": 5.234803578245483, "mean_action_processing_ms": 0.14573913763952498, "mean_env_wait_ms": 0.26378870948665484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015494346618652344, "StateBufferConnector_ms": 0.002373218536376953, "ViewRequirementAgentConnector_ms": 0.06173300743103027}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42336, "timers": {"training_iteration_time_ms": 1983.251, "learn_time_ms": 19.092, "learn_throughput": 17598.984, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "done": false, "episodes_total": 126, "training_iteration": 126, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-13", "timestamp": 1711725193, "time_this_iter_s": 1.9742743968963623, "time_total_s": 249.30490827560425, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05540>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577badbd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 249.30490827560425, "timesteps_since_restore": 0, "iterations_since_restore": 126, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 7.033333333333334, "ram_util_percent": 21.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.845799701817989e+33, "policy_entropy": 3745.138671875, "var_gnorm": 22.715744018554688, "vf_loss": 698734084096.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013947486877441406, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 127, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271902.0047019446, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15609920879113615, "mean_inference_ms": 5.235213046646319, "mean_action_processing_ms": 0.14574752096987476, "mean_env_wait_ms": 0.2638055450352335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015488624572753906, "StateBufferConnector_ms": 0.0023725032806396484, "ViewRequirementAgentConnector_ms": 0.0617372989654541}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271902.0047019446, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-273684.5573354873, -251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15609920879113615, "mean_inference_ms": 5.235213046646319, "mean_action_processing_ms": 0.14574752096987476, "mean_env_wait_ms": 0.2638055450352335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015488624572753906, "StateBufferConnector_ms": 0.0023725032806396484, "ViewRequirementAgentConnector_ms": 0.0617372989654541}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42672, "timers": {"training_iteration_time_ms": 1984.052, "learn_time_ms": 19.08, "learn_throughput": 17610.485, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "done": false, "episodes_total": 127, "training_iteration": 127, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-15", "timestamp": 1711725195, "time_this_iter_s": 1.996330976486206, "time_total_s": 251.30123925209045, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b079d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577baf5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 251.30123925209045, "timesteps_since_restore": 0, "iterations_since_restore": 127, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 22.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.535179572847599e+33, "policy_entropy": 3744.524169921875, "var_gnorm": 22.71574592590332, "vf_loss": 600614043648.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015997886657714844, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 128, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271854.44967220206, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1561205755434057, "mean_inference_ms": 5.235618527371688, "mean_action_processing_ms": 0.14575597824297212, "mean_env_wait_ms": 0.2638217913505234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015475273132324219, "StateBufferConnector_ms": 0.002371549606323242, "ViewRequirementAgentConnector_ms": 0.06171011924743652}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271854.44967220206, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-251206.92990223382, -255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1561205755434057, "mean_inference_ms": 5.235618527371688, "mean_action_processing_ms": 0.14575597824297212, "mean_env_wait_ms": 0.2638217913505234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015475273132324219, "StateBufferConnector_ms": 0.002371549606323242, "ViewRequirementAgentConnector_ms": 0.06171011924743652}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1982.201, "learn_time_ms": 19.272, "learn_throughput": 17435.057, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 128, "training_iteration": 128, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-17", "timestamp": 1711725197, "time_this_iter_s": 1.9669079780578613, "time_total_s": 253.26814723014832, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06950>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b58e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 253.26814723014832, "timesteps_since_restore": 0, "iterations_since_restore": 128, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.633333333333334, "ram_util_percent": 22.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2881362641120812e+33, "policy_entropy": 3744.205322265625, "var_gnorm": 22.71574592590332, "vf_loss": 594019352576.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001577138900756836, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 129, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271925.65266716125, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15614212435883698, "mean_inference_ms": 5.236042233033342, "mean_action_processing_ms": 0.145765066557367, "mean_env_wait_ms": 0.2638393174396478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015491962432861328, "StateBufferConnector_ms": 0.002373933792114258, "ViewRequirementAgentConnector_ms": 0.06172466278076172}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271925.65266716125, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-255883.6016375026, -279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15614212435883698, "mean_inference_ms": 5.236042233033342, "mean_action_processing_ms": 0.145765066557367, "mean_env_wait_ms": 0.2638393174396478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015491962432861328, "StateBufferConnector_ms": 0.002373933792114258, "ViewRequirementAgentConnector_ms": 0.06172466278076172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43344, "timers": {"training_iteration_time_ms": 1979.452, "learn_time_ms": 19.317, "learn_throughput": 17394.364, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "done": false, "episodes_total": 129, "training_iteration": 129, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-19", "timestamp": 1711725199, "time_this_iter_s": 1.9841418266296387, "time_total_s": 255.25228905677795, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06b90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577bae560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 255.25228905677795, "timesteps_since_restore": 0, "iterations_since_restore": 129, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.533333333333332, "ram_util_percent": 22.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.523594288972856e+33, "policy_entropy": 3744.383544921875, "var_gnorm": 22.715744018554688, "vf_loss": 489372352512.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017774105072021484, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 130, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271751.3023530131, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15616352550154772, "mean_inference_ms": 5.236461287597706, "mean_action_processing_ms": 0.1457744293350881, "mean_env_wait_ms": 0.2638576687558722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015484333038330078, "StateBufferConnector_ms": 0.0023736953735351562, "ViewRequirementAgentConnector_ms": 0.06172657012939453}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271751.3023530131, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-279467.37030495313, -279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15616352550154772, "mean_inference_ms": 5.236461287597706, "mean_action_processing_ms": 0.1457744293350881, "mean_env_wait_ms": 0.2638576687558722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015484333038330078, "StateBufferConnector_ms": 0.0023736953735351562, "ViewRequirementAgentConnector_ms": 0.06172657012939453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43680, "timers": {"training_iteration_time_ms": 1981.39, "learn_time_ms": 19.292, "learn_throughput": 17416.742, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "done": false, "episodes_total": 130, "training_iteration": 130, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-21", "timestamp": 1711725201, "time_this_iter_s": 1.9660449028015137, "time_total_s": 257.21833395957947, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b052a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577bae200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 257.21833395957947, "timesteps_since_restore": 0, "iterations_since_restore": 130, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 22.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.980796576857454e+33, "policy_entropy": 3743.841552734375, "var_gnorm": 22.715744018554688, "vf_loss": 639371706368.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001684427261352539, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 131, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271752.7755550064, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15618547403586228, "mean_inference_ms": 5.236877255006282, "mean_action_processing_ms": 0.1457843785218272, "mean_env_wait_ms": 0.26387670088747694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015510082244873047, "StateBufferConnector_ms": 0.00237274169921875, "ViewRequirementAgentConnector_ms": 0.061751365661621094}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271752.7755550064, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-279210.8809093244, -305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15618547403586228, "mean_inference_ms": 5.236877255006282, "mean_action_processing_ms": 0.1457843785218272, "mean_env_wait_ms": 0.26387670088747694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015510082244873047, "StateBufferConnector_ms": 0.00237274169921875, "ViewRequirementAgentConnector_ms": 0.061751365661621094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44016, "timers": {"training_iteration_time_ms": 1979.786, "learn_time_ms": 19.268, "learn_throughput": 17437.991, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "done": false, "episodes_total": 131, "training_iteration": 131, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-23", "timestamp": 1711725203, "time_this_iter_s": 1.9644694328308105, "time_total_s": 259.1828033924103, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac4b80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779d9510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 259.1828033924103, "timesteps_since_restore": 0, "iterations_since_restore": 131, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.133333333333333, "ram_util_percent": 21.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2076062473997307e+33, "policy_entropy": 3743.640625, "var_gnorm": 22.71574592590332, "vf_loss": 757410234368.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015747547149658203, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 132, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271900.26994338655, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15620673936919668, "mean_inference_ms": 5.237278978278563, "mean_action_processing_ms": 0.14579430098959673, "mean_env_wait_ms": 0.2638954473883328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015495777130126953, "StateBufferConnector_ms": 0.0023720264434814453, "ViewRequirementAgentConnector_ms": 0.061738014221191406}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271900.26994338655, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-305811.2978766699, -278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15620673936919668, "mean_inference_ms": 5.237278978278563, "mean_action_processing_ms": 0.14579430098959673, "mean_env_wait_ms": 0.2638954473883328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015495777130126953, "StateBufferConnector_ms": 0.0023720264434814453, "ViewRequirementAgentConnector_ms": 0.061738014221191406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44352, "timers": {"training_iteration_time_ms": 1978.968, "learn_time_ms": 19.222, "learn_throughput": 17480.038, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "done": false, "episodes_total": 132, "training_iteration": 132, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-25", "timestamp": 1711725205, "time_this_iter_s": 1.9606013298034668, "time_total_s": 261.14340472221375, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05a50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b5ae60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 261.14340472221375, "timesteps_since_restore": 0, "iterations_since_restore": 132, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 21.049999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.380962882968613e+33, "policy_entropy": 3744.44140625, "var_gnorm": 22.715744018554688, "vf_loss": 734510776320.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016677379608154297, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 133, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271715.5401548257, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15622785293555158, "mean_inference_ms": 5.237671187753831, "mean_action_processing_ms": 0.14580424287620794, "mean_env_wait_ms": 0.26391470657325916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015489816665649414, "StateBufferConnector_ms": 0.0023717880249023438, "ViewRequirementAgentConnector_ms": 0.0617375373840332}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271715.5401548257, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-278037.56897798454, -285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15622785293555158, "mean_inference_ms": 5.237671187753831, "mean_action_processing_ms": 0.14580424287620794, "mean_env_wait_ms": 0.26391470657325916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015489816665649414, "StateBufferConnector_ms": 0.0023717880249023438, "ViewRequirementAgentConnector_ms": 0.0617375373840332}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44688, "timers": {"training_iteration_time_ms": 1975.913, "learn_time_ms": 19.133, "learn_throughput": 17561.439, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "done": false, "episodes_total": 133, "training_iteration": 133, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-27", "timestamp": 1711725207, "time_this_iter_s": 1.947925090789795, "time_total_s": 263.09132981300354, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577aceb00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779d9900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 263.09132981300354, "timesteps_since_restore": 0, "iterations_since_restore": 133, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 20.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.991394830160352e+33, "policy_entropy": 3744.396484375, "var_gnorm": 22.715744018554688, "vf_loss": 677047828480.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001596212387084961, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 134, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271722.81247312, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15624766466809278, "mean_inference_ms": 5.238052713042617, "mean_action_processing_ms": 0.14581378737975037, "mean_env_wait_ms": 0.2639335082727716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01549386978149414, "StateBufferConnector_ms": 0.002370119094848633, "ViewRequirementAgentConnector_ms": 0.061731815338134766}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271722.81247312, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-285641.7819967891, -276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15624766466809278, "mean_inference_ms": 5.238052713042617, "mean_action_processing_ms": 0.14581378737975037, "mean_env_wait_ms": 0.2639335082727716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01549386978149414, "StateBufferConnector_ms": 0.002370119094848633, "ViewRequirementAgentConnector_ms": 0.061731815338134766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45024, "timers": {"training_iteration_time_ms": 1972.476, "learn_time_ms": 19.07, "learn_throughput": 17619.491, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "done": false, "episodes_total": 134, "training_iteration": 134, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-29", "timestamp": 1711725209, "time_this_iter_s": 1.9614837169647217, "time_total_s": 265.05281352996826, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577acf6d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x781577b97ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 265.05281352996826, "timesteps_since_restore": 0, "iterations_since_restore": 134, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 20.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.9082693229174073e+32, "policy_entropy": 3744.72607421875, "var_gnorm": 22.715744018554688, "vf_loss": 605840670720.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00019657611846923828, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 135, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271540.49636930187, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15626727081968286, "mean_inference_ms": 5.238443925362486, "mean_action_processing_ms": 0.14582340995249926, "mean_env_wait_ms": 0.2639523553763282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015508174896240234, "StateBufferConnector_ms": 0.0023703575134277344, "ViewRequirementAgentConnector_ms": 0.06174421310424805}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271540.49636930187, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276530.9090295316, -276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15626727081968286, "mean_inference_ms": 5.238443925362486, "mean_action_processing_ms": 0.14582340995249926, "mean_env_wait_ms": 0.2639523553763282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015508174896240234, "StateBufferConnector_ms": 0.0023703575134277344, "ViewRequirementAgentConnector_ms": 0.06174421310424805}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45360, "timers": {"training_iteration_time_ms": 1969.731, "learn_time_ms": 19.106, "learn_throughput": 17586.18, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "done": false, "episodes_total": 135, "training_iteration": 135, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-31", "timestamp": 1711725211, "time_this_iter_s": 1.9801523685455322, "time_total_s": 267.0329658985138, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05570>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779d8790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 267.0329658985138, "timesteps_since_restore": 0, "iterations_since_restore": 135, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 20.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.149594652974173e+33, "policy_entropy": 3745.28955078125, "var_gnorm": 22.71574592590332, "vf_loss": 756163215360.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001443624496459961, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 136, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271700.74050657474, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15628781679674492, "mean_inference_ms": 5.238856379780969, "mean_action_processing_ms": 0.1458338835996244, "mean_env_wait_ms": 0.2639730698935097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015517950057983398, "StateBufferConnector_ms": 0.0023708343505859375, "ViewRequirementAgentConnector_ms": 0.06176304817199707}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271700.74050657474, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276541.0317147833, -271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15628781679674492, "mean_inference_ms": 5.238856379780969, "mean_action_processing_ms": 0.1458338835996244, "mean_env_wait_ms": 0.2639730698935097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015517950057983398, "StateBufferConnector_ms": 0.0023708343505859375, "ViewRequirementAgentConnector_ms": 0.06176304817199707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1969.43, "learn_time_ms": 19.131, "learn_throughput": 17563.058, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "done": false, "episodes_total": 136, "training_iteration": 136, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-33", "timestamp": 1711725213, "time_this_iter_s": 1.9712467193603516, "time_total_s": 269.00421261787415, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05c90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779d97e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 269.00421261787415, "timesteps_since_restore": 0, "iterations_since_restore": 136, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 20.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.86800129433025e+32, "policy_entropy": 3746.1748046875, "var_gnorm": 22.71574592590332, "vf_loss": 588090966016.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001709461212158203, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 137, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271506.391075135, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15630853101923714, "mean_inference_ms": 5.239275174630475, "mean_action_processing_ms": 0.14584481393844193, "mean_env_wait_ms": 0.2639944539478269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015517473220825195, "StateBufferConnector_ms": 0.002370595932006836, "ViewRequirementAgentConnector_ms": 0.0617833137512207}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271506.391075135, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-271365.0876790914, -275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15630853101923714, "mean_inference_ms": 5.239275174630475, "mean_action_processing_ms": 0.14584481393844193, "mean_env_wait_ms": 0.2639944539478269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015517473220825195, "StateBufferConnector_ms": 0.002370595932006836, "ViewRequirementAgentConnector_ms": 0.0617833137512207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46032, "timers": {"training_iteration_time_ms": 1966.933, "learn_time_ms": 19.139, "learn_throughput": 17556.166, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "done": false, "episodes_total": 137, "training_iteration": 137, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-35", "timestamp": 1711725215, "time_this_iter_s": 1.971379041671753, "time_total_s": 270.9755916595459, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b04a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779da7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 270.9755916595459, "timesteps_since_restore": 0, "iterations_since_restore": 137, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.699999999999999, "ram_util_percent": 20.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.886505922649144e+32, "policy_entropy": 3744.7314453125, "var_gnorm": 22.71574592590332, "vf_loss": 521772695552.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001990795135498047, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 138, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271350.98117689864, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15632886975765248, "mean_inference_ms": 5.2396842330932145, "mean_action_processing_ms": 0.14585565726958727, "mean_env_wait_ms": 0.26401592108506106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015526294708251953, "StateBufferConnector_ms": 0.002371072769165039, "ViewRequirementAgentConnector_ms": 0.06178784370422363}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271350.98117689864, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-275255.71544415754, -287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15632886975765248, "mean_inference_ms": 5.2396842330932145, "mean_action_processing_ms": 0.14585565726958727, "mean_env_wait_ms": 0.26401592108506106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015526294708251953, "StateBufferConnector_ms": 0.002371072769165039, "ViewRequirementAgentConnector_ms": 0.06178784370422363}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46368, "timers": {"training_iteration_time_ms": 1967.161, "learn_time_ms": 18.957, "learn_throughput": 17724.417, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "done": false, "episodes_total": 138, "training_iteration": 138, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-37", "timestamp": 1711725217, "time_this_iter_s": 1.9690756797790527, "time_total_s": 272.94466733932495, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b05fc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779db1c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 272.94466733932495, "timesteps_since_restore": 0, "iterations_since_restore": 138, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.699999999999999, "ram_util_percent": 20.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.5806072471387e+33, "policy_entropy": 3745.91259765625, "var_gnorm": 22.71574592590332, "vf_loss": 804509319168.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001417398452758789, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 139, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271603.13646216603, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635, -300471.24397089763], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1563484554039513, "mean_inference_ms": 5.240063895915576, "mean_action_processing_ms": 0.14586586590723097, "mean_env_wait_ms": 0.26403578743658374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015540838241577148, "StateBufferConnector_ms": 0.0023713111877441406, "ViewRequirementAgentConnector_ms": 0.061815738677978516}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271603.13646216603, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-287489.33125055145, -305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635, -300471.24397089763], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1563484554039513, "mean_inference_ms": 5.240063895915576, "mean_action_processing_ms": 0.14586586590723097, "mean_env_wait_ms": 0.26403578743658374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015540838241577148, "StateBufferConnector_ms": 0.0023713111877441406, "ViewRequirementAgentConnector_ms": 0.061815738677978516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46704, "timers": {"training_iteration_time_ms": 1964.892, "learn_time_ms": 18.907, "learn_throughput": 17771.22, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "done": false, "episodes_total": 139, "training_iteration": 139, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-39", "timestamp": 1711725219, "time_this_iter_s": 1.9614620208740234, "time_total_s": 274.906129360199, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b06020>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779d9630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 274.906129360199, "timesteps_since_restore": 0, "iterations_since_restore": 139, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 20.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.112012733167053e+33, "policy_entropy": 3744.487548828125, "var_gnorm": 22.71574592590332, "vf_loss": 574452072448.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017511844635009766, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 140, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271281.65538568946, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635, -300471.24397089763, -255341.22360289283], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15636808067264496, "mean_inference_ms": 5.240435325231529, "mean_action_processing_ms": 0.14587632960316563, "mean_env_wait_ms": 0.2640557754636025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01554417610168457, "StateBufferConnector_ms": 0.0023729801177978516, "ViewRequirementAgentConnector_ms": 0.06184077262878418}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -271281.65538568946, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-305709.36399841734, -283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635, -300471.24397089763, -255341.22360289283], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15636808067264496, "mean_inference_ms": 5.240435325231529, "mean_action_processing_ms": 0.14587632960316563, "mean_env_wait_ms": 0.2640557754636025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01554417610168457, "StateBufferConnector_ms": 0.0023729801177978516, "ViewRequirementAgentConnector_ms": 0.06184077262878418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47040, "timers": {"training_iteration_time_ms": 1962.692, "learn_time_ms": 18.917, "learn_throughput": 17761.947, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "done": false, "episodes_total": 140, "training_iteration": 140, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-41", "timestamp": 1711725221, "time_this_iter_s": 1.9440255165100098, "time_total_s": 276.850154876709, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577ac63e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779dbb50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 276.850154876709, "timesteps_since_restore": 0, "iterations_since_restore": 140, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 20.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0955988253277337e+33, "policy_entropy": 3744.057861328125, "var_gnorm": 22.71574592590332, "vf_loss": 549843173376.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00019741058349609375, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 141, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -270757.51576509577, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635, -300471.24397089763, -255341.22360289283, -253295.40193904575], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15638780796506133, "mean_inference_ms": 5.24081526236651, "mean_action_processing_ms": 0.14588716803835444, "mean_env_wait_ms": 0.26407626278544855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015558004379272461, "StateBufferConnector_ms": 0.002373933792114258, "ViewRequirementAgentConnector_ms": 0.06188845634460449}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -270757.51576509577, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-283165.7091985025, -280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635, -300471.24397089763, -255341.22360289283, -253295.40193904575], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15638780796506133, "mean_inference_ms": 5.24081526236651, "mean_action_processing_ms": 0.14588716803835444, "mean_env_wait_ms": 0.26407626278544855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015558004379272461, "StateBufferConnector_ms": 0.002373933792114258, "ViewRequirementAgentConnector_ms": 0.06188845634460449}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47376, "timers": {"training_iteration_time_ms": 1967.853, "learn_time_ms": 18.985, "learn_throughput": 17698.396, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "done": false, "episodes_total": 141, "training_iteration": 141, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-43", "timestamp": 1711725223, "time_this_iter_s": 2.016073703765869, "time_total_s": 278.86622858047485, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b07070>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779d84c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 278.86622858047485, "timesteps_since_restore": 0, "iterations_since_restore": 141, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 6.633333333333333, "ram_util_percent": 21.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5045049660991564e+33, "policy_entropy": 3744.50927734375, "var_gnorm": 22.71574592590332, "vf_loss": 627901726720.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015497207641601562, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 142, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "sampler_results": {"episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -270685.49450303835, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635, -300471.24397089763, -255341.22360289283, -253295.40193904575, -275963.58299276244], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1564079347267015, "mean_inference_ms": 5.241213741047749, "mean_action_processing_ms": 0.14589848623055843, "mean_env_wait_ms": 0.2640972517765774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015563249588012695, "StateBufferConnector_ms": 0.0023729801177978516, "ViewRequirementAgentConnector_ms": 0.06187844276428223}}, "episode_reward_max": -234329.5490397994, "episode_reward_min": -325749.3376423783, "episode_reward_mean": -270685.49450303835, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-280585.64350639615, -276547.6724714712, -267766.62067206594, -268679.8150013692, -288784.6432024777, -272339.15366922587, -261280.46603354847, -296865.8061416473, -287743.3764204222, -257651.27679806398, -282480.78900321195, -268491.5561439243, -275416.39926198253, -288254.5342580937, -279269.50326805736, -289025.0938454753, -245384.13301996008, -284445.8160450789, -256601.7734650861, -273167.74152573314, -254339.238064137, -255161.27068145925, -263683.33065667964, -270167.322836632, -234466.48552798224, -251965.15956662846, -254267.1888757238, -286759.1227191227, -261800.3731872855, -242558.4251804332, -254168.3605167219, -263990.3720810281, -272898.560566274, -239518.03780561613, -253070.3356959439, -262313.16556595487, -310829.69449029973, -268951.28368228086, -286347.8161654515, -268866.41101694456, -298522.56151726627, -283090.19727504026, -290987.44649887155, -273128.2998927457, -258289.9541978178, -273017.76080979995, -279829.90456838504, -279003.42616977805, -234329.5490397994, -269106.2838386575, -272400.94035389705, -286054.56780027907, -276315.9875600908, -270790.78772589756, -253054.13826241106, -266349.75565296144, -294497.79372860544, -267657.59693662944, -262096.08103241504, -250608.71855666162, -281869.5887917373, -278857.68878183176, -268940.61681877973, -264589.42503721896, -279670.52806851827, -271141.4627720357, -251548.65436264224, -259212.3921895569, -254345.7919720556, -253657.71873433253, -259805.20198362027, -262263.2114839883, -276963.5380822802, -295701.3774161431, -278257.0885123979, -292550.35093463655, -273320.0367371409, -243445.8440629565, -325749.3376423783, -245511.2537696125, -266399.5509455538, -265323.2850999606, -269939.2382142803, -301383.6971306248, -288716.93334029615, -268929.0543612356, -258327.22939815163, -238448.5702226867, -279614.69050428376, -293960.31974734267, -287338.31902058446, -278764.8008074077, -267410.1716149793, -292555.32275681593, -257106.08857081228, -255824.09785545635, -300471.24397089763, -255341.22360289283, -253295.40193904575, -275963.58299276244], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1564079347267015, "mean_inference_ms": 5.241213741047749, "mean_action_processing_ms": 0.14589848623055843, "mean_env_wait_ms": 0.2640972517765774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015563249588012695, "StateBufferConnector_ms": 0.0023729801177978516, "ViewRequirementAgentConnector_ms": 0.06187844276428223}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47712, "timers": {"training_iteration_time_ms": 1973.369, "learn_time_ms": 19.089, "learn_throughput": 17602.215, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "done": false, "episodes_total": 142, "training_iteration": 142, "trial_id": "4259f_00000", "experiment_id": "747b0ba38abf4381a1153436e969d982", "date": "2024-03-29_15-13-45", "timestamp": 1711725225, "time_this_iter_s": 2.015807628631592, "time_total_s": 280.88203620910645, "pid": 165225, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x781577b07280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7815779dac20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 280.88203620910645, "timesteps_since_restore": 0, "iterations_since_restore": 142, "warmup_time": 2.999915361404419, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 21.133333333333336}}
