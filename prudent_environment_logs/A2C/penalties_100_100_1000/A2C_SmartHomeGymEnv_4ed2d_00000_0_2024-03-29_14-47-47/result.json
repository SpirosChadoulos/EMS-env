{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -149372752.0, "policy_entropy": 4261.99267578125, "var_gnorm": 22.627458572387695, "vf_loss": 265552740352.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -2.384185791015625e-07, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 1, "diff_num_grad_updates_vs_sampler_policy": 0}}, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "sampler_results": {"episode_reward_max": -55110.094516666664, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -76985.20417875, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667], "episode_lengths": [48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19010804173500673, "mean_inference_ms": 5.485602585427485, "mean_action_processing_ms": 0.1596626259099128, "mean_env_wait_ms": 0.5921461461913337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01668248857770647, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06981236594063896}}, "episode_reward_max": -55110.094516666664, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -76985.20417875, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667], "episode_lengths": [48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19010804173500673, "mean_inference_ms": 5.485602585427485, "mean_action_processing_ms": 0.1596626259099128, "mean_env_wait_ms": 0.5921461461913337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01668248857770647, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06981236594063896}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 336, "timers": {"training_iteration_time_ms": 2456.636, "learn_time_ms": 285.739, "learn_throughput": 1175.897, "synch_weights_time_ms": 0.206}, "counters": {"num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "done": false, "episodes_total": 7, "training_iteration": 1, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-47-57", "timestamp": 1711723677, "time_this_iter_s": 2.456925868988037, "time_total_s": 2.456925868988037, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc530ee0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x775f69cf2e60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 2.456925868988037, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 7.949999999999999, "ram_util_percent": 9.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -95675152.0, "policy_entropy": 4399.71484375, "var_gnorm": 22.63076400756836, "vf_loss": 122718232576.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -4.076957702636719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 2, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "sampler_results": {"episode_reward_max": -51837.69067583333, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -68777.45021869049, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1899557746147717, "mean_inference_ms": 5.447957830148063, "mean_action_processing_ms": 0.15683272023248732, "mean_env_wait_ms": 0.5876373853319369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016849381583077565, "StateBufferConnector_ms": 0.002590247562953404, "ViewRequirementAgentConnector_ms": 0.07105725152151925}}, "episode_reward_max": -51837.69067583333, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -68777.45021869049, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1899557746147717, "mean_inference_ms": 5.447957830148063, "mean_action_processing_ms": 0.15683272023248732, "mean_env_wait_ms": 0.5876373853319369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016849381583077565, "StateBufferConnector_ms": 0.002590247562953404, "ViewRequirementAgentConnector_ms": 0.07105725152151925}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 672, "timers": {"training_iteration_time_ms": 2289.336, "learn_time_ms": 152.356, "learn_throughput": 2205.362, "synch_weights_time_ms": 0.177}, "counters": {"num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "done": false, "episodes_total": 14, "training_iteration": 2, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-47-59", "timestamp": 1711723679, "time_this_iter_s": 2.1223082542419434, "time_total_s": 4.5792341232299805, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc5322c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5265f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 4.5792341232299805, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.233333333333334, "ram_util_percent": 9.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -79790816.0, "policy_entropy": 4104.25537109375, "var_gnorm": 22.633190155029297, "vf_loss": 85844557824.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.00010704994201660156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 3, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "sampler_results": {"episode_reward_max": -40707.029979583334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -62384.382310436515, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18878677093395022, "mean_inference_ms": 5.426876189835635, "mean_action_processing_ms": 0.15519030664464456, "mean_env_wait_ms": 0.5847049703635688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016643887474423365, "StateBufferConnector_ms": 0.0025465374901181177, "ViewRequirementAgentConnector_ms": 0.0696102778116862}}, "episode_reward_max": -40707.029979583334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -62384.382310436515, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18878677093395022, "mean_inference_ms": 5.426876189835635, "mean_action_processing_ms": 0.15519030664464456, "mean_env_wait_ms": 0.5847049703635688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016643887474423365, "StateBufferConnector_ms": 0.0025465374901181177, "ViewRequirementAgentConnector_ms": 0.0696102778116862}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1008, "timers": {"training_iteration_time_ms": 2231.743, "learn_time_ms": 107.838, "learn_throughput": 3115.799, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "done": false, "episodes_total": 21, "training_iteration": 3, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-01", "timestamp": 1711723681, "time_this_iter_s": 2.1168410778045654, "time_total_s": 6.696075201034546, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc532cb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc526950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 6.696075201034546, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 9.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -73095296.0, "policy_entropy": 3706.114501953125, "var_gnorm": 22.635757446289062, "vf_loss": 81313734656.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0001857280731201172, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 4, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "sampler_results": {"episode_reward_max": -36506.78608624999, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -58717.680649642854, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18823117805227657, "mean_inference_ms": 5.415798072921217, "mean_action_processing_ms": 0.1540137193469162, "mean_env_wait_ms": 0.5826171289998688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01662543841770717, "StateBufferConnector_ms": 0.002524682453700474, "ViewRequirementAgentConnector_ms": 0.07033348083496094}}, "episode_reward_max": -36506.78608624999, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -58717.680649642854, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18823117805227657, "mean_inference_ms": 5.415798072921217, "mean_action_processing_ms": 0.1540137193469162, "mean_env_wait_ms": 0.5826171289998688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01662543841770717, "StateBufferConnector_ms": 0.002524682453700474, "ViewRequirementAgentConnector_ms": 0.07033348083496094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1344, "timers": {"training_iteration_time_ms": 2206.948, "learn_time_ms": 85.615, "learn_throughput": 3924.569, "synch_weights_time_ms": 0.16}, "counters": {"num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "done": false, "episodes_total": 28, "training_iteration": 4, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-03", "timestamp": 1711723683, "time_this_iter_s": 2.1328742504119873, "time_total_s": 8.828949451446533, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc5a4220>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc527ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 8.828949451446533, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.7, "ram_util_percent": 10.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -60428812.0, "policy_entropy": 3369.018310546875, "var_gnorm": 22.637155532836914, "vf_loss": 61570670592.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.00027048587799072266, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 5, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "sampler_results": {"episode_reward_max": -29045.87162875, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -55542.7864842262, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18756228829591837, "mean_inference_ms": 5.406695293613652, "mean_action_processing_ms": 0.15316128474532023, "mean_env_wait_ms": 0.5809094248195278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016542162214006697, "StateBufferConnector_ms": 0.002486365182059152, "ViewRequirementAgentConnector_ms": 0.07000173841203962}}, "episode_reward_max": -29045.87162875, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -55542.7864842262, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18756228829591837, "mean_inference_ms": 5.406695293613652, "mean_action_processing_ms": 0.15316128474532023, "mean_env_wait_ms": 0.5809094248195278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016542162214006697, "StateBufferConnector_ms": 0.002486365182059152, "ViewRequirementAgentConnector_ms": 0.07000173841203962}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1680, "timers": {"training_iteration_time_ms": 2187.634, "learn_time_ms": 72.356, "learn_throughput": 4643.719, "synch_weights_time_ms": 0.176}, "counters": {"num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "done": false, "episodes_total": 35, "training_iteration": 5, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-06", "timestamp": 1711723686, "time_this_iter_s": 2.1107242107391357, "time_total_s": 10.939673662185669, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc5a5240>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc527eb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 10.939673662185669, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.733333333333333, "ram_util_percent": 10.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -57182140.0, "policy_entropy": 2885.847412109375, "var_gnorm": 22.64002799987793, "vf_loss": 64839700480.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0003743171691894531, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 6, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "sampler_results": {"episode_reward_max": -29045.87162875, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -53472.31185545636, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1869983088229707, "mean_inference_ms": 5.399873238205532, "mean_action_processing_ms": 0.15251527986672303, "mean_env_wait_ms": 0.5794448678608138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016586553482782273, "StateBufferConnector_ms": 0.0024551437014625186, "ViewRequirementAgentConnector_ms": 0.0698935417901902}}, "episode_reward_max": -29045.87162875, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -53472.31185545636, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1869983088229707, "mean_inference_ms": 5.399873238205532, "mean_action_processing_ms": 0.15251527986672303, "mean_env_wait_ms": 0.5794448678608138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016586553482782273, "StateBufferConnector_ms": 0.0024551437014625186, "ViewRequirementAgentConnector_ms": 0.0698935417901902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2016, "timers": {"training_iteration_time_ms": 2175.918, "learn_time_ms": 63.468, "learn_throughput": 5294.002, "synch_weights_time_ms": 0.171}, "counters": {"num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "done": false, "episodes_total": 42, "training_iteration": 6, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-08", "timestamp": 1711723688, "time_this_iter_s": 2.117705821990967, "time_total_s": 13.057379484176636, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc5a5d80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5ac310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 13.057379484176636, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 10.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -61755056.0, "policy_entropy": 2375.600830078125, "var_gnorm": 22.64380645751953, "vf_loss": 91390672896.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.00038433074951171875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 7, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "sampler_results": {"episode_reward_max": -29045.87162875, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -52753.40451209183, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18646427774167687, "mean_inference_ms": 5.393986286036771, "mean_action_processing_ms": 0.15199909387086655, "mean_env_wait_ms": 0.5781775085699932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017089259867765466, "StateBufferConnector_ms": 0.0024386814662388395, "ViewRequirementAgentConnector_ms": 0.06956956824477838}}, "episode_reward_max": -29045.87162875, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -52753.40451209183, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18646427774167687, "mean_inference_ms": 5.393986286036771, "mean_action_processing_ms": 0.15199909387086655, "mean_env_wait_ms": 0.5781775085699932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017089259867765466, "StateBufferConnector_ms": 0.0024386814662388395, "ViewRequirementAgentConnector_ms": 0.06956956824477838}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2352, "timers": {"training_iteration_time_ms": 2166.05, "learn_time_ms": 57.119, "learn_throughput": 5882.463, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "done": false, "episodes_total": 49, "training_iteration": 7, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-10", "timestamp": 1711723690, "time_this_iter_s": 2.1072025299072266, "time_total_s": 15.164582014083862, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc5a69b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5acdc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 15.164582014083862, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.366666666666667, "ram_util_percent": 10.266666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -47090340.0, "policy_entropy": 1808.899658203125, "var_gnorm": 22.647438049316406, "vf_loss": 75630002176.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.00048220157623291016, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 8, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "sampler_results": {"episode_reward_max": -29045.87162875, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -51947.61965479911, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18599332267255933, "mean_inference_ms": 5.389055225372759, "mean_action_processing_ms": 0.15157596223155417, "mean_env_wait_ms": 0.5771155033654394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01687620367322649, "StateBufferConnector_ms": 0.0024208000728062223, "ViewRequirementAgentConnector_ms": 0.06922270570482526}}, "episode_reward_max": -29045.87162875, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -51947.61965479911, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18599332267255933, "mean_inference_ms": 5.389055225372759, "mean_action_processing_ms": 0.15157596223155417, "mean_env_wait_ms": 0.5771155033654394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01687620367322649, "StateBufferConnector_ms": 0.0024208000728062223, "ViewRequirementAgentConnector_ms": 0.06922270570482526}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 2159.2, "learn_time_ms": 52.37, "learn_throughput": 6415.948, "synch_weights_time_ms": 0.164}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "done": false, "episodes_total": 56, "training_iteration": 8, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-12", "timestamp": 1711723692, "time_this_iter_s": 2.111633539199829, "time_total_s": 17.27621555328369, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc5a74c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5ad240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 17.27621555328369, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.466666666666666, "ram_util_percent": 10.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -35114184.0, "policy_entropy": 1383.1181640625, "var_gnorm": 22.650278091430664, "vf_loss": 51144835072.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0006233453750610352, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 9, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "sampler_results": {"episode_reward_max": -28115.4426425, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -50545.70508505954, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18564415504924184, "mean_inference_ms": 5.385176204909481, "mean_action_processing_ms": 0.1512255995773905, "mean_env_wait_ms": 0.5763211728833352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01689933595203218, "StateBufferConnector_ms": 0.0024269497583782862, "ViewRequirementAgentConnector_ms": 0.06950355711437407}}, "episode_reward_max": -28115.4426425, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -50545.70508505954, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18564415504924184, "mean_inference_ms": 5.385176204909481, "mean_action_processing_ms": 0.1512255995773905, "mean_env_wait_ms": 0.5763211728833352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01689933595203218, "StateBufferConnector_ms": 0.0024269497583782862, "ViewRequirementAgentConnector_ms": 0.06950355711437407}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3024, "timers": {"training_iteration_time_ms": 2155.4, "learn_time_ms": 48.697, "learn_throughput": 6899.799, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "done": false, "episodes_total": 63, "training_iteration": 9, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-14", "timestamp": 1711723694, "time_this_iter_s": 2.125394105911255, "time_total_s": 19.401609659194946, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc532140>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5ac8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 19.401609659194946, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.433333333333334, "ram_util_percent": 10.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -26892020.0, "policy_entropy": 913.4774169921875, "var_gnorm": 22.654312133789062, "vf_loss": 38047199232.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0009082555770874023, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 10, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -48739.98209974999, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18531920065373672, "mean_inference_ms": 5.381840571140199, "mean_action_processing_ms": 0.15092911421249378, "mean_env_wait_ms": 0.5756334072793362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016777856009347097, "StateBufferConnector_ms": 0.0024165425981794086, "ViewRequirementAgentConnector_ms": 0.06931781768798828}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -48739.98209974999, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18531920065373672, "mean_inference_ms": 5.381840571140199, "mean_action_processing_ms": 0.15092911421249378, "mean_env_wait_ms": 0.5756334072793362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016777856009347097, "StateBufferConnector_ms": 0.0024165425981794086, "ViewRequirementAgentConnector_ms": 0.06931781768798828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3360, "timers": {"training_iteration_time_ms": 2151.213, "learn_time_ms": 45.758, "learn_throughput": 7342.958, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "done": false, "episodes_total": 70, "training_iteration": 10, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-16", "timestamp": 1711723696, "time_this_iter_s": 2.113948345184326, "time_total_s": 21.515558004379272, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc446320>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5ae710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 21.515558004379272, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.833333333333333, "ram_util_percent": 10.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -24645850.0, "policy_entropy": 579.0067138671875, "var_gnorm": 22.656667709350586, "vf_loss": 43580141568.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0009964704513549805, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 11, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -47475.41250667208, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18506314774288626, "mean_inference_ms": 5.379259721634246, "mean_action_processing_ms": 0.15068186965025684, "mean_env_wait_ms": 0.5750708842682484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016770734415425884, "StateBufferConnector_ms": 0.0024163877809202515, "ViewRequirementAgentConnector_ms": 0.06956527759502461}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -47475.41250667208, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18506314774288626, "mean_inference_ms": 5.379259721634246, "mean_action_processing_ms": 0.15068186965025684, "mean_env_wait_ms": 0.5750708842682484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016770734415425884, "StateBufferConnector_ms": 0.0024163877809202515, "ViewRequirementAgentConnector_ms": 0.06956527759502461}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3696, "timers": {"training_iteration_time_ms": 2118.63, "learn_time_ms": 19.151, "learn_throughput": 17545.129, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "done": false, "episodes_total": 77, "training_iteration": 11, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-18", "timestamp": 1711723698, "time_this_iter_s": 2.131234884262085, "time_total_s": 23.646792888641357, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc445720>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5ada20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 23.646792888641357, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.525, "ram_util_percent": 10.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -20619566.0, "policy_entropy": 195.50143432617188, "var_gnorm": 22.66002655029297, "vf_loss": 36378370048.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0011366605758666992, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 12, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -46209.18750388393, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18486812902225486, "mean_inference_ms": 5.377542692377704, "mean_action_processing_ms": 0.15047807655582868, "mean_env_wait_ms": 0.5746214716001601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01678211348397391, "StateBufferConnector_ms": 0.0024338563283284507, "ViewRequirementAgentConnector_ms": 0.06973516373407274}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -46209.18750388393, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18486812902225486, "mean_inference_ms": 5.377542692377704, "mean_action_processing_ms": 0.15047807655582868, "mean_env_wait_ms": 0.5746214716001601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01678211348397391, "StateBufferConnector_ms": 0.0024338563283284507, "ViewRequirementAgentConnector_ms": 0.06973516373407274}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4032, "timers": {"training_iteration_time_ms": 2121.173, "learn_time_ms": 19.164, "learn_throughput": 17532.774, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "done": false, "episodes_total": 84, "training_iteration": 12, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-21", "timestamp": 1711723701, "time_this_iter_s": 2.1479382514953613, "time_total_s": 25.79473114013672, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc446fe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5ad240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 25.79473114013672, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.633333333333333, "ram_util_percent": 10.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -18956502.0, "policy_entropy": -60.70869445800781, "var_gnorm": 22.661968231201172, "vf_loss": 45336543232.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0011402368545532227, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 13, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -45430.765949377295, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1847187040461786, "mean_inference_ms": 5.37648361588606, "mean_action_processing_ms": 0.15030960966018103, "mean_env_wait_ms": 0.5742675517947982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016828421707991717, "StateBufferConnector_ms": 0.002434489491221669, "ViewRequirementAgentConnector_ms": 0.06987105359087933}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -45430.765949377295, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1847187040461786, "mean_inference_ms": 5.37648361588606, "mean_action_processing_ms": 0.15030960966018103, "mean_env_wait_ms": 0.5742675517947982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016828421707991717, "StateBufferConnector_ms": 0.002434489491221669, "ViewRequirementAgentConnector_ms": 0.06987105359087933}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4368, "timers": {"training_iteration_time_ms": 2124.685, "learn_time_ms": 19.217, "learn_throughput": 17484.419, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "done": false, "episodes_total": 91, "training_iteration": 13, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-23", "timestamp": 1711723703, "time_this_iter_s": 2.1521639823913574, "time_total_s": 27.946895122528076, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4582e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5af490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 27.946895122528076, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.833333333333333, "ram_util_percent": 10.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -15656776.0, "policy_entropy": -337.39337158203125, "var_gnorm": 22.664369583129883, "vf_loss": 44959387648.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.001167893409729004, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 14, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -44800.11300032312, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1845889405322328, "mean_inference_ms": 5.375615664059119, "mean_action_processing_ms": 0.1501668880817768, "mean_env_wait_ms": 0.5739740442832569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157136177530095, "StateBufferConnector_ms": 0.00243089636977838, "ViewRequirementAgentConnector_ms": 0.07002961878873865}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -90825.63321458333, "episode_reward_mean": -44800.11300032312, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72224.38548125, -81836.76248124999, -90825.63321458333, -82133.61041124999, -84824.59587083332, -55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1845889405322328, "mean_inference_ms": 5.375615664059119, "mean_action_processing_ms": 0.1501668880817768, "mean_env_wait_ms": 0.5739740442832569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017157136177530095, "StateBufferConnector_ms": 0.00243089636977838, "ViewRequirementAgentConnector_ms": 0.07002961878873865}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4704, "timers": {"training_iteration_time_ms": 2124.602, "learn_time_ms": 19.238, "learn_throughput": 17465.762, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "done": false, "episodes_total": 98, "training_iteration": 14, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-25", "timestamp": 1711723705, "time_this_iter_s": 2.132232427597046, "time_total_s": 30.079127550125122, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc5a5270>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5ad1b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 30.079127550125122, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 10.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -13698332.0, "policy_entropy": -495.81787109375, "var_gnorm": 22.665660858154297, "vf_loss": 41425219584.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0012508630752563477, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 15, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -71941.34727541667, "episode_reward_mean": -42175.785200424994, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18418654683611663, "mean_inference_ms": 5.36938340896761, "mean_action_processing_ms": 0.1495605614090951, "mean_env_wait_ms": 0.5728073246839555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0170743465423584, "StateBufferConnector_ms": 0.002412080764770508, "ViewRequirementAgentConnector_ms": 0.06994819641113281}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -71941.34727541667, "episode_reward_mean": -42175.785200424994, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-55110.094516666664, -71941.34727541667, -67150.65583291667, -65356.269453333356, -69822.54044416666, -51837.69067583333, -59271.6524175, -55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18418654683611663, "mean_inference_ms": 5.36938340896761, "mean_action_processing_ms": 0.1495605614090951, "mean_env_wait_ms": 0.5728073246839555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0170743465423584, "StateBufferConnector_ms": 0.002412080764770508, "ViewRequirementAgentConnector_ms": 0.06994819641113281}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 2126.806, "learn_time_ms": 19.2, "learn_throughput": 17500.377, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 105, "training_iteration": 15, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-27", "timestamp": 1711723707, "time_this_iter_s": 2.1328980922698975, "time_total_s": 32.21202564239502, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc45a4a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc468280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 32.21202564239502, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.666666666666667, "ram_util_percent": 10.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -13389385.0, "policy_entropy": -537.8314819335938, "var_gnorm": 22.665916442871094, "vf_loss": 42088038400.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.0013402700424194336, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 16, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -40207.453695812495, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18368834574325832, "mean_inference_ms": 5.364763108744164, "mean_action_processing_ms": 0.14904723335818593, "mean_env_wait_ms": 0.571735103029319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01706242561340332, "StateBufferConnector_ms": 0.0024001598358154297, "ViewRequirementAgentConnector_ms": 0.06996583938598633}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -40207.453695812495, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-55403.27654708335, -55145.788439583346, -43389.40894791668, -60524.20256041667, -56654.57575291666, -52132.07506958334, -49439.62609541667, -40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18368834574325832, "mean_inference_ms": 5.364763108744164, "mean_action_processing_ms": 0.14904723335818593, "mean_env_wait_ms": 0.571735103029319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01706242561340332, "StateBufferConnector_ms": 0.0024001598358154297, "ViewRequirementAgentConnector_ms": 0.06996583938598633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 2128.393, "learn_time_ms": 19.23, "learn_throughput": 17472.475, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "done": false, "episodes_total": 112, "training_iteration": 16, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-29", "timestamp": 1711723709, "time_this_iter_s": 2.13368558883667, "time_total_s": 34.34571123123169, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc459a80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5ae9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 34.34571123123169, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.6000000000000005, "ram_util_percent": 11.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -14216936.0, "policy_entropy": -507.33880615234375, "var_gnorm": 22.66583824157715, "vf_loss": 45498535936.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0012149810791015625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 17, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -38991.86223784584, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18335703166927028, "mean_inference_ms": 5.362923749261381, "mean_action_processing_ms": 0.14875011527372503, "mean_env_wait_ms": 0.5710665240059692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0170438289642334, "StateBufferConnector_ms": 0.002383708953857422, "ViewRequirementAgentConnector_ms": 0.0699155330657959}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -38991.86223784584, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40707.029979583334, -44340.807051666685, -46460.66218833332, -52146.34042791667, -46740.798461250015, -36506.78608624999, -56911.79881374998, -48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18335703166927028, "mean_inference_ms": 5.362923749261381, "mean_action_processing_ms": 0.14875011527372503, "mean_env_wait_ms": 0.5710665240059692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0170438289642334, "StateBufferConnector_ms": 0.002383708953857422, "ViewRequirementAgentConnector_ms": 0.0699155330657959}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5712, "timers": {"training_iteration_time_ms": 2130.609, "learn_time_ms": 19.264, "learn_throughput": 17441.682, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "done": false, "episodes_total": 119, "training_iteration": 17, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-31", "timestamp": 1711723711, "time_this_iter_s": 2.1295006275177, "time_total_s": 36.47521185874939, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc46c400>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc468c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 36.47521185874939, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.566666666666666, "ram_util_percent": 11.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -14047322.0, "policy_entropy": -449.04541015625, "var_gnorm": 22.665624618530273, "vf_loss": 47549935616.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.001214146614074707, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 18, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -38258.17104455, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18309475255550545, "mean_inference_ms": 5.361903323705685, "mean_action_processing_ms": 0.14857349414717333, "mean_env_wait_ms": 0.570641155484818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01700425148010254, "StateBufferConnector_ms": 0.002368927001953125, "ViewRequirementAgentConnector_ms": 0.06975913047790527}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -38258.17104455, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48527.59270916667, -46729.05098416665, -43150.08352083334, -47629.990969583334, -35336.3498275, -41933.346466250005, -54556.48218208334, -48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18309475255550545, "mean_inference_ms": 5.361903323705685, "mean_action_processing_ms": 0.14857349414717333, "mean_env_wait_ms": 0.570641155484818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01700425148010254, "StateBufferConnector_ms": 0.002368927001953125, "ViewRequirementAgentConnector_ms": 0.06975913047790527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6048, "timers": {"training_iteration_time_ms": 2134.555, "learn_time_ms": 19.284, "learn_throughput": 17423.719, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "done": false, "episodes_total": 126, "training_iteration": 18, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-34", "timestamp": 1711723714, "time_this_iter_s": 2.151217222213745, "time_total_s": 38.626429080963135, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc446d10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5ac430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 38.626429080963135, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 6.666666666666667, "ram_util_percent": 11.199999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -15453887.0, "policy_entropy": -343.8419494628906, "var_gnorm": 22.665239334106445, "vf_loss": 44285808640.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.0011179447174072266, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 19, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -37629.916832425006, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18295953875309912, "mean_inference_ms": 5.362153649127349, "mean_action_processing_ms": 0.14847065032901757, "mean_env_wait_ms": 0.5704304239155742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017078161239624023, "StateBufferConnector_ms": 0.0023818016052246094, "ViewRequirementAgentConnector_ms": 0.07027125358581543}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -37629.916832425006, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48250.34416291667, -29045.87162875, -40411.143319583316, -38914.465365416676, -42517.70986083334, -42515.106079583325, -41960.49211708333, -44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18295953875309912, "mean_inference_ms": 5.362153649127349, "mean_action_processing_ms": 0.14847065032901757, "mean_env_wait_ms": 0.5704304239155742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017078161239624023, "StateBufferConnector_ms": 0.0023818016052246094, "ViewRequirementAgentConnector_ms": 0.07027125358581543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6384, "timers": {"training_iteration_time_ms": 2141.702, "learn_time_ms": 19.308, "learn_throughput": 17401.774, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "done": false, "episodes_total": 133, "training_iteration": 19, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-36", "timestamp": 1711723716, "time_this_iter_s": 2.196955680847168, "time_total_s": 40.8233847618103, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc46cc70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc468670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 40.8233847618103, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 9.466666666666667, "ram_util_percent": 11.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -16256730.0, "policy_entropy": -236.25892639160156, "var_gnorm": 22.665090560913086, "vf_loss": 43930783744.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0010315179824829102, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 20, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -37293.30636127916, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18289462618086338, "mean_inference_ms": 5.363003123458798, "mean_action_processing_ms": 0.1484099529808101, "mean_env_wait_ms": 0.5703914991673794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017088890075683594, "StateBufferConnector_ms": 0.0023810863494873047, "ViewRequirementAgentConnector_ms": 0.07019591331481934}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -62268.90337166666, "episode_reward_mean": -37293.30636127916, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44009.89055416669, -51510.76368458333, -36460.69470041668, -54500.644108333356, -62268.90337166666, -38591.382907916675, -52385.73842541666, -50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18289462618086338, "mean_inference_ms": 5.363003123458798, "mean_action_processing_ms": 0.1484099529808101, "mean_env_wait_ms": 0.5703914991673794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017088890075683594, "StateBufferConnector_ms": 0.0023810863494873047, "ViewRequirementAgentConnector_ms": 0.07019591331481934}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6720, "timers": {"training_iteration_time_ms": 2145.314, "learn_time_ms": 19.321, "learn_throughput": 17390.479, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "done": false, "episodes_total": 140, "training_iteration": 20, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-38", "timestamp": 1711723718, "time_this_iter_s": 2.1501553058624268, "time_total_s": 42.97354006767273, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc45b850>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5acaf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 42.97354006767273, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 7.633333333333333, "ram_util_percent": 11.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -18778750.0, "policy_entropy": -127.79072570800781, "var_gnorm": 22.665172576904297, "vf_loss": 45620862976.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0010149478912353516, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 21, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -56004.82046625, "episode_reward_mean": -36562.37055474167, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18289390048112117, "mean_inference_ms": 5.364447537296699, "mean_action_processing_ms": 0.14838149280276727, "mean_env_wait_ms": 0.5704957755721352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017190933227539062, "StateBufferConnector_ms": 0.002389669418334961, "ViewRequirementAgentConnector_ms": 0.07062745094299316}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -56004.82046625, "episode_reward_mean": -36562.37055474167, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50587.09950958332, -44285.26014, -48495.35666583334, -44909.14330375001, -47602.58397958335, -44582.98104375001, -40981.90506166669, -41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18289390048112117, "mean_inference_ms": 5.364447537296699, "mean_action_processing_ms": 0.14838149280276727, "mean_env_wait_ms": 0.5704957755721352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017190933227539062, "StateBufferConnector_ms": 0.002389669418334961, "ViewRequirementAgentConnector_ms": 0.07062745094299316}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7056, "timers": {"training_iteration_time_ms": 2147.554, "learn_time_ms": 19.265, "learn_throughput": 17440.797, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "done": false, "episodes_total": 147, "training_iteration": 21, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-40", "timestamp": 1711723720, "time_this_iter_s": 2.153696060180664, "time_total_s": 45.127236127853394, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc447250>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5af5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 45.127236127853394, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 11.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -19518200.0, "policy_entropy": -28.863937377929688, "var_gnorm": 22.665380477905273, "vf_loss": 43494006784.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.0010304450988769531, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 22, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -56004.82046625, "episode_reward_mean": -35899.05284155834, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1829564820607309, "mean_inference_ms": 5.366750759098993, "mean_action_processing_ms": 0.14839045505203122, "mean_env_wait_ms": 0.5707523964383477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01732778549194336, "StateBufferConnector_ms": 0.0024008750915527344, "ViewRequirementAgentConnector_ms": 0.07118582725524902}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -56004.82046625, "episode_reward_mean": -35899.05284155834, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41573.089055416676, -56004.82046625, -37706.73877583334, -45492.60064333334, -28115.4426425, -51198.814694166664, -39789.51230625, -44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1829564820607309, "mean_inference_ms": 5.366750759098993, "mean_action_processing_ms": 0.14839045505203122, "mean_env_wait_ms": 0.5707523964383477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01732778549194336, "StateBufferConnector_ms": 0.0024008750915527344, "ViewRequirementAgentConnector_ms": 0.07118582725524902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7392, "timers": {"training_iteration_time_ms": 2153.191, "learn_time_ms": 19.529, "learn_throughput": 17205.237, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "done": false, "episodes_total": 154, "training_iteration": 22, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-42", "timestamp": 1711723722, "time_this_iter_s": 2.2044870853424072, "time_total_s": 47.3317232131958, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc46e9b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc469750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 47.3317232131958, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 8.466666666666667, "ram_util_percent": 11.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -21322006.0, "policy_entropy": 104.77467346191406, "var_gnorm": 22.665515899658203, "vf_loss": 49953771520.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0008714199066162109, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 23, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -46408.534741666655, "episode_reward_mean": -35764.44998613333, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1830860780938376, "mean_inference_ms": 5.37049857002964, "mean_action_processing_ms": 0.1484639061405229, "mean_env_wait_ms": 0.5712136686272121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017599821090698242, "StateBufferConnector_ms": 0.0024263858795166016, "ViewRequirementAgentConnector_ms": 0.07221531867980957}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -46408.534741666655, "episode_reward_mean": -35764.44998613333, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44007.88083583334, -29001.729792083344, -34125.002781250005, -45845.65336375, -28099.445847499996, -26918.888179166664, -34416.50839166666, -31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1830860780938376, "mean_inference_ms": 5.37049857002964, "mean_action_processing_ms": 0.1484639061405229, "mean_env_wait_ms": 0.5712136686272121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017599821090698242, "StateBufferConnector_ms": 0.0024263858795166016, "ViewRequirementAgentConnector_ms": 0.07221531867980957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7728, "timers": {"training_iteration_time_ms": 2170.211, "learn_time_ms": 19.495, "learn_throughput": 17235.538, "synch_weights_time_ms": 0.164}, "counters": {"num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "done": false, "episodes_total": 161, "training_iteration": 23, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-45", "timestamp": 1711723725, "time_this_iter_s": 2.322383403778076, "time_total_s": 49.65410661697388, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc46dea0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc469360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 49.65410661697388, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 18.0, "ram_util_percent": 11.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -23303816.0, "policy_entropy": 164.0438232421875, "var_gnorm": 22.666255950927734, "vf_loss": 49116979200.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0008101463317871094, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 24, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "sampler_results": {"episode_reward_max": -26599.78512458334, "episode_reward_min": -50022.34727333332, "episode_reward_mean": -36198.268212962495, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18322920686222802, "mean_inference_ms": 5.3743484822393635, "mean_action_processing_ms": 0.1485452281274834, "mean_env_wait_ms": 0.5716847583094389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017574548721313477, "StateBufferConnector_ms": 0.00241851806640625, "ViewRequirementAgentConnector_ms": 0.0721290111541748}}, "episode_reward_max": -26599.78512458334, "episode_reward_min": -50022.34727333332, "episode_reward_mean": -36198.268212962495, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31414.042935833335, -26599.78512458334, -27896.96715875, -31790.818009583334, -34183.80252666667, -40164.18603333333, -36592.81157208332, -29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18322920686222802, "mean_inference_ms": 5.3743484822393635, "mean_action_processing_ms": 0.1485452281274834, "mean_env_wait_ms": 0.5716847583094389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017574548721313477, "StateBufferConnector_ms": 0.00241851806640625, "ViewRequirementAgentConnector_ms": 0.0721290111541748}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 2171.257, "learn_time_ms": 19.569, "learn_throughput": 17169.937, "synch_weights_time_ms": 0.165}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "done": false, "episodes_total": 168, "training_iteration": 24, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-47", "timestamp": 1711723727, "time_this_iter_s": 2.1426775455474854, "time_total_s": 51.79678416252136, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc46c220>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5af010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 51.79678416252136, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 7.400000000000001, "ram_util_percent": 12.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -28772216.0, "policy_entropy": 216.37661743164062, "var_gnorm": 22.667118072509766, "vf_loss": 69169217536.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0006564855575561523, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 25, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "sampler_results": {"episode_reward_max": -27927.49050833333, "episode_reward_min": -51505.156933750004, "episode_reward_mean": -37104.57313428749, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1833793481989015, "mean_inference_ms": 5.378158493702981, "mean_action_processing_ms": 0.14862948215240027, "mean_env_wait_ms": 0.5721574311161239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017704248428344727, "StateBufferConnector_ms": 0.002432584762573242, "ViewRequirementAgentConnector_ms": 0.07268500328063965}}, "episode_reward_max": -27927.49050833333, "episode_reward_min": -51505.156933750004, "episode_reward_mean": -37104.57313428749, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29697.8837175, -43481.54701333333, -34218.98594999999, -27927.49050833333, -33315.57628249999, -36294.0390325, -34795.80533958333, -29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1833793481989015, "mean_inference_ms": 5.378158493702981, "mean_action_processing_ms": 0.14862948215240027, "mean_env_wait_ms": 0.5721574311161239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017704248428344727, "StateBufferConnector_ms": 0.002432584762573242, "ViewRequirementAgentConnector_ms": 0.07268500328063965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 2172.526, "learn_time_ms": 19.634, "learn_throughput": 17113.579, "synch_weights_time_ms": 0.168}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "done": false, "episodes_total": 175, "training_iteration": 25, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-49", "timestamp": 1711723729, "time_this_iter_s": 2.145634889602661, "time_total_s": 53.94241905212402, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc47d3f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc46a440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 53.94241905212402, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 7.266666666666667, "ram_util_percent": 12.199999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -28020050.0, "policy_entropy": 248.4906005859375, "var_gnorm": 22.6683292388916, "vf_loss": 70184337408.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0006299018859863281, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 26, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "sampler_results": {"episode_reward_max": -28834.174040416674, "episode_reward_min": -60478.98841124999, "episode_reward_mean": -37923.7854606875, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332, -43986.858787500016, -45778.00487999999, -60478.98841124999, -36785.877013749996, -35881.74861333333, -50886.08751208331, -47854.99526583333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18351478855971984, "mean_inference_ms": 5.381753597939223, "mean_action_processing_ms": 0.1487151212039839, "mean_env_wait_ms": 0.5726247219099782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017673015594482422, "StateBufferConnector_ms": 0.002414703369140625, "ViewRequirementAgentConnector_ms": 0.07252240180969238}}, "episode_reward_max": -28834.174040416674, "episode_reward_min": -60478.98841124999, "episode_reward_mean": -37923.7854606875, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29400.065168333327, -30013.025031249992, -35702.54641875, -35694.21719916666, -38420.522987916665, -36289.52423291667, -36614.14222166666, -31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332, -43986.858787500016, -45778.00487999999, -60478.98841124999, -36785.877013749996, -35881.74861333333, -50886.08751208331, -47854.99526583333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18351478855971984, "mean_inference_ms": 5.381753597939223, "mean_action_processing_ms": 0.1487151212039839, "mean_env_wait_ms": 0.5726247219099782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017673015594482422, "StateBufferConnector_ms": 0.002414703369140625, "ViewRequirementAgentConnector_ms": 0.07252240180969238}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8736, "timers": {"training_iteration_time_ms": 2174.821, "learn_time_ms": 19.562, "learn_throughput": 17176.32, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "done": false, "episodes_total": 182, "training_iteration": 26, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-51", "timestamp": 1711723731, "time_this_iter_s": 2.156637191772461, "time_total_s": 56.099056243896484, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc47c700>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc46a170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 56.099056243896484, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 12.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -28866904.0, "policy_entropy": 312.1092529296875, "var_gnorm": 22.66927146911621, "vf_loss": 68706168832.0}, "grad_gnorm": 39.99999237060547, "vf_explained_var": -0.000674128532409668, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 27, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "sampler_results": {"episode_reward_max": -28834.174040416674, "episode_reward_min": -60478.98841124999, "episode_reward_mean": -38713.68386481667, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332, -43986.858787500016, -45778.00487999999, -60478.98841124999, -36785.877013749996, -35881.74861333333, -50886.08751208331, -47854.99526583333, -46999.51783749999, -45780.46829541667, -35269.988735000006, -47015.15711166665, -48187.988165, -47305.64992333335, -50565.113605], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18365558799278553, "mean_inference_ms": 5.384978044269299, "mean_action_processing_ms": 0.14879579816424404, "mean_env_wait_ms": 0.5730674264623432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017702102661132812, "StateBufferConnector_ms": 0.0024170875549316406, "ViewRequirementAgentConnector_ms": 0.07265067100524902}}, "episode_reward_max": -28834.174040416674, "episode_reward_min": -60478.98841124999, "episode_reward_mean": -38713.68386481667, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31203.864222499997, -38703.133784166675, -33275.60397333333, -35719.11292375, -39582.528143749994, -34826.663614583325, -43506.55818583334, -38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332, -43986.858787500016, -45778.00487999999, -60478.98841124999, -36785.877013749996, -35881.74861333333, -50886.08751208331, -47854.99526583333, -46999.51783749999, -45780.46829541667, -35269.988735000006, -47015.15711166665, -48187.988165, -47305.64992333335, -50565.113605], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18365558799278553, "mean_inference_ms": 5.384978044269299, "mean_action_processing_ms": 0.14879579816424404, "mean_env_wait_ms": 0.5730674264623432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017702102661132812, "StateBufferConnector_ms": 0.0024170875549316406, "ViewRequirementAgentConnector_ms": 0.07265067100524902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9072, "timers": {"training_iteration_time_ms": 2176.7, "learn_time_ms": 19.592, "learn_throughput": 17150.129, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "done": false, "episodes_total": 189, "training_iteration": 27, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-54", "timestamp": 1711723734, "time_this_iter_s": 2.1483120918273926, "time_total_s": 58.24736833572388, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc47d2d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc5af5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 58.24736833572388, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 8.566666666666666, "ram_util_percent": 12.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -26967736.0, "policy_entropy": 391.02069091796875, "var_gnorm": 22.670114517211914, "vf_loss": 68773478400.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0006453990936279297, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 28, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "sampler_results": {"episode_reward_max": -28834.174040416674, "episode_reward_min": -60478.98841124999, "episode_reward_mean": -39131.63366676249, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332, -43986.858787500016, -45778.00487999999, -60478.98841124999, -36785.877013749996, -35881.74861333333, -50886.08751208331, -47854.99526583333, -46999.51783749999, -45780.46829541667, -35269.988735000006, -47015.15711166665, -48187.988165, -47305.64992333335, -50565.113605, -41278.414830833324, -30761.20340041667, -36798.38288125001, -49967.76953166668, -52724.85509666667, -43686.66713708333, -43395.15216458333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1837853174853319, "mean_inference_ms": 5.388034571558083, "mean_action_processing_ms": 0.14886945004802482, "mean_env_wait_ms": 0.5734843675011323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017626047134399414, "StateBufferConnector_ms": 0.002412557601928711, "ViewRequirementAgentConnector_ms": 0.07243156433105469}}, "episode_reward_max": -28834.174040416674, "episode_reward_min": -60478.98841124999, "episode_reward_mean": -39131.63366676249, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38681.60597458333, -30619.299822500005, -30001.02315541666, -32394.23690125, -30575.099645416667, -36569.300056666674, -37779.8877025, -33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332, -43986.858787500016, -45778.00487999999, -60478.98841124999, -36785.877013749996, -35881.74861333333, -50886.08751208331, -47854.99526583333, -46999.51783749999, -45780.46829541667, -35269.988735000006, -47015.15711166665, -48187.988165, -47305.64992333335, -50565.113605, -41278.414830833324, -30761.20340041667, -36798.38288125001, -49967.76953166668, -52724.85509666667, -43686.66713708333, -43395.15216458333], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1837853174853319, "mean_inference_ms": 5.388034571558083, "mean_action_processing_ms": 0.14886945004802482, "mean_env_wait_ms": 0.5734843675011323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017626047134399414, "StateBufferConnector_ms": 0.002412557601928711, "ViewRequirementAgentConnector_ms": 0.07243156433105469}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9408, "timers": {"training_iteration_time_ms": 2175.423, "learn_time_ms": 19.556, "learn_throughput": 17181.681, "synch_weights_time_ms": 0.166}, "counters": {"num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "done": false, "episodes_total": 196, "training_iteration": 28, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-56", "timestamp": 1711723736, "time_this_iter_s": 2.1384060382843018, "time_total_s": 60.38577437400818, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc47fe50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc46b5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 60.38577437400818, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 12.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -27812592.0, "policy_entropy": 466.67242431640625, "var_gnorm": 22.67106056213379, "vf_loss": 61229449216.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.0006399154663085938, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 29, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "sampler_results": {"episode_reward_max": -28834.174040416674, "episode_reward_min": -60478.98841124999, "episode_reward_mean": -39751.47774567916, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332, -43986.858787500016, -45778.00487999999, -60478.98841124999, -36785.877013749996, -35881.74861333333, -50886.08751208331, -47854.99526583333, -46999.51783749999, -45780.46829541667, -35269.988735000006, -47015.15711166665, -48187.988165, -47305.64992333335, -50565.113605, -41278.414830833324, -30761.20340041667, -36798.38288125001, -49967.76953166668, -52724.85509666667, -43686.66713708333, -43395.15216458333, -53010.618030416656, -37695.44480041666, -36785.500127499996, -40989.05638583334, -32276.930344166663, -47573.23403291667, -50274.07742874998], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18391475771481441, "mean_inference_ms": 5.390959176672909, "mean_action_processing_ms": 0.14893970672767617, "mean_env_wait_ms": 0.5738799575034487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017676830291748047, "StateBufferConnector_ms": 0.002418994903564453, "ViewRequirementAgentConnector_ms": 0.07254457473754883}}, "episode_reward_max": -28834.174040416674, "episode_reward_min": -60478.98841124999, "episode_reward_mean": -39751.47774567916, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-33589.461400833345, -38103.424607916655, -31807.9666325, -35428.547563750006, -32979.76788249999, -32426.66861666666, -37516.773237083326, -37495.949875, -36001.42634708335, -34197.257590416666, -37824.782415, -35713.411752500004, -35387.17176541665, -36902.83399333333, -35715.782625, -35388.56747458333, -35401.593915833335, -40186.76534416666, -33600.107518749996, -36279.51928500001, -34193.64590666666, -32112.745814166665, -38670.72589458334, -40511.20174791666, -35410.482395, -35366.54075541665, -38691.906557500006, -31249.78549708333, -34507.45304041665, -39300.10545375, -28834.174040416674, -44693.07560999998, -31820.65478291666, -40199.57932166665, -37197.3146575, -33899.364450416666, -33309.922556666665, -45292.81822291666, -33288.74348916667, -37484.80663291667, -36617.32738000001, -45276.642654583324, -33001.86579458333, -35672.23292458334, -36828.980216250005, -40416.97433708335, -35339.84712208333, -35038.29992583332, -35607.69807416666, -35621.21142791666, -36259.5472825, -33479.788844166666, -37704.56313250001, -40999.06071916666, -46408.534741666655, -44887.49812541666, -43117.455260833325, -39823.8322175, -45488.337382499994, -38879.380814166674, -38904.74408250001, -36201.03689833333, -50022.34727333332, -43096.00944458334, -33205.07597875, -51505.156933750004, -47881.93116916665, -42783.834397499995, -45476.58577041666, -45781.13269583333, -45473.46616708333, -40370.79835958332, -43986.858787500016, -45778.00487999999, -60478.98841124999, -36785.877013749996, -35881.74861333333, -50886.08751208331, -47854.99526583333, -46999.51783749999, -45780.46829541667, -35269.988735000006, -47015.15711166665, -48187.988165, -47305.64992333335, -50565.113605, -41278.414830833324, -30761.20340041667, -36798.38288125001, -49967.76953166668, -52724.85509666667, -43686.66713708333, -43395.15216458333, -53010.618030416656, -37695.44480041666, -36785.500127499996, -40989.05638583334, -32276.930344166663, -47573.23403291667, -50274.07742874998], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18391475771481441, "mean_inference_ms": 5.390959176672909, "mean_action_processing_ms": 0.14893970672767617, "mean_env_wait_ms": 0.5738799575034487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017676830291748047, "StateBufferConnector_ms": 0.002418994903564453, "ViewRequirementAgentConnector_ms": 0.07254457473754883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9744, "timers": {"training_iteration_time_ms": 2168.958, "learn_time_ms": 19.514, "learn_throughput": 17218.081, "synch_weights_time_ms": 0.166}, "counters": {"num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "done": true, "episodes_total": 203, "training_iteration": 29, "trial_id": "4ed2d_00000", "experiment_id": "2b2a8ddc2b624ad88a5c9043a7a8eb3a", "date": "2024-03-29_14-48-58", "timestamp": 1711723738, "time_this_iter_s": 2.132309913635254, "time_total_s": 62.51808428764343, "pid": 153109, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc47e620>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc46ac20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 62.51808428764343, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 5.2686779499053955, "perf": {"cpu_util_percent": 7.033333333333332, "ram_util_percent": 12.533333333333333}}
