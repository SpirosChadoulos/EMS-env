{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0010000000474974513, "total_loss": 10.000471115112305, "policy_loss": -0.05996542051434517, "vf_loss": 10.0, "vf_explained_var": 8.013513053128918e-08, "kl": 0.3021833896636963, "entropy": 12.904836654663086, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "sampler_results": {"episode_reward_max": -1005138.234705192, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -1005138.234705192, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16269697987361195, "mean_inference_ms": 5.228252722177024, "mean_action_processing_ms": 0.14894652437385536, "mean_env_wait_ms": 0.25873368147218967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014519691467285156, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.061202049255371094}}, "episode_reward_max": -1005138.234705192, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -1005138.234705192, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16269697987361195, "mean_inference_ms": 5.228252722177024, "mean_action_processing_ms": 0.14894652437385536, "mean_env_wait_ms": 0.25873368147218967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014519691467285156, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.061202049255371094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 336, "timers": {"training_iteration_time_ms": 3584.671, "learn_time_ms": 1625.986, "learn_throughput": 206.644}, "counters": {"num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-14", "timestamp": 1706260514, "time_this_iter_s": 3.584887742996216, "time_total_s": 3.584887742996216, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8112110>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80dcb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 3.584887742996216, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 8.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0010000000474974513, "total_loss": 9.875160217285156, "policy_loss": -0.14540457725524902, "vf_loss": 10.0, "vf_explained_var": 6.357829107628277e-08, "kl": 0.06854930520057678, "entropy": 12.703988075256348, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "sampler_results": {"episode_reward_max": -930640.2578650372, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -967889.2462851147, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1620216496112138, "mean_inference_ms": 5.230753793527673, "mean_action_processing_ms": 0.1484682218098592, "mean_env_wait_ms": 0.2586674712006912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014793872833251953, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06095170974731445}}, "episode_reward_max": -930640.2578650372, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -967889.2462851147, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1620216496112138, "mean_inference_ms": 5.230753793527673, "mean_action_processing_ms": 0.1484682218098592, "mean_env_wait_ms": 0.2586674712006912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014793872833251953, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06095170974731445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 672, "timers": {"training_iteration_time_ms": 3554.76, "learn_time_ms": 1598.676, "learn_throughput": 210.174}, "counters": {"num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-17", "timestamp": 1706260517, "time_this_iter_s": 3.5250861644744873, "time_total_s": 7.109973907470703, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee81133a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94748430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 7.109973907470703, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.64, "ram_util_percent": 8.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.44999998807907104, "cur_lr": 0.0010000000474974513, "total_loss": 9.894678115844727, "policy_loss": -0.128618523478508, "vf_loss": 10.0, "vf_explained_var": 4.503462136540293e-08, "kl": 0.0517704151570797, "entropy": 12.747153282165527, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "sampler_results": {"episode_reward_max": -930640.2578650372, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -967767.3907145592, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16158410264327586, "mean_inference_ms": 5.230020193403243, "mean_action_processing_ms": 0.14815400515832475, "mean_env_wait_ms": 0.25857820173897544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01510779062906901, "StateBufferConnector_ms": 0.0026305516560872397, "ViewRequirementAgentConnector_ms": 0.06012916564941406}}, "episode_reward_max": -930640.2578650372, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -967767.3907145592, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16158410264327586, "mean_inference_ms": 5.230020193403243, "mean_action_processing_ms": 0.14815400515832475, "mean_env_wait_ms": 0.25857820173897544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01510779062906901, "StateBufferConnector_ms": 0.0026305516560872397, "ViewRequirementAgentConnector_ms": 0.06012916564941406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1008, "timers": {"training_iteration_time_ms": 3533.545, "learn_time_ms": 1580.645, "learn_throughput": 212.571}, "counters": {"num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-21", "timestamp": 1706260521, "time_this_iter_s": 3.4913337230682373, "time_total_s": 10.60130763053894, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8113070>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8198040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 10.60130763053894, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.639999999999999, "ram_util_percent": 8.940000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.675000011920929, "cur_lr": 0.0010000000474974513, "total_loss": 9.89787483215332, "policy_loss": -0.13083966076374054, "vf_loss": 10.0, "vf_explained_var": 2.119276309997531e-08, "kl": 0.042540691792964935, "entropy": 12.725915908813477, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "sampler_results": {"episode_reward_max": -930640.2578650372, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -970319.5963684679, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1613173361557686, "mean_inference_ms": 5.236610062534149, "mean_action_processing_ms": 0.14804255335668354, "mean_env_wait_ms": 0.2586244113813855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015652179718017578, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.06321072578430176}}, "episode_reward_max": -930640.2578650372, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -970319.5963684679, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1613173361557686, "mean_inference_ms": 5.236610062534149, "mean_action_processing_ms": 0.14804255335668354, "mean_env_wait_ms": 0.2586244113813855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015652179718017578, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.06321072578430176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1344, "timers": {"training_iteration_time_ms": 3534.076, "learn_time_ms": 1572.261, "learn_throughput": 213.705}, "counters": {"num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-24", "timestamp": 1706260524, "time_this_iter_s": 3.5358922481536865, "time_total_s": 14.137199878692627, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc83d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8198940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 14.137199878692627, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 6.9799999999999995, "ram_util_percent": 8.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0125000476837158, "cur_lr": 0.0010000000474974513, "total_loss": 9.889533042907715, "policy_loss": -0.14430730044841766, "vf_loss": 10.0, "vf_explained_var": 6.225373994084293e-08, "kl": 0.03342263773083687, "entropy": 12.773758888244629, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "sampler_results": {"episode_reward_max": -930640.2578650372, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -970756.9509798478, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16095793405845799, "mean_inference_ms": 5.2384940104661535, "mean_action_processing_ms": 0.14783183356125543, "mean_env_wait_ms": 0.2583929213595764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015554428100585938, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06218910217285156}}, "episode_reward_max": -930640.2578650372, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -970756.9509798478, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16095793405845799, "mean_inference_ms": 5.2384940104661535, "mean_action_processing_ms": 0.14783183356125543, "mean_env_wait_ms": 0.2583929213595764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015554428100585938, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06218910217285156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1680, "timers": {"training_iteration_time_ms": 3524.083, "learn_time_ms": 1567.123, "learn_throughput": 214.406}, "counters": {"num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-28", "timestamp": 1706260528, "time_this_iter_s": 3.484335422515869, "time_total_s": 17.621535301208496, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc9330>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8199b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 17.621535301208496, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 9.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5187499523162842, "cur_lr": 0.0010000000474974513, "total_loss": 9.908182144165039, "policy_loss": -0.13095049560070038, "vf_loss": 10.0, "vf_explained_var": 4.437234579768301e-08, "kl": 0.02576642856001854, "entropy": 12.815885543823242, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "sampler_results": {"episode_reward_max": -930286.0407806522, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -964011.7992799819, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16062727999708434, "mean_inference_ms": 5.2382502927249535, "mean_action_processing_ms": 0.14761799798790176, "mean_env_wait_ms": 0.2581184472178399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01544952392578125, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.06158749262491862}}, "episode_reward_max": -930286.0407806522, "episode_reward_min": -1005138.234705192, "episode_reward_mean": -964011.7992799819, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16062727999708434, "mean_inference_ms": 5.2382502927249535, "mean_action_processing_ms": 0.14761799798790176, "mean_env_wait_ms": 0.2581184472178399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01544952392578125, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.06158749262491862}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2016, "timers": {"training_iteration_time_ms": 3517.396, "learn_time_ms": 1564.287, "learn_throughput": 214.794}, "counters": {"num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-31", "timestamp": 1706260531, "time_this_iter_s": 3.4842209815979004, "time_total_s": 21.105756282806396, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fca830>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee819a4d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 21.105756282806396, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5600000000000005, "ram_util_percent": 9.219999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 0.0010000000474974513, "total_loss": 9.893575668334961, "policy_loss": -0.14946843683719635, "vf_loss": 10.0, "vf_explained_var": 5.0332811696307544e-08, "kl": 0.018894225358963013, "entropy": 12.81175708770752, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "sampler_results": {"episode_reward_max": -930286.0407806522, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -975472.7363988351, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16039330062715926, "mean_inference_ms": 5.238466800294383, "mean_action_processing_ms": 0.14744868115036844, "mean_env_wait_ms": 0.2579086040490734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01576287405831473, "StateBufferConnector_ms": 0.0025885445731026785, "ViewRequirementAgentConnector_ms": 0.061443873814174106}}, "episode_reward_max": -930286.0407806522, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -975472.7363988351, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16039330062715926, "mean_inference_ms": 5.238466800294383, "mean_action_processing_ms": 0.14744868115036844, "mean_env_wait_ms": 0.2579086040490734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01576287405831473, "StateBufferConnector_ms": 0.0025885445731026785, "ViewRequirementAgentConnector_ms": 0.061443873814174106}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2352, "timers": {"training_iteration_time_ms": 3517.653, "learn_time_ms": 1563.87, "learn_throughput": 214.852}, "counters": {"num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-35", "timestamp": 1706260535, "time_this_iter_s": 3.5194523334503174, "time_total_s": 24.625208616256714, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc9f00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee819aa70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 24.625208616256714, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 9.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 0.0010000000474974513, "total_loss": 9.90373706817627, "policy_loss": -0.1378566473722458, "vf_loss": 10.0, "vf_explained_var": 5.7617821624944554e-08, "kl": 0.018258029595017433, "entropy": 12.808073043823242, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "sampler_results": {"episode_reward_max": -930286.0407806522, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -973959.3359818234, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16016443355853682, "mean_inference_ms": 5.237610688497229, "mean_action_processing_ms": 0.14726895274288004, "mean_env_wait_ms": 0.25765984582711154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563429832458496, "StateBufferConnector_ms": 0.0025719404220581055, "ViewRequirementAgentConnector_ms": 0.06116330623626709}}, "episode_reward_max": -930286.0407806522, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -973959.3359818234, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16016443355853682, "mean_inference_ms": 5.237610688497229, "mean_action_processing_ms": 0.14726895274288004, "mean_env_wait_ms": 0.25765984582711154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563429832458496, "StateBufferConnector_ms": 0.0025719404220581055, "ViewRequirementAgentConnector_ms": 0.06116330623626709}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 3513.47, "learn_time_ms": 1563.104, "learn_throughput": 214.957}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-38", "timestamp": 1706260538, "time_this_iter_s": 3.484428644180298, "time_total_s": 28.10963726043701, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fcb7c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee819b010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 28.10963726043701, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.699999999999999, "ram_util_percent": 9.459999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 0.0010000000474974513, "total_loss": 9.905400276184082, "policy_loss": -0.13628220558166504, "vf_loss": 10.0, "vf_explained_var": 4.635916894812908e-08, "kl": 0.018296729773283005, "entropy": 12.772595405578613, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 765.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "sampler_results": {"episode_reward_max": -930286.0407806522, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -972203.1329826111, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15997852897155196, "mean_inference_ms": 5.237014605530053, "mean_action_processing_ms": 0.1471175335925219, "mean_env_wait_ms": 0.25743473175762815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015574031405978732, "StateBufferConnector_ms": 0.0025537278917100695, "ViewRequirementAgentConnector_ms": 0.061175558302137584}}, "episode_reward_max": -930286.0407806522, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -972203.1329826111, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15997852897155196, "mean_inference_ms": 5.237014605530053, "mean_action_processing_ms": 0.1471175335925219, "mean_env_wait_ms": 0.25743473175762815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015574031405978732, "StateBufferConnector_ms": 0.0025537278917100695, "ViewRequirementAgentConnector_ms": 0.061175558302137584}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3024, "timers": {"training_iteration_time_ms": 3512.109, "learn_time_ms": 1561.787, "learn_throughput": 215.138}, "counters": {"num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-42", "timestamp": 1706260542, "time_this_iter_s": 3.5014631748199463, "time_total_s": 31.611100435256958, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc9de0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee819acb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 31.611100435256958, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.720000000000001, "ram_util_percent": 9.580000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 0.0010000000474974513, "total_loss": 9.90578842163086, "policy_loss": -0.13754026591777802, "vf_loss": 10.0, "vf_explained_var": 3.245141755314762e-08, "kl": 0.01901957578957081, "entropy": 12.740312576293945, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "sampler_results": {"episode_reward_max": -930286.0407806522, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -971278.490407869, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15983573148872543, "mean_inference_ms": 5.236818835386269, "mean_action_processing_ms": 0.146990818679153, "mean_env_wait_ms": 0.25728263784228633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015528202056884766, "StateBufferConnector_ms": 0.002529621124267578, "ViewRequirementAgentConnector_ms": 0.060973167419433594}}, "episode_reward_max": -930286.0407806522, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -971278.490407869, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15983573148872543, "mean_inference_ms": 5.236818835386269, "mean_action_processing_ms": 0.146990818679153, "mean_env_wait_ms": 0.25728263784228633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015528202056884766, "StateBufferConnector_ms": 0.002529621124267578, "ViewRequirementAgentConnector_ms": 0.060973167419433594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3360, "timers": {"training_iteration_time_ms": 3511.642, "learn_time_ms": 1560.366, "learn_throughput": 215.334}, "counters": {"num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-45", "timestamp": 1706260545, "time_this_iter_s": 3.507685661315918, "time_total_s": 35.118786096572876, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80499f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8054940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 35.118786096572876, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 9.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 0.0010000000474974513, "total_loss": 9.899279594421387, "policy_loss": -0.14182516932487488, "vf_loss": 10.0, "vf_explained_var": 4.039870304950455e-08, "kl": 0.018043171614408493, "entropy": 12.725668907165527, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -965966.1690085132, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15971245349215638, "mean_inference_ms": 5.236488681513953, "mean_action_processing_ms": 0.14688457541097716, "mean_env_wait_ms": 0.2571356039007714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016056407581676136, "StateBufferConnector_ms": 0.0025163997303355823, "ViewRequirementAgentConnector_ms": 0.0607078725641424}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -965966.1690085132, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15971245349215638, "mean_inference_ms": 5.236488681513953, "mean_action_processing_ms": 0.14688457541097716, "mean_env_wait_ms": 0.2571356039007714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016056407581676136, "StateBufferConnector_ms": 0.0025163997303355823, "ViewRequirementAgentConnector_ms": 0.0607078725641424}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3696, "timers": {"training_iteration_time_ms": 3502.093, "learn_time_ms": 1552.45, "learn_throughput": 216.432}, "counters": {"num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-49", "timestamp": 1706260549, "time_this_iter_s": 3.4894399642944336, "time_total_s": 38.60822606086731, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8049960>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8054790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 38.60822606086731, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 9.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 0.0010000000474974513, "total_loss": 9.913562774658203, "policy_loss": -0.13102778792381287, "vf_loss": 10.0, "vf_explained_var": 3.245141755314762e-08, "kl": 0.019573325291275978, "entropy": 12.710453033447266, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1035.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -964302.4416716091, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1596015872993235, "mean_inference_ms": 5.236088466152384, "mean_action_processing_ms": 0.1467905113042321, "mean_env_wait_ms": 0.25699187966090503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01598199208577474, "StateBufferConnector_ms": 0.002501408259073893, "ViewRequirementAgentConnector_ms": 0.0609139601389567}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -964302.4416716091, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1596015872993235, "mean_inference_ms": 5.236088466152384, "mean_action_processing_ms": 0.1467905113042321, "mean_env_wait_ms": 0.25699187966090503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01598199208577474, "StateBufferConnector_ms": 0.002501408259073893, "ViewRequirementAgentConnector_ms": 0.0609139601389567}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4032, "timers": {"training_iteration_time_ms": 3499.825, "learn_time_ms": 1551.334, "learn_throughput": 216.588}, "counters": {"num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-53", "timestamp": 1706260553, "time_this_iter_s": 3.502415895462036, "time_total_s": 42.110641956329346, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee804b100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8055510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 42.110641956329346, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 9.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 0.0010000000474974513, "total_loss": 9.899983406066895, "policy_loss": -0.1414550393819809, "vf_loss": 10.0, "vf_explained_var": 2.4504132056790695e-08, "kl": 0.018189597874879837, "entropy": 12.737937927246094, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -964502.7712553688, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1595114687552588, "mean_inference_ms": 5.235575735195322, "mean_action_processing_ms": 0.14671059269507117, "mean_env_wait_ms": 0.2568694942048785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015930029062124398, "StateBufferConnector_ms": 0.0024887231680063102, "ViewRequirementAgentConnector_ms": 0.06083525144136869}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -964502.7712553688, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1595114687552588, "mean_inference_ms": 5.235575735195322, "mean_action_processing_ms": 0.14671059269507117, "mean_env_wait_ms": 0.2568694942048785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015930029062124398, "StateBufferConnector_ms": 0.0024887231680063102, "ViewRequirementAgentConnector_ms": 0.06083525144136869}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4368, "timers": {"training_iteration_time_ms": 3498.365, "learn_time_ms": 1550.585, "learn_throughput": 216.692}, "counters": {"num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-15-56", "timestamp": 1706260556, "time_this_iter_s": 3.4767918586730957, "time_total_s": 45.58743381500244, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee804af50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80553f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 45.58743381500244, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.679999999999999, "ram_util_percent": 10.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 0.0010000000474974513, "total_loss": 9.898438453674316, "policy_loss": -0.1433144062757492, "vf_loss": 10.0, "vf_explained_var": 3.112686997042147e-08, "kl": 0.018327899277210236, "entropy": 12.76539134979248, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -965751.4706707362, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15943243888615682, "mean_inference_ms": 5.235271968321009, "mean_action_processing_ms": 0.14663840031191677, "mean_env_wait_ms": 0.25676184188318796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01584972654070173, "StateBufferConnector_ms": 0.0024761472429547992, "ViewRequirementAgentConnector_ms": 0.06075075694492885}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -965751.4706707362, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15943243888615682, "mean_inference_ms": 5.235271968321009, "mean_action_processing_ms": 0.14663840031191677, "mean_env_wait_ms": 0.25676184188318796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01584972654070173, "StateBufferConnector_ms": 0.0024761472429547992, "ViewRequirementAgentConnector_ms": 0.06075075694492885}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4704, "timers": {"training_iteration_time_ms": 3495.168, "learn_time_ms": 1550.569, "learn_throughput": 216.695}, "counters": {"num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-00", "timestamp": 1706260560, "time_this_iter_s": 3.503967761993408, "time_total_s": 49.09140157699585, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee804be50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8056050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 49.09140157699585, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.660000000000001, "ram_util_percent": 10.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.278125047683716, "cur_lr": 0.0010000000474974513, "total_loss": 9.897957801818848, "policy_loss": -0.14804725348949432, "vf_loss": 10.0, "vf_explained_var": 3.7087335869046e-08, "kl": 0.02019423060119152, "entropy": 12.715075492858887, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1305.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -966258.2196483235, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15935827069082154, "mean_inference_ms": 5.234990113204679, "mean_action_processing_ms": 0.14656489609226872, "mean_env_wait_ms": 0.2566477404603833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01575311024983724, "StateBufferConnector_ms": 0.002463658650716146, "ViewRequirementAgentConnector_ms": 0.06068229675292969}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -966258.2196483235, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15935827069082154, "mean_inference_ms": 5.234990113204679, "mean_action_processing_ms": 0.14656489609226872, "mean_env_wait_ms": 0.2566477404603833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01575311024983724, "StateBufferConnector_ms": 0.002463658650716146, "ViewRequirementAgentConnector_ms": 0.06068229675292969}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 3496.706, "learn_time_ms": 1551.375, "learn_throughput": 216.582}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-03", "timestamp": 1706260563, "time_this_iter_s": 3.4997503757476807, "time_total_s": 52.59115195274353, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee804afb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8055480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 52.59115195274353, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.540000000000001, "ram_util_percent": 10.379999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.906577110290527, "policy_loss": -0.14889341592788696, "vf_loss": 10.0, "vf_explained_var": 3.7087335869046e-08, "kl": 0.016232844442129135, "entropy": 12.639729499816895, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -965082.5304421315, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15929393868357322, "mean_inference_ms": 5.234828033276498, "mean_action_processing_ms": 0.14649726645336508, "mean_env_wait_ms": 0.2565363070136545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015628337860107422, "StateBufferConnector_ms": 0.002454221248626709, "ViewRequirementAgentConnector_ms": 0.06050318479537964}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -965082.5304421315, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15929393868357322, "mean_inference_ms": 5.234828033276498, "mean_action_processing_ms": 0.14649726645336508, "mean_env_wait_ms": 0.2565363070136545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015628337860107422, "StateBufferConnector_ms": 0.002454221248626709, "ViewRequirementAgentConnector_ms": 0.06050318479537964}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 3498.917, "learn_time_ms": 1551.503, "learn_throughput": 216.564}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-07", "timestamp": 1706260567, "time_this_iter_s": 3.5063259601593018, "time_total_s": 56.09747791290283, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8058ac0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8054820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 56.09747791290283, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 10.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.905399322509766, "policy_loss": -0.14717532694339752, "vf_loss": 10.0, "vf_explained_var": 2.2517310682701464e-08, "kl": 0.015385455451905727, "entropy": 12.617888450622559, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1485.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -963335.1879124317, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15923676320360416, "mean_inference_ms": 5.234681738545451, "mean_action_processing_ms": 0.14643425727012305, "mean_env_wait_ms": 0.256435610911226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015494402717141545, "StateBufferConnector_ms": 0.002440284280215993, "ViewRequirementAgentConnector_ms": 0.060317095588235295}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -963335.1879124317, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15923676320360416, "mean_inference_ms": 5.234681738545451, "mean_action_processing_ms": 0.14643425727012305, "mean_env_wait_ms": 0.256435610911226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015494402717141545, "StateBufferConnector_ms": 0.002440284280215993, "ViewRequirementAgentConnector_ms": 0.060317095588235295}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5712, "timers": {"training_iteration_time_ms": 3495.041, "learn_time_ms": 1548.594, "learn_throughput": 216.971}, "counters": {"num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "done": false, "episodes_total": 17, "training_iteration": 17, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-10", "timestamp": 1706260570, "time_this_iter_s": 3.480700731277466, "time_total_s": 59.5781786441803, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8048940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8055cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 59.5781786441803, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 10.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.910653114318848, "policy_loss": -0.14325958490371704, "vf_loss": 10.0, "vf_explained_var": 2.781550101360608e-08, "kl": 0.01577669568359852, "entropy": 12.669754028320312, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -960908.9195708284, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1591792927702189, "mean_inference_ms": 5.234419196492769, "mean_action_processing_ms": 0.1463713077630496, "mean_env_wait_ms": 0.2563320265805151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015388594733344184, "StateBufferConnector_ms": 0.00242259767320421, "ViewRequirementAgentConnector_ms": 0.0603583123948839}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -960908.9195708284, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1591792927702189, "mean_inference_ms": 5.234419196492769, "mean_action_processing_ms": 0.1463713077630496, "mean_env_wait_ms": 0.2563320265805151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015388594733344184, "StateBufferConnector_ms": 0.00242259767320421, "ViewRequirementAgentConnector_ms": 0.0603583123948839}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6048, "timers": {"training_iteration_time_ms": 3494.244, "learn_time_ms": 1547.296, "learn_throughput": 217.153}, "counters": {"num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "done": false, "episodes_total": 18, "training_iteration": 18, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-14", "timestamp": 1706260574, "time_this_iter_s": 3.4765028953552246, "time_total_s": 63.05468153953552, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80591b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8056c20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 63.05468153953552, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 10.779999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.906817436218262, "policy_loss": -0.1438751369714737, "vf_loss": 10.0, "vf_explained_var": 1.8543667934523e-08, "kl": 0.014834871515631676, "entropy": 12.609785079956055, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1665.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -960021.9525113484, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15911673792003664, "mean_inference_ms": 5.234000482232946, "mean_action_processing_ms": 0.1463075676903002, "mean_env_wait_ms": 0.2562236068492513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563649428518195, "StateBufferConnector_ms": 0.0024255953337016856, "ViewRequirementAgentConnector_ms": 0.06020696539627878}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -960021.9525113484, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15911673792003664, "mean_inference_ms": 5.234000482232946, "mean_action_processing_ms": 0.1463075676903002, "mean_env_wait_ms": 0.2562236068492513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563649428518195, "StateBufferConnector_ms": 0.0024255953337016856, "ViewRequirementAgentConnector_ms": 0.06020696539627878}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6384, "timers": {"training_iteration_time_ms": 3491.238, "learn_time_ms": 1547.136, "learn_throughput": 217.175}, "counters": {"num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "done": false, "episodes_total": 19, "training_iteration": 19, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-17", "timestamp": 1706260577, "time_this_iter_s": 3.471421480178833, "time_total_s": 66.52610301971436, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fca620>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80569e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 66.52610301971436, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.619999999999999, "ram_util_percent": 10.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.904086112976074, "policy_loss": -0.14889006316661835, "vf_loss": 10.0, "vf_explained_var": 2.1855036891338386e-08, "kl": 0.015502623282372952, "entropy": 12.642751693725586, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1755.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "sampler_results": {"episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -960886.1949616403, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.159057284633361, "mean_inference_ms": 5.233611307384133, "mean_action_processing_ms": 0.14624661998272492, "mean_env_wait_ms": 0.25611722970512074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015535354614257812, "StateBufferConnector_ms": 0.0024247169494628906, "ViewRequirementAgentConnector_ms": 0.06007075309753418}}, "episode_reward_max": -912842.9550149553, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -960886.1949616403, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.159057284633361, "mean_inference_ms": 5.233611307384133, "mean_action_processing_ms": 0.14624661998272492, "mean_env_wait_ms": 0.25611722970512074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015535354614257812, "StateBufferConnector_ms": 0.0024247169494628906, "ViewRequirementAgentConnector_ms": 0.06007075309753418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6720, "timers": {"training_iteration_time_ms": 3489.439, "learn_time_ms": 1547.04, "learn_throughput": 217.189}, "counters": {"num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-21", "timestamp": 1706260581, "time_this_iter_s": 3.489715814590454, "time_total_s": 70.01581883430481, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee805a170>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8057640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 70.01581883430481, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.56, "ram_util_percent": 11.06}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.90398120880127, "policy_loss": -0.1483810544013977, "vf_loss": 10.0, "vf_explained_var": 4.503462136540293e-08, "kl": 0.015323476865887642, "entropy": 12.632538795471191, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1845.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -957492.8663938097, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15899922498084024, "mean_inference_ms": 5.233263247458032, "mean_action_processing_ms": 0.1461863425545564, "mean_env_wait_ms": 0.2560088179104177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015519914172944568, "StateBufferConnector_ms": 0.0024205162411644345, "ViewRequirementAgentConnector_ms": 0.06000427972702753}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -957492.8663938097, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15899922498084024, "mean_inference_ms": 5.233263247458032, "mean_action_processing_ms": 0.1461863425545564, "mean_env_wait_ms": 0.2560088179104177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015519914172944568, "StateBufferConnector_ms": 0.0024205162411644345, "ViewRequirementAgentConnector_ms": 0.06000427972702753}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7056, "timers": {"training_iteration_time_ms": 3489.773, "learn_time_ms": 1547.225, "learn_throughput": 217.163}, "counters": {"num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "done": false, "episodes_total": 21, "training_iteration": 21, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-24", "timestamp": 1706260584, "time_this_iter_s": 3.4927871227264404, "time_total_s": 73.50860595703125, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8059240>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8057490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 73.50860595703125, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.56, "ram_util_percent": 11.180000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.90158748626709, "policy_loss": -0.14960530400276184, "vf_loss": 10.0, "vf_explained_var": 3.774960788405224e-08, "kl": 0.014980856329202652, "entropy": 12.618855476379395, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -956467.5373620287, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15895232317131036, "mean_inference_ms": 5.233005097753042, "mean_action_processing_ms": 0.14613330918344772, "mean_env_wait_ms": 0.25590983953962004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0154766169461337, "StateBufferConnector_ms": 0.0024166974154385653, "ViewRequirementAgentConnector_ms": 0.05999153310602361}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -956467.5373620287, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15895232317131036, "mean_inference_ms": 5.233005097753042, "mean_action_processing_ms": 0.14613330918344772, "mean_env_wait_ms": 0.25590983953962004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0154766169461337, "StateBufferConnector_ms": 0.0024166974154385653, "ViewRequirementAgentConnector_ms": 0.05999153310602361}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7392, "timers": {"training_iteration_time_ms": 3490.7, "learn_time_ms": 1546.645, "learn_throughput": 217.244}, "counters": {"num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "done": false, "episodes_total": 22, "training_iteration": 22, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-28", "timestamp": 1706260588, "time_this_iter_s": 3.511723279953003, "time_total_s": 77.02032923698425, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee805b310>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8057f40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 77.02032923698425, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 11.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.893349647521973, "policy_loss": -0.15979281067848206, "vf_loss": 10.0, "vf_explained_var": 2.8477774804969158e-08, "kl": 0.015551573596894741, "entropy": 12.622834205627441, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -954865.4915701639, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15891102974157606, "mean_inference_ms": 5.232769956956511, "mean_action_processing_ms": 0.1460841616610371, "mean_env_wait_ms": 0.2558161432843558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015418425850246264, "StateBufferConnector_ms": 0.0024101008539614472, "ViewRequirementAgentConnector_ms": 0.05999337071957796}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -954865.4915701639, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15891102974157606, "mean_inference_ms": 5.232769956956511, "mean_action_processing_ms": 0.1460841616610371, "mean_env_wait_ms": 0.2558161432843558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015418425850246264, "StateBufferConnector_ms": 0.0024101008539614472, "ViewRequirementAgentConnector_ms": 0.05999337071957796}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7728, "timers": {"training_iteration_time_ms": 3492.923, "learn_time_ms": 1548.167, "learn_throughput": 217.031}, "counters": {"num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "done": false, "episodes_total": 23, "training_iteration": 23, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-31", "timestamp": 1706260591, "time_this_iter_s": 3.4990310668945312, "time_total_s": 80.51936030387878, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee805b010>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8057910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 80.51936030387878, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.680000000000001, "ram_util_percent": 11.440000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.903650283813477, "policy_loss": -0.14419646561145782, "vf_loss": 10.0, "vf_explained_var": 3.3775965135873776e-08, "kl": 0.014001472853124142, "entropy": 12.775033950805664, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2115.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -954640.3122196916, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1588752691504214, "mean_inference_ms": 5.232481757585865, "mean_action_processing_ms": 0.14603914228310402, "mean_env_wait_ms": 0.2557266655182501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015437602996826172, "StateBufferConnector_ms": 0.0024050474166870117, "ViewRequirementAgentConnector_ms": 0.059986114501953125}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -954640.3122196916, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1588752691504214, "mean_inference_ms": 5.232481757585865, "mean_action_processing_ms": 0.14603914228310402, "mean_env_wait_ms": 0.2557266655182501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015437602996826172, "StateBufferConnector_ms": 0.0024050474166870117, "ViewRequirementAgentConnector_ms": 0.059986114501953125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 3490.693, "learn_time_ms": 1548.369, "learn_throughput": 217.003}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-35", "timestamp": 1706260595, "time_this_iter_s": 3.481675624847412, "time_total_s": 84.0010359287262, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80601f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8094940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 84.0010359287262, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.66, "ram_util_percent": 11.56}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.895710945129395, "policy_loss": -0.15520724654197693, "vf_loss": 10.0, "vf_explained_var": 3.443824070359369e-08, "kl": 0.014900407753884792, "entropy": 12.690865516662598, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -955860.9425229847, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1588406080587452, "mean_inference_ms": 5.232157831153528, "mean_action_processing_ms": 0.14599499693047538, "mean_env_wait_ms": 0.2556391391324385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015372276306152344, "StateBufferConnector_ms": 0.002399444580078125, "ViewRequirementAgentConnector_ms": 0.05995655059814453}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -955860.9425229847, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1588406080587452, "mean_inference_ms": 5.232157831153528, "mean_action_processing_ms": 0.14599499693047538, "mean_env_wait_ms": 0.2556391391324385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015372276306152344, "StateBufferConnector_ms": 0.002399444580078125, "ViewRequirementAgentConnector_ms": 0.05995655059814453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 3487.921, "learn_time_ms": 1546.906, "learn_throughput": 217.208}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "done": false, "episodes_total": 25, "training_iteration": 25, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-38", "timestamp": 1706260598, "time_this_iter_s": 3.4720590114593506, "time_total_s": 87.47309494018555, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc8df0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80570a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 87.47309494018555, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 11.680000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.897626876831055, "policy_loss": -0.1542547643184662, "vf_loss": 10.0, "vf_explained_var": 9.2718339672615e-09, "kl": 0.015182615257799625, "entropy": 12.686838150024414, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2295.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -955263.6055521579, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15880902092422078, "mean_inference_ms": 5.231855450540148, "mean_action_processing_ms": 0.14595391718075273, "mean_env_wait_ms": 0.25555936749191893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534131857065054, "StateBufferConnector_ms": 0.002392438741830679, "ViewRequirementAgentConnector_ms": 0.059910003955547624}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -955263.6055521579, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15880902092422078, "mean_inference_ms": 5.231855450540148, "mean_action_processing_ms": 0.14595391718075273, "mean_env_wait_ms": 0.25555936749191893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534131857065054, "StateBufferConnector_ms": 0.002392438741830679, "ViewRequirementAgentConnector_ms": 0.059910003955547624}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8736, "timers": {"training_iteration_time_ms": 3484.695, "learn_time_ms": 1544.642, "learn_throughput": 217.526}, "counters": {"num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "done": false, "episodes_total": 26, "training_iteration": 26, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-42", "timestamp": 1706260602, "time_this_iter_s": 3.4741103649139404, "time_total_s": 90.94720530509949, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8061330>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8095360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 90.94720530509949, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.659999999999999, "ram_util_percent": 11.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.890913963317871, "policy_loss": -0.16412104666233063, "vf_loss": 10.0, "vf_explained_var": 4.17232506322307e-08, "kl": 0.01610524207353592, "entropy": 12.66944408416748, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2385.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -954855.8850960315, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15877704314746774, "mean_inference_ms": 5.231489474963866, "mean_action_processing_ms": 0.1459135586772335, "mean_env_wait_ms": 0.2554804305689298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015278215761537905, "StateBufferConnector_ms": 0.002391250045211227, "ViewRequirementAgentConnector_ms": 0.059831583941424335}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -954855.8850960315, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15877704314746774, "mean_inference_ms": 5.231489474963866, "mean_action_processing_ms": 0.1459135586772335, "mean_env_wait_ms": 0.2554804305689298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015278215761537905, "StateBufferConnector_ms": 0.002391250045211227, "ViewRequirementAgentConnector_ms": 0.059831583941424335}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9072, "timers": {"training_iteration_time_ms": 3480.607, "learn_time_ms": 1543.167, "learn_throughput": 217.734}, "counters": {"num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "done": false, "episodes_total": 27, "training_iteration": 27, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-45", "timestamp": 1706260605, "time_this_iter_s": 3.4398252964019775, "time_total_s": 94.38703060150146, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee805a0b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8095120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 94.38703060150146, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.720000000000001, "ram_util_percent": 11.959999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.899417877197266, "policy_loss": -0.1545921117067337, "vf_loss": 10.0, "vf_explained_var": 2.781550101360608e-08, "kl": 0.01580534689128399, "entropy": 12.706964492797852, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -953503.6200164706, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15874598879342902, "mean_inference_ms": 5.2311141845397, "mean_action_processing_ms": 0.1458748275704988, "mean_env_wait_ms": 0.255404179350597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015284333910260881, "StateBufferConnector_ms": 0.002389294760567801, "ViewRequirementAgentConnector_ms": 0.059808152062552314}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -953503.6200164706, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15874598879342902, "mean_inference_ms": 5.2311141845397, "mean_action_processing_ms": 0.1458748275704988, "mean_env_wait_ms": 0.255404179350597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015284333910260881, "StateBufferConnector_ms": 0.002389294760567801, "ViewRequirementAgentConnector_ms": 0.059808152062552314}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9408, "timers": {"training_iteration_time_ms": 3478.826, "learn_time_ms": 1541.147, "learn_throughput": 218.019}, "counters": {"num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-49", "timestamp": 1706260609, "time_this_iter_s": 3.4587020874023438, "time_total_s": 97.84573268890381, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80624a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8095a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 97.84573268890381, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.639999999999999, "ram_util_percent": 12.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.895280838012695, "policy_loss": -0.15473321080207825, "vf_loss": 10.0, "vf_explained_var": 3.1789145538141383e-08, "kl": 0.014636375941336155, "entropy": 12.724262237548828, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2565.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -952984.0323606442, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15871627897330062, "mean_inference_ms": 5.230722123441766, "mean_action_processing_ms": 0.14583763065483765, "mean_env_wait_ms": 0.2553308169030065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015266188259782463, "StateBufferConnector_ms": 0.0023858300570783943, "ViewRequirementAgentConnector_ms": 0.05980360096898572}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -952984.0323606442, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15871627897330062, "mean_inference_ms": 5.230722123441766, "mean_action_processing_ms": 0.14583763065483765, "mean_env_wait_ms": 0.2553308169030065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015266188259782463, "StateBufferConnector_ms": 0.0023858300570783943, "ViewRequirementAgentConnector_ms": 0.05980360096898572}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9744, "timers": {"training_iteration_time_ms": 3478.138, "learn_time_ms": 1539.503, "learn_throughput": 218.252}, "counters": {"num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "done": false, "episodes_total": 29, "training_iteration": 29, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-52", "timestamp": 1706260612, "time_this_iter_s": 3.4645607471466064, "time_total_s": 101.31029343605042, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80622f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8095990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 101.31029343605042, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 12.239999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.896044731140137, "policy_loss": -0.1542053371667862, "vf_loss": 10.0, "vf_explained_var": 2.4504132056790695e-08, "kl": 0.01470525935292244, "entropy": 12.752302169799805, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2655.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -951302.119368231, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15868787632410117, "mean_inference_ms": 5.2302970302898215, "mean_action_processing_ms": 0.14580076280654805, "mean_env_wait_ms": 0.2552571814025068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015439192454020182, "StateBufferConnector_ms": 0.0023833910624186196, "ViewRequirementAgentConnector_ms": 0.05981127421061198}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -951302.119368231, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15868787632410117, "mean_inference_ms": 5.2302970302898215, "mean_action_processing_ms": 0.14580076280654805, "mean_env_wait_ms": 0.2552571814025068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015439192454020182, "StateBufferConnector_ms": 0.0023833910624186196, "ViewRequirementAgentConnector_ms": 0.05981127421061198}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10080, "timers": {"training_iteration_time_ms": 3473.901, "learn_time_ms": 1537.198, "learn_throughput": 218.579}, "counters": {"num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "done": false, "episodes_total": 30, "training_iteration": 30, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-56", "timestamp": 1706260616, "time_this_iter_s": 3.4473814964294434, "time_total_s": 104.75767493247986, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8063100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8096290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 104.75767493247986, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.479999999999999, "ram_util_percent": 12.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.883574485778809, "policy_loss": -0.16664814949035645, "vf_loss": 10.0, "vf_explained_var": 3.907415546677839e-08, "kl": 0.01469691563397646, "entropy": 12.765325546264648, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2745.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -952230.5435374709, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15865935784357224, "mean_inference_ms": 5.229827443578398, "mean_action_processing_ms": 0.14576492447502282, "mean_env_wait_ms": 0.2551843665990754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01541030022405809, "StateBufferConnector_ms": 0.0023811094222530244, "ViewRequirementAgentConnector_ms": 0.05973615953999181}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -952230.5435374709, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15865935784357224, "mean_inference_ms": 5.229827443578398, "mean_action_processing_ms": 0.14576492447502282, "mean_env_wait_ms": 0.2551843665990754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01541030022405809, "StateBufferConnector_ms": 0.0023811094222530244, "ViewRequirementAgentConnector_ms": 0.05973615953999181}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10416, "timers": {"training_iteration_time_ms": 3470.172, "learn_time_ms": 1536.091, "learn_throughput": 218.737}, "counters": {"num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "done": false, "episodes_total": 31, "training_iteration": 31, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-16-59", "timestamp": 1706260619, "time_this_iter_s": 3.4555647373199463, "time_total_s": 108.2132396697998, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80637f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80945e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 108.2132396697998, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 12.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.896918296813965, "policy_loss": -0.15828068554401398, "vf_loss": 10.0, "vf_explained_var": 3.973643103449831e-08, "kl": 0.016153473407030106, "entropy": 12.663580894470215, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -952207.1677788962, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15863263443840003, "mean_inference_ms": 5.22937955113105, "mean_action_processing_ms": 0.14573049714607061, "mean_env_wait_ms": 0.2551134570925058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015366822481155396, "StateBufferConnector_ms": 0.0023797154426574707, "ViewRequirementAgentConnector_ms": 0.059738755226135254}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -952207.1677788962, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15863263443840003, "mean_inference_ms": 5.22937955113105, "mean_action_processing_ms": 0.14573049714607061, "mean_env_wait_ms": 0.2551134570925058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015366822481155396, "StateBufferConnector_ms": 0.0023797154426574707, "ViewRequirementAgentConnector_ms": 0.059738755226135254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 3466.892, "learn_time_ms": 1534.663, "learn_throughput": 218.941}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 32, "training_iteration": 32, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-03", "timestamp": 1706260623, "time_this_iter_s": 3.4789445400238037, "time_total_s": 111.69218420982361, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8063fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8096a70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 111.69218420982361, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 12.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.880952835083008, "policy_loss": -0.17107346653938293, "vf_loss": 10.0, "vf_explained_var": 1.1920929132713809e-08, "kl": 0.015224763192236423, "entropy": 12.68323040008545, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 2925.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -952269.7636740599, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15860784513635368, "mean_inference_ms": 5.228955754084274, "mean_action_processing_ms": 0.14569683181961082, "mean_env_wait_ms": 0.25504528669070564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015407620054302794, "StateBufferConnector_ms": 0.0023762385050455728, "ViewRequirementAgentConnector_ms": 0.059757810650449814}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -952269.7636740599, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15860784513635368, "mean_inference_ms": 5.228955754084274, "mean_action_processing_ms": 0.14569683181961082, "mean_env_wait_ms": 0.25504528669070564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015407620054302794, "StateBufferConnector_ms": 0.0023762385050455728, "ViewRequirementAgentConnector_ms": 0.059757810650449814}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11088, "timers": {"training_iteration_time_ms": 3466.918, "learn_time_ms": 1535.31, "learn_throughput": 218.848}, "counters": {"num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "done": false, "episodes_total": 33, "training_iteration": 33, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-06", "timestamp": 1706260626, "time_this_iter_s": 3.499323844909668, "time_total_s": 115.19150805473328, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8058a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8095630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 115.19150805473328, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 12.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.89245891571045, "policy_loss": -0.1617191880941391, "vf_loss": 10.0, "vf_explained_var": 1.9205941725886078e-08, "kl": 0.015854554250836372, "entropy": 12.680255889892578, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3015.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -951980.1341720213, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15858452942712412, "mean_inference_ms": 5.228551557011115, "mean_action_processing_ms": 0.14566476484830304, "mean_env_wait_ms": 0.2549802164015889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359766343060662, "StateBufferConnector_ms": 0.0023757710176355697, "ViewRequirementAgentConnector_ms": 0.059754007002886605}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -951980.1341720213, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15858452942712412, "mean_inference_ms": 5.228551557011115, "mean_action_processing_ms": 0.14566476484830304, "mean_env_wait_ms": 0.2549802164015889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359766343060662, "StateBufferConnector_ms": 0.0023757710176355697, "ViewRequirementAgentConnector_ms": 0.059754007002886605}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11424, "timers": {"training_iteration_time_ms": 3466.046, "learn_time_ms": 1533.713, "learn_throughput": 219.076}, "counters": {"num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "done": false, "episodes_total": 34, "training_iteration": 34, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-10", "timestamp": 1706260630, "time_this_iter_s": 3.472984552383423, "time_total_s": 118.6644926071167, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8090fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8097490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 118.6644926071167, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.619999999999999, "ram_util_percent": 12.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.896537780761719, "policy_loss": -0.15947170555591583, "vf_loss": 10.0, "vf_explained_var": 3.1789145538141383e-08, "kl": 0.016390426084399223, "entropy": 12.701351165771484, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3105.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -951162.6184290729, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15856208983846456, "mean_inference_ms": 5.228137277212646, "mean_action_processing_ms": 0.1456331691496016, "mean_env_wait_ms": 0.25491690620180724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015314647129603795, "StateBufferConnector_ms": 0.002371924264090402, "ViewRequirementAgentConnector_ms": 0.059707505362374444}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -951162.6184290729, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15856208983846456, "mean_inference_ms": 5.228137277212646, "mean_action_processing_ms": 0.1456331691496016, "mean_env_wait_ms": 0.25491690620180724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015314647129603795, "StateBufferConnector_ms": 0.002371924264090402, "ViewRequirementAgentConnector_ms": 0.059707505362374444}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11760, "timers": {"training_iteration_time_ms": 3466.311, "learn_time_ms": 1534.469, "learn_throughput": 218.968}, "counters": {"num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "done": false, "episodes_total": 35, "training_iteration": 35, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-13", "timestamp": 1706260633, "time_this_iter_s": 3.4747254848480225, "time_total_s": 122.13921809196472, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8062f80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8096200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 122.13921809196472, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 13.040000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.883869171142578, "policy_loss": -0.16806425154209137, "vf_loss": 10.0, "vf_explained_var": 2.9140048596332235e-08, "kl": 0.015197605825960636, "entropy": 12.64122200012207, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3195.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -950844.3206692596, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15854053548332447, "mean_inference_ms": 5.227733404788298, "mean_action_processing_ms": 0.14560217038971, "mean_env_wait_ms": 0.2548538156572705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015289253658718534, "StateBufferConnector_ms": 0.0023709403143988717, "ViewRequirementAgentConnector_ms": 0.05968875355190701}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -950844.3206692596, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15854053548332447, "mean_inference_ms": 5.227733404788298, "mean_action_processing_ms": 0.14560217038971, "mean_env_wait_ms": 0.2548538156572705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015289253658718534, "StateBufferConnector_ms": 0.0023709403143988717, "ViewRequirementAgentConnector_ms": 0.05968875355190701}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12096, "timers": {"training_iteration_time_ms": 3466.63, "learn_time_ms": 1535.888, "learn_throughput": 218.766}, "counters": {"num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "done": false, "episodes_total": 36, "training_iteration": 36, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-17", "timestamp": 1706260637, "time_this_iter_s": 3.477318525314331, "time_total_s": 125.61653661727905, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8091cf0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8097b50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 125.61653661727905, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.48, "ram_util_percent": 13.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.907947540283203, "policy_loss": -0.15359722077846527, "vf_loss": 10.0, "vf_explained_var": 3.1789145538141383e-08, "kl": 0.018010269850492477, "entropy": 12.629952430725098, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3285.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -950261.9455511344, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15852230754398783, "mean_inference_ms": 5.227389214031771, "mean_action_processing_ms": 0.14557332503496742, "mean_env_wait_ms": 0.2547966646024059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015263944058804898, "StateBufferConnector_ms": 0.002370653925715266, "ViewRequirementAgentConnector_ms": 0.05970903345056482}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -950261.9455511344, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15852230754398783, "mean_inference_ms": 5.227389214031771, "mean_action_processing_ms": 0.14557332503496742, "mean_env_wait_ms": 0.2547966646024059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015263944058804898, "StateBufferConnector_ms": 0.002370653925715266, "ViewRequirementAgentConnector_ms": 0.05970903345056482}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12432, "timers": {"training_iteration_time_ms": 3475.015, "learn_time_ms": 1540.348, "learn_throughput": 218.133}, "counters": {"num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "done": false, "episodes_total": 37, "training_iteration": 37, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-20", "timestamp": 1706260640, "time_this_iter_s": 3.52371883392334, "time_total_s": 129.1402554512024, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee805ac50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80969e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 129.1402554512024, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 13.279999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.877280235290527, "policy_loss": -0.17452630400657654, "vf_loss": 10.0, "vf_explained_var": 1.2583202924076886e-08, "kl": 0.015160569921135902, "entropy": 12.630245208740234, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "sampler_results": {"episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -950208.0675977796, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.158505270149858, "mean_inference_ms": 5.2270597438171125, "mean_action_processing_ms": 0.14554561163768193, "mean_env_wait_ms": 0.2547408170246776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015415643390856291, "StateBufferConnector_ms": 0.0023710100274336966, "ViewRequirementAgentConnector_ms": 0.05972887340344881}}, "episode_reward_max": -889626.295037199, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -950208.0675977796, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.158505270149858, "mean_inference_ms": 5.2270597438171125, "mean_action_processing_ms": 0.14554561163768193, "mean_env_wait_ms": 0.2547408170246776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015415643390856291, "StateBufferConnector_ms": 0.0023710100274336966, "ViewRequirementAgentConnector_ms": 0.05972887340344881}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12768, "timers": {"training_iteration_time_ms": 3476.597, "learn_time_ms": 1541.372, "learn_throughput": 217.988}, "counters": {"num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "done": false, "episodes_total": 38, "training_iteration": 38, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-24", "timestamp": 1706260644, "time_this_iter_s": 3.4745402336120605, "time_total_s": 132.61479568481445, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093010>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80983a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 132.61479568481445, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.56, "ram_util_percent": 13.440000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.882661819458008, "policy_loss": -0.1682446151971817, "vf_loss": 10.0, "vf_explained_var": 1.0596381549987655e-08, "kl": 0.014897195622324944, "entropy": 12.621057510375977, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -948646.0462949965, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15848973814132689, "mean_inference_ms": 5.226715653209029, "mean_action_processing_ms": 0.14551874410561763, "mean_env_wait_ms": 0.25468580252756196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015398172231820913, "StateBufferConnector_ms": 0.002367068559695513, "ViewRequirementAgentConnector_ms": 0.05972202007587139}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -948646.0462949965, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15848973814132689, "mean_inference_ms": 5.226715653209029, "mean_action_processing_ms": 0.14551874410561763, "mean_env_wait_ms": 0.25468580252756196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015398172231820913, "StateBufferConnector_ms": 0.002367068559695513, "ViewRequirementAgentConnector_ms": 0.05972202007587139}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13104, "timers": {"training_iteration_time_ms": 3476.647, "learn_time_ms": 1542.045, "learn_throughput": 217.893}, "counters": {"num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "done": false, "episodes_total": 39, "training_iteration": 39, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-27", "timestamp": 1706260647, "time_this_iter_s": 3.465092897415161, "time_total_s": 136.07988858222961, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093070>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8096290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 136.07988858222961, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 13.559999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.875447273254395, "policy_loss": -0.17773760855197906, "vf_loss": 10.0, "vf_explained_var": 2.1855036891338386e-08, "kl": 0.01556401513516903, "entropy": 12.641205787658691, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3555.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -948043.4928547274, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15847583300816231, "mean_inference_ms": 5.2263712285686585, "mean_action_processing_ms": 0.14549319213840353, "mean_env_wait_ms": 0.2546335804452179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015404820442199707, "StateBufferConnector_ms": 0.0023651123046875, "ViewRequirementAgentConnector_ms": 0.059673190116882324}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -948043.4928547274, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15847583300816231, "mean_inference_ms": 5.2263712285686585, "mean_action_processing_ms": 0.14549319213840353, "mean_env_wait_ms": 0.2546335804452179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015404820442199707, "StateBufferConnector_ms": 0.0023651123046875, "ViewRequirementAgentConnector_ms": 0.059673190116882324}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 3478.882, "learn_time_ms": 1543.375, "learn_throughput": 217.705}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "done": false, "episodes_total": 40, "training_iteration": 40, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-31", "timestamp": 1706260651, "time_this_iter_s": 3.4697623252868652, "time_total_s": 139.54965090751648, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8098820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 139.54965090751648, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.540000000000001, "ram_util_percent": 13.680000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.887757301330566, "policy_loss": -0.16709749400615692, "vf_loss": 10.0, "vf_explained_var": 6.622738357719982e-09, "kl": 0.016052553430199623, "entropy": 12.558156967163086, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3645.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947461.7896238524, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15846122825576256, "mean_inference_ms": 5.226021014533868, "mean_action_processing_ms": 0.1454677300286405, "mean_env_wait_ms": 0.2545818927076686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015414051893280774, "StateBufferConnector_ms": 0.0023638329854825646, "ViewRequirementAgentConnector_ms": 0.05973141367842511}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947461.7896238524, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15846122825576256, "mean_inference_ms": 5.226021014533868, "mean_action_processing_ms": 0.1454677300286405, "mean_env_wait_ms": 0.2545818927076686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015414051893280774, "StateBufferConnector_ms": 0.0023638329854825646, "ViewRequirementAgentConnector_ms": 0.05973141367842511}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13776, "timers": {"training_iteration_time_ms": 3477.84, "learn_time_ms": 1541.506, "learn_throughput": 217.969}, "counters": {"num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "done": false, "episodes_total": 41, "training_iteration": 41, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-34", "timestamp": 1706260654, "time_this_iter_s": 3.4451184272766113, "time_total_s": 142.9947693347931, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093850>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8096560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 142.9947693347931, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.659999999999999, "ram_util_percent": 13.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.892008781433105, "policy_loss": -0.16051581501960754, "vf_loss": 10.0, "vf_explained_var": 6.622738357719982e-09, "kl": 0.01537088118493557, "entropy": 12.58732795715332, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3735.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947108.1350201762, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584463343467536, "mean_inference_ms": 5.2256590837629115, "mean_action_processing_ms": 0.1454421939487579, "mean_env_wait_ms": 0.25453029032612046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537459237234933, "StateBufferConnector_ms": 0.0023626145862397693, "ViewRequirementAgentConnector_ms": 0.059714771452404204}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947108.1350201762, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584463343467536, "mean_inference_ms": 5.2256590837629115, "mean_action_processing_ms": 0.1454421939487579, "mean_env_wait_ms": 0.25453029032612046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537459237234933, "StateBufferConnector_ms": 0.0023626145862397693, "ViewRequirementAgentConnector_ms": 0.059714771452404204}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14112, "timers": {"training_iteration_time_ms": 3476.119, "learn_time_ms": 1541.509, "learn_throughput": 217.968}, "counters": {"num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "done": false, "episodes_total": 42, "training_iteration": 42, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-38", "timestamp": 1706260658, "time_this_iter_s": 3.461747646331787, "time_total_s": 146.45651698112488, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecc4c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8098f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 146.45651698112488, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.540000000000001, "ram_util_percent": 13.959999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.892964363098145, "policy_loss": -0.16199113428592682, "vf_loss": 10.0, "vf_explained_var": 1.8543667934523e-08, "kl": 0.016082262620329857, "entropy": 12.567137718200684, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3825.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946774.5894620245, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15843245987516347, "mean_inference_ms": 5.225306772985627, "mean_action_processing_ms": 0.14541739732125783, "mean_env_wait_ms": 0.25448048505538085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015371344810308413, "StateBufferConnector_ms": 0.002362561780352925, "ViewRequirementAgentConnector_ms": 0.059738270072049876}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946774.5894620245, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15843245987516347, "mean_inference_ms": 5.225306772985627, "mean_action_processing_ms": 0.14541739732125783, "mean_env_wait_ms": 0.25448048505538085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015371344810308413, "StateBufferConnector_ms": 0.002362561780352925, "ViewRequirementAgentConnector_ms": 0.059738270072049876}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14448, "timers": {"training_iteration_time_ms": 3473.534, "learn_time_ms": 1539.398, "learn_throughput": 218.267}, "counters": {"num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "done": false, "episodes_total": 43, "training_iteration": 43, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-41", "timestamp": 1706260661, "time_this_iter_s": 3.473477602005005, "time_total_s": 149.92999458312988, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093c70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8057910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 149.92999458312988, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 14.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.887198448181152, "policy_loss": -0.16882571578025818, "vf_loss": 10.0, "vf_explained_var": 1.7881394143159923e-08, "kl": 0.01639477349817753, "entropy": 12.64721965789795, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 3915.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947230.0284505374, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15841940757604678, "mean_inference_ms": 5.2249579059236995, "mean_action_processing_ms": 0.14539359147388678, "mean_env_wait_ms": 0.25443323178055927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330856496637518, "StateBufferConnector_ms": 0.002360885793512518, "ViewRequirementAgentConnector_ms": 0.05971247499639338}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947230.0284505374, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15841940757604678, "mean_inference_ms": 5.2249579059236995, "mean_action_processing_ms": 0.14539359147388678, "mean_env_wait_ms": 0.25443323178055927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330856496637518, "StateBufferConnector_ms": 0.002360885793512518, "ViewRequirementAgentConnector_ms": 0.05971247499639338}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14784, "timers": {"training_iteration_time_ms": 3474.768, "learn_time_ms": 1541.364, "learn_throughput": 217.989}, "counters": {"num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "done": false, "episodes_total": 44, "training_iteration": 44, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-45", "timestamp": 1706260665, "time_this_iter_s": 3.4853553771972656, "time_total_s": 153.41534996032715, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd360>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8099630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 153.41534996032715, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.680000000000001, "ram_util_percent": 14.239999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.868020057678223, "policy_loss": -0.18535178899765015, "vf_loss": 10.0, "vf_explained_var": 1.9868215517249155e-08, "kl": 0.015618875622749329, "entropy": 12.584636688232422, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4005.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946867.0295568196, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15840717983807343, "mean_inference_ms": 5.224604776785862, "mean_action_processing_ms": 0.14537059434469413, "mean_env_wait_ms": 0.2543871418191441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323956807454428, "StateBufferConnector_ms": 0.002357694837782118, "ViewRequirementAgentConnector_ms": 0.059735510084364146}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946867.0295568196, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15840717983807343, "mean_inference_ms": 5.224604776785862, "mean_action_processing_ms": 0.14537059434469413, "mean_env_wait_ms": 0.2543871418191441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323956807454428, "StateBufferConnector_ms": 0.002357694837782118, "ViewRequirementAgentConnector_ms": 0.059735510084364146}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15120, "timers": {"training_iteration_time_ms": 3474.363, "learn_time_ms": 1541.045, "learn_throughput": 218.034}, "counters": {"num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "done": false, "episodes_total": 45, "training_iteration": 45, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-48", "timestamp": 1706260668, "time_this_iter_s": 3.470707654953003, "time_total_s": 156.88605761528015, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8092f50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8099480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 156.88605761528015, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.660000000000001, "ram_util_percent": 14.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.880392074584961, "policy_loss": -0.17211197316646576, "vf_loss": 10.0, "vf_explained_var": 1.5894572769070692e-08, "kl": 0.015364914201200008, "entropy": 12.67820930480957, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4095.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947667.0204616569, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15839481484191853, "mean_inference_ms": 5.22424963895907, "mean_action_processing_ms": 0.14534809084585856, "mean_env_wait_ms": 0.25434207519802426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015419980754023012, "StateBufferConnector_ms": 0.00235723412555197, "ViewRequirementAgentConnector_ms": 0.0597108965334685}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947667.0204616569, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15839481484191853, "mean_inference_ms": 5.22424963895907, "mean_action_processing_ms": 0.14534809084585856, "mean_env_wait_ms": 0.25434207519802426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015419980754023012, "StateBufferConnector_ms": 0.00235723412555197, "ViewRequirementAgentConnector_ms": 0.0597108965334685}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15456, "timers": {"training_iteration_time_ms": 3473.309, "learn_time_ms": 1540.806, "learn_throughput": 218.068}, "counters": {"num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "done": false, "episodes_total": 46, "training_iteration": 46, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-52", "timestamp": 1706260672, "time_this_iter_s": 3.4667770862579346, "time_total_s": 160.3528347015381, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece2c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8099cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 160.3528347015381, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.540000000000001, "ram_util_percent": 14.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.875161170959473, "policy_loss": -0.17933480441570282, "vf_loss": 10.0, "vf_explained_var": 1.9205941725886078e-08, "kl": 0.015947604551911354, "entropy": 12.611912727355957, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946842.0581600213, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15838410296549263, "mean_inference_ms": 5.2239162187155035, "mean_action_processing_ms": 0.14532696188594896, "mean_env_wait_ms": 0.2543003123758147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015419594785000415, "StateBufferConnector_ms": 0.00235577847095246, "ViewRequirementAgentConnector_ms": 0.05971320131991772}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946842.0581600213, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15838410296549263, "mean_inference_ms": 5.2239162187155035, "mean_action_processing_ms": 0.14532696188594896, "mean_env_wait_ms": 0.2543003123758147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015419594785000415, "StateBufferConnector_ms": 0.00235577847095246, "ViewRequirementAgentConnector_ms": 0.05971320131991772}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15792, "timers": {"training_iteration_time_ms": 3471.113, "learn_time_ms": 1540.075, "learn_throughput": 218.171}, "counters": {"num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "done": false, "episodes_total": 47, "training_iteration": 47, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-55", "timestamp": 1706260675, "time_this_iter_s": 3.5017712116241455, "time_total_s": 163.85460591316223, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80610f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8098f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 163.85460591316223, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 14.62}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.880315780639648, "policy_loss": -0.1744012087583542, "vf_loss": 10.0, "vf_explained_var": 3.5762788286319847e-08, "kl": 0.016012251377105713, "entropy": 12.609594345092773, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4275.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946227.1663602396, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583742694510907, "mean_inference_ms": 5.223608238771916, "mean_action_processing_ms": 0.14530687819754118, "mean_env_wait_ms": 0.25426071695010605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015400846799214682, "StateBufferConnector_ms": 0.0023518999417622886, "ViewRequirementAgentConnector_ms": 0.059707462787628174}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946227.1663602396, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583742694510907, "mean_inference_ms": 5.223608238771916, "mean_action_processing_ms": 0.14530687819754118, "mean_env_wait_ms": 0.25426071695010605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015400846799214682, "StateBufferConnector_ms": 0.0023518999417622886, "ViewRequirementAgentConnector_ms": 0.059707462787628174}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 3473.488, "learn_time_ms": 1541.453, "learn_throughput": 217.976}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "done": false, "episodes_total": 48, "training_iteration": 48, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-17-59", "timestamp": 1706260679, "time_this_iter_s": 3.4983160495758057, "time_total_s": 167.35292196273804, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdcc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809a440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 167.35292196273804, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 14.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.887154579162598, "policy_loss": -0.16522608697414398, "vf_loss": 10.0, "vf_explained_var": 2.317958447406454e-08, "kl": 0.015328779816627502, "entropy": 12.543338775634766, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4365.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945504.4630138525, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583652154697532, "mean_inference_ms": 5.22330850359882, "mean_action_processing_ms": 0.14528740866105838, "mean_env_wait_ms": 0.2542226453314607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015376052077935666, "StateBufferConnector_ms": 0.0023510991310586736, "ViewRequirementAgentConnector_ms": 0.0597764034660495}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945504.4630138525, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583652154697532, "mean_inference_ms": 5.22330850359882, "mean_action_processing_ms": 0.14528740866105838, "mean_env_wait_ms": 0.2542226453314607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015376052077935666, "StateBufferConnector_ms": 0.0023510991310586736, "ViewRequirementAgentConnector_ms": 0.0597764034660495}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16464, "timers": {"training_iteration_time_ms": 3476.726, "learn_time_ms": 1543.524, "learn_throughput": 217.684}, "counters": {"num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "done": false, "episodes_total": 49, "training_iteration": 49, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-02", "timestamp": 1706260682, "time_this_iter_s": 3.4974875450134277, "time_total_s": 170.85040950775146, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8091750>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809a7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 170.85040950775146, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 14.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.887998580932617, "policy_loss": -0.16960345208644867, "vf_loss": 10.0, "vf_explained_var": 2.9802322387695312e-08, "kl": 0.016856689006090164, "entropy": 12.624784469604492, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4455.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946113.4878650801, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15835638644008815, "mean_inference_ms": 5.223016013728959, "mean_action_processing_ms": 0.14526828210825657, "mean_env_wait_ms": 0.2541854409459287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015358448028564453, "StateBufferConnector_ms": 0.002349376678466797, "ViewRequirementAgentConnector_ms": 0.05977773666381836}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946113.4878650801, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15835638644008815, "mean_inference_ms": 5.223016013728959, "mean_action_processing_ms": 0.14526828210825657, "mean_env_wait_ms": 0.2541854409459287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015358448028564453, "StateBufferConnector_ms": 0.002349376678466797, "ViewRequirementAgentConnector_ms": 0.05977773666381836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16800, "timers": {"training_iteration_time_ms": 3478.47, "learn_time_ms": 1545.043, "learn_throughput": 217.47}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "done": false, "episodes_total": 50, "training_iteration": 50, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-06", "timestamp": 1706260686, "time_this_iter_s": 3.4872074127197266, "time_total_s": 174.3376169204712, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf520>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80991b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 174.3376169204712, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 15.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.886412620544434, "policy_loss": -0.16894899308681488, "vf_loss": 10.0, "vf_explained_var": 3.3775965135873776e-08, "kl": 0.01620061881840229, "entropy": 12.666279792785645, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4545.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945880.8700290874, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583481653186019, "mean_inference_ms": 5.222752099008783, "mean_action_processing_ms": 0.14525051864147148, "mean_env_wait_ms": 0.25414998666269256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533358704810049, "StateBufferConnector_ms": 0.002346319310805377, "ViewRequirementAgentConnector_ms": 0.0597537732591816}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945880.8700290874, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583481653186019, "mean_inference_ms": 5.222752099008783, "mean_action_processing_ms": 0.14525051864147148, "mean_env_wait_ms": 0.25414998666269256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533358704810049, "StateBufferConnector_ms": 0.002346319310805377, "ViewRequirementAgentConnector_ms": 0.0597537732591816}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17136, "timers": {"training_iteration_time_ms": 3484.237, "learn_time_ms": 1547.831, "learn_throughput": 217.078}, "counters": {"num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "done": false, "episodes_total": 51, "training_iteration": 51, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-09", "timestamp": 1706260689, "time_this_iter_s": 3.502821683883667, "time_total_s": 177.84043860435486, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80936d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80dfeb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 177.84043860435486, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.719999999999999, "ram_util_percent": 15.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.878508567810059, "policy_loss": -0.17584721744060516, "vf_loss": 10.0, "vf_explained_var": 2.2517310682701464e-08, "kl": 0.015906650573015213, "entropy": 12.610662460327148, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4635.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946663.5270876414, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583404748878763, "mean_inference_ms": 5.222497947652799, "mean_action_processing_ms": 0.14523353734957392, "mean_env_wait_ms": 0.2541156339191147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306472778320312, "StateBufferConnector_ms": 0.0023442965287428638, "ViewRequirementAgentConnector_ms": 0.05974081846383902}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946663.5270876414, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583404748878763, "mean_inference_ms": 5.222497947652799, "mean_action_processing_ms": 0.14523353734957392, "mean_env_wait_ms": 0.2541156339191147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306472778320312, "StateBufferConnector_ms": 0.0023442965287428638, "ViewRequirementAgentConnector_ms": 0.05974081846383902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17472, "timers": {"training_iteration_time_ms": 3487.053, "learn_time_ms": 1548.799, "learn_throughput": 216.942}, "counters": {"num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "done": false, "episodes_total": 52, "training_iteration": 52, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-13", "timestamp": 1706260693, "time_this_iter_s": 3.4899373054504395, "time_total_s": 181.3303759098053, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd990>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809a4d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 181.3303759098053, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.539999999999999, "ram_util_percent": 15.279999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.875080108642578, "policy_loss": -0.18227341771125793, "vf_loss": 10.0, "vf_explained_var": 1.3245476715439963e-08, "kl": 0.01678377576172352, "entropy": 12.682909965515137, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947129.6345858892, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15833252089854222, "mean_inference_ms": 5.22222252051046, "mean_action_processing_ms": 0.14521661485572757, "mean_env_wait_ms": 0.25408160284589676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01527498353202388, "StateBufferConnector_ms": 0.0023419002317032725, "ViewRequirementAgentConnector_ms": 0.05972430391131707}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947129.6345858892, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15833252089854222, "mean_inference_ms": 5.22222252051046, "mean_action_processing_ms": 0.14521661485572757, "mean_env_wait_ms": 0.25408160284589676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01527498353202388, "StateBufferConnector_ms": 0.0023419002317032725, "ViewRequirementAgentConnector_ms": 0.05972430391131707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17808, "timers": {"training_iteration_time_ms": 3482.977, "learn_time_ms": 1547.382, "learn_throughput": 217.141}, "counters": {"num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "done": false, "episodes_total": 53, "training_iteration": 53, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-16", "timestamp": 1706260696, "time_this_iter_s": 3.4327661991119385, "time_total_s": 184.76314210891724, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8091cf0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809bac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 184.76314210891724, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.66, "ram_util_percent": 15.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.873040199279785, "policy_loss": -0.18253487348556519, "vf_loss": 10.0, "vf_explained_var": 7.947286384535346e-09, "kl": 0.016263296827673912, "entropy": 12.678688049316406, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4815.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947768.3585556647, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583249021523525, "mean_inference_ms": 5.221948830567377, "mean_action_processing_ms": 0.14520040583416619, "mean_env_wait_ms": 0.25404862419041857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015274683634440104, "StateBufferConnector_ms": 0.002341358749954789, "ViewRequirementAgentConnector_ms": 0.05971193313598633}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -947768.3585556647, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583249021523525, "mean_inference_ms": 5.221948830567377, "mean_action_processing_ms": 0.14520040583416619, "mean_env_wait_ms": 0.25404862419041857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015274683634440104, "StateBufferConnector_ms": 0.002341358749954789, "ViewRequirementAgentConnector_ms": 0.05971193313598633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18144, "timers": {"training_iteration_time_ms": 3479.506, "learn_time_ms": 1544.044, "learn_throughput": 217.61}, "counters": {"num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "done": false, "episodes_total": 54, "training_iteration": 54, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-20", "timestamp": 1706260700, "time_this_iter_s": 3.450671434402466, "time_total_s": 188.2138135433197, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eccd60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809bb50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 188.2138135433197, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.739999999999999, "ram_util_percent": 15.559999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.884281158447266, "policy_loss": -0.17301902174949646, "vf_loss": 10.0, "vf_explained_var": 2.3841858265427618e-08, "kl": 0.01676822640001774, "entropy": 12.575937271118164, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4905.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946873.5308932432, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15831698858976692, "mean_inference_ms": 5.22166052583965, "mean_action_processing_ms": 0.14518402573689645, "mean_env_wait_ms": 0.25401552865838894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015257055109197443, "StateBufferConnector_ms": 0.0023404034701260653, "ViewRequirementAgentConnector_ms": 0.059725588018243965}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946873.5308932432, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15831698858976692, "mean_inference_ms": 5.22166052583965, "mean_action_processing_ms": 0.14518402573689645, "mean_env_wait_ms": 0.25401552865838894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015257055109197443, "StateBufferConnector_ms": 0.0023404034701260653, "ViewRequirementAgentConnector_ms": 0.059725588018243965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18480, "timers": {"training_iteration_time_ms": 3478.635, "learn_time_ms": 1544.618, "learn_throughput": 217.53}, "counters": {"num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "done": false, "episodes_total": 55, "training_iteration": 55, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-23", "timestamp": 1706260703, "time_this_iter_s": 3.462033748626709, "time_total_s": 191.6758472919464, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093c70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809b130>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 191.6758472919464, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 15.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.876062393188477, "policy_loss": -0.18238413333892822, "vf_loss": 10.0, "vf_explained_var": 2.9802322387695312e-08, "kl": 0.017103446647524834, "entropy": 12.53203296661377, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 4995.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946224.0512247764, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583092289810806, "mean_inference_ms": 5.22138226760066, "mean_action_processing_ms": 0.1451679968549537, "mean_env_wait_ms": 0.25398310604381796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015242610658918108, "StateBufferConnector_ms": 0.002338630812508719, "ViewRequirementAgentConnector_ms": 0.05974088396344866}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946224.0512247764, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583092289810806, "mean_inference_ms": 5.22138226760066, "mean_action_processing_ms": 0.1451679968549537, "mean_env_wait_ms": 0.25398310604381796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015242610658918108, "StateBufferConnector_ms": 0.002338630812508719, "ViewRequirementAgentConnector_ms": 0.05974088396344866}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 3482.907, "learn_time_ms": 1547.727, "learn_throughput": 217.093}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "done": false, "episodes_total": 56, "training_iteration": 56, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-27", "timestamp": 1706260707, "time_this_iter_s": 3.509561538696289, "time_total_s": 195.1854088306427, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd150>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee8097a30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 195.1854088306427, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 15.799999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.879148483276367, "policy_loss": -0.18096818029880524, "vf_loss": 10.0, "vf_explained_var": 3.7087335869046e-08, "kl": 0.017592428252100945, "entropy": 12.536563873291016, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5085.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946220.2833325777, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15830221891507398, "mean_inference_ms": 5.221112028833155, "mean_action_processing_ms": 0.14515242297891345, "mean_env_wait_ms": 0.253952056755242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533617053115577, "StateBufferConnector_ms": 0.0023406848572848134, "ViewRequirementAgentConnector_ms": 0.05974184002792626}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946220.2833325777, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15830221891507398, "mean_inference_ms": 5.221112028833155, "mean_action_processing_ms": 0.14515242297891345, "mean_env_wait_ms": 0.253952056755242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533617053115577, "StateBufferConnector_ms": 0.0023406848572848134, "ViewRequirementAgentConnector_ms": 0.05974184002792626}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19152, "timers": {"training_iteration_time_ms": 3480.606, "learn_time_ms": 1546.337, "learn_throughput": 217.288}, "counters": {"num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "done": false, "episodes_total": 57, "training_iteration": 57, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-30", "timestamp": 1706260710, "time_this_iter_s": 3.478811025619507, "time_total_s": 198.6642198562622, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8092980>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80996c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 198.6642198562622, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.574999999999999, "ram_util_percent": 15.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.885355949401855, "policy_loss": -0.17166107892990112, "vf_loss": 10.0, "vf_explained_var": 2.1855036891338386e-08, "kl": 0.016685351729393005, "entropy": 12.487923622131348, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5175.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946027.2628167102, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15829562671901176, "mean_inference_ms": 5.220851486070677, "mean_action_processing_ms": 0.14513722599920847, "mean_env_wait_ms": 0.2539223570334864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015332781035324624, "StateBufferConnector_ms": 0.002339790607320851, "ViewRequirementAgentConnector_ms": 0.05975797258574387}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946027.2628167102, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15829562671901176, "mean_inference_ms": 5.220851486070677, "mean_action_processing_ms": 0.14513722599920847, "mean_env_wait_ms": 0.2539223570334864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015332781035324624, "StateBufferConnector_ms": 0.002339790607320851, "ViewRequirementAgentConnector_ms": 0.05975797258574387}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19488, "timers": {"training_iteration_time_ms": 3479.757, "learn_time_ms": 1546.484, "learn_throughput": 217.267}, "counters": {"num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "done": false, "episodes_total": 58, "training_iteration": 58, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-34", "timestamp": 1706260714, "time_this_iter_s": 3.4898762702941895, "time_total_s": 202.1540961265564, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf0d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7efc670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 202.1540961265564, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 16.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.889518737792969, "policy_loss": -0.16643419861793518, "vf_loss": 10.0, "vf_explained_var": 5.298190686175985e-08, "kl": 0.016374126076698303, "entropy": 12.4473295211792, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5265.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946335.0267636405, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15828907284822694, "mean_inference_ms": 5.220601164707617, "mean_action_processing_ms": 0.14512206147018755, "mean_env_wait_ms": 0.25389296809329803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534041711839579, "StateBufferConnector_ms": 0.0023405430680614406, "ViewRequirementAgentConnector_ms": 0.05976992138361527}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946335.0267636405, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15828907284822694, "mean_inference_ms": 5.220601164707617, "mean_action_processing_ms": 0.14512206147018755, "mean_env_wait_ms": 0.25389296809329803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534041711839579, "StateBufferConnector_ms": 0.0023405430680614406, "ViewRequirementAgentConnector_ms": 0.05976992138361527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19824, "timers": {"training_iteration_time_ms": 3479.648, "learn_time_ms": 1546.145, "learn_throughput": 217.315}, "counters": {"num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "done": false, "episodes_total": 59, "training_iteration": 59, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-37", "timestamp": 1706260717, "time_this_iter_s": 3.49642014503479, "time_total_s": 205.6505162715912, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80480a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809b370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 205.6505162715912, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 16.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.880630493164062, "policy_loss": -0.1740339994430542, "vf_loss": 10.0, "vf_explained_var": 3.7087335869046e-08, "kl": 0.015996981412172318, "entropy": 12.512113571166992, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5355.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946336.8817772222, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15828275204597722, "mean_inference_ms": 5.220366461009763, "mean_action_processing_ms": 0.14510720178554806, "mean_env_wait_ms": 0.25386431445866603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323162078857422, "StateBufferConnector_ms": 0.0023392836252848306, "ViewRequirementAgentConnector_ms": 0.05978862444559733}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946336.8817772222, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15828275204597722, "mean_inference_ms": 5.220366461009763, "mean_action_processing_ms": 0.14510720178554806, "mean_env_wait_ms": 0.25386431445866603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323162078857422, "StateBufferConnector_ms": 0.0023392836252848306, "ViewRequirementAgentConnector_ms": 0.05978862444559733}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20160, "timers": {"training_iteration_time_ms": 3480.772, "learn_time_ms": 1546.045, "learn_throughput": 217.329}, "counters": {"num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "done": false, "episodes_total": 60, "training_iteration": 60, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-41", "timestamp": 1706260721, "time_this_iter_s": 3.498499870300293, "time_total_s": 209.14901614189148, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd240>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7efce50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 209.14901614189148, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.639999999999999, "ram_util_percent": 16.340000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.885984420776367, "policy_loss": -0.17345166206359863, "vf_loss": 10.0, "vf_explained_var": 2.582867963951685e-08, "kl": 0.017393210902810097, "entropy": 12.54527759552002, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5445.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946014.4351918828, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15827741874792262, "mean_inference_ms": 5.220143195308962, "mean_action_processing_ms": 0.1450931776845804, "mean_env_wait_ms": 0.253836827781847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015313508080654457, "StateBufferConnector_ms": 0.0023380654757140114, "ViewRequirementAgentConnector_ms": 0.059817658096063334}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -946014.4351918828, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15827741874792262, "mean_inference_ms": 5.220143195308962, "mean_action_processing_ms": 0.1450931776845804, "mean_env_wait_ms": 0.253836827781847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015313508080654457, "StateBufferConnector_ms": 0.0023380654757140114, "ViewRequirementAgentConnector_ms": 0.059817658096063334}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20496, "timers": {"training_iteration_time_ms": 3479.093, "learn_time_ms": 1545.408, "learn_throughput": 217.418}, "counters": {"num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "done": false, "episodes_total": 61, "training_iteration": 61, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-45", "timestamp": 1706260725, "time_this_iter_s": 3.4860541820526123, "time_total_s": 212.6350703239441, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8092b60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809beb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 212.6350703239441, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 16.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.877884864807129, "policy_loss": -0.1754923164844513, "vf_loss": 10.0, "vf_explained_var": 9.934107758624577e-09, "kl": 0.015620105899870396, "entropy": 12.583733558654785, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5535.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945964.6317962148, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15827271116410527, "mean_inference_ms": 5.219927442244068, "mean_action_processing_ms": 0.1450796307145269, "mean_env_wait_ms": 0.253810458959543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015300320040795111, "StateBufferConnector_ms": 0.0023391938978625884, "ViewRequirementAgentConnector_ms": 0.05983960243963426}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945964.6317962148, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15827271116410527, "mean_inference_ms": 5.219927442244068, "mean_action_processing_ms": 0.1450796307145269, "mean_env_wait_ms": 0.253810458959543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015300320040795111, "StateBufferConnector_ms": 0.0023391938978625884, "ViewRequirementAgentConnector_ms": 0.05983960243963426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20832, "timers": {"training_iteration_time_ms": 3479.635, "learn_time_ms": 1545.894, "learn_throughput": 217.35}, "counters": {"num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "done": false, "episodes_total": 62, "training_iteration": 62, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-48", "timestamp": 1706260728, "time_this_iter_s": 3.4953837394714355, "time_total_s": 216.13045406341553, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdab0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7efd510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 216.13045406341553, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5200000000000005, "ram_util_percent": 16.62}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.876275062561035, "policy_loss": -0.1761757731437683, "vf_loss": 10.0, "vf_explained_var": 1.7219120351796846e-08, "kl": 0.015349005348980427, "entropy": 12.531830787658691, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5625.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945555.192156293, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826870224239764, "mean_inference_ms": 5.21972696777515, "mean_action_processing_ms": 0.14506687561835024, "mean_env_wait_ms": 0.25378502525817337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015284144689166357, "StateBufferConnector_ms": 0.002338015843951513, "ViewRequirementAgentConnector_ms": 0.059823762802850636}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945555.192156293, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826870224239764, "mean_inference_ms": 5.21972696777515, "mean_action_processing_ms": 0.14506687561835024, "mean_env_wait_ms": 0.25378502525817337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015284144689166357, "StateBufferConnector_ms": 0.002338015843951513, "ViewRequirementAgentConnector_ms": 0.059823762802850636}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21168, "timers": {"training_iteration_time_ms": 3486.867, "learn_time_ms": 1548.848, "learn_throughput": 216.935}, "counters": {"num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "done": false, "episodes_total": 63, "training_iteration": 63, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-52", "timestamp": 1706260732, "time_this_iter_s": 3.5050902366638184, "time_total_s": 219.63554430007935, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093e80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809a560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 219.63554430007935, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 16.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.870662689208984, "policy_loss": -0.18115219473838806, "vf_loss": 10.0, "vf_explained_var": 1.9205941725886078e-08, "kl": 0.015163064002990723, "entropy": 12.71261215209961, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5715.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945582.7058270208, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826519890536436, "mean_inference_ms": 5.21954629160186, "mean_action_processing_ms": 0.14505458213067995, "mean_env_wait_ms": 0.2537607375937576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015261396765708923, "StateBufferConnector_ms": 0.0023365020751953125, "ViewRequirementAgentConnector_ms": 0.05983710289001465}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945582.7058270208, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826519890536436, "mean_inference_ms": 5.21954629160186, "mean_action_processing_ms": 0.14505458213067995, "mean_env_wait_ms": 0.2537607375937576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015261396765708923, "StateBufferConnector_ms": 0.0023365020751953125, "ViewRequirementAgentConnector_ms": 0.05983710289001465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 3491.799, "learn_time_ms": 1550.975, "learn_throughput": 216.638}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 64, "training_iteration": 64, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-55", "timestamp": 1706260735, "time_this_iter_s": 3.4999990463256836, "time_total_s": 223.13554334640503, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdf00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7efe0e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 223.13554334640503, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 16.860000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.870217323303223, "policy_loss": -0.18512339890003204, "vf_loss": 10.0, "vf_explained_var": 3.774960788405224e-08, "kl": 0.016195023432374, "entropy": 12.594314575195312, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5805.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945598.5665533147, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826217922854507, "mean_inference_ms": 5.219369945050687, "mean_action_processing_ms": 0.14504266523567033, "mean_env_wait_ms": 0.25373692868744196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01536112565260667, "StateBufferConnector_ms": 0.0023376024686373197, "ViewRequirementAgentConnector_ms": 0.059863970829890326}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945598.5665533147, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826217922854507, "mean_inference_ms": 5.219369945050687, "mean_action_processing_ms": 0.14504266523567033, "mean_env_wait_ms": 0.25373692868744196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01536112565260667, "StateBufferConnector_ms": 0.0023376024686373197, "ViewRequirementAgentConnector_ms": 0.059863970829890326}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21840, "timers": {"training_iteration_time_ms": 3494.049, "learn_time_ms": 1550.591, "learn_throughput": 216.692}, "counters": {"num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "done": false, "episodes_total": 65, "training_iteration": 65, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-18-59", "timestamp": 1706260739, "time_this_iter_s": 3.4845738410949707, "time_total_s": 226.6201171875, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd3c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7efeb90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 226.6201171875, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 16.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.880253791809082, "policy_loss": -0.17542803287506104, "vf_loss": 10.0, "vf_explained_var": 3.7087335869046e-08, "kl": 0.016294440254569054, "entropy": 12.692134857177734, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5895.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945207.875852913, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825935345948472, "mean_inference_ms": 5.219202374697205, "mean_action_processing_ms": 0.1450310603015015, "mean_env_wait_ms": 0.25371377814180773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015346931688713305, "StateBufferConnector_ms": 0.0023372245557380447, "ViewRequirementAgentConnector_ms": 0.05992831605853456}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -945207.875852913, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825935345948472, "mean_inference_ms": 5.219202374697205, "mean_action_processing_ms": 0.1450310603015015, "mean_env_wait_ms": 0.25371377814180773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015346931688713305, "StateBufferConnector_ms": 0.0023372245557380447, "ViewRequirementAgentConnector_ms": 0.05992831605853456}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22176, "timers": {"training_iteration_time_ms": 3493.231, "learn_time_ms": 1549.073, "learn_throughput": 216.904}, "counters": {"num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "done": false, "episodes_total": 66, "training_iteration": 66, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-02", "timestamp": 1706260742, "time_this_iter_s": 3.5013749599456787, "time_total_s": 230.12149214744568, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecc190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7efedd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 230.12149214744568, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.680000000000001, "ram_util_percent": 17.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.874959945678711, "policy_loss": -0.17960307002067566, "vf_loss": 10.0, "vf_explained_var": 2.8477774804969158e-08, "kl": 0.01596745476126671, "entropy": 12.60603141784668, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 5985.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "sampler_results": {"episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944805.7117303358, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825676902050922, "mean_inference_ms": 5.219051211596672, "mean_action_processing_ms": 0.14502018868982527, "mean_env_wait_ms": 0.25369179906967276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352733099638527, "StateBufferConnector_ms": 0.002334366983442164, "ViewRequirementAgentConnector_ms": 0.059928822873243644}}, "episode_reward_max": -889289.2367892396, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944805.7117303358, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825676902050922, "mean_inference_ms": 5.219051211596672, "mean_action_processing_ms": 0.14502018868982527, "mean_env_wait_ms": 0.25369179906967276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352733099638527, "StateBufferConnector_ms": 0.002334366983442164, "ViewRequirementAgentConnector_ms": 0.059928822873243644}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22512, "timers": {"training_iteration_time_ms": 3496.189, "learn_time_ms": 1549.948, "learn_throughput": 216.781}, "counters": {"num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "done": false, "episodes_total": 67, "training_iteration": 67, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-06", "timestamp": 1706260746, "time_this_iter_s": 3.508380651473999, "time_total_s": 233.62987279891968, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8090070>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7efc040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 233.62987279891968, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.680000000000001, "ram_util_percent": 17.259999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.868852615356445, "policy_loss": -0.18618468940258026, "vf_loss": 10.0, "vf_explained_var": 2.4504132056790695e-08, "kl": 0.01610642299056053, "entropy": 12.638656616210938, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6075.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943417.619722868, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825452979217966, "mean_inference_ms": 5.2189129064746655, "mean_action_processing_ms": 0.14501004228312486, "mean_env_wait_ms": 0.25367061651387657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015349247876335593, "StateBufferConnector_ms": 0.002334748997407801, "ViewRequirementAgentConnector_ms": 0.059935625861672795}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943417.619722868, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825452979217966, "mean_inference_ms": 5.2189129064746655, "mean_action_processing_ms": 0.14501004228312486, "mean_env_wait_ms": 0.25367061651387657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015349247876335593, "StateBufferConnector_ms": 0.002334748997407801, "ViewRequirementAgentConnector_ms": 0.059935625861672795}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22848, "timers": {"training_iteration_time_ms": 3498.91, "learn_time_ms": 1551.193, "learn_throughput": 216.607}, "counters": {"num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "done": false, "episodes_total": 68, "training_iteration": 68, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-09", "timestamp": 1706260749, "time_this_iter_s": 3.517117738723755, "time_total_s": 237.14699053764343, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece290>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809b910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 237.14699053764343, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.640000000000001, "ram_util_percent": 17.380000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.882346153259277, "policy_loss": -0.17568528652191162, "vf_loss": 10.0, "vf_explained_var": -5.298190774993827e-09, "kl": 0.01698218658566475, "entropy": 12.698974609375, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6165.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943768.3292966513, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825255450575484, "mean_inference_ms": 5.218791208508946, "mean_action_processing_ms": 0.14500033698217638, "mean_env_wait_ms": 0.25365084864526527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534482707148013, "StateBufferConnector_ms": 0.0023347744043322577, "ViewRequirementAgentConnector_ms": 0.05992910136347231}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943768.3292966513, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825255450575484, "mean_inference_ms": 5.218791208508946, "mean_action_processing_ms": 0.14500033698217638, "mean_env_wait_ms": 0.25365084864526527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534482707148013, "StateBufferConnector_ms": 0.0023347744043322577, "ViewRequirementAgentConnector_ms": 0.05992910136347231}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23184, "timers": {"training_iteration_time_ms": 3501.78, "learn_time_ms": 1551.739, "learn_throughput": 216.531}, "counters": {"num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "done": false, "episodes_total": 69, "training_iteration": 69, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-13", "timestamp": 1706260753, "time_this_iter_s": 3.5251638889312744, "time_total_s": 240.6721544265747, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece050>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7efd480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 240.6721544265747, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 17.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.870316505432129, "policy_loss": -0.18431754410266876, "vf_loss": 10.0, "vf_explained_var": 3.245141755314762e-08, "kl": 0.015988031402230263, "entropy": 12.728972434997559, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6255.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943304.9761629746, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825096091364485, "mean_inference_ms": 5.218681636067245, "mean_action_processing_ms": 0.14499125826293008, "mean_env_wait_ms": 0.2536322579219234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015327589852469308, "StateBufferConnector_ms": 0.002335139683314732, "ViewRequirementAgentConnector_ms": 0.05990913936070034}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943304.9761629746, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825096091364485, "mean_inference_ms": 5.218681636067245, "mean_action_processing_ms": 0.14499125826293008, "mean_env_wait_ms": 0.2536322579219234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015327589852469308, "StateBufferConnector_ms": 0.002335139683314732, "ViewRequirementAgentConnector_ms": 0.05990913936070034}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23520, "timers": {"training_iteration_time_ms": 3503.699, "learn_time_ms": 1552.687, "learn_throughput": 216.399}, "counters": {"num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "done": false, "episodes_total": 70, "training_iteration": 70, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-16", "timestamp": 1706260756, "time_this_iter_s": 3.517714738845825, "time_total_s": 244.18986916542053, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece170>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809bb50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 244.18986916542053, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.719999999999999, "ram_util_percent": 17.660000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.882658958435059, "policy_loss": -0.17795266211032867, "vf_loss": 10.0, "vf_explained_var": 3.112686997042147e-08, "kl": 0.017737187445163727, "entropy": 12.588936805725098, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6345.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943304.8550491368, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582496606558611, "mean_inference_ms": 5.218583138506257, "mean_action_processing_ms": 0.14498273912451357, "mean_env_wait_ms": 0.2536149928151387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015310502388107945, "StateBufferConnector_ms": 0.0023351588719327685, "ViewRequirementAgentConnector_ms": 0.059897127285809586}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943304.8550491368, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582496606558611, "mean_inference_ms": 5.218583138506257, "mean_action_processing_ms": 0.14498273912451357, "mean_env_wait_ms": 0.2536149928151387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015310502388107945, "StateBufferConnector_ms": 0.0023351588719327685, "ViewRequirementAgentConnector_ms": 0.059897127285809586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23856, "timers": {"training_iteration_time_ms": 3506.033, "learn_time_ms": 1553.906, "learn_throughput": 216.229}, "counters": {"num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "done": false, "episodes_total": 71, "training_iteration": 71, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-20", "timestamp": 1706260760, "time_this_iter_s": 3.5094566345214844, "time_total_s": 247.69932579994202, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecc4f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7eff880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 247.69932579994202, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.720000000000001, "ram_util_percent": 17.779999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.875436782836914, "policy_loss": -0.1792260706424713, "vf_loss": 10.0, "vf_explained_var": 2.3841858265427618e-08, "kl": 0.015996506437659264, "entropy": 12.431090354919434, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6435.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943796.1193787799, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824814360461562, "mean_inference_ms": 5.218481682780371, "mean_action_processing_ms": 0.14497433334016302, "mean_env_wait_ms": 0.2535979538205916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01528991593254937, "StateBufferConnector_ms": 0.002333521842956543, "ViewRequirementAgentConnector_ms": 0.05988942252265082}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943796.1193787799, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824814360461562, "mean_inference_ms": 5.218481682780371, "mean_action_processing_ms": 0.14497433334016302, "mean_env_wait_ms": 0.2535979538205916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01528991593254937, "StateBufferConnector_ms": 0.002333521842956543, "ViewRequirementAgentConnector_ms": 0.05988942252265082}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 3504.158, "learn_time_ms": 1553.079, "learn_throughput": 216.344}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "done": false, "episodes_total": 72, "training_iteration": 72, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-23", "timestamp": 1706260763, "time_this_iter_s": 3.4766335487365723, "time_total_s": 251.1759593486786, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80633a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f208b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 251.1759593486786, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 17.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.87736988067627, "policy_loss": -0.17480017244815826, "vf_loss": 10.0, "vf_explained_var": 2.2517310682701464e-08, "kl": 0.01526718121021986, "entropy": 12.456307411193848, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6525.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944484.3589096479, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824677222270297, "mean_inference_ms": 5.218388666243105, "mean_action_processing_ms": 0.14496612612960422, "mean_env_wait_ms": 0.2535814765599922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015373425940944725, "StateBufferConnector_ms": 0.002333562668055704, "ViewRequirementAgentConnector_ms": 0.05988617465920644}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944484.3589096479, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824677222270297, "mean_inference_ms": 5.218388666243105, "mean_action_processing_ms": 0.14496612612960422, "mean_env_wait_ms": 0.2535814765599922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015373425940944725, "StateBufferConnector_ms": 0.002333562668055704, "ViewRequirementAgentConnector_ms": 0.05988617465920644}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24528, "timers": {"training_iteration_time_ms": 3503.656, "learn_time_ms": 1552.633, "learn_throughput": 216.407}, "counters": {"num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "done": false, "episodes_total": 73, "training_iteration": 73, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-27", "timestamp": 1706260767, "time_this_iter_s": 3.500107765197754, "time_total_s": 254.67606711387634, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf7c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7efd630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 254.67606711387634, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 18.060000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.881536483764648, "policy_loss": -0.17084698379039764, "vf_loss": 10.0, "vf_explained_var": 2.5166405848153772e-08, "kl": 0.015329607762396336, "entropy": 12.543641090393066, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944745.8624186416, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824555817227445, "mean_inference_ms": 5.218301160392316, "mean_action_processing_ms": 0.14495817714877005, "mean_env_wait_ms": 0.2535655935201916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015394429902772646, "StateBufferConnector_ms": 0.002339401760616818, "ViewRequirementAgentConnector_ms": 0.05991652205183699}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944745.8624186416, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824555817227445, "mean_inference_ms": 5.218301160392316, "mean_action_processing_ms": 0.14495817714877005, "mean_env_wait_ms": 0.2535655935201916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015394429902772646, "StateBufferConnector_ms": 0.002339401760616818, "ViewRequirementAgentConnector_ms": 0.05991652205183699}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24864, "timers": {"training_iteration_time_ms": 3503.866, "learn_time_ms": 1554.064, "learn_throughput": 216.207}, "counters": {"num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "done": false, "episodes_total": 74, "training_iteration": 74, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-31", "timestamp": 1706260771, "time_this_iter_s": 3.5021212100982666, "time_total_s": 258.1781883239746, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8092860>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f20b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 258.1781883239746, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.539999999999999, "ram_util_percent": 18.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.866297721862793, "policy_loss": -0.19026629626750946, "vf_loss": 10.0, "vf_explained_var": 1.2583202924076886e-08, "kl": 0.016552789136767387, "entropy": 12.399133682250977, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6705.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944525.0784067042, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824460590241385, "mean_inference_ms": 5.2182165092381965, "mean_action_processing_ms": 0.1449505398214836, "mean_env_wait_ms": 0.2535502222692693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015415509541829428, "StateBufferConnector_ms": 0.0023399988810221353, "ViewRequirementAgentConnector_ms": 0.05990409851074219}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944525.0784067042, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824460590241385, "mean_inference_ms": 5.2182165092381965, "mean_action_processing_ms": 0.1449505398214836, "mean_env_wait_ms": 0.2535502222692693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015415509541829428, "StateBufferConnector_ms": 0.0023399988810221353, "ViewRequirementAgentConnector_ms": 0.05990409851074219}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25200, "timers": {"training_iteration_time_ms": 3506.698, "learn_time_ms": 1556.42, "learn_throughput": 215.88}, "counters": {"num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "done": false, "episodes_total": 75, "training_iteration": 75, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-34", "timestamp": 1706260774, "time_this_iter_s": 3.5129196643829346, "time_total_s": 261.69110798835754, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecead0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7effe20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 261.69110798835754, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.66, "ram_util_percent": 18.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.877925872802734, "policy_loss": -0.18085549771785736, "vf_loss": 10.0, "vf_explained_var": 2.6490953430879927e-08, "kl": 0.017201675102114677, "entropy": 12.37260913848877, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6795.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944974.7591000916, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824389298011018, "mean_inference_ms": 5.218143829031378, "mean_action_processing_ms": 0.144943275175131, "mean_env_wait_ms": 0.25353558575736657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015398075706080386, "StateBufferConnector_ms": 0.0023402665790758633, "ViewRequirementAgentConnector_ms": 0.05990988329837197}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944974.7591000916, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824389298011018, "mean_inference_ms": 5.218143829031378, "mean_action_processing_ms": 0.144943275175131, "mean_env_wait_ms": 0.25353558575736657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015398075706080386, "StateBufferConnector_ms": 0.0023402665790758633, "ViewRequirementAgentConnector_ms": 0.05990988329837197}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25536, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25536, "timers": {"training_iteration_time_ms": 3507.356, "learn_time_ms": 1555.405, "learn_throughput": 216.021}, "counters": {"num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "done": false, "episodes_total": 76, "training_iteration": 76, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-38", "timestamp": 1706260778, "time_this_iter_s": 3.5080039501190186, "time_total_s": 265.19911193847656, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd0f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 265.19911193847656, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 18.439999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.880022048950195, "policy_loss": -0.1764959990978241, "vf_loss": 10.0, "vf_explained_var": 2.1855036891338386e-08, "kl": 0.016539253294467926, "entropy": 12.428566932678223, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6885.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944567.1853812027, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.158243088166636, "mean_inference_ms": 5.218075219519163, "mean_action_processing_ms": 0.1449361398978759, "mean_env_wait_ms": 0.25352128164516374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015386358484045251, "StateBufferConnector_ms": 0.0023395984203784495, "ViewRequirementAgentConnector_ms": 0.05990003610586191}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944567.1853812027, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.158243088166636, "mean_inference_ms": 5.218075219519163, "mean_action_processing_ms": 0.1449361398978759, "mean_env_wait_ms": 0.25352128164516374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015386358484045251, "StateBufferConnector_ms": 0.0023395984203784495, "ViewRequirementAgentConnector_ms": 0.05990003610586191}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25872, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25872, "timers": {"training_iteration_time_ms": 3506.207, "learn_time_ms": 1555.58, "learn_throughput": 215.997}, "counters": {"num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "done": false, "episodes_total": 77, "training_iteration": 77, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-41", "timestamp": 1706260781, "time_this_iter_s": 3.496925115585327, "time_total_s": 268.6960370540619, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eced70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee809b910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 268.6960370540619, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 18.560000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.874794960021973, "policy_loss": -0.18064367771148682, "vf_loss": 10.0, "vf_explained_var": 2.0530489308612232e-08, "kl": 0.016223294660449028, "entropy": 12.459757804870605, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944486.2675547409, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824262195928743, "mean_inference_ms": 5.218019875696919, "mean_action_processing_ms": 0.14492958512332155, "mean_env_wait_ms": 0.2535079953135976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538227765988081, "StateBufferConnector_ms": 0.0023398643884903346, "ViewRequirementAgentConnector_ms": 0.059910003955547624}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -944486.2675547409, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824262195928743, "mean_inference_ms": 5.218019875696919, "mean_action_processing_ms": 0.14492958512332155, "mean_env_wait_ms": 0.2535079953135976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538227765988081, "StateBufferConnector_ms": 0.0023398643884903346, "ViewRequirementAgentConnector_ms": 0.059910003955547624}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26208, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26208, "timers": {"training_iteration_time_ms": 3507.854, "learn_time_ms": 1555.89, "learn_throughput": 215.954}, "counters": {"num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "done": false, "episodes_total": 78, "training_iteration": 78, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-45", "timestamp": 1706260785, "time_this_iter_s": 3.533597946166992, "time_total_s": 272.2296350002289, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8091840>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 272.2296350002289, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 18.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.871109008789062, "policy_loss": -0.18364368379116058, "vf_loss": 10.0, "vf_explained_var": 1.1258655341350732e-08, "kl": 0.01602248102426529, "entropy": 12.43164348602295, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7065.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943844.2346740095, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824212428981013, "mean_inference_ms": 5.217966184076138, "mean_action_processing_ms": 0.1449231949321472, "mean_env_wait_ms": 0.2534948509838424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015358683429186858, "StateBufferConnector_ms": 0.002338916440553303, "ViewRequirementAgentConnector_ms": 0.059892256048661247}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943844.2346740095, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824212428981013, "mean_inference_ms": 5.217966184076138, "mean_action_processing_ms": 0.1449231949321472, "mean_env_wait_ms": 0.2534948509838424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015358683429186858, "StateBufferConnector_ms": 0.002338916440553303, "ViewRequirementAgentConnector_ms": 0.059892256048661247}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26544, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26544, "timers": {"training_iteration_time_ms": 3503.934, "learn_time_ms": 1554.013, "learn_throughput": 216.214}, "counters": {"num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "done": false, "episodes_total": 79, "training_iteration": 79, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-48", "timestamp": 1706260788, "time_this_iter_s": 3.485980987548828, "time_total_s": 275.7156159877777, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecece0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 275.7156159877777, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.4799999999999995, "ram_util_percent": 18.840000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.883419036865234, "policy_loss": -0.1730995625257492, "vf_loss": 10.0, "vf_explained_var": 3.046459795541523e-08, "kl": 0.0165395624935627, "entropy": 12.519241333007812, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7155.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943791.6073737277, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824183610406056, "mean_inference_ms": 5.217913822170361, "mean_action_processing_ms": 0.14491704556069146, "mean_env_wait_ms": 0.2534818189707577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339553356170654, "StateBufferConnector_ms": 0.0023379921913146973, "ViewRequirementAgentConnector_ms": 0.05989283323287964}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943791.6073737277, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824183610406056, "mean_inference_ms": 5.217913822170361, "mean_action_processing_ms": 0.14491704556069146, "mean_env_wait_ms": 0.2534818189707577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339553356170654, "StateBufferConnector_ms": 0.0023379921913146973, "ViewRequirementAgentConnector_ms": 0.05989283323287964}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26880, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 3501.512, "learn_time_ms": 1553.096, "learn_throughput": 216.342}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "done": false, "episodes_total": 80, "training_iteration": 80, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-52", "timestamp": 1706260792, "time_this_iter_s": 3.49348521232605, "time_total_s": 279.20910120010376, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f22680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 279.20910120010376, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 18.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.871686935424805, "policy_loss": -0.1835077553987503, "vf_loss": 10.0, "vf_explained_var": 3.6425060301326084e-08, "kl": 0.01615210436284542, "entropy": 12.328214645385742, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7245.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943724.129232638, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824179761416707, "mean_inference_ms": 5.217869733179265, "mean_action_processing_ms": 0.1449112007343753, "mean_env_wait_ms": 0.2534695551113338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330020292305652, "StateBufferConnector_ms": 0.002337090763044946, "ViewRequirementAgentConnector_ms": 0.059886037567515434}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943724.129232638, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824179761416707, "mean_inference_ms": 5.217869733179265, "mean_action_processing_ms": 0.1449112007343753, "mean_env_wait_ms": 0.2534695551113338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330020292305652, "StateBufferConnector_ms": 0.002337090763044946, "ViewRequirementAgentConnector_ms": 0.059886037567515434}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27216, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27216, "timers": {"training_iteration_time_ms": 3501.245, "learn_time_ms": 1552.589, "learn_throughput": 216.413}, "counters": {"num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "done": false, "episodes_total": 81, "training_iteration": 81, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-55", "timestamp": 1706260795, "time_this_iter_s": 3.506805181503296, "time_total_s": 282.71590638160706, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eccc10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f228c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 282.71590638160706, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 19.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.870553016662598, "policy_loss": -0.18727459013462067, "vf_loss": 10.0, "vf_explained_var": 2.317958447406454e-08, "kl": 0.0169226061552763, "entropy": 12.488570213317871, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7335.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943219.4918098379, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582421055921789, "mean_inference_ms": 5.2178248819301905, "mean_action_processing_ms": 0.14490560067839792, "mean_env_wait_ms": 0.25345768571598104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015332059162419016, "StateBufferConnector_ms": 0.0023385373557486184, "ViewRequirementAgentConnector_ms": 0.05989714366633717}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943219.4918098379, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582421055921789, "mean_inference_ms": 5.2178248819301905, "mean_action_processing_ms": 0.14490560067839792, "mean_env_wait_ms": 0.25345768571598104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015332059162419016, "StateBufferConnector_ms": 0.0023385373557486184, "ViewRequirementAgentConnector_ms": 0.05989714366633717}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27552, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27552, "timers": {"training_iteration_time_ms": 3501.863, "learn_time_ms": 1552.301, "learn_throughput": 216.453}, "counters": {"num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "done": false, "episodes_total": 82, "training_iteration": 82, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-19-59", "timestamp": 1706260799, "time_this_iter_s": 3.482823133468628, "time_total_s": 286.1987295150757, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8092ad0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f22f80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 286.1987295150757, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.680000000000001, "ram_util_percent": 19.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.873560905456543, "policy_loss": -0.17968864738941193, "vf_loss": 10.0, "vf_explained_var": 1.8543667934523e-08, "kl": 0.015582931227982044, "entropy": 12.560282707214355, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7425.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -942592.5162737452, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824254967032944, "mean_inference_ms": 5.217795308950877, "mean_action_processing_ms": 0.1449003781037152, "mean_env_wait_ms": 0.25344627871565306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015315377568624106, "StateBufferConnector_ms": 0.0023388000855962916, "ViewRequirementAgentConnector_ms": 0.059892470578113234}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -942592.5162737452, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824254967032944, "mean_inference_ms": 5.217795308950877, "mean_action_processing_ms": 0.1449003781037152, "mean_env_wait_ms": 0.25344627871565306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015315377568624106, "StateBufferConnector_ms": 0.0023388000855962916, "ViewRequirementAgentConnector_ms": 0.059892470578113234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27888, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27888, "timers": {"training_iteration_time_ms": 3505.296, "learn_time_ms": 1553.251, "learn_throughput": 216.321}, "counters": {"num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "done": false, "episodes_total": 83, "training_iteration": 83, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-02", "timestamp": 1706260802, "time_this_iter_s": 3.5344676971435547, "time_total_s": 289.73319721221924, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecebc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f22680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 289.73319721221924, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 19.360000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.876917839050293, "policy_loss": -0.18398700654506683, "vf_loss": 10.0, "vf_explained_var": 2.317958447406454e-08, "kl": 0.017822977155447006, "entropy": 12.466404914855957, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7515.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943394.4008567652, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824326480949155, "mean_inference_ms": 5.217773992562568, "mean_action_processing_ms": 0.14489551040398282, "mean_env_wait_ms": 0.2534356091947756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015372321719215029, "StateBufferConnector_ms": 0.002339056559971401, "ViewRequirementAgentConnector_ms": 0.05988052913120815}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943394.4008567652, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824326480949155, "mean_inference_ms": 5.217773992562568, "mean_action_processing_ms": 0.14489551040398282, "mean_env_wait_ms": 0.2534356091947756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015372321719215029, "StateBufferConnector_ms": 0.002339056559971401, "ViewRequirementAgentConnector_ms": 0.05988052913120815}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28224, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28224, "timers": {"training_iteration_time_ms": 3508.898, "learn_time_ms": 1555.297, "learn_throughput": 216.036}, "counters": {"num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "done": false, "episodes_total": 84, "training_iteration": 84, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-06", "timestamp": 1706260806, "time_this_iter_s": 3.538184881210327, "time_total_s": 293.27138209342957, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eccf10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f23880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 293.27138209342957, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.619999999999999, "ram_util_percent": 19.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.86567497253418, "policy_loss": -0.18747057020664215, "vf_loss": 10.0, "vf_explained_var": 2.0530489308612232e-08, "kl": 0.015552476048469543, "entropy": 12.50175952911377, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7605.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943599.0364193517, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824456389178396, "mean_inference_ms": 5.217758770772376, "mean_action_processing_ms": 0.14489111669445942, "mean_env_wait_ms": 0.2534257141445926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537631539737477, "StateBufferConnector_ms": 0.0023387460147633273, "ViewRequirementAgentConnector_ms": 0.05989719839657054}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -943599.0364193517, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824456389178396, "mean_inference_ms": 5.217758770772376, "mean_action_processing_ms": 0.14489111669445942, "mean_env_wait_ms": 0.2534257141445926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537631539737477, "StateBufferConnector_ms": 0.0023387460147633273, "ViewRequirementAgentConnector_ms": 0.05989719839657054}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28560, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28560, "timers": {"training_iteration_time_ms": 3508.41, "learn_time_ms": 1553.112, "learn_throughput": 216.34}, "counters": {"num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "done": false, "episodes_total": 85, "training_iteration": 85, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-09", "timestamp": 1706260809, "time_this_iter_s": 3.5080292224884033, "time_total_s": 296.77941131591797, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdb40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f23d00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 296.77941131591797, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.679999999999999, "ram_util_percent": 19.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.879087448120117, "policy_loss": -0.1889849156141281, "vf_loss": 10.0, "vf_explained_var": 3.443824070359369e-08, "kl": 0.019920509308576584, "entropy": 12.383585929870605, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7695.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -942834.5142399343, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824566461717215, "mean_inference_ms": 5.217742249954828, "mean_action_processing_ms": 0.1448867152278204, "mean_env_wait_ms": 0.2534157290708323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015366077423095703, "StateBufferConnector_ms": 0.002339274384254633, "ViewRequirementAgentConnector_ms": 0.05988852922306504}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -942834.5142399343, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824566461717215, "mean_inference_ms": 5.217742249954828, "mean_action_processing_ms": 0.1448867152278204, "mean_env_wait_ms": 0.2534157290708323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015366077423095703, "StateBufferConnector_ms": 0.002339274384254633, "ViewRequirementAgentConnector_ms": 0.05988852922306504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28896, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28896, "timers": {"training_iteration_time_ms": 3505.891, "learn_time_ms": 1553.017, "learn_throughput": 216.353}, "counters": {"num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "done": false, "episodes_total": 86, "training_iteration": 86, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-13", "timestamp": 1706260813, "time_this_iter_s": 3.482846260070801, "time_total_s": 300.26225757598877, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8090e80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f232e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 300.26225757598877, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 19.759999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.88525676727295, "policy_loss": -0.17248664796352386, "vf_loss": 10.0, "vf_explained_var": 1.4570024298166118e-08, "kl": 0.01689787581562996, "entropy": 12.413150787353516, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7785.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -942235.2846156062, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824679747809905, "mean_inference_ms": 5.217725241895154, "mean_action_processing_ms": 0.14488242220096995, "mean_env_wait_ms": 0.2534058022511645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015362377824454472, "StateBufferConnector_ms": 0.0023386944299456716, "ViewRequirementAgentConnector_ms": 0.05988252573999865}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -942235.2846156062, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824679747809905, "mean_inference_ms": 5.217725241895154, "mean_action_processing_ms": 0.14488242220096995, "mean_env_wait_ms": 0.2534058022511645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015362377824454472, "StateBufferConnector_ms": 0.0023386944299456716, "ViewRequirementAgentConnector_ms": 0.05988252573999865}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29232, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29232, "timers": {"training_iteration_time_ms": 3504.693, "learn_time_ms": 1552.307, "learn_throughput": 216.452}, "counters": {"num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "done": false, "episodes_total": 87, "training_iteration": 87, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-16", "timestamp": 1706260816, "time_this_iter_s": 3.484966516494751, "time_total_s": 303.7472240924835, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecddb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 303.7472240924835, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.66, "ram_util_percent": 19.880000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.870837211608887, "policy_loss": -0.1865721195936203, "vf_loss": 10.0, "vf_explained_var": 3.510051271859993e-08, "kl": 0.016800086945295334, "entropy": 12.349313735961914, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7875.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -941843.1275029257, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582479475356469, "mean_inference_ms": 5.217707689408844, "mean_action_processing_ms": 0.14487809988783254, "mean_env_wait_ms": 0.25339599831229925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01536770300431685, "StateBufferConnector_ms": 0.002338398586619984, "ViewRequirementAgentConnector_ms": 0.05988153544339267}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -941843.1275029257, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582479475356469, "mean_inference_ms": 5.217707689408844, "mean_action_processing_ms": 0.14487809988783254, "mean_env_wait_ms": 0.25339599831229925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01536770300431685, "StateBufferConnector_ms": 0.002338398586619984, "ViewRequirementAgentConnector_ms": 0.05988153544339267}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29568, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 3499.183, "learn_time_ms": 1549.595, "learn_throughput": 216.831}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "done": false, "episodes_total": 88, "training_iteration": 88, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-20", "timestamp": 1706260820, "time_this_iter_s": 3.4785239696502686, "time_total_s": 307.2257480621338, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece530>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f58a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 307.2257480621338, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.700000000000001, "ram_util_percent": 20.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.871156692504883, "policy_loss": -0.18845222890377045, "vf_loss": 10.0, "vf_explained_var": 2.317958447406454e-08, "kl": 0.01744394749403, "entropy": 12.441258430480957, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 7965.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -941677.8873722451, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824916359941385, "mean_inference_ms": 5.217687115257822, "mean_action_processing_ms": 0.14487382536977209, "mean_env_wait_ms": 0.2533864165293911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015362460961502589, "StateBufferConnector_ms": 0.0023378415054149844, "ViewRequirementAgentConnector_ms": 0.05993869867217674}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -941677.8873722451, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824916359941385, "mean_inference_ms": 5.217687115257822, "mean_action_processing_ms": 0.14487382536977209, "mean_env_wait_ms": 0.2533864165293911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015362460961502589, "StateBufferConnector_ms": 0.0023378415054149844, "ViewRequirementAgentConnector_ms": 0.05993869867217674}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29904, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29904, "timers": {"training_iteration_time_ms": 3499.195, "learn_time_ms": 1550.415, "learn_throughput": 216.716}, "counters": {"num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "done": false, "episodes_total": 89, "training_iteration": 89, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-24", "timestamp": 1706260824, "time_this_iter_s": 3.4861385822296143, "time_total_s": 310.7118866443634, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80622f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f239a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 310.7118866443634, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.56, "ram_util_percent": 20.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.868030548095703, "policy_loss": -0.1870555281639099, "vf_loss": 10.0, "vf_explained_var": 2.317958447406454e-08, "kl": 0.016120415180921555, "entropy": 12.370987892150879, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8055.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -941442.2305062438, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825051731195663, "mean_inference_ms": 5.217666241660426, "mean_action_processing_ms": 0.14486945289783992, "mean_env_wait_ms": 0.25337762559840843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015349917941623263, "StateBufferConnector_ms": 0.0023370318942599827, "ViewRequirementAgentConnector_ms": 0.059931808047824435}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -941442.2305062438, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825051731195663, "mean_inference_ms": 5.217666241660426, "mean_action_processing_ms": 0.14486945289783992, "mean_env_wait_ms": 0.25337762559840843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015349917941623263, "StateBufferConnector_ms": 0.0023370318942599827, "ViewRequirementAgentConnector_ms": 0.059931808047824435}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30240, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30240, "timers": {"training_iteration_time_ms": 3497.513, "learn_time_ms": 1548.721, "learn_throughput": 216.953}, "counters": {"num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "done": false, "episodes_total": 90, "training_iteration": 90, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-27", "timestamp": 1706260827, "time_this_iter_s": 3.4767158031463623, "time_total_s": 314.18860244750977, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece0b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 314.18860244750977, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.48, "ram_util_percent": 20.279999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.870820045471191, "policy_loss": -0.18708665668964386, "vf_loss": 10.0, "vf_explained_var": 4.437234579768301e-08, "kl": 0.016945552080869675, "entropy": 12.470738410949707, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8145.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -941316.4587483837, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825165498928553, "mean_inference_ms": 5.217638773623846, "mean_action_processing_ms": 0.14486510162804767, "mean_env_wait_ms": 0.25336913943961586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339484581580529, "StateBufferConnector_ms": 0.002337550068949605, "ViewRequirementAgentConnector_ms": 0.05992637885795845}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -941316.4587483837, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825165498928553, "mean_inference_ms": 5.217638773623846, "mean_action_processing_ms": 0.14486510162804767, "mean_env_wait_ms": 0.25336913943961586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339484581580529, "StateBufferConnector_ms": 0.002337550068949605, "ViewRequirementAgentConnector_ms": 0.05992637885795845}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30576, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30576, "timers": {"training_iteration_time_ms": 3491.978, "learn_time_ms": 1546.836, "learn_throughput": 217.218}, "counters": {"num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "done": false, "episodes_total": 91, "training_iteration": 91, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-30", "timestamp": 1706260830, "time_this_iter_s": 3.4514787197113037, "time_total_s": 317.64008116722107, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80922f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 317.64008116722107, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5200000000000005, "ram_util_percent": 20.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.87269115447998, "policy_loss": -0.1825447529554367, "vf_loss": 10.0, "vf_explained_var": 1.5894572769070692e-08, "kl": 0.016163988038897514, "entropy": 12.456353187561035, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8235.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940942.2409463971, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825263437607884, "mean_inference_ms": 5.2176024196900945, "mean_action_processing_ms": 0.14486070641963675, "mean_env_wait_ms": 0.25336044205175706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015396657197371773, "StateBufferConnector_ms": 0.002339093581489895, "ViewRequirementAgentConnector_ms": 0.059913552325704826}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940942.2409463971, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825263437607884, "mean_inference_ms": 5.2176024196900945, "mean_action_processing_ms": 0.14486070641963675, "mean_env_wait_ms": 0.25336044205175706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015396657197371773, "StateBufferConnector_ms": 0.002339093581489895, "ViewRequirementAgentConnector_ms": 0.059913552325704826}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30912, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30912, "timers": {"training_iteration_time_ms": 3488.5, "learn_time_ms": 1545.92, "learn_throughput": 217.346}, "counters": {"num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "done": false, "episodes_total": 92, "training_iteration": 92, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-34", "timestamp": 1706260834, "time_this_iter_s": 3.448103904724121, "time_total_s": 321.0881850719452, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecded0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f20af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 321.0881850719452, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.640000000000001, "ram_util_percent": 20.560000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.869650840759277, "policy_loss": -0.1884622722864151, "vf_loss": 10.0, "vf_explained_var": 2.5166405848153772e-08, "kl": 0.017006324604153633, "entropy": 12.603342056274414, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8325.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940925.720698378, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825336095286402, "mean_inference_ms": 5.217557937408163, "mean_action_processing_ms": 0.14485615883322667, "mean_env_wait_ms": 0.2533517010955036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015380561992686281, "StateBufferConnector_ms": 0.002338552987703713, "ViewRequirementAgentConnector_ms": 0.0598953616234564}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940925.720698378, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825336095286402, "mean_inference_ms": 5.217557937408163, "mean_action_processing_ms": 0.14485615883322667, "mean_env_wait_ms": 0.2533517010955036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015380561992686281, "StateBufferConnector_ms": 0.002338552987703713, "ViewRequirementAgentConnector_ms": 0.0598953616234564}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31248, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31248, "timers": {"training_iteration_time_ms": 3480.213, "learn_time_ms": 1543.84, "learn_throughput": 217.639}, "counters": {"num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "done": false, "episodes_total": 93, "training_iteration": 93, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-37", "timestamp": 1706260837, "time_this_iter_s": 3.4515933990478516, "time_total_s": 324.53977847099304, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80934c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f23910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 324.53977847099304, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5600000000000005, "ram_util_percent": 20.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.87925910949707, "policy_loss": -0.1765269637107849, "vf_loss": 10.0, "vf_explained_var": 2.5166405848153772e-08, "kl": 0.016325080767273903, "entropy": 12.512258529663086, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8415.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940701.2829481175, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825399413877653, "mean_inference_ms": 5.217514168134309, "mean_action_processing_ms": 0.14485165394699526, "mean_env_wait_ms": 0.2533430466426684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015374954710615443, "StateBufferConnector_ms": 0.002339038443058095, "ViewRequirementAgentConnector_ms": 0.0599082480085657}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940701.2829481175, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825399413877653, "mean_inference_ms": 5.217514168134309, "mean_action_processing_ms": 0.14485165394699526, "mean_env_wait_ms": 0.2533430466426684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015374954710615443, "StateBufferConnector_ms": 0.002339038443058095, "ViewRequirementAgentConnector_ms": 0.0599082480085657}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31584, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31584, "timers": {"training_iteration_time_ms": 3475.565, "learn_time_ms": 1541.416, "learn_throughput": 217.981}, "counters": {"num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "done": false, "episodes_total": 94, "training_iteration": 94, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-41", "timestamp": 1706260841, "time_this_iter_s": 3.491737127304077, "time_total_s": 328.0315155982971, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eceda0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f58dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 328.0315155982971, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.64, "ram_util_percent": 20.840000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.417187452316284, "cur_lr": 0.0010000000474974513, "total_loss": 9.899455070495605, "policy_loss": -0.1910526305437088, "vf_loss": 10.0, "vf_explained_var": 1.9205941725886078e-08, "kl": 0.0264863483607769, "entropy": 12.42547607421875, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940362.2200852026, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825464739679576, "mean_inference_ms": 5.217468725356209, "mean_action_processing_ms": 0.14484717589291193, "mean_env_wait_ms": 0.25333434099679586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537222611276727, "StateBufferConnector_ms": 0.0023392627113743834, "ViewRequirementAgentConnector_ms": 0.05992889404296875}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940362.2200852026, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825464739679576, "mean_inference_ms": 5.217468725356209, "mean_action_processing_ms": 0.14484717589291193, "mean_env_wait_ms": 0.25333434099679586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537222611276727, "StateBufferConnector_ms": 0.0023392627113743834, "ViewRequirementAgentConnector_ms": 0.05992889404296875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31920, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31920, "timers": {"training_iteration_time_ms": 3472.869, "learn_time_ms": 1541.394, "learn_throughput": 217.985}, "counters": {"num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "done": false, "episodes_total": 95, "training_iteration": 95, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-44", "timestamp": 1706260844, "time_this_iter_s": 3.481137990951538, "time_total_s": 331.51265358924866, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8059cc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21e10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 331.51265358924866, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.74, "ram_util_percent": 20.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 0.0010000000474974513, "total_loss": 9.90959644317627, "policy_loss": -0.16511155664920807, "vf_loss": 10.0, "vf_explained_var": 7.947286384535346e-09, "kl": 0.014574953354895115, "entropy": 12.459614753723145, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8595.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940744.9919280022, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825543867146866, "mean_inference_ms": 5.217428860483576, "mean_action_processing_ms": 0.14484284457189825, "mean_env_wait_ms": 0.253326105875814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01536284883817037, "StateBufferConnector_ms": 0.0023382405440012612, "ViewRequirementAgentConnector_ms": 0.05992278456687927}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940744.9919280022, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825543867146866, "mean_inference_ms": 5.217428860483576, "mean_action_processing_ms": 0.14484284457189825, "mean_env_wait_ms": 0.253326105875814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01536284883817037, "StateBufferConnector_ms": 0.0023382405440012612, "ViewRequirementAgentConnector_ms": 0.05992278456687927}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32256, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 3476.619, "learn_time_ms": 1543.112, "learn_throughput": 217.742}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 96, "training_iteration": 96, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-48", "timestamp": 1706260848, "time_this_iter_s": 3.5203561782836914, "time_total_s": 335.03300976753235, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf4f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f58d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 335.03300976753235, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.640000000000001, "ram_util_percent": 21.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 0.0010000000474974513, "total_loss": 9.908902168273926, "policy_loss": -0.1773073673248291, "vf_loss": 10.0, "vf_explained_var": 1.5232298977707615e-08, "kl": 0.016818832606077194, "entropy": 12.399842262268066, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8685.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940718.6513204719, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825612983763593, "mean_inference_ms": 5.217388529368405, "mean_action_processing_ms": 0.14483862057049623, "mean_env_wait_ms": 0.25331804956785514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015361776056977892, "StateBufferConnector_ms": 0.0023387142063416157, "ViewRequirementAgentConnector_ms": 0.05993916816318158}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940718.6513204719, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825612983763593, "mean_inference_ms": 5.217388529368405, "mean_action_processing_ms": 0.14483862057049623, "mean_env_wait_ms": 0.25331804956785514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015361776056977892, "StateBufferConnector_ms": 0.0023387142063416157, "ViewRequirementAgentConnector_ms": 0.05993916816318158}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32592, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32592, "timers": {"training_iteration_time_ms": 3475.231, "learn_time_ms": 1542.012, "learn_throughput": 217.897}, "counters": {"num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "done": false, "episodes_total": 97, "training_iteration": 97, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-52", "timestamp": 1706260852, "time_this_iter_s": 3.4710750579833984, "time_total_s": 338.50408482551575, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80934c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 338.50408482551575, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 21.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 0.0010000000474974513, "total_loss": 9.885480880737305, "policy_loss": -0.1765071004629135, "vf_loss": 10.0, "vf_explained_var": 2.3841858265427618e-08, "kl": 0.012093395926058292, "entropy": 12.59589958190918, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8775.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940358.831589285, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825703107837694, "mean_inference_ms": 5.217350147667008, "mean_action_processing_ms": 0.1448345001656594, "mean_env_wait_ms": 0.2533103885045929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015430061184630101, "StateBufferConnector_ms": 0.002339664770632374, "ViewRequirementAgentConnector_ms": 0.05996178607551419}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940358.831589285, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825703107837694, "mean_inference_ms": 5.217350147667008, "mean_action_processing_ms": 0.1448345001656594, "mean_env_wait_ms": 0.2533103885045929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015430061184630101, "StateBufferConnector_ms": 0.002339664770632374, "ViewRequirementAgentConnector_ms": 0.05996178607551419}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32928, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32928, "timers": {"training_iteration_time_ms": 3476.181, "learn_time_ms": 1542.245, "learn_throughput": 217.864}, "counters": {"num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "done": false, "episodes_total": 98, "training_iteration": 98, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-55", "timestamp": 1706260855, "time_this_iter_s": 3.488027572631836, "time_total_s": 341.9921123981476, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece050>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5a290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 341.9921123981476, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.56, "ram_util_percent": 21.360000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 0.0010000000474974513, "total_loss": 9.879908561706543, "policy_loss": -0.18186819553375244, "vf_loss": 10.0, "vf_explained_var": 1.1258655341350732e-08, "kl": 0.012052197009325027, "entropy": 12.611100196838379, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8865.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940659.3794361997, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825805053314101, "mean_inference_ms": 5.217313643338954, "mean_action_processing_ms": 0.14483057565082064, "mean_env_wait_ms": 0.25330311832792307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433388526993568, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.05995938272187204}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940659.3794361997, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825805053314101, "mean_inference_ms": 5.217313643338954, "mean_action_processing_ms": 0.14483057565082064, "mean_env_wait_ms": 0.25330311832792307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433388526993568, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.05995938272187204}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33264, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33264, "timers": {"training_iteration_time_ms": 3476.176, "learn_time_ms": 1540.905, "learn_throughput": 218.054}, "counters": {"num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "done": false, "episodes_total": 99, "training_iteration": 99, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-20-59", "timestamp": 1706260859, "time_this_iter_s": 3.4861247539520264, "time_total_s": 345.4782371520996, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19270>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5b0a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 345.4782371520996, "timesteps_since_restore": 0, "iterations_since_restore": 99, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.56, "ram_util_percent": 21.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 0.0010000000474974513, "total_loss": 9.894817352294922, "policy_loss": -0.16692239046096802, "vf_loss": 10.0, "vf_explained_var": 2.119276309997531e-08, "kl": 0.012045086361467838, "entropy": 12.407001495361328, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 8955.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940347.2527593127, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825925085253437, "mean_inference_ms": 5.21728008602538, "mean_action_processing_ms": 0.14482689859271303, "mean_env_wait_ms": 0.25329618048851327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015422582626342773, "StateBufferConnector_ms": 0.0023403167724609375, "ViewRequirementAgentConnector_ms": 0.05994987487792969}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -940347.2527593127, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1005138.234705192, -930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825925085253437, "mean_inference_ms": 5.21728008602538, "mean_action_processing_ms": 0.14482689859271303, "mean_env_wait_ms": 0.25329618048851327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015422582626342773, "StateBufferConnector_ms": 0.0023403167724609375, "ViewRequirementAgentConnector_ms": 0.05994987487792969}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33600, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 3478.662, "learn_time_ms": 1542.465, "learn_throughput": 217.833}, "counters": {"num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "done": false, "episodes_total": 100, "training_iteration": 100, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-02", "timestamp": 1706260862, "time_this_iter_s": 3.5015788078308105, "time_total_s": 348.9798159599304, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece200>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5b010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 348.9798159599304, "timesteps_since_restore": 0, "iterations_since_restore": 100, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 21.62}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.125781059265137, "cur_lr": 0.0010000000474974513, "total_loss": 9.930371284484863, "policy_loss": -0.17294301092624664, "vf_loss": 10.0, "vf_explained_var": 4.702144096313532e-08, "kl": 0.02015562541782856, "entropy": 12.580537796020508, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9045.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -939684.9598123454, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582162277439236, "mean_inference_ms": 5.217133535641134, "mean_action_processing_ms": 0.14478223673071206, "mean_env_wait_ms": 0.25323520912024633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015414237976074219, "StateBufferConnector_ms": 0.0023365020751953125, "ViewRequirementAgentConnector_ms": 0.059934377670288086}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -939684.9598123454, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-930640.2578650372, -967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582162277439236, "mean_inference_ms": 5.217133535641134, "mean_action_processing_ms": 0.14478223673071206, "mean_env_wait_ms": 0.25323520912024633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015414237976074219, "StateBufferConnector_ms": 0.0023365020751953125, "ViewRequirementAgentConnector_ms": 0.059934377670288086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33936, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33936, "timers": {"training_iteration_time_ms": 3480.21, "learn_time_ms": 1543.07, "learn_throughput": 217.748}, "counters": {"num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "done": false, "episodes_total": 101, "training_iteration": 101, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-06", "timestamp": 1706260866, "time_this_iter_s": 3.4669744968414307, "time_total_s": 352.44679045677185, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093010>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f59cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 352.44679045677185, "timesteps_since_restore": 0, "iterations_since_restore": 101, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.66, "ram_util_percent": 21.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.944250106811523, "policy_loss": -0.15653784573078156, "vf_loss": 10.0, "vf_explained_var": 1.8543667934523e-08, "kl": 0.013108689337968826, "entropy": 12.259965896606445, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9135.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -939529.3988740561, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15818671942049456, "mean_inference_ms": 5.216937652381445, "mean_action_processing_ms": 0.14474718181429944, "mean_env_wait_ms": 0.25317561397904265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01541757583618164, "StateBufferConnector_ms": 0.002333402633666992, "ViewRequirementAgentConnector_ms": 0.059920549392700195}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -939529.3988740561, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-967523.6795734484, -977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15818671942049456, "mean_inference_ms": 5.216937652381445, "mean_action_processing_ms": 0.14474718181429944, "mean_env_wait_ms": 0.25317561397904265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01541757583618164, "StateBufferConnector_ms": 0.002333402633666992, "ViewRequirementAgentConnector_ms": 0.059920549392700195}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34272, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34272, "timers": {"training_iteration_time_ms": 3485.034, "learn_time_ms": 1544.779, "learn_throughput": 217.507}, "counters": {"num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "done": false, "episodes_total": 102, "training_iteration": 102, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-09", "timestamp": 1706260869, "time_this_iter_s": 3.4963254928588867, "time_total_s": 355.94311594963074, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf4f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5b5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 355.94311594963074, "timesteps_since_restore": 0, "iterations_since_restore": 102, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.760000000000001, "ram_util_percent": 21.860000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.92210578918457, "policy_loss": -0.15522561967372894, "vf_loss": 10.0, "vf_explained_var": 4.7683716530855236e-08, "kl": 0.010058003477752209, "entropy": 12.511992454528809, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9225.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -939312.0879848917, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581637119539872, "mean_inference_ms": 5.2167905250855755, "mean_action_processing_ms": 0.14471682645435086, "mean_env_wait_ms": 0.2531182822335746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015404224395751953, "StateBufferConnector_ms": 0.0023322105407714844, "ViewRequirementAgentConnector_ms": 0.059937238693237305}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -939312.0879848917, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-977976.2133301937, -972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581637119539872, "mean_inference_ms": 5.2167905250855755, "mean_action_processing_ms": 0.14471682645435086, "mean_env_wait_ms": 0.2531182822335746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015404224395751953, "StateBufferConnector_ms": 0.0023322105407714844, "ViewRequirementAgentConnector_ms": 0.059937238693237305}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34608, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34608, "timers": {"training_iteration_time_ms": 3489.823, "learn_time_ms": 1546.034, "learn_throughput": 217.33}, "counters": {"num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "done": false, "episodes_total": 103, "training_iteration": 103, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-13", "timestamp": 1706260873, "time_this_iter_s": 3.4995203018188477, "time_total_s": 359.4426362514496, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece0e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5b9a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 359.4426362514496, "timesteps_since_restore": 0, "iterations_since_restore": 103, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 22.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.899314880371094, "policy_loss": -0.16443859040737152, "vf_loss": 10.0, "vf_explained_var": 1.2583202924076886e-08, "kl": 0.00829194113612175, "entropy": 12.590965270996094, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9315.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -938314.6307362877, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581428527286186, "mean_inference_ms": 5.216368492158316, "mean_action_processing_ms": 0.14468490956672186, "mean_env_wait_ms": 0.2530576097895488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538228988647461, "StateBufferConnector_ms": 0.002329111099243164, "ViewRequirementAgentConnector_ms": 0.0598149299621582}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -938314.6307362877, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-972506.3694253671, -930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581428527286186, "mean_inference_ms": 5.216368492158316, "mean_action_processing_ms": 0.14468490956672186, "mean_env_wait_ms": 0.2530576097895488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538228988647461, "StateBufferConnector_ms": 0.002329111099243164, "ViewRequirementAgentConnector_ms": 0.0598149299621582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34944, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 3492.749, "learn_time_ms": 1547.351, "learn_throughput": 217.145}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "done": false, "episodes_total": 104, "training_iteration": 104, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-16", "timestamp": 1706260876, "time_this_iter_s": 3.521026372909546, "time_total_s": 362.96366262435913, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eced40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 362.96366262435913, "timesteps_since_restore": 0, "iterations_since_restore": 104, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 22.140000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.902626037597656, "policy_loss": -0.16890200972557068, "vf_loss": 10.0, "vf_explained_var": 3.1789145538141383e-08, "kl": 0.009303017519414425, "entropy": 12.564973831176758, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9405.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -937887.6631342615, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581321294362286, "mean_inference_ms": 5.216051524579445, "mean_action_processing_ms": 0.14466023551958965, "mean_env_wait_ms": 0.25300997593843344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537775993347168, "StateBufferConnector_ms": 0.0023212432861328125, "ViewRequirementAgentConnector_ms": 0.05983781814575195}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -937887.6631342615, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-930286.0407806522, -1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581321294362286, "mean_inference_ms": 5.216051524579445, "mean_action_processing_ms": 0.14466023551958965, "mean_env_wait_ms": 0.25300997593843344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537775993347168, "StateBufferConnector_ms": 0.0023212432861328125, "ViewRequirementAgentConnector_ms": 0.05983781814575195}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35280, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35280, "timers": {"training_iteration_time_ms": 3496.056, "learn_time_ms": 1549.098, "learn_throughput": 216.9}, "counters": {"num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "done": false, "episodes_total": 105, "training_iteration": 105, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-20", "timestamp": 1706260880, "time_this_iter_s": 3.5141890048980713, "time_total_s": 366.4778516292572, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80934c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f59ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 366.4778516292572, "timesteps_since_restore": 0, "iterations_since_restore": 105, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.74, "ram_util_percent": 22.259999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.90469741821289, "policy_loss": -0.15620875358581543, "vf_loss": 10.0, "vf_explained_var": 3.774960788405224e-08, "kl": 0.007921429350972176, "entropy": 12.59678840637207, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9495.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -937698.5161244945, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812688553205617, "mean_inference_ms": 5.215823224072206, "mean_action_processing_ms": 0.14463997029771433, "mean_env_wait_ms": 0.2529694710996065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015365123748779297, "StateBufferConnector_ms": 0.0023212432861328125, "ViewRequirementAgentConnector_ms": 0.059844970703125}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1044238.3591119543, "episode_reward_mean": -937698.5161244945, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1044238.3591119543, -963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812688553205617, "mean_inference_ms": 5.215823224072206, "mean_action_processing_ms": 0.14463997029771433, "mean_env_wait_ms": 0.2529694710996065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015365123748779297, "StateBufferConnector_ms": 0.0023212432861328125, "ViewRequirementAgentConnector_ms": 0.059844970703125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35616, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35616, "timers": {"training_iteration_time_ms": 3492.164, "learn_time_ms": 1547.227, "learn_throughput": 217.163}, "counters": {"num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "done": false, "episodes_total": 106, "training_iteration": 106, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-23", "timestamp": 1706260883, "time_this_iter_s": 3.481477975845337, "time_total_s": 369.95932960510254, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f186a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6ce50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 369.95932960510254, "timesteps_since_restore": 0, "iterations_since_restore": 106, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 22.380000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.907261848449707, "policy_loss": -0.1595362424850464, "vf_loss": 10.0, "vf_explained_var": 2.7153227222243004e-08, "kl": 0.008687946945428848, "entropy": 12.486105918884277, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9585.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936808.8639904906, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812164405771906, "mean_inference_ms": 5.215570377868857, "mean_action_processing_ms": 0.14462095657314336, "mean_env_wait_ms": 0.2529300758483335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533055305480957, "StateBufferConnector_ms": 0.002320528030395508, "ViewRequirementAgentConnector_ms": 0.05984210968017578}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936808.8639904906, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-963365.5330627419, -958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812164405771906, "mean_inference_ms": 5.215570377868857, "mean_action_processing_ms": 0.14462095657314336, "mean_env_wait_ms": 0.2529300758483335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533055305480957, "StateBufferConnector_ms": 0.002320528030395508, "ViewRequirementAgentConnector_ms": 0.05984210968017578}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35952, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35952, "timers": {"training_iteration_time_ms": 3495.291, "learn_time_ms": 1548.744, "learn_throughput": 216.95}, "counters": {"num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "done": false, "episodes_total": 107, "training_iteration": 107, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-27", "timestamp": 1706260887, "time_this_iter_s": 3.5023961067199707, "time_total_s": 373.4617257118225, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdfc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5bd90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 373.4617257118225, "timesteps_since_restore": 0, "iterations_since_restore": 107, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.55, "ram_util_percent": 22.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.902193069458008, "policy_loss": -0.1651039868593216, "vf_loss": 10.0, "vf_explained_var": 2.2517310682701464e-08, "kl": 0.00875270739197731, "entropy": 12.45020580291748, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9675.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936561.3959812745, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812076247823195, "mean_inference_ms": 5.215396959244606, "mean_action_processing_ms": 0.1446061855585645, "mean_env_wait_ms": 0.25289792728200294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334844589233398, "StateBufferConnector_ms": 0.002319812774658203, "ViewRequirementAgentConnector_ms": 0.05984687805175781}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936561.3959812745, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-958153.5089889127, -962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812076247823195, "mean_inference_ms": 5.215396959244606, "mean_action_processing_ms": 0.1446061855585645, "mean_env_wait_ms": 0.25289792728200294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334844589233398, "StateBufferConnector_ms": 0.002319812774658203, "ViewRequirementAgentConnector_ms": 0.05984687805175781}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36288, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36288, "timers": {"training_iteration_time_ms": 3494.407, "learn_time_ms": 1549.061, "learn_throughput": 216.906}, "counters": {"num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "done": false, "episodes_total": 108, "training_iteration": 108, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-30", "timestamp": 1706260890, "time_this_iter_s": 3.479186534881592, "time_total_s": 376.9409122467041, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecfd90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6c550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 376.9409122467041, "timesteps_since_restore": 0, "iterations_since_restore": 108, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 22.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.894129753112793, "policy_loss": -0.17048975825309753, "vf_loss": 10.0, "vf_explained_var": 2.5166405848153772e-08, "kl": 0.008404487743973732, "entropy": 12.424859046936035, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936412.7024289657, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812099753031625, "mean_inference_ms": 5.215223319577572, "mean_action_processing_ms": 0.14459256742557222, "mean_env_wait_ms": 0.25286908967221494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352487564086914, "StateBufferConnector_ms": 0.0023183822631835938, "ViewRequirementAgentConnector_ms": 0.05985140800476074}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936412.7024289657, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-962956.7072351902, -912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812099753031625, "mean_inference_ms": 5.215223319577572, "mean_action_processing_ms": 0.14459256742557222, "mean_env_wait_ms": 0.25286908967221494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352487564086914, "StateBufferConnector_ms": 0.0023183822631835938, "ViewRequirementAgentConnector_ms": 0.05985140800476074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36624, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36624, "timers": {"training_iteration_time_ms": 3498.183, "learn_time_ms": 1550.748, "learn_throughput": 216.67}, "counters": {"num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "done": false, "episodes_total": 109, "training_iteration": 109, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-34", "timestamp": 1706260894, "time_this_iter_s": 3.5238373279571533, "time_total_s": 380.46474957466125, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdb40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5ba30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 380.46474957466125, "timesteps_since_restore": 0, "iterations_since_restore": 109, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 22.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.903197288513184, "policy_loss": -0.1643572747707367, "vf_loss": 10.0, "vf_explained_var": 3.1789145538141383e-08, "kl": 0.008786297403275967, "entropy": 12.357486724853516, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9855.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936191.6169147118, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581205946352499, "mean_inference_ms": 5.21501771770558, "mean_action_processing_ms": 0.1445794227901514, "mean_env_wait_ms": 0.25283728757149815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534891128540039, "StateBufferConnector_ms": 0.002318859100341797, "ViewRequirementAgentConnector_ms": 0.05984663963317871}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936191.6169147118, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-912842.9550149553, -946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581205946352499, "mean_inference_ms": 5.21501771770558, "mean_action_processing_ms": 0.1445794227901514, "mean_env_wait_ms": 0.25283728757149815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534891128540039, "StateBufferConnector_ms": 0.002318859100341797, "ViewRequirementAgentConnector_ms": 0.05984663963317871}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36960, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36960, "timers": {"training_iteration_time_ms": 3494.349, "learn_time_ms": 1549.335, "learn_throughput": 216.867}, "counters": {"num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "done": false, "episodes_total": 110, "training_iteration": 110, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-37", "timestamp": 1706260897, "time_this_iter_s": 3.4632632732391357, "time_total_s": 383.9280128479004, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8091750>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6d630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 383.9280128479004, "timesteps_since_restore": 0, "iterations_since_restore": 110, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.540000000000001, "ram_util_percent": 22.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.902950286865234, "policy_loss": -0.1624654233455658, "vf_loss": 10.0, "vf_explained_var": 2.7153227222243004e-08, "kl": 0.008508151397109032, "entropy": 12.405614852905273, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 9945.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936921.7903507707, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581209044253036, "mean_inference_ms": 5.2148282484207265, "mean_action_processing_ms": 0.14456652314620633, "mean_env_wait_ms": 0.2528080674735729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533961296081543, "StateBufferConnector_ms": 0.0023195743560791016, "ViewRequirementAgentConnector_ms": 0.059857845306396484}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936921.7903507707, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-946001.4409656643, -966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581209044253036, "mean_inference_ms": 5.2148282484207265, "mean_action_processing_ms": 0.14456652314620633, "mean_env_wait_ms": 0.2528080674735729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533961296081543, "StateBufferConnector_ms": 0.0023195743560791016, "ViewRequirementAgentConnector_ms": 0.059857845306396484}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37296, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37296, "timers": {"training_iteration_time_ms": 3494.569, "learn_time_ms": 1549.453, "learn_throughput": 216.851}, "counters": {"num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "done": false, "episodes_total": 111, "training_iteration": 111, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-41", "timestamp": 1706260901, "time_this_iter_s": 3.4691622257232666, "time_total_s": 387.39717507362366, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8091c30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5bd90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 387.39717507362366, "timesteps_since_restore": 0, "iterations_since_restore": 111, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.680000000000001, "ram_util_percent": 23.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89028549194336, "policy_loss": -0.17749813199043274, "vf_loss": 10.0, "vf_explained_var": 2.3841858265427618e-08, "kl": 0.008816076442599297, "entropy": 12.440439224243164, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10035.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936688.061416078, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581223558468981, "mean_inference_ms": 5.214657994212575, "mean_action_processing_ms": 0.1445543328505265, "mean_env_wait_ms": 0.25278152617764543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534128189086914, "StateBufferConnector_ms": 0.002321958541870117, "ViewRequirementAgentConnector_ms": 0.0598597526550293}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936688.061416078, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-966906.726260485, -981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581223558468981, "mean_inference_ms": 5.214657994212575, "mean_action_processing_ms": 0.1445543328505265, "mean_env_wait_ms": 0.25278152617764543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534128189086914, "StateBufferConnector_ms": 0.002321958541870117, "ViewRequirementAgentConnector_ms": 0.0598597526550293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37632, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 3497.564, "learn_time_ms": 1550.97, "learn_throughput": 216.639}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "done": false, "episodes_total": 112, "training_iteration": 112, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-44", "timestamp": 1706260904, "time_this_iter_s": 3.5263092517852783, "time_total_s": 390.92348432540894, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecfbe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6e0e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 390.92348432540894, "timesteps_since_restore": 0, "iterations_since_restore": 112, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 23.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.9014892578125, "policy_loss": -0.16255883872509003, "vf_loss": 10.0, "vf_explained_var": 2.0530489308612232e-08, "kl": 0.008330201730132103, "entropy": 12.369850158691406, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10125.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936311.1388036982, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.158123365375925, "mean_inference_ms": 5.21450971910631, "mean_action_processing_ms": 0.14454218400071428, "mean_env_wait_ms": 0.2527548264523182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331745147705078, "StateBufferConnector_ms": 0.0023207664489746094, "ViewRequirementAgentConnector_ms": 0.059850215911865234}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -936311.1388036982, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981984.5630705123, -973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.158123365375925, "mean_inference_ms": 5.21450971910631, "mean_action_processing_ms": 0.14454218400071428, "mean_env_wait_ms": 0.2527548264523182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331745147705078, "StateBufferConnector_ms": 0.0023207664489746094, "ViewRequirementAgentConnector_ms": 0.059850215911865234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37968, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37968, "timers": {"training_iteration_time_ms": 3496.99, "learn_time_ms": 1551.432, "learn_throughput": 216.574}, "counters": {"num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "done": false, "episodes_total": 113, "training_iteration": 113, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-48", "timestamp": 1706260908, "time_this_iter_s": 3.4937973022460938, "time_total_s": 394.41728162765503, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf820>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5b130>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 394.41728162765503, "timesteps_since_restore": 0, "iterations_since_restore": 113, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.660000000000001, "ram_util_percent": 23.360000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.908543586730957, "policy_loss": -0.16198556125164032, "vf_loss": 10.0, "vf_explained_var": 2.2517310682701464e-08, "kl": 0.00917314738035202, "entropy": 12.404194831848145, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10215.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -935521.7369472896, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581247898316545, "mean_inference_ms": 5.214359126156362, "mean_action_processing_ms": 0.14453065588630604, "mean_env_wait_ms": 0.2527287727070759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015351295471191406, "StateBufferConnector_ms": 0.0023212432861328125, "ViewRequirementAgentConnector_ms": 0.05987048149108887}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -935521.7369472896, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-973352.7053345465, -947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581247898316545, "mean_inference_ms": 5.214359126156362, "mean_action_processing_ms": 0.14453065588630604, "mean_env_wait_ms": 0.2527287727070759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015351295471191406, "StateBufferConnector_ms": 0.0023212432861328125, "ViewRequirementAgentConnector_ms": 0.05987048149108887}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38304, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38304, "timers": {"training_iteration_time_ms": 3502.685, "learn_time_ms": 1551.945, "learn_throughput": 216.502}, "counters": {"num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "done": false, "episodes_total": 114, "training_iteration": 114, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-52", "timestamp": 1706260912, "time_this_iter_s": 3.5779647827148438, "time_total_s": 397.9952464103699, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6e050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 397.9952464103699, "timesteps_since_restore": 0, "iterations_since_restore": 114, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.659999999999999, "ram_util_percent": 23.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.894349098205566, "policy_loss": -0.1679549664258957, "vf_loss": 10.0, "vf_explained_var": 1.3245476715439963e-08, "kl": 0.008103455416858196, "entropy": 12.456530570983887, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10305.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -934952.1597796248, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812729400184558, "mean_inference_ms": 5.214216191948364, "mean_action_processing_ms": 0.14452093738105198, "mean_env_wait_ms": 0.25270625400865776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01535797119140625, "StateBufferConnector_ms": 0.002321958541870117, "ViewRequirementAgentConnector_ms": 0.05989503860473633}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -934952.1597796248, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-947447.1923492505, -935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812729400184558, "mean_inference_ms": 5.214216191948364, "mean_action_processing_ms": 0.14452093738105198, "mean_env_wait_ms": 0.25270625400865776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01535797119140625, "StateBufferConnector_ms": 0.002321958541870117, "ViewRequirementAgentConnector_ms": 0.05989503860473633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38640, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38640, "timers": {"training_iteration_time_ms": 3504.318, "learn_time_ms": 1551.959, "learn_throughput": 216.501}, "counters": {"num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "done": false, "episodes_total": 115, "training_iteration": 115, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-55", "timestamp": 1706260915, "time_this_iter_s": 3.5305042266845703, "time_total_s": 401.52575063705444, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093ac0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f58ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 401.52575063705444, "timesteps_since_restore": 0, "iterations_since_restore": 115, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 23.640000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.904335975646973, "policy_loss": -0.16657119989395142, "vf_loss": 10.0, "vf_explained_var": 1.9205941725886078e-08, "kl": 0.009222334250807762, "entropy": 12.364669799804688, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -934182.9742616144, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812996245538946, "mean_inference_ms": 5.214066225649368, "mean_action_processing_ms": 0.14451194800875686, "mean_env_wait_ms": 0.2526859787419675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015375614166259766, "StateBufferConnector_ms": 0.002323150634765625, "ViewRequirementAgentConnector_ms": 0.05994868278503418}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -934182.9742616144, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-935377.707437236, -919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15812996245538946, "mean_inference_ms": 5.214066225649368, "mean_action_processing_ms": 0.14451194800875686, "mean_env_wait_ms": 0.2526859787419675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015375614166259766, "StateBufferConnector_ms": 0.002323150634765625, "ViewRequirementAgentConnector_ms": 0.05994868278503418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38976, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38976, "timers": {"training_iteration_time_ms": 3510.33, "learn_time_ms": 1554.531, "learn_throughput": 216.142}, "counters": {"num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "done": false, "episodes_total": 116, "training_iteration": 116, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-21-59", "timestamp": 1706260919, "time_this_iter_s": 3.5415737628936768, "time_total_s": 405.0673243999481, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecce80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f203a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 405.0673243999481, "timesteps_since_restore": 0, "iterations_since_restore": 116, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 23.759999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.893209457397461, "policy_loss": -0.17268674075603485, "vf_loss": 10.0, "vf_explained_var": 2.1855036891338386e-08, "kl": 0.008570466190576553, "entropy": 12.506499290466309, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10485.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -934081.2315154745, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15813281902562415, "mean_inference_ms": 5.213919901277454, "mean_action_processing_ms": 0.1445036044059974, "mean_env_wait_ms": 0.25266621304344405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015414237976074219, "StateBufferConnector_ms": 0.0023260116577148438, "ViewRequirementAgentConnector_ms": 0.05997276306152344}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -934081.2315154745, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-919662.3577635734, -944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15813281902562415, "mean_inference_ms": 5.213919901277454, "mean_action_processing_ms": 0.1445036044059974, "mean_env_wait_ms": 0.25266621304344405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015414237976074219, "StateBufferConnector_ms": 0.0023260116577148438, "ViewRequirementAgentConnector_ms": 0.05997276306152344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39312, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39312, "timers": {"training_iteration_time_ms": 3511.837, "learn_time_ms": 1555.734, "learn_throughput": 215.975}, "counters": {"num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "done": false, "episodes_total": 117, "training_iteration": 117, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-02", "timestamp": 1706260922, "time_this_iter_s": 3.517446994781494, "time_total_s": 408.5847713947296, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f23d00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 408.5847713947296, "timesteps_since_restore": 0, "iterations_since_restore": 117, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.54, "ram_util_percent": 23.880000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.905474662780762, "policy_loss": -0.15686309337615967, "vf_loss": 10.0, "vf_explained_var": 3.8411883451772155e-08, "kl": 0.008107791654765606, "entropy": 12.3226900100708, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10575.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -933554.7157593071, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15813686434916405, "mean_inference_ms": 5.213797558141106, "mean_action_processing_ms": 0.14449652376594752, "mean_env_wait_ms": 0.2526489620231709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015419960021972656, "StateBufferConnector_ms": 0.0023283958435058594, "ViewRequirementAgentConnector_ms": 0.05994391441345215}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -933554.7157593071, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-944056.545440707, -977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15813686434916405, "mean_inference_ms": 5.213797558141106, "mean_action_processing_ms": 0.14449652376594752, "mean_env_wait_ms": 0.2526489620231709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015419960021972656, "StateBufferConnector_ms": 0.0023283958435058594, "ViewRequirementAgentConnector_ms": 0.05994391441345215}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39648, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39648, "timers": {"training_iteration_time_ms": 3511.721, "learn_time_ms": 1554.721, "learn_throughput": 216.116}, "counters": {"num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "done": false, "episodes_total": 118, "training_iteration": 118, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-06", "timestamp": 1706260926, "time_this_iter_s": 3.478060483932495, "time_total_s": 412.0628318786621, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf910>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6d000>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 412.0628318786621, "timesteps_since_restore": 0, "iterations_since_restore": 118, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 24.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.905014038085938, "policy_loss": -0.16366373002529144, "vf_loss": 10.0, "vf_explained_var": 3.443824070359369e-08, "kl": 0.008932361379265785, "entropy": 12.33671760559082, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10665.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -933061.3049261348, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581429880680619, "mean_inference_ms": 5.213708294370484, "mean_action_processing_ms": 0.1444908211949199, "mean_env_wait_ms": 0.25263458064996797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015423059463500977, "StateBufferConnector_ms": 0.002326488494873047, "ViewRequirementAgentConnector_ms": 0.05997586250305176}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -933061.3049261348, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-977306.8015171855, -889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581429880680619, "mean_inference_ms": 5.213708294370484, "mean_action_processing_ms": 0.1444908211949199, "mean_env_wait_ms": 0.25263458064996797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015423059463500977, "StateBufferConnector_ms": 0.002326488494873047, "ViewRequirementAgentConnector_ms": 0.05997586250305176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39984, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39984, "timers": {"training_iteration_time_ms": 3507.919, "learn_time_ms": 1554.183, "learn_throughput": 216.191}, "counters": {"num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "done": false, "episodes_total": 119, "training_iteration": 119, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-09", "timestamp": 1706260929, "time_this_iter_s": 3.485825777053833, "time_total_s": 415.54865765571594, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecfa00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6f9a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 415.54865765571594, "timesteps_since_restore": 0, "iterations_since_restore": 119, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.72, "ram_util_percent": 24.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.904306411743164, "policy_loss": -0.16506391763687134, "vf_loss": 10.0, "vf_explained_var": 2.781550101360608e-08, "kl": 0.00902232900261879, "entropy": 12.31418228149414, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10755.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -932488.0385026245, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15814966350346676, "mean_inference_ms": 5.213624161172742, "mean_action_processing_ms": 0.14448581735113966, "mean_env_wait_ms": 0.25262188953816006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433549880981445, "StateBufferConnector_ms": 0.002325296401977539, "ViewRequirementAgentConnector_ms": 0.05999946594238281}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -932488.0385026245, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-889626.295037199, -934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15814966350346676, "mean_inference_ms": 5.213624161172742, "mean_action_processing_ms": 0.14448581735113966, "mean_env_wait_ms": 0.25262188953816006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433549880981445, "StateBufferConnector_ms": 0.002325296401977539, "ViewRequirementAgentConnector_ms": 0.05999946594238281}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40320, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 3511.443, "learn_time_ms": 1555.07, "learn_throughput": 216.067}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "done": false, "episodes_total": 120, "training_iteration": 120, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-13", "timestamp": 1706260933, "time_this_iter_s": 3.498504161834717, "time_total_s": 419.04716181755066, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece080>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 419.04716181755066, "timesteps_since_restore": 0, "iterations_since_restore": 120, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5600000000000005, "ram_util_percent": 24.279999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.900177955627441, "policy_loss": -0.1635526418685913, "vf_loss": 10.0, "vf_explained_var": 3.5762788286319847e-08, "kl": 0.008288787677884102, "entropy": 12.498287200927734, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10845.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -932357.3384838626, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15815720537329983, "mean_inference_ms": 5.213537245723274, "mean_action_processing_ms": 0.1444817779273842, "mean_env_wait_ms": 0.25261163329349656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015424013137817383, "StateBufferConnector_ms": 0.0023241043090820312, "ViewRequirementAgentConnector_ms": 0.060002803802490234}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -932357.3384838626, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-934935.6276946303, -919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15815720537329983, "mean_inference_ms": 5.213537245723274, "mean_action_processing_ms": 0.1444817779273842, "mean_env_wait_ms": 0.25261163329349656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015424013137817383, "StateBufferConnector_ms": 0.0023241043090820312, "ViewRequirementAgentConnector_ms": 0.060002803802490234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40656, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40656, "timers": {"training_iteration_time_ms": 3511.983, "learn_time_ms": 1555.451, "learn_throughput": 216.015}, "counters": {"num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "done": false, "episodes_total": 121, "training_iteration": 121, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-16", "timestamp": 1706260936, "time_this_iter_s": 3.474579095840454, "time_total_s": 422.5217409133911, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf2e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6ef80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 422.5217409133911, "timesteps_since_restore": 0, "iterations_since_restore": 121, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 24.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.928702354431152, "policy_loss": -0.1615564227104187, "vf_loss": 10.0, "vf_explained_var": 1.9205941725886078e-08, "kl": 0.01173913199454546, "entropy": 12.512945175170898, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 10935.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -932217.8674082699, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15816342632765032, "mean_inference_ms": 5.213434439624429, "mean_action_processing_ms": 0.1444772389727607, "mean_env_wait_ms": 0.25260123771767695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01541900634765625, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.0599977970123291}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -932217.8674082699, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-919620.4841491346, -949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15816342632765032, "mean_inference_ms": 5.213434439624429, "mean_action_processing_ms": 0.1444772389727607, "mean_env_wait_ms": 0.25260123771767695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01541900634765625, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.0599977970123291}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40992, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40992, "timers": {"training_iteration_time_ms": 3508.082, "learn_time_ms": 1554.56, "learn_throughput": 216.138}, "counters": {"num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "done": false, "episodes_total": 122, "training_iteration": 122, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-20", "timestamp": 1706260940, "time_this_iter_s": 3.4872887134552, "time_total_s": 426.0090296268463, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee805b6a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f22680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 426.0090296268463, "timesteps_since_restore": 0, "iterations_since_restore": 122, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 24.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.897544860839844, "policy_loss": -0.16797611117362976, "vf_loss": 10.0, "vf_explained_var": 2.119276309997531e-08, "kl": 0.008521831594407558, "entropy": 12.5635347366333, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11025.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -932098.859112087, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15816915838437393, "mean_inference_ms": 5.213326410028803, "mean_action_processing_ms": 0.1444726791397288, "mean_env_wait_ms": 0.2525914055556824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015417098999023438, "StateBufferConnector_ms": 0.0023238658905029297, "ViewRequirementAgentConnector_ms": 0.0599818229675293}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -932098.859112087, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-949461.1871588298, -985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15816915838437393, "mean_inference_ms": 5.213326410028803, "mean_action_processing_ms": 0.1444726791397288, "mean_env_wait_ms": 0.2525914055556824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015417098999023438, "StateBufferConnector_ms": 0.0023238658905029297, "ViewRequirementAgentConnector_ms": 0.0599818229675293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41328, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41328, "timers": {"training_iteration_time_ms": 3505.213, "learn_time_ms": 1553.596, "learn_throughput": 216.272}, "counters": {"num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "done": false, "episodes_total": 123, "training_iteration": 123, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-23", "timestamp": 1706260943, "time_this_iter_s": 3.4650959968566895, "time_total_s": 429.474125623703, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd2d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6c940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 429.474125623703, "timesteps_since_restore": 0, "iterations_since_restore": 123, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 24.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.898314476013184, "policy_loss": -0.1693550944328308, "vf_loss": 10.0, "vf_explained_var": 7.285012149083059e-09, "kl": 0.008801205083727837, "entropy": 12.53161907196045, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11115.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -931393.8480240552, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15817445568522012, "mean_inference_ms": 5.213235823752512, "mean_action_processing_ms": 0.14446819058490065, "mean_env_wait_ms": 0.2525826340436343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015425920486450195, "StateBufferConnector_ms": 0.002324342727661133, "ViewRequirementAgentConnector_ms": 0.059967994689941406}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -931393.8480240552, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-985156.0698020185, -940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15817445568522012, "mean_inference_ms": 5.213235823752512, "mean_action_processing_ms": 0.14446819058490065, "mean_env_wait_ms": 0.2525826340436343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015425920486450195, "StateBufferConnector_ms": 0.002324342727661133, "ViewRequirementAgentConnector_ms": 0.059967994689941406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41664, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41664, "timers": {"training_iteration_time_ms": 3496.566, "learn_time_ms": 1551.325, "learn_throughput": 216.589}, "counters": {"num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "done": false, "episodes_total": 124, "training_iteration": 124, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-27", "timestamp": 1706260947, "time_this_iter_s": 3.491475820541382, "time_total_s": 432.9656014442444, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80936d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6fbe0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 432.9656014442444, "timesteps_since_restore": 0, "iterations_since_restore": 124, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.64, "ram_util_percent": 24.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.901755332946777, "policy_loss": -0.16565431654453278, "vf_loss": 10.0, "vf_explained_var": 1.7219120351796846e-08, "kl": 0.008767307735979557, "entropy": 12.541247367858887, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11205.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930432.0717508416, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15818034902209224, "mean_inference_ms": 5.213159747138275, "mean_action_processing_ms": 0.14446447047025293, "mean_env_wait_ms": 0.2525751906605684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015428543090820312, "StateBufferConnector_ms": 0.002324342727661133, "ViewRequirementAgentConnector_ms": 0.05997633934020996}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930432.0717508416, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-940330.1812814845, -944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15818034902209224, "mean_inference_ms": 5.213159747138275, "mean_action_processing_ms": 0.14446447047025293, "mean_env_wait_ms": 0.2525751906605684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015428543090820312, "StateBufferConnector_ms": 0.002324342727661133, "ViewRequirementAgentConnector_ms": 0.05997633934020996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42000, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 3490.501, "learn_time_ms": 1547.405, "learn_throughput": 217.138}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 125, "training_iteration": 125, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-30", "timestamp": 1706260950, "time_this_iter_s": 3.4698851108551025, "time_total_s": 436.4354865550995, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecef20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb4940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 436.4354865550995, "timesteps_since_restore": 0, "iterations_since_restore": 125, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 24.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.900064468383789, "policy_loss": -0.17057541012763977, "vf_loss": 10.0, "vf_explained_var": 3.245141755314762e-08, "kl": 0.009187467396259308, "entropy": 12.521257400512695, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11295.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930254.2153589529, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15818615780379144, "mean_inference_ms": 5.213081965794632, "mean_action_processing_ms": 0.14446091784311924, "mean_env_wait_ms": 0.25256759874397094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433311462402344, "StateBufferConnector_ms": 0.002325296401977539, "ViewRequirementAgentConnector_ms": 0.05998039245605469}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930254.2153589529, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-944255.1532367463, -916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15818615780379144, "mean_inference_ms": 5.213081965794632, "mean_action_processing_ms": 0.14446091784311924, "mean_env_wait_ms": 0.25256759874397094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433311462402344, "StateBufferConnector_ms": 0.002325296401977539, "ViewRequirementAgentConnector_ms": 0.05998039245605469}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42336, "timers": {"training_iteration_time_ms": 3483.613, "learn_time_ms": 1544.379, "learn_throughput": 217.563}, "counters": {"num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "done": false, "episodes_total": 126, "training_iteration": 126, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-34", "timestamp": 1706260954, "time_this_iter_s": 3.472686290740967, "time_total_s": 439.90817284584045, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f182b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb56c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 439.90817284584045, "timesteps_since_restore": 0, "iterations_since_restore": 126, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.640000000000001, "ram_util_percent": 25.059999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.904805183410645, "policy_loss": -0.16192729771137238, "vf_loss": 10.0, "vf_explained_var": 1.3245476715439963e-08, "kl": 0.008679274469614029, "entropy": 12.61225414276123, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11385.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930428.2059256834, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581926435673544, "mean_inference_ms": 5.21302758432572, "mean_action_processing_ms": 0.1444579913572171, "mean_env_wait_ms": 0.25256125442654953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015445232391357422, "StateBufferConnector_ms": 0.002325296401977539, "ViewRequirementAgentConnector_ms": 0.06000018119812012}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930428.2059256834, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-916992.4628683268, -938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581926435673544, "mean_inference_ms": 5.21302758432572, "mean_action_processing_ms": 0.1444579913572171, "mean_env_wait_ms": 0.25256125442654953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015445232391357422, "StateBufferConnector_ms": 0.002325296401977539, "ViewRequirementAgentConnector_ms": 0.06000018119812012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42672, "timers": {"training_iteration_time_ms": 3482.448, "learn_time_ms": 1544.583, "learn_throughput": 217.535}, "counters": {"num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "done": false, "episodes_total": 127, "training_iteration": 127, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-37", "timestamp": 1706260957, "time_this_iter_s": 3.505810499191284, "time_total_s": 443.41398334503174, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf2b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6feb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 443.41398334503174, "timesteps_since_restore": 0, "iterations_since_restore": 127, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.640000000000001, "ram_util_percent": 25.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89305591583252, "policy_loss": -0.17142218351364136, "vf_loss": 10.0, "vf_explained_var": 2.7153227222243004e-08, "kl": 0.008385994471609592, "entropy": 12.528018951416016, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11475.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930787.3270084285, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581995919497007, "mean_inference_ms": 5.212989614494838, "mean_action_processing_ms": 0.14445550973668494, "mean_env_wait_ms": 0.2525559922610864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015446662902832031, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.06001543998718262}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930787.3270084285, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-938435.5779975053, -902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581995919497007, "mean_inference_ms": 5.212989614494838, "mean_action_processing_ms": 0.14445550973668494, "mean_env_wait_ms": 0.2525559922610864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015446662902832031, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.06001543998718262}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 3488.015, "learn_time_ms": 1547.262, "learn_throughput": 217.158}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 128, "training_iteration": 128, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-41", "timestamp": 1706260961, "time_this_iter_s": 3.533752202987671, "time_total_s": 446.9477355480194, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece9b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb5b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 446.9477355480194, "timesteps_since_restore": 0, "iterations_since_restore": 128, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.640000000000001, "ram_util_percent": 25.340000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.894967079162598, "policy_loss": -0.1683160364627838, "vf_loss": 10.0, "vf_explained_var": 3.510051271859993e-08, "kl": 0.008230583742260933, "entropy": 12.451210021972656, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11565.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930158.6023465118, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582068799129601, "mean_inference_ms": 5.212966258186641, "mean_action_processing_ms": 0.1444534869250552, "mean_env_wait_ms": 0.2525515396210874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015440940856933594, "StateBufferConnector_ms": 0.002323150634765625, "ViewRequirementAgentConnector_ms": 0.0600130558013916}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930158.6023465118, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-902526.6425882496, -980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582068799129601, "mean_inference_ms": 5.212966258186641, "mean_action_processing_ms": 0.1444534869250552, "mean_env_wait_ms": 0.2525515396210874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015440940856933594, "StateBufferConnector_ms": 0.002323150634765625, "ViewRequirementAgentConnector_ms": 0.0600130558013916}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43344, "timers": {"training_iteration_time_ms": 3492.734, "learn_time_ms": 1550.063, "learn_throughput": 216.765}, "counters": {"num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "done": false, "episodes_total": 129, "training_iteration": 129, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-44", "timestamp": 1706260964, "time_this_iter_s": 3.5330049991607666, "time_total_s": 450.4807405471802, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd240>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f21120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 450.4807405471802, "timesteps_since_restore": 0, "iterations_since_restore": 129, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.74, "ram_util_percent": 25.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.896240234375, "policy_loss": -0.16856180131435394, "vf_loss": 10.0, "vf_explained_var": 1.9868215517249155e-08, "kl": 0.008428269997239113, "entropy": 12.516121864318848, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11655.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930756.731073306, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15821445619406288, "mean_inference_ms": 5.212961491043082, "mean_action_processing_ms": 0.14445215664903346, "mean_env_wait_ms": 0.25254863364634417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015460491180419922, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.06000828742980957}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930756.731073306, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-980083.2686146636, -951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15821445619406288, "mean_inference_ms": 5.212961491043082, "mean_action_processing_ms": 0.14445215664903346, "mean_env_wait_ms": 0.25254863364634417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015460491180419922, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.06000828742980957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43680, "timers": {"training_iteration_time_ms": 3493.777, "learn_time_ms": 1551.69, "learn_throughput": 216.538}, "counters": {"num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "done": false, "episodes_total": 130, "training_iteration": 130, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-48", "timestamp": 1706260968, "time_this_iter_s": 3.5089147090911865, "time_total_s": 453.98965525627136, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093e80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb63b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 453.98965525627136, "timesteps_since_restore": 0, "iterations_since_restore": 130, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 25.580000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.899896621704102, "policy_loss": -0.16581012308597565, "vf_loss": 10.0, "vf_explained_var": 1.1258655341350732e-08, "kl": 0.008546056225895882, "entropy": 12.36968994140625, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11745.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930524.4809212816, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582227047086155, "mean_inference_ms": 5.2129801084571445, "mean_action_processing_ms": 0.14445128478341526, "mean_env_wait_ms": 0.2525468794809477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015462160110473633, "StateBufferConnector_ms": 0.002323150634765625, "ViewRequirementAgentConnector_ms": 0.06003689765930176}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930524.4809212816, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-951482.5192630853, -954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582227047086155, "mean_inference_ms": 5.2129801084571445, "mean_action_processing_ms": 0.14445128478341526, "mean_env_wait_ms": 0.2525468794809477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015462160110473633, "StateBufferConnector_ms": 0.002323150634765625, "ViewRequirementAgentConnector_ms": 0.06003689765930176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44016, "timers": {"training_iteration_time_ms": 3497.55, "learn_time_ms": 1554.078, "learn_throughput": 216.205}, "counters": {"num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "done": false, "episodes_total": 131, "training_iteration": 131, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-52", "timestamp": 1706260972, "time_this_iter_s": 3.5123143196105957, "time_total_s": 457.50196957588196, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eccf70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6fbe0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 457.50196957588196, "timesteps_since_restore": 0, "iterations_since_restore": 131, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 25.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89344310760498, "policy_loss": -0.16606628894805908, "vf_loss": 10.0, "vf_explained_var": 2.4504132056790695e-08, "kl": 0.007739855907857418, "entropy": 12.392693519592285, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11835.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930099.1814431592, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15823102936190817, "mean_inference_ms": 5.213002273134156, "mean_action_processing_ms": 0.14445073071300873, "mean_env_wait_ms": 0.2525460208295446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015468358993530273, "StateBufferConnector_ms": 0.0023229122161865234, "ViewRequirementAgentConnector_ms": 0.0600285530090332}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -930099.1814431592, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-954272.8323192981, -942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15823102936190817, "mean_inference_ms": 5.213002273134156, "mean_action_processing_ms": 0.14445073071300873, "mean_env_wait_ms": 0.2525460208295446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015468358993530273, "StateBufferConnector_ms": 0.0023229122161865234, "ViewRequirementAgentConnector_ms": 0.0600285530090332}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44352, "timers": {"training_iteration_time_ms": 3497.717, "learn_time_ms": 1552.266, "learn_throughput": 216.458}, "counters": {"num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "done": false, "episodes_total": 132, "training_iteration": 132, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-55", "timestamp": 1706260975, "time_this_iter_s": 3.488985538482666, "time_total_s": 460.9909551143646, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecc070>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb4940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 460.9909551143646, "timesteps_since_restore": 0, "iterations_since_restore": 132, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.640000000000001, "ram_util_percent": 25.860000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.896296501159668, "policy_loss": -0.16665051877498627, "vf_loss": 10.0, "vf_explained_var": 3.112686997042147e-08, "kl": 0.008186966180801392, "entropy": 12.314020156860352, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 11925.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929868.628986924, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15823913651419574, "mean_inference_ms": 5.213020423868017, "mean_action_processing_ms": 0.14445043917424066, "mean_env_wait_ms": 0.25254531688232607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015458822250366211, "StateBufferConnector_ms": 0.0023238658905029297, "ViewRequirementAgentConnector_ms": 0.06003427505493164}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929868.628986924, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-942422.360604747, -923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15823913651419574, "mean_inference_ms": 5.213020423868017, "mean_action_processing_ms": 0.14445043917424066, "mean_env_wait_ms": 0.25254531688232607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015458822250366211, "StateBufferConnector_ms": 0.0023238658905029297, "ViewRequirementAgentConnector_ms": 0.06003427505493164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44688, "timers": {"training_iteration_time_ms": 3496.017, "learn_time_ms": 1550.752, "learn_throughput": 216.669}, "counters": {"num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "done": false, "episodes_total": 133, "training_iteration": 133, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-22-59", "timestamp": 1706260979, "time_this_iter_s": 3.4480528831481934, "time_total_s": 464.4390079975128, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f194e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb7a30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 464.4390079975128, "timesteps_since_restore": 0, "iterations_since_restore": 133, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5600000000000005, "ram_util_percent": 25.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.90178394317627, "policy_loss": -0.16540679335594177, "vf_loss": 10.0, "vf_explained_var": 2.582867963951685e-08, "kl": 0.008738971315324306, "entropy": 12.356606483459473, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12015.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929504.1928734209, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824716750422288, "mean_inference_ms": 5.213040568241951, "mean_action_processing_ms": 0.1444502054207526, "mean_env_wait_ms": 0.2525448599643414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015464544296264648, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.06003427505493164}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929504.1928734209, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923367.0831688317, -939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824716750422288, "mean_inference_ms": 5.213040568241951, "mean_action_processing_ms": 0.1444502054207526, "mean_env_wait_ms": 0.2525448599643414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015464544296264648, "StateBufferConnector_ms": 0.002323627471923828, "ViewRequirementAgentConnector_ms": 0.06003427505493164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45024, "timers": {"training_iteration_time_ms": 3495.821, "learn_time_ms": 1550.693, "learn_throughput": 216.677}, "counters": {"num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "done": false, "episodes_total": 134, "training_iteration": 134, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-02", "timestamp": 1706260982, "time_this_iter_s": 3.489529609680176, "time_total_s": 467.928537607193, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecfd60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb77f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 467.928537607193, "timesteps_since_restore": 0, "iterations_since_restore": 134, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.639999999999999, "ram_util_percent": 26.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.913331031799316, "policy_loss": -0.1658559888601303, "vf_loss": 10.0, "vf_explained_var": 2.781550101360608e-08, "kl": 0.01029917597770691, "entropy": 12.138555526733398, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12105.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929619.879861219, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825544922973991, "mean_inference_ms": 5.213075031028687, "mean_action_processing_ms": 0.14445052458525645, "mean_env_wait_ms": 0.25254515667007693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015498876571655273, "StateBufferConnector_ms": 0.002329587936401367, "ViewRequirementAgentConnector_ms": 0.06011176109313965}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929619.879861219, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-939703.8990757981, -929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15825544922973991, "mean_inference_ms": 5.213075031028687, "mean_action_processing_ms": 0.14445052458525645, "mean_env_wait_ms": 0.25254515667007693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015498876571655273, "StateBufferConnector_ms": 0.002329587936401367, "ViewRequirementAgentConnector_ms": 0.06011176109313965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45360, "timers": {"training_iteration_time_ms": 3500.009, "learn_time_ms": 1553.561, "learn_throughput": 216.277}, "counters": {"num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "done": false, "episodes_total": 135, "training_iteration": 135, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-06", "timestamp": 1706260986, "time_this_iter_s": 3.511777877807617, "time_total_s": 471.4403154850006, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093ac0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb6e60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 471.4403154850006, "timesteps_since_restore": 0, "iterations_since_restore": 135, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 26.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.893857955932617, "policy_loss": -0.17369458079338074, "vf_loss": 10.0, "vf_explained_var": 2.7153227222243004e-08, "kl": 0.008786039426922798, "entropy": 12.36806869506836, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12195.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929346.849788412, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826412045650098, "mean_inference_ms": 5.213116631809936, "mean_action_processing_ms": 0.144451209434271, "mean_env_wait_ms": 0.2525467930536329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015500783920288086, "StateBufferConnector_ms": 0.0023288726806640625, "ViewRequirementAgentConnector_ms": 0.060126543045043945}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929346.849788412, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-929296.4412986233, -948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15826412045650098, "mean_inference_ms": 5.213116631809936, "mean_action_processing_ms": 0.144451209434271, "mean_env_wait_ms": 0.2525467930536329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015500783920288086, "StateBufferConnector_ms": 0.0023288726806640625, "ViewRequirementAgentConnector_ms": 0.060126543045043945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 3505.906, "learn_time_ms": 1557.077, "learn_throughput": 215.789}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "done": false, "episodes_total": 136, "training_iteration": 136, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-09", "timestamp": 1706260989, "time_this_iter_s": 3.5316548347473145, "time_total_s": 474.9719703197479, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdde0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb6f80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 474.9719703197479, "timesteps_since_restore": 0, "iterations_since_restore": 136, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5600000000000005, "ram_util_percent": 26.380000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.902840614318848, "policy_loss": -0.16501744091510773, "vf_loss": 10.0, "vf_explained_var": 3.510051271859993e-08, "kl": 0.008825934492051601, "entropy": 12.547327995300293, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929119.0651607892, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15827214836804, "mean_inference_ms": 5.213148239966095, "mean_action_processing_ms": 0.1444517332632297, "mean_env_wait_ms": 0.2525477802787563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015517950057983398, "StateBufferConnector_ms": 0.0023293495178222656, "ViewRequirementAgentConnector_ms": 0.06013178825378418}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929119.0651607892, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-948214.5833236488, -889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15827214836804, "mean_inference_ms": 5.213148239966095, "mean_action_processing_ms": 0.1444517332632297, "mean_env_wait_ms": 0.2525477802787563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015517950057983398, "StateBufferConnector_ms": 0.0023293495178222656, "ViewRequirementAgentConnector_ms": 0.06013178825378418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46032, "timers": {"training_iteration_time_ms": 3506.734, "learn_time_ms": 1555.799, "learn_throughput": 215.966}, "counters": {"num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "done": false, "episodes_total": 137, "training_iteration": 137, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-13", "timestamp": 1706260993, "time_this_iter_s": 3.5140938758850098, "time_total_s": 478.48606419563293, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdbd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd0550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 478.48606419563293, "timesteps_since_restore": 0, "iterations_since_restore": 137, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.640000000000001, "ram_util_percent": 26.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.911832809448242, "policy_loss": -0.16167251765727997, "vf_loss": 10.0, "vf_explained_var": 3.973643192267673e-09, "kl": 0.00956021435558796, "entropy": 12.56926155090332, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12375.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928947.5972816898, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15828006159773517, "mean_inference_ms": 5.213180727592009, "mean_action_processing_ms": 0.14445233995133755, "mean_env_wait_ms": 0.25254922757965304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015512228012084961, "StateBufferConnector_ms": 0.002328157424926758, "ViewRequirementAgentConnector_ms": 0.06011199951171875}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928947.5972816898, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-889289.2367892396, -924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15828006159773517, "mean_inference_ms": 5.213180727592009, "mean_action_processing_ms": 0.14445233995133755, "mean_env_wait_ms": 0.25254922757965304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015512228012084961, "StateBufferConnector_ms": 0.002328157424926758, "ViewRequirementAgentConnector_ms": 0.06011199951171875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46368, "timers": {"training_iteration_time_ms": 3503.22, "learn_time_ms": 1555.523, "learn_throughput": 216.004}, "counters": {"num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "done": false, "episodes_total": 138, "training_iteration": 138, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-16", "timestamp": 1706260996, "time_this_iter_s": 3.49857759475708, "time_total_s": 481.98464179039, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece020>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb4940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 481.98464179039, "timesteps_since_restore": 0, "iterations_since_restore": 138, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.66, "ram_util_percent": 26.640000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.898537635803223, "policy_loss": -0.16715151071548462, "vf_loss": 10.0, "vf_explained_var": 2.2517310682701464e-08, "kl": 0.008543524891138077, "entropy": 12.619977951049805, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12465.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929873.0647603504, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15828771780132087, "mean_inference_ms": 5.213226538682409, "mean_action_processing_ms": 0.14445314050168429, "mean_env_wait_ms": 0.25255140891096145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015505075454711914, "StateBufferConnector_ms": 0.002333402633666992, "ViewRequirementAgentConnector_ms": 0.060111045837402344}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929873.0647603504, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-924543.9086842288, -924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15828771780132087, "mean_inference_ms": 5.213226538682409, "mean_action_processing_ms": 0.14445314050168429, "mean_env_wait_ms": 0.25255140891096145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015505075454711914, "StateBufferConnector_ms": 0.002333402633666992, "ViewRequirementAgentConnector_ms": 0.060111045837402344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46704, "timers": {"training_iteration_time_ms": 3497.715, "learn_time_ms": 1550.683, "learn_throughput": 216.679}, "counters": {"num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "done": false, "episodes_total": 139, "training_iteration": 139, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-20", "timestamp": 1706261000, "time_this_iter_s": 3.4779975414276123, "time_total_s": 485.4626393318176, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece710>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd05e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 485.4626393318176, "timesteps_since_restore": 0, "iterations_since_restore": 139, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.72, "ram_util_percent": 26.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89918327331543, "policy_loss": -0.16422855854034424, "vf_loss": 10.0, "vf_explained_var": 1.7219120351796846e-08, "kl": 0.008247317746281624, "entropy": 12.613061904907227, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929330.9495250663, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582949451190241, "mean_inference_ms": 5.213276054270727, "mean_action_processing_ms": 0.14445385321603468, "mean_env_wait_ms": 0.2525534113092766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015499353408813477, "StateBufferConnector_ms": 0.0023338794708251953, "ViewRequirementAgentConnector_ms": 0.06012988090515137}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929330.9495250663, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-924193.6603888462, -932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1582949451190241, "mean_inference_ms": 5.213276054270727, "mean_action_processing_ms": 0.14445385321603468, "mean_env_wait_ms": 0.2525534113092766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015499353408813477, "StateBufferConnector_ms": 0.0023338794708251953, "ViewRequirementAgentConnector_ms": 0.06012988090515137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47040, "timers": {"training_iteration_time_ms": 3494.272, "learn_time_ms": 1549.365, "learn_throughput": 216.863}, "counters": {"num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "done": false, "episodes_total": 140, "training_iteration": 140, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-23", "timestamp": 1706261003, "time_this_iter_s": 3.474492073059082, "time_total_s": 488.9371314048767, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eccbb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb6170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 488.9371314048767, "timesteps_since_restore": 0, "iterations_since_restore": 140, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.459999999999999, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.895041465759277, "policy_loss": -0.17121519148349762, "vf_loss": 10.0, "vf_explained_var": 1.9205941725886078e-08, "kl": 0.008617516607046127, "entropy": 12.60983657836914, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12645.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929231.281598888, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583029233758697, "mean_inference_ms": 5.2133392508570955, "mean_action_processing_ms": 0.1444551502570423, "mean_env_wait_ms": 0.25255650399528895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015488862991333008, "StateBufferConnector_ms": 0.002332925796508789, "ViewRequirementAgentConnector_ms": 0.06011652946472168}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929231.281598888, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-932608.2962694527, -932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583029233758697, "mean_inference_ms": 5.2133392508570955, "mean_action_processing_ms": 0.1444551502570423, "mean_env_wait_ms": 0.25255650399528895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015488862991333008, "StateBufferConnector_ms": 0.002332925796508789, "ViewRequirementAgentConnector_ms": 0.06011652946472168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47376, "timers": {"training_iteration_time_ms": 3494.127, "learn_time_ms": 1547.35, "learn_throughput": 217.145}, "counters": {"num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "done": false, "episodes_total": 141, "training_iteration": 141, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-27", "timestamp": 1706261007, "time_this_iter_s": 3.510859966278076, "time_total_s": 492.4479913711548, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecddb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd1750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 492.4479913711548, "timesteps_since_restore": 0, "iterations_since_restore": 141, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.74, "ram_util_percent": 27.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.903422355651855, "policy_loss": -0.1631738245487213, "vf_loss": 10.0, "vf_explained_var": 1.9868215517249155e-08, "kl": 0.008661597035825253, "entropy": 12.608320236206055, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12735.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929119.9432657144, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583112244648956, "mean_inference_ms": 5.213412232560715, "mean_action_processing_ms": 0.14445691834470314, "mean_env_wait_ms": 0.25256048830833255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015494346618652344, "StateBufferConnector_ms": 0.002332448959350586, "ViewRequirementAgentConnector_ms": 0.06012225151062012}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -929119.9432657144, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-932765.6760196507, -966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583112244648956, "mean_inference_ms": 5.213412232560715, "mean_action_processing_ms": 0.14445691834470314, "mean_env_wait_ms": 0.25256048830833255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015494346618652344, "StateBufferConnector_ms": 0.002332448959350586, "ViewRequirementAgentConnector_ms": 0.06012225151062012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47712, "timers": {"training_iteration_time_ms": 3493.224, "learn_time_ms": 1548.14, "learn_throughput": 217.035}, "counters": {"num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "done": false, "episodes_total": 142, "training_iteration": 142, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-30", "timestamp": 1706261010, "time_this_iter_s": 3.4799392223358154, "time_total_s": 495.9279305934906, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ece530>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6c4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 495.9279305934906, "timesteps_since_restore": 0, "iterations_since_restore": 142, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 27.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.896364212036133, "policy_loss": -0.17040599882602692, "vf_loss": 10.0, "vf_explained_var": 1.0596381549987655e-08, "kl": 0.00868426077067852, "entropy": 12.524457931518555, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12825.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928811.9337619086, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15831931692092396, "mean_inference_ms": 5.213486234702277, "mean_action_processing_ms": 0.14445878370344156, "mean_env_wait_ms": 0.25256455303705116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015487432479858398, "StateBufferConnector_ms": 0.002330780029296875, "ViewRequirementAgentConnector_ms": 0.0601038932800293}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928811.9337619086, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-966813.9049565839, -930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15831931692092396, "mean_inference_ms": 5.213486234702277, "mean_action_processing_ms": 0.14445878370344156, "mean_env_wait_ms": 0.25256455303705116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015487432479858398, "StateBufferConnector_ms": 0.002330780029296875, "ViewRequirementAgentConnector_ms": 0.0601038932800293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48048, "timers": {"training_iteration_time_ms": 3497.077, "learn_time_ms": 1550.617, "learn_throughput": 216.688}, "counters": {"num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "done": false, "episodes_total": 143, "training_iteration": 143, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-34", "timestamp": 1706261014, "time_this_iter_s": 3.486591339111328, "time_total_s": 499.41452193260193, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecead0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb4a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 499.41452193260193, "timesteps_since_restore": 0, "iterations_since_restore": 143, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.639999999999999, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.90296745300293, "policy_loss": -0.1704559177160263, "vf_loss": 10.0, "vf_explained_var": 2.6490953874969136e-09, "kl": 0.00954954419285059, "entropy": 12.824298858642578, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 12915.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928395.8856991827, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15832741331828173, "mean_inference_ms": 5.21356818841643, "mean_action_processing_ms": 0.14446075537554856, "mean_env_wait_ms": 0.25256850618538507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01549530029296875, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.06012749671936035}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928395.8856991827, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-930895.0782332392, -983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15832741331828173, "mean_inference_ms": 5.21356818841643, "mean_action_processing_ms": 0.14446075537554856, "mean_env_wait_ms": 0.25256850618538507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01549530029296875, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.06012749671936035}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 3500.298, "learn_time_ms": 1552.558, "learn_throughput": 216.417}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "done": false, "episodes_total": 144, "training_iteration": 144, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-37", "timestamp": 1706261017, "time_this_iter_s": 3.5217666625976562, "time_total_s": 502.9362885951996, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eced70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb7910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 502.9362885951996, "timesteps_since_restore": 0, "iterations_since_restore": 144, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5600000000000005, "ram_util_percent": 27.439999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.899599075317383, "policy_loss": -0.17332130670547485, "vf_loss": 10.0, "vf_explained_var": 3.510051271859993e-08, "kl": 0.009484171867370605, "entropy": 12.593862533569336, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13005.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928279.4929277449, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15833534424906062, "mean_inference_ms": 5.21365804116259, "mean_action_processing_ms": 0.1444627717877158, "mean_env_wait_ms": 0.2525726892364854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015484333038330078, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.06010842323303223}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928279.4929277449, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-983666.6111793271, -908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15833534424906062, "mean_inference_ms": 5.21365804116259, "mean_action_processing_ms": 0.1444627717877158, "mean_env_wait_ms": 0.2525726892364854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015484333038330078, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.06010842323303223}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48720, "timers": {"training_iteration_time_ms": 3498.356, "learn_time_ms": 1552.561, "learn_throughput": 216.417}, "counters": {"num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "done": false, "episodes_total": 145, "training_iteration": 145, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-41", "timestamp": 1706261021, "time_this_iter_s": 3.492311477661133, "time_total_s": 506.4286000728607, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd7e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd1510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 506.4286000728607, "timesteps_since_restore": 0, "iterations_since_restore": 145, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 27.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89216423034668, "policy_loss": -0.17615216970443726, "vf_loss": 10.0, "vf_explained_var": 2.582867963951685e-08, "kl": 0.008885437622666359, "entropy": 12.532923698425293, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13095.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -927968.2464534852, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15834367232156962, "mean_inference_ms": 5.213756995627444, "mean_action_processing_ms": 0.14446504775820987, "mean_env_wait_ms": 0.25257728195193274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015514135360717773, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.060125112533569336}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -927968.2464534852, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-908893.7922847894, -917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15834367232156962, "mean_inference_ms": 5.213756995627444, "mean_action_processing_ms": 0.14446504775820987, "mean_env_wait_ms": 0.25257728195193274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015514135360717773, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.060125112533569336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49056, "timers": {"training_iteration_time_ms": 3495.948, "learn_time_ms": 1550.906, "learn_throughput": 216.648}, "counters": {"num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "done": false, "episodes_total": 146, "training_iteration": 146, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-44", "timestamp": 1706261024, "time_this_iter_s": 3.5075559616088867, "time_total_s": 509.9361560344696, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecfcd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb70a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 509.9361560344696, "timesteps_since_restore": 0, "iterations_since_restore": 146, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 27.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89030933380127, "policy_loss": -0.1720997542142868, "vf_loss": 10.0, "vf_explained_var": 1.9868215517249155e-08, "kl": 0.008116858080029488, "entropy": 12.59135627746582, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13185.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -927840.1618148871, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15835159800917387, "mean_inference_ms": 5.213854121977871, "mean_action_processing_ms": 0.1444671978203865, "mean_env_wait_ms": 0.252581184647877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01551365852355957, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.060128211975097656}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -927840.1618148871, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-917327.2517705165, -910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15835159800917387, "mean_inference_ms": 5.213854121977871, "mean_action_processing_ms": 0.1444671978203865, "mean_env_wait_ms": 0.252581184647877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01551365852355957, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.060128211975097656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49392, "timers": {"training_iteration_time_ms": 3494.924, "learn_time_ms": 1551.216, "learn_throughput": 216.604}, "counters": {"num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "done": false, "episodes_total": 147, "training_iteration": 147, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-48", "timestamp": 1706261028, "time_this_iter_s": 3.5038537979125977, "time_total_s": 513.4400098323822, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8062d70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd2170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 513.4400098323822, "timesteps_since_restore": 0, "iterations_since_restore": 147, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 27.840000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.886216163635254, "policy_loss": -0.1726708859205246, "vf_loss": 10.0, "vf_explained_var": 2.1855036891338386e-08, "kl": 0.007658949121832848, "entropy": 12.519946098327637, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13275.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -927752.0560152344, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583592912432982, "mean_inference_ms": 5.2139458026217085, "mean_action_processing_ms": 0.14446921270705373, "mean_env_wait_ms": 0.2525847733440686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015517234802246094, "StateBufferConnector_ms": 0.0023326873779296875, "ViewRequirementAgentConnector_ms": 0.0601351261138916}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -927752.0560152344, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-910814.7023872643, -975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583592912432982, "mean_inference_ms": 5.2139458026217085, "mean_action_processing_ms": 0.14446921270705373, "mean_env_wait_ms": 0.2525847733440686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015517234802246094, "StateBufferConnector_ms": 0.0023326873779296875, "ViewRequirementAgentConnector_ms": 0.0601351261138916}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49728, "timers": {"training_iteration_time_ms": 3492.15, "learn_time_ms": 1548.167, "learn_throughput": 217.031}, "counters": {"num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "done": false, "episodes_total": 148, "training_iteration": 148, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-51", "timestamp": 1706261031, "time_this_iter_s": 3.4708306789398193, "time_total_s": 516.910840511322, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecc730>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb7640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 516.910840511322, "timesteps_since_restore": 0, "iterations_since_restore": 148, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.66, "ram_util_percent": 27.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.887057304382324, "policy_loss": -0.18008147180080414, "vf_loss": 10.0, "vf_explained_var": 2.317958447406454e-08, "kl": 0.008732221089303493, "entropy": 12.66324234008789, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13365.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928231.8635967365, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15836694477907784, "mean_inference_ms": 5.214039403122873, "mean_action_processing_ms": 0.1444713906865138, "mean_env_wait_ms": 0.25258849227895536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015522956848144531, "StateBufferConnector_ms": 0.0023326873779296875, "ViewRequirementAgentConnector_ms": 0.06009817123413086}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1009950.82124743, "episode_reward_mean": -928231.8635967365, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-975955.7055752368, -934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15836694477907784, "mean_inference_ms": 5.214039403122873, "mean_action_processing_ms": 0.1444713906865138, "mean_env_wait_ms": 0.25258849227895536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015522956848144531, "StateBufferConnector_ms": 0.0023326873779296875, "ViewRequirementAgentConnector_ms": 0.06009817123413086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50064, "timers": {"training_iteration_time_ms": 3493.339, "learn_time_ms": 1549.735, "learn_throughput": 216.811}, "counters": {"num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "done": false, "episodes_total": 149, "training_iteration": 149, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-55", "timestamp": 1706261035, "time_this_iter_s": 3.4898664951324463, "time_total_s": 520.4007070064545, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd630>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd2f80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 520.4007070064545, "timesteps_since_restore": 0, "iterations_since_restore": 149, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 28.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89251708984375, "policy_loss": -0.17641612887382507, "vf_loss": 10.0, "vf_explained_var": 7.947286384535346e-09, "kl": 0.008965535089373589, "entropy": 12.641337394714355, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13455.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928591.1360876918, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15837471862026045, "mean_inference_ms": 5.21413574926268, "mean_action_processing_ms": 0.14447370910683147, "mean_env_wait_ms": 0.2525924431355746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015527486801147461, "StateBufferConnector_ms": 0.0023338794708251953, "ViewRequirementAgentConnector_ms": 0.06010246276855469}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928591.1360876918, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-934249.9782294575, -986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15837471862026045, "mean_inference_ms": 5.21413574926268, "mean_action_processing_ms": 0.14447370910683147, "mean_env_wait_ms": 0.2525924431355746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015527486801147461, "StateBufferConnector_ms": 0.0023338794708251953, "ViewRequirementAgentConnector_ms": 0.06010246276855469}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50400, "timers": {"training_iteration_time_ms": 3495.98, "learn_time_ms": 1550.521, "learn_throughput": 216.701}, "counters": {"num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "done": false, "episodes_total": 150, "training_iteration": 150, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-23-59", "timestamp": 1706261039, "time_this_iter_s": 3.500927686691284, "time_total_s": 523.9016346931458, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecc280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb4a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 523.9016346931458, "timesteps_since_restore": 0, "iterations_since_restore": 150, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 28.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.894143104553223, "policy_loss": -0.1745992749929428, "vf_loss": 10.0, "vf_explained_var": 2.1855036891338386e-08, "kl": 0.00894077681005001, "entropy": 12.683759689331055, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13545.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928806.8614399828, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583824264255841, "mean_inference_ms": 5.214223075165746, "mean_action_processing_ms": 0.14447574460504053, "mean_env_wait_ms": 0.2525963073370088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015540361404418945, "StateBufferConnector_ms": 0.002335786819458008, "ViewRequirementAgentConnector_ms": 0.060126543045043945}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928806.8614399828, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-986579.0370738952, -971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1583824264255841, "mean_inference_ms": 5.214223075165746, "mean_action_processing_ms": 0.14447574460504053, "mean_env_wait_ms": 0.2525963073370088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015540361404418945, "StateBufferConnector_ms": 0.002335786819458008, "ViewRequirementAgentConnector_ms": 0.060126543045043945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50736, "timers": {"training_iteration_time_ms": 3496.307, "learn_time_ms": 1553.267, "learn_throughput": 216.318}, "counters": {"num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "done": false, "episodes_total": 151, "training_iteration": 151, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-02", "timestamp": 1706261042, "time_this_iter_s": 3.514092445373535, "time_total_s": 527.4157271385193, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecda50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd2680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 527.4157271385193, "timesteps_since_restore": 0, "iterations_since_restore": 151, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 28.360000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.910967826843262, "policy_loss": -0.16198274493217468, "vf_loss": 10.0, "vf_explained_var": 1.7881394143159923e-08, "kl": 0.009488075040280819, "entropy": 12.415173530578613, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13635.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927954.1657758035, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15839009384532635, "mean_inference_ms": 5.214314164743157, "mean_action_processing_ms": 0.1444777811255266, "mean_env_wait_ms": 0.25260040219707053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015560150146484375, "StateBufferConnector_ms": 0.002337932586669922, "ViewRequirementAgentConnector_ms": 0.06014108657836914}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927954.1657758035, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-971367.224494772, -981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15839009384532635, "mean_inference_ms": 5.214314164743157, "mean_action_processing_ms": 0.1444777811255266, "mean_env_wait_ms": 0.25260040219707053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015560150146484375, "StateBufferConnector_ms": 0.002337932586669922, "ViewRequirementAgentConnector_ms": 0.06014108657836914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 3499.379, "learn_time_ms": 1553.262, "learn_throughput": 216.319}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "done": false, "episodes_total": 152, "training_iteration": 152, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-06", "timestamp": 1706261046, "time_this_iter_s": 3.510662794113159, "time_total_s": 530.9263899326324, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdea0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f5ba30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 530.9263899326324, "timesteps_since_restore": 0, "iterations_since_restore": 152, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.616666666666667, "ram_util_percent": 28.483333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.88448715209961, "policy_loss": -0.17320005595684052, "vf_loss": 10.0, "vf_explained_var": 1.9868215517249155e-08, "kl": 0.007502756081521511, "entropy": 12.556656837463379, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13725.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927910.9545883327, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15839820595479004, "mean_inference_ms": 5.21442149384597, "mean_action_processing_ms": 0.14448018574439792, "mean_env_wait_ms": 0.25260506539855976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0155792236328125, "StateBufferConnector_ms": 0.002339601516723633, "ViewRequirementAgentConnector_ms": 0.06015515327453613}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927910.9545883327, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981620.7289537606, -898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15839820595479004, "mean_inference_ms": 5.21442149384597, "mean_action_processing_ms": 0.14448018574439792, "mean_env_wait_ms": 0.25260506539855976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0155792236328125, "StateBufferConnector_ms": 0.002339601516723633, "ViewRequirementAgentConnector_ms": 0.06015515327453613}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51408, "timers": {"training_iteration_time_ms": 3502.02, "learn_time_ms": 1554.642, "learn_throughput": 216.127}, "counters": {"num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "done": false, "episodes_total": 153, "training_iteration": 153, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-09", "timestamp": 1706261049, "time_this_iter_s": 3.5130090713500977, "time_total_s": 534.4393990039825, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf880>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e10310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 534.4393990039825, "timesteps_since_restore": 0, "iterations_since_restore": 153, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 28.640000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.910185813903809, "policy_loss": -0.1657116413116455, "vf_loss": 10.0, "vf_explained_var": 3.3775965135873776e-08, "kl": 0.009871299378573895, "entropy": 12.365436553955078, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13815.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927220.1640617811, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584064358526637, "mean_inference_ms": 5.214534147502177, "mean_action_processing_ms": 0.14448267165089368, "mean_env_wait_ms": 0.25261000190591626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015575408935546875, "StateBufferConnector_ms": 0.0023403167724609375, "ViewRequirementAgentConnector_ms": 0.06019115447998047}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927220.1640617811, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-898552.8371224839, -910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584064358526637, "mean_inference_ms": 5.214534147502177, "mean_action_processing_ms": 0.14448267165089368, "mean_env_wait_ms": 0.25261000190591626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015575408935546875, "StateBufferConnector_ms": 0.0023403167724609375, "ViewRequirementAgentConnector_ms": 0.06019115447998047}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51744, "timers": {"training_iteration_time_ms": 3500.154, "learn_time_ms": 1553.386, "learn_throughput": 216.302}, "counters": {"num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "done": false, "episodes_total": 154, "training_iteration": 154, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-13", "timestamp": 1706261053, "time_this_iter_s": 3.5030922889709473, "time_total_s": 537.9424912929535, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecccd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7f6e050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 537.9424912929535, "timesteps_since_restore": 0, "iterations_since_restore": 154, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 28.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.883400917053223, "policy_loss": -0.17916223406791687, "vf_loss": 10.0, "vf_explained_var": 2.317958447406454e-08, "kl": 0.008137223310768604, "entropy": 12.609092712402344, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13905.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928007.0920271417, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15841515831323336, "mean_inference_ms": 5.214662439049485, "mean_action_processing_ms": 0.14448568864723663, "mean_env_wait_ms": 0.25261579733066203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015576839447021484, "StateBufferConnector_ms": 0.0023419857025146484, "ViewRequirementAgentConnector_ms": 0.06018543243408203}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928007.0920271417, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-910502.6694591047, -946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15841515831323336, "mean_inference_ms": 5.214662439049485, "mean_action_processing_ms": 0.14448568864723663, "mean_env_wait_ms": 0.25261579733066203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015576839447021484, "StateBufferConnector_ms": 0.0023419857025146484, "ViewRequirementAgentConnector_ms": 0.06018543243408203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52080, "timers": {"training_iteration_time_ms": 3503.015, "learn_time_ms": 1554.255, "learn_throughput": 216.181}, "counters": {"num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "done": false, "episodes_total": 155, "training_iteration": 155, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-16", "timestamp": 1706261056, "time_this_iter_s": 3.520954132080078, "time_total_s": 541.4634454250336, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecec50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e10a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 541.4634454250336, "timesteps_since_restore": 0, "iterations_since_restore": 155, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.64, "ram_util_percent": 28.880000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89298152923584, "policy_loss": -0.17194540798664093, "vf_loss": 10.0, "vf_explained_var": 1.655684656043377e-08, "kl": 0.008444474078714848, "entropy": 12.520122528076172, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 13995.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928066.5133508863, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15842412381119883, "mean_inference_ms": 5.214794526631955, "mean_action_processing_ms": 0.14448890236042194, "mean_env_wait_ms": 0.2526221620365675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015586376190185547, "StateBufferConnector_ms": 0.002342700958251953, "ViewRequirementAgentConnector_ms": 0.060202836990356445}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928066.5133508863, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-946009.2813694461, -935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15842412381119883, "mean_inference_ms": 5.214794526631955, "mean_action_processing_ms": 0.14448890236042194, "mean_env_wait_ms": 0.2526221620365675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015586376190185547, "StateBufferConnector_ms": 0.002342700958251953, "ViewRequirementAgentConnector_ms": 0.060202836990356445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52416, "timers": {"training_iteration_time_ms": 3504.317, "learn_time_ms": 1553.914, "learn_throughput": 216.228}, "counters": {"num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "done": false, "episodes_total": 156, "training_iteration": 156, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-20", "timestamp": 1706261060, "time_this_iter_s": 3.5205886363983154, "time_total_s": 544.9840340614319, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eccd00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb7490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 544.9840340614319, "timesteps_since_restore": 0, "iterations_since_restore": 156, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.639999999999999, "ram_util_percent": 29.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.887903213500977, "policy_loss": -0.17618420720100403, "vf_loss": 10.0, "vf_explained_var": 4.1060978617224464e-08, "kl": 0.00833525788038969, "entropy": 12.449758529663086, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14085.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928134.9783011121, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15843292523146021, "mean_inference_ms": 5.214928271584204, "mean_action_processing_ms": 0.1444921778519666, "mean_env_wait_ms": 0.2526283928626253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015596628189086914, "StateBufferConnector_ms": 0.002341032028198242, "ViewRequirementAgentConnector_ms": 0.06021308898925781}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928134.9783011121, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-935025.0934122688, -964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15843292523146021, "mean_inference_ms": 5.214928271584204, "mean_action_processing_ms": 0.1444921778519666, "mean_env_wait_ms": 0.2526283928626253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015596628189086914, "StateBufferConnector_ms": 0.002341032028198242, "ViewRequirementAgentConnector_ms": 0.06021308898925781}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52752, "timers": {"training_iteration_time_ms": 3504.416, "learn_time_ms": 1554.272, "learn_throughput": 216.178}, "counters": {"num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "done": false, "episodes_total": 157, "training_iteration": 157, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-23", "timestamp": 1706261063, "time_this_iter_s": 3.504810333251953, "time_total_s": 548.4888443946838, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf4f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e100d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 548.4888443946838, "timesteps_since_restore": 0, "iterations_since_restore": 157, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 29.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.893998146057129, "policy_loss": -0.17395468056201935, "vf_loss": 10.0, "vf_explained_var": 3.443824070359369e-08, "kl": 0.00883804727345705, "entropy": 12.49015998840332, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928140.700934689, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584416591915798, "mean_inference_ms": 5.215063396708064, "mean_action_processing_ms": 0.14449550850557022, "mean_env_wait_ms": 0.2526344428929044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015591859817504883, "StateBufferConnector_ms": 0.0023415088653564453, "ViewRequirementAgentConnector_ms": 0.06020975112915039}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -928140.700934689, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-964185.3356855954, -946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584416591915798, "mean_inference_ms": 5.215063396708064, "mean_action_processing_ms": 0.14449550850557022, "mean_env_wait_ms": 0.2526344428929044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015591859817504883, "StateBufferConnector_ms": 0.0023415088653564453, "ViewRequirementAgentConnector_ms": 0.06020975112915039}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53088, "timers": {"training_iteration_time_ms": 3507.719, "learn_time_ms": 1556.65, "learn_throughput": 215.848}, "counters": {"num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "done": false, "episodes_total": 158, "training_iteration": 158, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-27", "timestamp": 1706261067, "time_this_iter_s": 3.5038678646087646, "time_total_s": 551.9927122592926, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecf550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb4a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 551.9927122592926, "timesteps_since_restore": 0, "iterations_since_restore": 158, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.779999999999999, "ram_util_percent": 29.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89352035522461, "policy_loss": -0.1710425466299057, "vf_loss": 10.0, "vf_explained_var": 1.9868215961338365e-09, "kl": 0.008397091180086136, "entropy": 12.475824356079102, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14265.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927979.24266584, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584504871145767, "mean_inference_ms": 5.215199683426555, "mean_action_processing_ms": 0.14449913200786085, "mean_env_wait_ms": 0.25264101672449363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015594005584716797, "StateBufferConnector_ms": 0.0023407936096191406, "ViewRequirementAgentConnector_ms": 0.06020474433898926}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927979.24266584, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-946446.3275785471, -926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584504871145767, "mean_inference_ms": 5.215199683426555, "mean_action_processing_ms": 0.14449913200786085, "mean_env_wait_ms": 0.25264101672449363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015594005584716797, "StateBufferConnector_ms": 0.0023407936096191406, "ViewRequirementAgentConnector_ms": 0.06020474433898926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53424, "timers": {"training_iteration_time_ms": 3509.024, "learn_time_ms": 1556.838, "learn_throughput": 215.822}, "counters": {"num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "done": false, "episodes_total": 159, "training_iteration": 159, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-30", "timestamp": 1706261070, "time_this_iter_s": 3.5029263496398926, "time_total_s": 555.4956386089325, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18610>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e12170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 555.4956386089325, "timesteps_since_restore": 0, "iterations_since_restore": 159, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 29.439999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.890378952026367, "policy_loss": -0.17608602344989777, "vf_loss": 10.0, "vf_explained_var": 2.7153227222243004e-08, "kl": 0.008644548244774342, "entropy": 12.250646591186523, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14355.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927662.8961064874, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584594505818402, "mean_inference_ms": 5.215336428109181, "mean_action_processing_ms": 0.14450296274327323, "mean_env_wait_ms": 0.2526479381772393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015592575073242188, "StateBufferConnector_ms": 0.002341747283935547, "ViewRequirementAgentConnector_ms": 0.060185909271240234}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927662.8961064874, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-926667.6400715195, -942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584594505818402, "mean_inference_ms": 5.215336428109181, "mean_action_processing_ms": 0.14450296274327323, "mean_env_wait_ms": 0.2526479381772393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015592575073242188, "StateBufferConnector_ms": 0.002341747283935547, "ViewRequirementAgentConnector_ms": 0.060185909271240234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 3513.29, "learn_time_ms": 1558.346, "learn_throughput": 215.613}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 160, "training_iteration": 160, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-34", "timestamp": 1706261074, "time_this_iter_s": 3.543588638305664, "time_total_s": 559.0392272472382, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecc280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd2170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 559.0392272472382, "timesteps_since_restore": 0, "iterations_since_restore": 160, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.539999999999999, "ram_util_percent": 29.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89179515838623, "policy_loss": -0.17404083907604218, "vf_loss": 10.0, "vf_explained_var": 1.4570024298166118e-08, "kl": 0.008562668226659298, "entropy": 12.555397987365723, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14445.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927678.3975884897, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15846798690498068, "mean_inference_ms": 5.215471979984478, "mean_action_processing_ms": 0.14450664928397802, "mean_env_wait_ms": 0.25265484622671097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015591621398925781, "StateBufferConnector_ms": 0.0023441314697265625, "ViewRequirementAgentConnector_ms": 0.06017780303955078}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927678.3975884897, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-942926.6246604724, -920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15846798690498068, "mean_inference_ms": 5.215471979984478, "mean_action_processing_ms": 0.14450664928397802, "mean_env_wait_ms": 0.25265484622671097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015591621398925781, "StateBufferConnector_ms": 0.0023441314697265625, "ViewRequirementAgentConnector_ms": 0.06017780303955078}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54096, "timers": {"training_iteration_time_ms": 3512.195, "learn_time_ms": 1556.389, "learn_throughput": 215.884}, "counters": {"num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "done": false, "episodes_total": 161, "training_iteration": 161, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-37", "timestamp": 1706261077, "time_this_iter_s": 3.5031728744506836, "time_total_s": 562.5424001216888, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19420>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e12a70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 562.5424001216888, "timesteps_since_restore": 0, "iterations_since_restore": 161, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 29.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89001750946045, "policy_loss": -0.17780479788780212, "vf_loss": 10.0, "vf_explained_var": 3.510051271859993e-08, "kl": 0.008821098133921623, "entropy": 12.459771156311035, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14535.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927065.8170560219, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15847626318494273, "mean_inference_ms": 5.215609236513451, "mean_action_processing_ms": 0.1445103723668294, "mean_env_wait_ms": 0.2526617323514701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015594959259033203, "StateBufferConnector_ms": 0.002343893051147461, "ViewRequirementAgentConnector_ms": 0.06017804145812988}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927065.8170560219, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-920169.934481136, -947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15847626318494273, "mean_inference_ms": 5.215609236513451, "mean_action_processing_ms": 0.1445103723668294, "mean_env_wait_ms": 0.2526617323514701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015594959259033203, "StateBufferConnector_ms": 0.002343893051147461, "ViewRequirementAgentConnector_ms": 0.06017804145812988}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54432, "timers": {"training_iteration_time_ms": 3512.289, "learn_time_ms": 1557.195, "learn_throughput": 215.773}, "counters": {"num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "done": false, "episodes_total": 162, "training_iteration": 162, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-41", "timestamp": 1706261081, "time_this_iter_s": 3.511603832244873, "time_total_s": 566.0540039539337, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd840>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7fb5fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 566.0540039539337, "timesteps_since_restore": 0, "iterations_since_restore": 162, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.720000000000001, "ram_util_percent": 29.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.911674499511719, "policy_loss": -0.1727130115032196, "vf_loss": 10.0, "vf_explained_var": 2.2517310682701464e-08, "kl": 0.010975598357617855, "entropy": 12.562894821166992, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14625.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926911.1749075376, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15848436148257458, "mean_inference_ms": 5.215742663785246, "mean_action_processing_ms": 0.1445140187890321, "mean_env_wait_ms": 0.2526687442094969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015610933303833008, "StateBufferConnector_ms": 0.0023453235626220703, "ViewRequirementAgentConnector_ms": 0.06021380424499512}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926911.1749075376, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-947316.0670828698, -946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15848436148257458, "mean_inference_ms": 5.215742663785246, "mean_action_processing_ms": 0.1445140187890321, "mean_env_wait_ms": 0.2526687442094969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015610933303833008, "StateBufferConnector_ms": 0.0023453235626220703, "ViewRequirementAgentConnector_ms": 0.06021380424499512}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54768, "timers": {"training_iteration_time_ms": 3511.86, "learn_time_ms": 1555.68, "learn_throughput": 215.983}, "counters": {"num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "done": false, "episodes_total": 163, "training_iteration": 163, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-45", "timestamp": 1706261085, "time_this_iter_s": 3.5087246894836426, "time_total_s": 569.5627286434174, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eceaa0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e11fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 569.5627286434174, "timesteps_since_restore": 0, "iterations_since_restore": 163, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 29.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.901785850524902, "policy_loss": -0.16756895184516907, "vf_loss": 10.0, "vf_explained_var": 1.9868215517249155e-08, "kl": 0.009020415134727955, "entropy": 12.583906173706055, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14715.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926932.2809648571, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15849223508028776, "mean_inference_ms": 5.215868104503649, "mean_action_processing_ms": 0.14451763110812388, "mean_env_wait_ms": 0.2526756017325232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015611410140991211, "StateBufferConnector_ms": 0.0023462772369384766, "ViewRequirementAgentConnector_ms": 0.0601954460144043}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926932.2809648571, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-946613.653036124, -919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15849223508028776, "mean_inference_ms": 5.215868104503649, "mean_action_processing_ms": 0.14451763110812388, "mean_env_wait_ms": 0.2526756017325232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015611410140991211, "StateBufferConnector_ms": 0.0023462772369384766, "ViewRequirementAgentConnector_ms": 0.0601954460144043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55104, "timers": {"training_iteration_time_ms": 3512.389, "learn_time_ms": 1556.32, "learn_throughput": 215.894}, "counters": {"num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "done": false, "episodes_total": 164, "training_iteration": 164, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-48", "timestamp": 1706261088, "time_this_iter_s": 3.5083703994750977, "time_total_s": 573.0710990428925, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19f90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e13f40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 573.0710990428925, "timesteps_since_restore": 0, "iterations_since_restore": 164, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.700000000000001, "ram_util_percent": 30.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.890731811523438, "policy_loss": -0.17209334671497345, "vf_loss": 10.0, "vf_explained_var": 1.9868215517249155e-08, "kl": 0.008171157911419868, "entropy": 12.426462173461914, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14805.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926460.5962937813, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584998786634394, "mean_inference_ms": 5.215996511329702, "mean_action_processing_ms": 0.14452129194456098, "mean_env_wait_ms": 0.25268270999633013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015594005584716797, "StateBufferConnector_ms": 0.002346038818359375, "ViewRequirementAgentConnector_ms": 0.06016945838928223}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926460.5962937813, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-919812.9803268043, -918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584998786634394, "mean_inference_ms": 5.215996511329702, "mean_action_processing_ms": 0.14452129194456098, "mean_env_wait_ms": 0.25268270999633013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015594005584716797, "StateBufferConnector_ms": 0.002346038818359375, "ViewRequirementAgentConnector_ms": 0.06016945838928223}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55440, "timers": {"training_iteration_time_ms": 3511.086, "learn_time_ms": 1554.992, "learn_throughput": 216.078}, "counters": {"num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "done": false, "episodes_total": 165, "training_iteration": 165, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-52", "timestamp": 1706261092, "time_this_iter_s": 3.507903575897217, "time_total_s": 576.5790026187897, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eccf10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e12b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 576.5790026187897, "timesteps_since_restore": 0, "iterations_since_restore": 165, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5600000000000005, "ram_util_percent": 30.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89838981628418, "policy_loss": -0.168864905834198, "vf_loss": 10.0, "vf_explained_var": 2.582867963951685e-08, "kl": 0.008747280575335026, "entropy": 12.540852546691895, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14895.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926430.892758525, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585074501070346, "mean_inference_ms": 5.216122762758403, "mean_action_processing_ms": 0.14452492518094323, "mean_env_wait_ms": 0.252689801946604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015590429306030273, "StateBufferConnector_ms": 0.0023453235626220703, "ViewRequirementAgentConnector_ms": 0.060120344161987305}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926430.892758525, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-918262.8796402428, -850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585074501070346, "mean_inference_ms": 5.216122762758403, "mean_action_processing_ms": 0.14452492518094323, "mean_env_wait_ms": 0.252689801946604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015590429306030273, "StateBufferConnector_ms": 0.0023453235626220703, "ViewRequirementAgentConnector_ms": 0.060120344161987305}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55776, "timers": {"training_iteration_time_ms": 3506.513, "learn_time_ms": 1552.545, "learn_throughput": 216.419}, "counters": {"num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "done": false, "episodes_total": 166, "training_iteration": 166, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-55", "timestamp": 1706261095, "time_this_iter_s": 3.4748828411102295, "time_total_s": 580.0538854598999, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19e70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e38160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 580.0538854598999, "timesteps_since_restore": 0, "iterations_since_restore": 166, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.56, "ram_util_percent": 30.360000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.88298511505127, "policy_loss": -0.18192557990550995, "vf_loss": 10.0, "vf_explained_var": 3.311369312086754e-08, "kl": 0.008442460559308529, "entropy": 12.587778091430664, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 14985.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "sampler_results": {"episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926823.668972263, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15851493099547415, "mean_inference_ms": 5.216240328100727, "mean_action_processing_ms": 0.14452823761329578, "mean_env_wait_ms": 0.25269644522919915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015573740005493164, "StateBufferConnector_ms": 0.002347707748413086, "ViewRequirementAgentConnector_ms": 0.06012082099914551}}, "episode_reward_max": -850415.4552225135, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926823.668972263, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-850415.4552225135, -967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15851493099547415, "mean_inference_ms": 5.216240328100727, "mean_action_processing_ms": 0.14452823761329578, "mean_env_wait_ms": 0.25269644522919915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015573740005493164, "StateBufferConnector_ms": 0.002347707748413086, "ViewRequirementAgentConnector_ms": 0.06012082099914551}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56112, "timers": {"training_iteration_time_ms": 3504.732, "learn_time_ms": 1551.8, "learn_throughput": 216.523}, "counters": {"num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "done": false, "episodes_total": 167, "training_iteration": 167, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-24-59", "timestamp": 1706261099, "time_this_iter_s": 3.487016201019287, "time_total_s": 583.5409016609192, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8093460>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e13be0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 583.5409016609192, "timesteps_since_restore": 0, "iterations_since_restore": 167, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 30.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.902115821838379, "policy_loss": -0.16768167912960052, "vf_loss": 10.0, "vf_explained_var": 2.1855036891338386e-08, "kl": 0.009077939204871655, "entropy": 12.417914390563965, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15075.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927718.4727407432, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585222382921619, "mean_inference_ms": 5.216359202179779, "mean_action_processing_ms": 0.14453124703036344, "mean_env_wait_ms": 0.25270280728690603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015576839447021484, "StateBufferConnector_ms": 0.002348184585571289, "ViewRequirementAgentConnector_ms": 0.06012558937072754}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927718.4727407432, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-967616.580313923, -911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585222382921619, "mean_inference_ms": 5.216359202179779, "mean_action_processing_ms": 0.14453124703036344, "mean_env_wait_ms": 0.25270280728690603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015576839447021484, "StateBufferConnector_ms": 0.002348184585571289, "ViewRequirementAgentConnector_ms": 0.06012558937072754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 3522.186, "learn_time_ms": 1566.173, "learn_throughput": 214.536}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "done": false, "episodes_total": 168, "training_iteration": 168, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-02", "timestamp": 1706261102, "time_this_iter_s": 3.67842960357666, "time_total_s": 587.2193312644958, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8110760>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee80dfeb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 587.2193312644958, "timesteps_since_restore": 0, "iterations_since_restore": 168, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.64, "ram_util_percent": 30.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.896446228027344, "policy_loss": -0.1729487031698227, "vf_loss": 10.0, "vf_explained_var": 3.5762788286319847e-08, "kl": 0.009025579318404198, "entropy": 12.599651336669922, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15165.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927081.6817637319, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15852945010153804, "mean_inference_ms": 5.216471494978825, "mean_action_processing_ms": 0.14453420998467167, "mean_env_wait_ms": 0.2527086205992638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015570402145385742, "StateBufferConnector_ms": 0.0023479461669921875, "ViewRequirementAgentConnector_ms": 0.06012415885925293}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927081.6817637319, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-911333.6099392824, -943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15852945010153804, "mean_inference_ms": 5.216471494978825, "mean_action_processing_ms": 0.14453420998467167, "mean_env_wait_ms": 0.2527086205992638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015570402145385742, "StateBufferConnector_ms": 0.0023479461669921875, "ViewRequirementAgentConnector_ms": 0.06012415885925293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56784, "timers": {"training_iteration_time_ms": 3522.371, "learn_time_ms": 1566.143, "learn_throughput": 214.54}, "counters": {"num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "done": false, "episodes_total": 169, "training_iteration": 169, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-06", "timestamp": 1706261106, "time_this_iter_s": 3.504782199859619, "time_total_s": 590.7241134643555, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80fea40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e13520>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 590.7241134643555, "timesteps_since_restore": 0, "iterations_since_restore": 169, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 6.5600000000000005, "ram_util_percent": 30.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.89543628692627, "policy_loss": -0.16951778531074524, "vf_loss": 10.0, "vf_explained_var": 1.1258655341350732e-08, "kl": 0.008447968401014805, "entropy": 12.468368530273438, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15255.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927195.8202431451, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585365293464482, "mean_inference_ms": 5.216581218806385, "mean_action_processing_ms": 0.14453699298927172, "mean_env_wait_ms": 0.2527140933994607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01558828353881836, "StateBufferConnector_ms": 0.002347230911254883, "ViewRequirementAgentConnector_ms": 0.06014823913574219}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927195.8202431451, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-943296.3770804842, -978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585365293464482, "mean_inference_ms": 5.216581218806385, "mean_action_processing_ms": 0.14453699298927172, "mean_env_wait_ms": 0.2527140933994607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01558828353881836, "StateBufferConnector_ms": 0.002347230911254883, "ViewRequirementAgentConnector_ms": 0.06014823913574219}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57120, "timers": {"training_iteration_time_ms": 3520.747, "learn_time_ms": 1565.138, "learn_throughput": 214.678}, "counters": {"num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "done": false, "episodes_total": 170, "training_iteration": 170, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-09", "timestamp": 1706261109, "time_this_iter_s": 3.5273451805114746, "time_total_s": 594.251458644867, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80fc0d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e123b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 594.251458644867, "timesteps_since_restore": 0, "iterations_since_restore": 170, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 30.880000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.891081809997559, "policy_loss": -0.18026767671108246, "vf_loss": 10.0, "vf_explained_var": 7.947286384535346e-09, "kl": 0.009279956109821796, "entropy": 12.4317626953125, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927077.7544462383, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15854347574112798, "mean_inference_ms": 5.2166928532382295, "mean_action_processing_ms": 0.14453963941555592, "mean_env_wait_ms": 0.25271911347229076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015589714050292969, "StateBufferConnector_ms": 0.0023458003997802734, "ViewRequirementAgentConnector_ms": 0.06015801429748535}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -927077.7544462383, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-978675.8867834479, -994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15854347574112798, "mean_inference_ms": 5.2166928532382295, "mean_action_processing_ms": 0.14453963941555592, "mean_env_wait_ms": 0.25271911347229076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015589714050292969, "StateBufferConnector_ms": 0.0023458003997802734, "ViewRequirementAgentConnector_ms": 0.06015801429748535}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57456, "timers": {"training_iteration_time_ms": 3524.102, "learn_time_ms": 1564.638, "learn_throughput": 214.746}, "counters": {"num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "done": false, "episodes_total": 171, "training_iteration": 171, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-13", "timestamp": 1706261113, "time_this_iter_s": 3.5367233753204346, "time_total_s": 597.7881820201874, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80fda20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e13400>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 597.7881820201874, "timesteps_since_restore": 0, "iterations_since_restore": 171, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 31.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.900014877319336, "policy_loss": -0.1730039417743683, "vf_loss": 10.0, "vf_explained_var": 1.7219120351796846e-08, "kl": 0.009496989659965038, "entropy": 12.514725685119629, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926704.0576115985, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15855072128069322, "mean_inference_ms": 5.2168096903151, "mean_action_processing_ms": 0.14454246954686367, "mean_env_wait_ms": 0.252724492103016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015599489212036133, "StateBufferConnector_ms": 0.0023462772369384766, "ViewRequirementAgentConnector_ms": 0.0601809024810791}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926704.0576115985, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-994037.6051321487, -963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15855072128069322, "mean_inference_ms": 5.2168096903151, "mean_action_processing_ms": 0.14454246954686367, "mean_env_wait_ms": 0.252724492103016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015599489212036133, "StateBufferConnector_ms": 0.0023462772369384766, "ViewRequirementAgentConnector_ms": 0.0601809024810791}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57792, "timers": {"training_iteration_time_ms": 3522.244, "learn_time_ms": 1562.958, "learn_throughput": 214.977}, "counters": {"num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "done": false, "episodes_total": 172, "training_iteration": 172, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-17", "timestamp": 1706261117, "time_this_iter_s": 3.492990016937256, "time_total_s": 601.2811720371246, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80fe500>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e10430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 601.2811720371246, "timesteps_since_restore": 0, "iterations_since_restore": 172, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.5600000000000005, "ram_util_percent": 31.140000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.893253326416016, "policy_loss": -0.17392730712890625, "vf_loss": 10.0, "vf_explained_var": 1.3245476715439963e-08, "kl": 0.00873758364468813, "entropy": 12.45881175994873, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15525.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925719.2434628605, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585579433542114, "mean_inference_ms": 5.216921414521631, "mean_action_processing_ms": 0.14454538004787543, "mean_env_wait_ms": 0.25272983605768123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015591859817504883, "StateBufferConnector_ms": 0.0023474693298339844, "ViewRequirementAgentConnector_ms": 0.06017446517944336}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925719.2434628605, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-963835.6185751638, -928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585579433542114, "mean_inference_ms": 5.216921414521631, "mean_action_processing_ms": 0.14454538004787543, "mean_env_wait_ms": 0.25272983605768123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015591859817504883, "StateBufferConnector_ms": 0.0023474693298339844, "ViewRequirementAgentConnector_ms": 0.06017446517944336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58128, "timers": {"training_iteration_time_ms": 3520.348, "learn_time_ms": 1562.549, "learn_throughput": 215.033}, "counters": {"num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "done": false, "episodes_total": 173, "training_iteration": 173, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-20", "timestamp": 1706261120, "time_this_iter_s": 3.489755868911743, "time_total_s": 604.7709279060364, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8058880>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd27a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 604.7709279060364, "timesteps_since_restore": 0, "iterations_since_restore": 173, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 31.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.891718864440918, "policy_loss": -0.17420843243598938, "vf_loss": 10.0, "vf_explained_var": 1.1258655341350732e-08, "kl": 0.008574639447033405, "entropy": 12.443824768066406, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15615.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925776.0339439426, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15856506253935682, "mean_inference_ms": 5.217030176320878, "mean_action_processing_ms": 0.14454825062897222, "mean_env_wait_ms": 0.25273496763805836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015573501586914062, "StateBufferConnector_ms": 0.002343416213989258, "ViewRequirementAgentConnector_ms": 0.060160160064697266}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925776.0339439426, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-928187.0615233454, -978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15856506253935682, "mean_inference_ms": 5.217030176320878, "mean_action_processing_ms": 0.14454825062897222, "mean_env_wait_ms": 0.25273496763805836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015573501586914062, "StateBufferConnector_ms": 0.002343416213989258, "ViewRequirementAgentConnector_ms": 0.060160160064697266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58464, "timers": {"training_iteration_time_ms": 3520.141, "learn_time_ms": 1563.202, "learn_throughput": 214.943}, "counters": {"num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "done": false, "episodes_total": 174, "training_iteration": 174, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-24", "timestamp": 1706261124, "time_this_iter_s": 3.5063064098358154, "time_total_s": 608.2772343158722, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8059090>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd3490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 608.2772343158722, "timesteps_since_restore": 0, "iterations_since_restore": 174, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.55, "ram_util_percent": 31.416666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.888391494750977, "policy_loss": -0.17543740570545197, "vf_loss": 10.0, "vf_explained_var": 1.3245476715439963e-08, "kl": 0.0083015700802207, "entropy": 12.398810386657715, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15705.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925586.9613357768, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15857207841008356, "mean_inference_ms": 5.2171408919585165, "mean_action_processing_ms": 0.14455109890383555, "mean_env_wait_ms": 0.2527401524617412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01555323600769043, "StateBufferConnector_ms": 0.00234222412109375, "ViewRequirementAgentConnector_ms": 0.06016802787780762}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925586.9613357768, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-978700.8111041469, -913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15857207841008356, "mean_inference_ms": 5.2171408919585165, "mean_action_processing_ms": 0.14455109890383555, "mean_env_wait_ms": 0.2527401524617412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01555323600769043, "StateBufferConnector_ms": 0.00234222412109375, "ViewRequirementAgentConnector_ms": 0.06016802787780762}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58800, "timers": {"training_iteration_time_ms": 3521.866, "learn_time_ms": 1564.616, "learn_throughput": 214.749}, "counters": {"num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "done": false, "episodes_total": 175, "training_iteration": 175, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-27", "timestamp": 1706261127, "time_this_iter_s": 3.52516508102417, "time_total_s": 611.8023993968964, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80598d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7dd20e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 611.8023993968964, "timesteps_since_restore": 0, "iterations_since_restore": 175, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.760000000000001, "ram_util_percent": 31.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.87230110168457, "policy_loss": -0.16685894131660461, "vf_loss": 9.968033790588379, "vf_explained_var": 2.847777409442642e-07, "kl": 0.009250839240849018, "entropy": 12.213628768920898, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15795.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924956.4330672106, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15857906481431536, "mean_inference_ms": 5.21724504945496, "mean_action_processing_ms": 0.14455389793657594, "mean_env_wait_ms": 0.25274527263140384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015564680099487305, "StateBufferConnector_ms": 0.0023419857025146484, "ViewRequirementAgentConnector_ms": 0.06019878387451172}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924956.4330672106, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-913591.5827456405, -938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15857906481431536, "mean_inference_ms": 5.21724504945496, "mean_action_processing_ms": 0.14455389793657594, "mean_env_wait_ms": 0.25274527263140384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015564680099487305, "StateBufferConnector_ms": 0.0023419857025146484, "ViewRequirementAgentConnector_ms": 0.06019878387451172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 3526.541, "learn_time_ms": 1568.459, "learn_throughput": 214.223}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "done": false, "episodes_total": 176, "training_iteration": 176, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-31", "timestamp": 1706261131, "time_this_iter_s": 3.5216047763824463, "time_total_s": 615.3240041732788, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8058a60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e39240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 615.3240041732788, "timesteps_since_restore": 0, "iterations_since_restore": 176, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 31.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.893426895141602, "policy_loss": -0.1782187819480896, "vf_loss": 10.0, "vf_explained_var": 6.17901491750672e-07, "kl": 0.009318363852798939, "entropy": 12.39263916015625, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15885.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925529.5788717446, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15858607092268148, "mean_inference_ms": 5.217348040996802, "mean_action_processing_ms": 0.1445567612023874, "mean_env_wait_ms": 0.25275044370516797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015577316284179688, "StateBufferConnector_ms": 0.002342700958251953, "ViewRequirementAgentConnector_ms": 0.06019234657287598}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925529.5788717446, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-938255.5949171743, -893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15858607092268148, "mean_inference_ms": 5.217348040996802, "mean_action_processing_ms": 0.1445567612023874, "mean_env_wait_ms": 0.25275044370516797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015577316284179688, "StateBufferConnector_ms": 0.002342700958251953, "ViewRequirementAgentConnector_ms": 0.06019234657287598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59472, "timers": {"training_iteration_time_ms": 3529.351, "learn_time_ms": 1570.214, "learn_throughput": 213.984}, "counters": {"num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "done": false, "episodes_total": 177, "training_iteration": 177, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-34", "timestamp": 1706261134, "time_this_iter_s": 3.515155792236328, "time_total_s": 618.8391599655151, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee805b670>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e395a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 618.8391599655151, "timesteps_since_restore": 0, "iterations_since_restore": 177, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 31.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.889936447143555, "policy_loss": -0.17506399750709534, "vf_loss": 10.0, "vf_explained_var": 8.728769103072409e-07, "kl": 0.008453922346234322, "entropy": 12.307392120361328, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 15975.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925143.6301835926, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585928556849978, "mean_inference_ms": 5.2174425753517175, "mean_action_processing_ms": 0.14455941488583327, "mean_env_wait_ms": 0.25275516356914224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01559758186340332, "StateBufferConnector_ms": 0.002342700958251953, "ViewRequirementAgentConnector_ms": 0.06018376350402832}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925143.6301835926, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-893765.6699769646, -939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585928556849978, "mean_inference_ms": 5.2174425753517175, "mean_action_processing_ms": 0.14455941488583327, "mean_env_wait_ms": 0.25275516356914224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01559758186340332, "StateBufferConnector_ms": 0.002342700958251953, "ViewRequirementAgentConnector_ms": 0.06018376350402832}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59808, "timers": {"training_iteration_time_ms": 3512.713, "learn_time_ms": 1556.932, "learn_throughput": 215.809}, "counters": {"num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "done": false, "episodes_total": 178, "training_iteration": 178, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-38", "timestamp": 1706261138, "time_this_iter_s": 3.5120222568511963, "time_total_s": 622.3511822223663, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8048a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e39ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 622.3511822223663, "timesteps_since_restore": 0, "iterations_since_restore": 178, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.720000000000001, "ram_util_percent": 31.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.91347599029541, "policy_loss": -0.16832870244979858, "vf_loss": 10.0, "vf_explained_var": 7.7684723009952e-07, "kl": 0.01063951663672924, "entropy": 12.35519027709961, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925664.0401930609, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585997806370415, "mean_inference_ms": 5.217537919402457, "mean_action_processing_ms": 0.14456216736025618, "mean_env_wait_ms": 0.252760184373984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015600919723510742, "StateBufferConnector_ms": 0.00234222412109375, "ViewRequirementAgentConnector_ms": 0.06021523475646973}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925664.0401930609, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-939634.0506514751, -938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585997806370415, "mean_inference_ms": 5.217537919402457, "mean_action_processing_ms": 0.14456216736025618, "mean_env_wait_ms": 0.252760184373984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015600919723510742, "StateBufferConnector_ms": 0.00234222412109375, "ViewRequirementAgentConnector_ms": 0.06021523475646973}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60144, "timers": {"training_iteration_time_ms": 3513.458, "learn_time_ms": 1558.051, "learn_throughput": 215.654}, "counters": {"num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "done": false, "episodes_total": 179, "training_iteration": 179, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-41", "timestamp": 1706261141, "time_this_iter_s": 3.512238025665283, "time_total_s": 625.8634202480316, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8058a90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e39a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 625.8634202480316, "timesteps_since_restore": 0, "iterations_since_restore": 179, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 32.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.882376670837402, "policy_loss": -0.18296511471271515, "vf_loss": 10.0, "vf_explained_var": 3.788206299759622e-07, "kl": 0.00849850382655859, "entropy": 12.26127815246582, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16155.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925541.3594919421, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15860668641372566, "mean_inference_ms": 5.217634698201381, "mean_action_processing_ms": 0.14456492638430243, "mean_env_wait_ms": 0.2527655528257885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015613317489624023, "StateBufferConnector_ms": 0.0023429393768310547, "ViewRequirementAgentConnector_ms": 0.06023001670837402}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925541.3594919421, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-938325.8779454611, -902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15860668641372566, "mean_inference_ms": 5.217634698201381, "mean_action_processing_ms": 0.14456492638430243, "mean_env_wait_ms": 0.2527655528257885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015613317489624023, "StateBufferConnector_ms": 0.0023429393768310547, "ViewRequirementAgentConnector_ms": 0.06023001670837402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60480, "timers": {"training_iteration_time_ms": 3513.697, "learn_time_ms": 1559.265, "learn_throughput": 215.486}, "counters": {"num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "done": false, "episodes_total": 180, "training_iteration": 180, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-45", "timestamp": 1706261145, "time_this_iter_s": 3.5297577381134033, "time_total_s": 629.393177986145, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8048730>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e3a5f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 629.393177986145, "timesteps_since_restore": 0, "iterations_since_restore": 180, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.640000000000001, "ram_util_percent": 32.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.882434844970703, "policy_loss": -0.182504341006279, "vf_loss": 10.0, "vf_explained_var": 3.510051271859993e-07, "kl": 0.008445953950285912, "entropy": 12.478036880493164, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16245.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925428.331493086, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15861345982954755, "mean_inference_ms": 5.21772679858137, "mean_action_processing_ms": 0.14456748202398645, "mean_env_wait_ms": 0.2527706276874918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015617132186889648, "StateBufferConnector_ms": 0.0023429393768310547, "ViewRequirementAgentConnector_ms": 0.060231924057006836}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925428.331493086, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-902343.8605630315, -891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15861345982954755, "mean_inference_ms": 5.21772679858137, "mean_action_processing_ms": 0.14456748202398645, "mean_env_wait_ms": 0.2527706276874918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015617132186889648, "StateBufferConnector_ms": 0.0023429393768310547, "ViewRequirementAgentConnector_ms": 0.060231924057006836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60816, "timers": {"training_iteration_time_ms": 3510.472, "learn_time_ms": 1559.863, "learn_throughput": 215.404}, "counters": {"num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "done": false, "episodes_total": 181, "training_iteration": 181, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-48", "timestamp": 1706261148, "time_this_iter_s": 3.5044705867767334, "time_total_s": 632.8976485729218, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8059ab0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e39fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 632.8976485729218, "timesteps_since_restore": 0, "iterations_since_restore": 181, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 32.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.906145095825195, "policy_loss": -0.16900534927845, "vf_loss": 10.0, "vf_explained_var": 5.828009648212173e-07, "kl": 0.00977414008229971, "entropy": 12.528894424438477, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16335.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925600.654860729, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1586200460071424, "mean_inference_ms": 5.2178234536434385, "mean_action_processing_ms": 0.14457005874179896, "mean_env_wait_ms": 0.2527758480877141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015607118606567383, "StateBufferConnector_ms": 0.0023412704467773438, "ViewRequirementAgentConnector_ms": 0.06022000312805176}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925600.654860729, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-891180.5223141477, -1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1586200460071424, "mean_inference_ms": 5.2178234536434385, "mean_action_processing_ms": 0.14457005874179896, "mean_env_wait_ms": 0.2527758480877141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015607118606567383, "StateBufferConnector_ms": 0.0023412704467773438, "ViewRequirementAgentConnector_ms": 0.06022000312805176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61152, "timers": {"training_iteration_time_ms": 3512.337, "learn_time_ms": 1560.444, "learn_throughput": 215.323}, "counters": {"num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "done": false, "episodes_total": 182, "training_iteration": 182, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-52", "timestamp": 1706261152, "time_this_iter_s": 3.511647939682007, "time_total_s": 636.4092965126038, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8048820>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e3add0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 636.4092965126038, "timesteps_since_restore": 0, "iterations_since_restore": 182, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 32.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.894556999206543, "policy_loss": -0.16967330873012543, "vf_loss": 10.0, "vf_explained_var": 1.1563300859052106e-06, "kl": 0.008353965356945992, "entropy": 12.413738250732422, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16425.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925794.0018771605, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15862657088429427, "mean_inference_ms": 5.217910063986321, "mean_action_processing_ms": 0.14457247093516495, "mean_env_wait_ms": 0.2527810077715128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01561737060546875, "StateBufferConnector_ms": 0.0023429393768310547, "ViewRequirementAgentConnector_ms": 0.06026053428649902}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925794.0018771605, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1009950.82124743, -960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15862657088429427, "mean_inference_ms": 5.217910063986321, "mean_action_processing_ms": 0.14457247093516495, "mean_env_wait_ms": 0.2527810077715128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01561737060546875, "StateBufferConnector_ms": 0.0023429393768310547, "ViewRequirementAgentConnector_ms": 0.06026053428649902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61488, "timers": {"training_iteration_time_ms": 3513.479, "learn_time_ms": 1559.879, "learn_throughput": 215.401}, "counters": {"num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "done": false, "episodes_total": 183, "training_iteration": 183, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-56", "timestamp": 1706261156, "time_this_iter_s": 3.5011942386627197, "time_total_s": 639.9104907512665, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee804a920>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e3a7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 639.9104907512665, "timesteps_since_restore": 0, "iterations_since_restore": 183, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.720000000000001, "ram_util_percent": 32.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.900237083435059, "policy_loss": -0.16985829174518585, "vf_loss": 10.0, "vf_explained_var": 1.144409225162235e-06, "kl": 0.00911674089729786, "entropy": 12.482561111450195, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16515.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924581.7784112267, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15863287600643278, "mean_inference_ms": 5.217991330279554, "mean_action_processing_ms": 0.14457466856385756, "mean_env_wait_ms": 0.25278578450914496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015630722045898438, "StateBufferConnector_ms": 0.0023436546325683594, "ViewRequirementAgentConnector_ms": 0.060277462005615234}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924581.7784112267, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-960788.4236766081, -877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15863287600643278, "mean_inference_ms": 5.217991330279554, "mean_action_processing_ms": 0.14457466856385756, "mean_env_wait_ms": 0.25278578450914496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015630722045898438, "StateBufferConnector_ms": 0.0023436546325683594, "ViewRequirementAgentConnector_ms": 0.060277462005615234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 3514.235, "learn_time_ms": 1559.447, "learn_throughput": 215.461}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "done": false, "episodes_total": 184, "training_iteration": 184, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-25-59", "timestamp": 1706261159, "time_this_iter_s": 3.5138461589813232, "time_total_s": 643.4243369102478, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8048a90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e3b7f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 643.4243369102478, "timesteps_since_restore": 0, "iterations_since_restore": 184, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 32.739999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.903714179992676, "policy_loss": -0.1698131114244461, "vf_loss": 10.0, "vf_explained_var": 1.4881293282087427e-06, "kl": 0.009563008323311806, "entropy": 12.168424606323242, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16605.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924330.3391894726, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15863870563558555, "mean_inference_ms": 5.2180699730001185, "mean_action_processing_ms": 0.1445766241874325, "mean_env_wait_ms": 0.2527901577816264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015625953674316406, "StateBufferConnector_ms": 0.002344846725463867, "ViewRequirementAgentConnector_ms": 0.06027722358703613}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924330.3391894726, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-877850.1289894528, -890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15863870563558555, "mean_inference_ms": 5.2180699730001185, "mean_action_processing_ms": 0.1445766241874325, "mean_env_wait_ms": 0.2527901577816264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015625953674316406, "StateBufferConnector_ms": 0.002344846725463867, "ViewRequirementAgentConnector_ms": 0.06027722358703613}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62160, "timers": {"training_iteration_time_ms": 3513.236, "learn_time_ms": 1558.504, "learn_throughput": 215.591}, "counters": {"num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "done": false, "episodes_total": 185, "training_iteration": 185, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-03", "timestamp": 1706261163, "time_this_iter_s": 3.515177011489868, "time_total_s": 646.9395139217377, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8049f60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e3a170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 646.9395139217377, "timesteps_since_restore": 0, "iterations_since_restore": 185, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 32.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.88378620147705, "policy_loss": -0.1793556660413742, "vf_loss": 10.0, "vf_explained_var": 7.987022172528668e-07, "kl": 0.008212285116314888, "entropy": 12.30041790008545, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16695.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924916.367473788, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1586446998898271, "mean_inference_ms": 5.218148967696527, "mean_action_processing_ms": 0.14457864202448226, "mean_env_wait_ms": 0.2527947378109125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01562190055847168, "StateBufferConnector_ms": 0.002343893051147461, "ViewRequirementAgentConnector_ms": 0.06027626991271973}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924916.367473788, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-890701.536923391, -907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1586446998898271, "mean_inference_ms": 5.218148967696527, "mean_action_processing_ms": 0.14457864202448226, "mean_env_wait_ms": 0.2527947378109125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01562190055847168, "StateBufferConnector_ms": 0.002343893051147461, "ViewRequirementAgentConnector_ms": 0.06027626991271973}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62496, "timers": {"training_iteration_time_ms": 3509.518, "learn_time_ms": 1556.2, "learn_throughput": 215.911}, "counters": {"num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "done": false, "episodes_total": 186, "training_iteration": 186, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-06", "timestamp": 1706261166, "time_this_iter_s": 3.484422445297241, "time_total_s": 650.4239363670349, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8048910>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e3bf40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 650.4239363670349, "timesteps_since_restore": 0, "iterations_since_restore": 186, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 32.980000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.90224552154541, "policy_loss": -0.16757804155349731, "vf_loss": 10.0, "vf_explained_var": 1.2662675317187677e-06, "kl": 0.009081325493752956, "entropy": 12.352555274963379, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16785.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925674.5984550022, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15865059548695823, "mean_inference_ms": 5.218228800778491, "mean_action_processing_ms": 0.14458062922705334, "mean_env_wait_ms": 0.2527993601739582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015612363815307617, "StateBufferConnector_ms": 0.0023431777954101562, "ViewRequirementAgentConnector_ms": 0.06028151512145996}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925674.5984550022, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-907725.4586997227, -927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15865059548695823, "mean_inference_ms": 5.218228800778491, "mean_action_processing_ms": 0.14458062922705334, "mean_env_wait_ms": 0.2527993601739582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015612363815307617, "StateBufferConnector_ms": 0.0023431777954101562, "ViewRequirementAgentConnector_ms": 0.06028151512145996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62832, "timers": {"training_iteration_time_ms": 3508.81, "learn_time_ms": 1555.794, "learn_throughput": 215.967}, "counters": {"num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "done": false, "episodes_total": 187, "training_iteration": 187, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-10", "timestamp": 1706261170, "time_this_iter_s": 3.508044481277466, "time_total_s": 653.9319808483124, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8049660>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e39f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 653.9319808483124, "timesteps_since_restore": 0, "iterations_since_restore": 187, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.66, "ram_util_percent": 33.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.913518905639648, "policy_loss": -0.158625066280365, "vf_loss": 10.0, "vf_explained_var": 3.476937706636818e-07, "kl": 0.009383132681250572, "entropy": 12.470507621765137, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16875.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926192.8954543035, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15865644000158036, "mean_inference_ms": 5.218309890660077, "mean_action_processing_ms": 0.14458272690961452, "mean_env_wait_ms": 0.25280407159492757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015604019165039062, "StateBufferConnector_ms": 0.0023436546325683594, "ViewRequirementAgentConnector_ms": 0.060274600982666016}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -926192.8954543035, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-927136.7558723575, -920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15865644000158036, "mean_inference_ms": 5.218309890660077, "mean_action_processing_ms": 0.14458272690961452, "mean_env_wait_ms": 0.25280407159492757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015604019165039062, "StateBufferConnector_ms": 0.0023436546325683594, "ViewRequirementAgentConnector_ms": 0.060274600982666016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63168, "timers": {"training_iteration_time_ms": 3506.911, "learn_time_ms": 1554.011, "learn_throughput": 216.215}, "counters": {"num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "done": false, "episodes_total": 188, "training_iteration": 188, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-13", "timestamp": 1706261173, "time_this_iter_s": 3.4930460453033447, "time_total_s": 657.4250268936157, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc92d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e68a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 657.4250268936157, "timesteps_since_restore": 0, "iterations_since_restore": 188, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.62, "ram_util_percent": 33.260000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.90145206451416, "policy_loss": -0.1684771180152893, "vf_loss": 10.0, "vf_explained_var": 7.510185469072894e-07, "kl": 0.009095215238630772, "entropy": 12.270100593566895, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 16965.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925721.3086183618, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15866222122934823, "mean_inference_ms": 5.218395036344979, "mean_action_processing_ms": 0.14458491368893941, "mean_env_wait_ms": 0.25280884131735204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015591859817504883, "StateBufferConnector_ms": 0.002343416213989258, "ViewRequirementAgentConnector_ms": 0.06020641326904297}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925721.3086183618, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-920468.7694321234, -929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15866222122934823, "mean_inference_ms": 5.218395036344979, "mean_action_processing_ms": 0.14458491368893941, "mean_env_wait_ms": 0.25280884131735204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015591859817504883, "StateBufferConnector_ms": 0.002343416213989258, "ViewRequirementAgentConnector_ms": 0.06020641326904297}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63504, "timers": {"training_iteration_time_ms": 3506.499, "learn_time_ms": 1553.655, "learn_throughput": 216.264}, "counters": {"num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "done": false, "episodes_total": 189, "training_iteration": 189, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-17", "timestamp": 1706261177, "time_this_iter_s": 3.5081288814544678, "time_total_s": 660.9331557750702, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8048400>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e3a290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 660.9331557750702, "timesteps_since_restore": 0, "iterations_since_restore": 189, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.48, "ram_util_percent": 33.38}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.889042854309082, "policy_loss": -0.18104961514472961, "vf_loss": 10.0, "vf_explained_var": 7.357862159551587e-07, "kl": 0.00911636557430029, "entropy": 12.305150032043457, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17055.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925635.4572743757, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15866784230480513, "mean_inference_ms": 5.218481402806517, "mean_action_processing_ms": 0.14458726553728188, "mean_env_wait_ms": 0.2528130330658184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015599966049194336, "StateBufferConnector_ms": 0.0023441314697265625, "ViewRequirementAgentConnector_ms": 0.0602107048034668}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925635.4572743757, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-929997.000540979, -906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15866784230480513, "mean_inference_ms": 5.218481402806517, "mean_action_processing_ms": 0.14458726553728188, "mean_env_wait_ms": 0.2528130330658184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015599966049194336, "StateBufferConnector_ms": 0.0023441314697265625, "ViewRequirementAgentConnector_ms": 0.0602107048034668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63840, "timers": {"training_iteration_time_ms": 3504.923, "learn_time_ms": 1552.845, "learn_throughput": 216.377}, "counters": {"num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "done": false, "episodes_total": 190, "training_iteration": 190, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-20", "timestamp": 1706261180, "time_this_iter_s": 3.5139472484588623, "time_total_s": 664.447103023529, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc9120>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e692d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 664.447103023529, "timesteps_since_restore": 0, "iterations_since_restore": 190, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.76, "ram_util_percent": 33.519999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.889842987060547, "policy_loss": -0.17774216830730438, "vf_loss": 10.0, "vf_explained_var": 7.775094559292484e-07, "kl": 0.008790265768766403, "entropy": 12.680468559265137, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17145.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925220.5782250975, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15867371606897543, "mean_inference_ms": 5.218574334863299, "mean_action_processing_ms": 0.1445896877503733, "mean_env_wait_ms": 0.25281739665227365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015606164932250977, "StateBufferConnector_ms": 0.002343416213989258, "ViewRequirementAgentConnector_ms": 0.06021928787231445}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925220.5782250975, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-906888.4209656182, -939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15867371606897543, "mean_inference_ms": 5.218574334863299, "mean_action_processing_ms": 0.1445896877503733, "mean_env_wait_ms": 0.25281739665227365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015606164932250977, "StateBufferConnector_ms": 0.002343416213989258, "ViewRequirementAgentConnector_ms": 0.06021928787231445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64176, "timers": {"training_iteration_time_ms": 3504.483, "learn_time_ms": 1552.67, "learn_throughput": 216.401}, "counters": {"num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "done": false, "episodes_total": 191, "training_iteration": 191, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-24", "timestamp": 1706261184, "time_this_iter_s": 3.5000433921813965, "time_total_s": 667.9471464157104, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc96c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e69120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 667.9471464157104, "timesteps_since_restore": 0, "iterations_since_restore": 191, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.74, "ram_util_percent": 33.660000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.88770580291748, "policy_loss": -0.17705002427101135, "vf_loss": 10.0, "vf_explained_var": 1.1026859283447266e-06, "kl": 0.008422392420470715, "entropy": 12.403812408447266, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17235.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925692.0741492964, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15867954289304373, "mean_inference_ms": 5.218670947316019, "mean_action_processing_ms": 0.1445920201868719, "mean_env_wait_ms": 0.2528218575680873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015601873397827148, "StateBufferConnector_ms": 0.002341032028198242, "ViewRequirementAgentConnector_ms": 0.06021571159362793}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925692.0741492964, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-939405.8578806389, -919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15867954289304373, "mean_inference_ms": 5.218670947316019, "mean_action_processing_ms": 0.1445920201868719, "mean_env_wait_ms": 0.2528218575680873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015601873397827148, "StateBufferConnector_ms": 0.002341032028198242, "ViewRequirementAgentConnector_ms": 0.06021571159362793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 3497.979, "learn_time_ms": 1551.933, "learn_throughput": 216.504}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "episodes_total": 192, "training_iteration": 192, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-27", "timestamp": 1706261187, "time_this_iter_s": 3.446631669998169, "time_total_s": 671.3937780857086, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc88e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e69ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 671.3937780857086, "timesteps_since_restore": 0, "iterations_since_restore": 192, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 33.779999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.893929481506348, "policy_loss": -0.1683434545993805, "vf_loss": 10.0, "vf_explained_var": 7.748603820800781e-07, "kl": 0.008099266327917576, "entropy": 12.392992973327637, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925170.4957784218, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15868569928783852, "mean_inference_ms": 5.21877708585833, "mean_action_processing_ms": 0.14459471576180086, "mean_env_wait_ms": 0.2528267364590369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015612602233886719, "StateBufferConnector_ms": 0.002341032028198242, "ViewRequirementAgentConnector_ms": 0.06025242805480957}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925170.4957784218, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-919828.5721738758, -908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15868569928783852, "mean_inference_ms": 5.21877708585833, "mean_action_processing_ms": 0.14459471576180086, "mean_env_wait_ms": 0.2528267364590369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015612602233886719, "StateBufferConnector_ms": 0.002341032028198242, "ViewRequirementAgentConnector_ms": 0.06025242805480957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64848, "timers": {"training_iteration_time_ms": 3499.488, "learn_time_ms": 1553.529, "learn_throughput": 216.282}, "counters": {"num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "done": false, "episodes_total": 193, "training_iteration": 193, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-31", "timestamp": 1706261191, "time_this_iter_s": 3.5163002014160156, "time_total_s": 674.9100782871246, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc8fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e69990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 674.9100782871246, "timesteps_since_restore": 0, "iterations_since_restore": 193, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 33.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.90167236328125, "policy_loss": -0.16780975461006165, "vf_loss": 10.0, "vf_explained_var": 1.8874804652568855e-07, "kl": 0.009036864154040813, "entropy": 12.419658660888672, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17415.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925127.0915146458, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15869199393040048, "mean_inference_ms": 5.218883603298014, "mean_action_processing_ms": 0.14459745417507583, "mean_env_wait_ms": 0.25283176326901047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015616893768310547, "StateBufferConnector_ms": 0.0023398399353027344, "ViewRequirementAgentConnector_ms": 0.06024026870727539}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925127.0915146458, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-908490.3109711998, -977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15869199393040048, "mean_inference_ms": 5.218883603298014, "mean_action_processing_ms": 0.14459745417507583, "mean_env_wait_ms": 0.25283176326901047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015616893768310547, "StateBufferConnector_ms": 0.0023398399353027344, "ViewRequirementAgentConnector_ms": 0.06024026870727539}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65184, "timers": {"training_iteration_time_ms": 3498.307, "learn_time_ms": 1552.799, "learn_throughput": 216.383}, "counters": {"num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "done": false, "episodes_total": 194, "training_iteration": 194, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-34", "timestamp": 1706261194, "time_this_iter_s": 3.502072334289551, "time_total_s": 678.4121506214142, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80608e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e6a290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 678.4121506214142, "timesteps_since_restore": 0, "iterations_since_restore": 194, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.660000000000001, "ram_util_percent": 34.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.899507522583008, "policy_loss": -0.16429650783538818, "vf_loss": 10.0, "vf_explained_var": 8.742014756535355e-08, "kl": 0.008298410102725029, "entropy": 12.72007942199707, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17505.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925171.5126851368, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1586982323062714, "mean_inference_ms": 5.2189920959054605, "mean_action_processing_ms": 0.14460025541531987, "mean_env_wait_ms": 0.2528370363276414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015610694885253906, "StateBufferConnector_ms": 0.0023391246795654297, "ViewRequirementAgentConnector_ms": 0.06022334098815918}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -925171.5126851368, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-977108.316993952, -938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1586982323062714, "mean_inference_ms": 5.2189920959054605, "mean_action_processing_ms": 0.14460025541531987, "mean_env_wait_ms": 0.2528370363276414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015610694885253906, "StateBufferConnector_ms": 0.0023391246795654297, "ViewRequirementAgentConnector_ms": 0.06022334098815918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65520, "timers": {"training_iteration_time_ms": 3495.518, "learn_time_ms": 1551.736, "learn_throughput": 216.532}, "counters": {"num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "done": false, "episodes_total": 195, "training_iteration": 195, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-38", "timestamp": 1706261198, "time_this_iter_s": 3.487309694290161, "time_total_s": 681.8994603157043, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc9150>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e695a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 681.8994603157043, "timesteps_since_restore": 0, "iterations_since_restore": 195, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.540000000000001, "ram_util_percent": 34.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.891149520874023, "policy_loss": -0.17418670654296875, "vf_loss": 10.0, "vf_explained_var": 7.304880114133994e-07, "kl": 0.008497769013047218, "entropy": 12.520193099975586, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17595.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924558.9391295121, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15870422419625071, "mean_inference_ms": 5.219093240909672, "mean_action_processing_ms": 0.14460292604516722, "mean_env_wait_ms": 0.25284193153476386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015608072280883789, "StateBufferConnector_ms": 0.0023393630981445312, "ViewRequirementAgentConnector_ms": 0.060210227966308594}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924558.9391295121, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-938189.9529975704, -905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15870422419625071, "mean_inference_ms": 5.219093240909672, "mean_action_processing_ms": 0.14460292604516722, "mean_env_wait_ms": 0.25284193153476386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015608072280883789, "StateBufferConnector_ms": 0.0023393630981445312, "ViewRequirementAgentConnector_ms": 0.060210227966308594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65856, "timers": {"training_iteration_time_ms": 3491.595, "learn_time_ms": 1549.203, "learn_throughput": 216.886}, "counters": {"num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "done": false, "episodes_total": 196, "training_iteration": 196, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-41", "timestamp": 1706261201, "time_this_iter_s": 3.4451937675476074, "time_total_s": 685.344654083252, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8060460>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e6ab00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 685.344654083252, "timesteps_since_restore": 0, "iterations_since_restore": 196, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.58, "ram_util_percent": 34.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.894119262695312, "policy_loss": -0.17006339132785797, "vf_loss": 10.0, "vf_explained_var": 3.3908420959960495e-07, "kl": 0.008347634226083755, "entropy": 12.681081771850586, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17685.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924621.1982432163, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548, -944415.8643680039], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15871020387717313, "mean_inference_ms": 5.219193170266485, "mean_action_processing_ms": 0.14460552393088394, "mean_env_wait_ms": 0.2528466675344099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01559758186340332, "StateBufferConnector_ms": 0.002339601516723633, "ViewRequirementAgentConnector_ms": 0.06020474433898926}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924621.1982432163, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-905456.3176641642, -970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548, -944415.8643680039], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15871020387717313, "mean_inference_ms": 5.219193170266485, "mean_action_processing_ms": 0.14460552393088394, "mean_env_wait_ms": 0.2528466675344099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01559758186340332, "StateBufferConnector_ms": 0.002339601516723633, "ViewRequirementAgentConnector_ms": 0.06020474433898926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66192, "timers": {"training_iteration_time_ms": 3488.01, "learn_time_ms": 1547.406, "learn_throughput": 217.138}, "counters": {"num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "done": false, "episodes_total": 197, "training_iteration": 197, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-45", "timestamp": 1706261205, "time_this_iter_s": 3.472198963165283, "time_total_s": 688.8168530464172, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7fc8b80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e68c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 688.8168530464172, "timesteps_since_restore": 0, "iterations_since_restore": 197, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.52, "ram_util_percent": 34.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.896903038024902, "policy_loss": -0.17125171422958374, "vf_loss": 10.0, "vf_explained_var": 1.8278757352163666e-07, "kl": 0.008864336647093296, "entropy": 12.61921215057373, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17775.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924606.6160184299, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548, -944415.8643680039, -903998.095185498], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15871592134535192, "mean_inference_ms": 5.219291278015933, "mean_action_processing_ms": 0.14460807360451786, "mean_env_wait_ms": 0.25285108948066326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015521049499511719, "StateBufferConnector_ms": 0.002337932586669922, "ViewRequirementAgentConnector_ms": 0.06017780303955078}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924606.6160184299, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-970113.0684338338, -909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548, -944415.8643680039, -903998.095185498], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15871592134535192, "mean_inference_ms": 5.219291278015933, "mean_action_processing_ms": 0.14460807360451786, "mean_env_wait_ms": 0.25285108948066326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015521049499511719, "StateBufferConnector_ms": 0.002337932586669922, "ViewRequirementAgentConnector_ms": 0.06017780303955078}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66528, "timers": {"training_iteration_time_ms": 3488.361, "learn_time_ms": 1548.628, "learn_throughput": 216.966}, "counters": {"num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "done": false, "episodes_total": 198, "training_iteration": 198, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-48", "timestamp": 1706261208, "time_this_iter_s": 3.496549367904663, "time_total_s": 692.3134024143219, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80605e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e6b520>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 692.3134024143219, "timesteps_since_restore": 0, "iterations_since_restore": 198, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.74, "ram_util_percent": 34.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.892593383789062, "policy_loss": -0.17737756669521332, "vf_loss": 10.0, "vf_explained_var": 9.265210678677249e-07, "kl": 0.009100641123950481, "entropy": 12.717581748962402, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17865.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924239.2117226822, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548, -944415.8643680039, -903998.095185498, -933372.6388590983], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.158721549704201, "mean_inference_ms": 5.219389389401795, "mean_action_processing_ms": 0.14461060858758165, "mean_env_wait_ms": 0.25285542216119716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015503406524658203, "StateBufferConnector_ms": 0.0023355484008789062, "ViewRequirementAgentConnector_ms": 0.06016993522644043}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924239.2117226822, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-909446.7117475043, -938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548, -944415.8643680039, -903998.095185498, -933372.6388590983], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.158721549704201, "mean_inference_ms": 5.219389389401795, "mean_action_processing_ms": 0.14461060858758165, "mean_env_wait_ms": 0.25285542216119716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015503406524658203, "StateBufferConnector_ms": 0.0023355484008789062, "ViewRequirementAgentConnector_ms": 0.06016993522644043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66864, "timers": {"training_iteration_time_ms": 3487.673, "learn_time_ms": 1547.762, "learn_throughput": 217.088}, "counters": {"num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "done": false, "episodes_total": 199, "training_iteration": 199, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-52", "timestamp": 1706261212, "time_this_iter_s": 3.5012447834014893, "time_total_s": 695.8146471977234, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80613c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e69ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 695.8146471977234, "timesteps_since_restore": 0, "iterations_since_restore": 199, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 34.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.688672065734863, "cur_lr": 0.0010000000474974513, "total_loss": 9.889647483825684, "policy_loss": -0.17435741424560547, "vf_loss": 10.0, "vf_explained_var": 1.0669231187421246e-06, "kl": 0.008324522525072098, "entropy": 12.678781509399414, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 112.0, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 44.5}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "sampler_results": {"episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924324.6387637296, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548, -944415.8643680039, -903998.095185498, -933372.6388590983, -917989.4158522283], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15872707913366702, "mean_inference_ms": 5.2194897490002585, "mean_action_processing_ms": 0.14461307167459897, "mean_env_wait_ms": 0.2528598005723676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01550745964050293, "StateBufferConnector_ms": 0.002336740493774414, "ViewRequirementAgentConnector_ms": 0.06017589569091797}}, "episode_reward_max": -867010.7821468462, "episode_reward_min": -1011882.9546707764, "episode_reward_mean": -924324.6387637296, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-938908.9400084806, -915084.1640360822, -945792.590657008, -878230.4884697733, -929809.6092227483, -911371.3398039506, -955273.1457115591, -938618.7321411484, -943284.1537580473, -940848.1558097684, -985860.2986208501, -922628.547496409, -929214.4650225008, -903044.3774296539, -916394.9885680645, -870528.6405482129, -925203.4328232488, -867010.7821468462, -894715.4621234719, -919980.1591661609, -876556.2931610151, -920988.520135354, -907719.6545308351, -878960.0783556602, -888978.4424806595, -922544.542092614, -961654.2099097997, -952904.5711428456, -875563.1118057983, -962339.5152676876, -956858.2534122374, -908952.5714508567, -931217.5866957633, -905978.7492544355, -934935.7819486331, -912400.8917951118, -906517.9785363429, -931067.7954137096, -981835.9846552851, -870332.3851558275, -914226.8677709933, -921474.4629521098, -901964.725639059, -925209.0986839955, -919255.8010894579, -952541.9637533756, -896085.3284249727, -908516.6718052658, -958795.4605374458, -1011882.9546707764, -955822.5134585658, -901309.470655956, -967046.1057476742, -912541.6762986116, -977245.6336585465, -916444.8018335756, -952855.7763920185, -935597.3567699952, -948039.5088006491, -914811.6716433077, -928217.78827173, -881668.5714136902, -904705.7196327344, -949426.6728147994, -899445.1859285367, -916842.6268011732, -957540.5010140376, -939895.8320705373, -903937.482612783, -922747.4578806021, -931489.7973898061, -941306.203319497, -895556.1902583609, -969514.6666833773, -909279.8007067752, -915647.9842475088, -970906.1631990313, -899660.7261019762, -945806.670923787, -927365.9805395713, -927023.0780598713, -919576.1973273328, -910515.223957299, -888728.4746540652, -935644.5015011829, -936452.9574209952, -966524.6350448102, -959555.1586298555, -879978.0722781844, -911883.6350335181, -888509.0956131645, -954038.0133854938, -887248.0207931894, -915488.14579629, -912932.4280202945, -915850.9614314548, -944415.8643680039, -903998.095185498, -933372.6388590983, -917989.4158522283], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15872707913366702, "mean_inference_ms": 5.2194897490002585, "mean_action_processing_ms": 0.14461307167459897, "mean_env_wait_ms": 0.2528598005723676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01550745964050293, "StateBufferConnector_ms": 0.002336740493774414, "ViewRequirementAgentConnector_ms": 0.06017589569091797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 67200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 3491.274, "learn_time_ms": 1548.39, "learn_throughput": 217.0}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "done": true, "episodes_total": 200, "training_iteration": 200, "trial_id": "6395c_00000", "experiment_id": "6ce7fcdec1494c54946bcd9548096e10", "date": "2024-01-26_09-26-55", "timestamp": 1706261215, "time_this_iter_s": 3.549959659576416, "time_total_s": 699.3646068572998, "pid": 31437, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8061ff0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e6bd00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 699.3646068572998, "timesteps_since_restore": 0, "iterations_since_restore": 200, "warmup_time": 4.396353721618652, "perf": {"cpu_util_percent": 5.68, "ram_util_percent": 34.839999999999996}}
